\documentclass{article}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[english]{babel}

% Set page size and margins
% Replace `letterpaper' with`a4paper' for UK/EU standard size
\usepackage[letterpaper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}

% Useful packages
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{graphicx}
\usepackage{stmaryrd}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{amssymb}


\title{}
\date{}
\author{Rafael Fern√°ndez Ortiz}

\begin{document}
\maketitle

\section*{Assignments 1}
\begin{enumerate}
\item Let us assume $e,e' \in AExp$ and $x\in Var$. The notation $e[x/e']$ denotes the result of replacing all occurrences of $x$ in $e$ by $e'$. For example: $(x+y)[x/(3*z)] = (3*z)+y$.
    \begin{enumerate}
        \item Define $e[x/e']$ in a compositional way.
        \item Prove the following substitution lemma: for all $e,e' \in AExp, x\in Var, \sigma \in State$:
        $$\mathcal{A}\llbracket e[x/e'] \rrbracket \sigma = \mathcal{A}\llbracket e \rrbracket \sigma [x \xrightarrow[]{}\mathcal{A} \llbracket e'\rrbracket\sigma]$$
    \end{enumerate}
\subsubsection*{Proof}
    \begin{enumerate}
        \item Let us assume that $e_{1}, e_{2}, e' \in AExp$ and $x, y \in Var$ such that $x \neq y$. We can define  $e[x/e']$ in terms of $AExp$ as follow:
        \begin{align*}
        n[x/e'] &= n \\
        x[x/e'] &= e' \\
        y[x/e'] &= y \\
        (e_1 + e_2)[x/e'] &= (e_1)[x/e'] + (e_2)[x/e'] \\
        (e_1 - e_2)[x/e'] &= (e_1)[x/e'] - (e_2)[x/e'] \\
        (e_1 * e_2)[x/e'] &= (e_1)[x/e'] \cdot (e_2)[x/e']
        \end{align*}
        
        \item In order to prove the following equality, we need to apply structural induction for every term in $AExp$. Now we can consider the semantics function $$\mathcal{A}\llbracket \_ \rrbracket : AExp \longrightarrow State \longrightarrow \mathbb Z $$
        
        We can assume the base case when $e$ be either $n$ or a variable $x \in Var$. Once we proved that (it will be our structural induction hipothesis, SIH) we will assume this for any expression $e$ and we will try to prove one of the compositioned expression, for instance the sum expression (the rest will be similiar).\\
        
        Therefore, let's first consider the case  \mbox{\boldmath $e := n$}.
        \begin{align*}
        \mathcal{A}\llbracket n[x/e'] \rrbracket \sigma &=^{(1)} \mathcal{A}\llbracket n \rrbracket \sigma = n
        \end{align*}
        for all $\sigma: State \longrightarrow \mathbb Z$, in particular for $\sigma [x \rightarrow n ]$. Thus, we obtain
        
        \begin{align*}
        \begin{split}
        \mathcal{A}\llbracket n[x/e'] \rrbracket \sigma & =^{(1)} \mathcal{A}\llbracket n \rrbracket \sigma \\
        & = n \\
        & = \mathcal{A}\llbracket n \rrbracket \sigma [x \rightarrow n]
        \end{split}
        \end{align*}
        
        Let us see the case when \mbox{\boldmath $e := x$} with $x \in Var$. Let $e' \in AExp$ and $m \in \mathbb Z$ be such that $\mathcal{A}\llbracket e' \rrbracket \sigma = m$  $\forall \sigma \in State$, in particular $\sigma [x \rightarrow m]$:
        \begin{equation*}
        \begin{split}
        \mathcal{A}\llbracket x[x/e'] \rrbracket \sigma & =^{(1)} \mathcal{A}\llbracket e' \rrbracket \sigma \\
        & = m\\
        & = \mathcal{A}\llbracket x \rrbracket \sigma[x \rightarrow m] \\
        & = \mathcal{A}\llbracket x \rrbracket \sigma[x \rightarrow \mathcal{A}\llbracket e' \rrbracket \sigma]
        \end{split}
        \end{equation*}
        We can obtain analogously \mbox{\boldmath $e := y$} because the fact of mapping a variable $y$ by $\sigma[x \rightarrow m]$ doesn't affect.\\
        
        Let $e' \in AExp$ and $m, m' \in \mathbb Z$ be such that $\mathcal{A}\llbracket e' \rrbracket \sigma = m$ and $\mathcal{A}\llbracket y \rrbracket \sigma = m'$ $\forall \sigma \in State$. In particular, for $\sigma[x \rightarrow m]$:
        
        \begin{equation}\tag{2}
        \mathcal{A}\llbracket y \rrbracket \sigma[x \rightarrow m] = m'
        \end{equation}
        
       \begin{equation*}
        \begin{split}
        \mathcal{A}\llbracket y[x/e'] \rrbracket \sigma & =^{(1)} \mathcal{A}\llbracket y \rrbracket \sigma \\
        & = m'\\
        & =^{(2)} \mathcal{A}\llbracket y \rrbracket \sigma[x \rightarrow m] \\
        & = \mathcal{A}\llbracket y \rrbracket \sigma[x \rightarrow \mathcal{A}\llbracket e' \rrbracket \sigma]
        \end{split}
        \end{equation*}

        Finally, let us consider some expressions $e_1, e_2 \in AExp$. We can continue with the sum compositioned expression proof as follow
        \begin{equation*}
        \begin{split}
        \mathcal{A}\llbracket (e_1 + e_2)[x/e'] \rrbracket \sigma & =^{(1)} \mathcal{A}\llbracket (e_1)[x/e'] \rrbracket \sigma + \mathcal{A}\llbracket (e_2)[x/e'] \rrbracket \sigma \\
        & =^{(SIH)} \mathcal{A}\llbracket e_1 \rrbracket \sigma [x \rightarrow \mathcal{A} \llbracket e'\rrbracket\sigma] + \mathcal{A}\llbracket (e_2)[x/e'] \rrbracket \sigma \\
        & =^{(SIH)} \mathcal{A}\llbracket e_1 \rrbracket \sigma [x \rightarrow \mathcal{A} \llbracket e'\rrbracket\sigma] + \mathcal{A}\llbracket e_2 \rrbracket \sigma [x \rightarrow \mathcal{A} \llbracket e'\rrbracket\sigma] \\
        & =^{(def)} \mathcal{A}\llbracket (e_1 + e_2) \rrbracket \sigma [x \rightarrow \mathcal{A} \llbracket (e')\rrbracket\sigma] \\
        \end{split}
        \end{equation*}
        \footnote{By the last section}

    \end{enumerate}
\end{enumerate}

\begin{flushright}\rule{0.7em}{0.7em}\end{flushright}


\end{document}