<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/MeasureSets/Sets.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>{VV##4930 : GHC.Types.Module | $k_##4931}</span><span class='hs-keyword'>{-@</span></a> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>MeasureSets.Sets</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  4: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Set</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>insert</span><span class='hs-layout'>,</span> <span class='hs-varid'>partition</span><span class='hs-layout'>,</span> <span class='hs-varid'>filter</span><span class='hs-layout'>,</span> <span class='hs-varid'>split</span><span class='hs-layout'>,</span> <span class='hs-varid'>elems</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  5: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span>  <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>elem</span><span class='hs-layout'>,</span> <span class='hs-varid'>reverse</span><span class='hs-layout'>,</span> <span class='hs-varid'>filter</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  6: </span>
<span class=hs-linenum>  7: </span><span class='hs-definition'>main</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>  8: </span><a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-definition'>main</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>return</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4973 : () | lq_tmp$x##4973 == GHC.Tuple.()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum>  9: </span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>die</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| false}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 11: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##594:{v : [GHC.Types.Char] | false} -&gt; a</span><span class='hs-definition'>die</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span>
<span class=hs-linenum> 12: </span>
<span class=hs-linenum> 13: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 14: </span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>True</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>|</span>     <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 16: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>False</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>not</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 17: </span>
<span class=hs-linenum> 18: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>elts</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 19: </span><span class='hs-definition'>elts</span>        <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Set</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 20: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##875:[a] -&gt; {VV : (Data.Set.Internal.Set a) | VV == MeasureSets.Sets.elts lq_tmp$x##875}</span><span class='hs-definition'>elts</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a##a4wX .
      {lq_tmp$x##903 : (Data.Set.Internal.Set a##a4wX) | Set_emp lq_tmp$x##903} | VV == Data.Set.Internal.empty}</span><span class='hs-varid'>empty</span></a>
<span class=hs-linenum> 21: </span><span class='hs-definition'>elts</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##945 : (Data.Set.Internal.Set {lq_tmp$x##950 : a | $k_##949[VV##948:=lq_tmp$x##950][lq_tmp$x##947:=x##a2CO]}) | lq_tmp$x##945 == Set_sng x##a2CO}</span><span class='hs-varid'>singleton</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##951 : a | lq_tmp$x##951 == x##a2CO}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>`union`</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##960 : (Data.Set.Internal.Set {lq_tmp$x##969 : a | $k_##968[VV##967:=lq_tmp$x##969][lq_tmp$x##964:=fix$36$$36$dOrd_a2M4][lq_tmp$x##965:=xs##a2CP]}) | lq_tmp$x##960 == MeasureSets.Sets.elts xs##a2CP}</span><span class='hs-varid'>elts</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##975 : [a] | lq_tmp$x##975 == xs##a2CP
                       &amp;&amp; len lq_tmp$x##975 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 22: </span>
<span class=hs-linenum> 23: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListS</span> <span class='hs-varid'>a</span> <span class='hs-conid'>S</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>elts</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>S</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 24: </span>
<span class=hs-linenum> 25: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListEmp</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListS</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-conid'>Set_empty</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 26: </span>
<span class=hs-linenum> 27: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListEq</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListS</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-varid'>elts</span> <span class='hs-conid'>X</span><span class='hs-layout'>}</span>    <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListSub</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-keyglyph'>|</span> <span class='hs-conid'>Set_sub</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 30: </span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListUn</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListS</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-conid'>Set_cup</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 32: </span>
<span class=hs-linenum> 33: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListUn1</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListS</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-conid'>Set_cup</span> <span class='hs-layout'>(</span><span class='hs-conid'>Set_sng</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>append'</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ys</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListUn</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 36: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1156:[a] -&gt; lq_tmp$x##1157:[a] -&gt; {VV##0 : [a] | MeasureSets.Sets.elts VV##0 == Set_cup (MeasureSets.Sets.elts lq_tmp$x##1156) (MeasureSets.Sets.elts lq_tmp$x##1157)}</span><span class='hs-definition'>append'</span></a> <span class='hs-conid'>[]</span>     <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1189 : [a] | lq_tmp$x##1189 == ys##a2CQ
                        &amp;&amp; len lq_tmp$x##1189 &gt;= 0}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum> 37: </span><span class='hs-definition'>append'</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1285 : a | lq_tmp$x##1285 == x##a2CR}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1238 : [{lq_tmp$x##1250 : a | $k_##1249[VV##1248:=lq_tmp$x##1250][lq_tmp$x##1243:=xs##a2CS][lq_tmp$x##1244:=ys##a2CQ]}] | MeasureSets.Sets.elts lq_tmp$x##1238 == Set_cup (MeasureSets.Sets.elts xs##a2CS) (MeasureSets.Sets.elts ys##a2CQ)}</span><span class='hs-varid'>append'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1254 : [a] | lq_tmp$x##1254 == xs##a2CS
                        &amp;&amp; len lq_tmp$x##1254 &gt;= 0}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1259 : [a] | lq_tmp$x##1259 == ys##a2CQ
                        &amp;&amp; len lq_tmp$x##1259 &gt;= 0}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum> 38: </span>
<span class=hs-linenum> 39: </span><span class='hs-comment'>{- ################################################### 
### Exercise 1: Type to revHelper
#######################################################-}</span>
<span class=hs-linenum> 42: </span>
<span class=hs-linenum> 43: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reverse'</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListEq</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 44: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1431:[a] -&gt; {VV##0 : [a] | MeasureSets.Sets.elts VV##0 == MeasureSets.Sets.elts lq_tmp$x##1431}</span><span class='hs-definition'>reverse'</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>revHelper</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##1438 : [a]&lt;\lq_tmp$x##1439 VV -&gt; {lq_tmp$x##1437 : a&lt;p lq_tmp$x##1439&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##1438
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##1438)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##1438 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##1438 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1480 : [a] | lq_tmp$x##1480 == xs##a2CU
                        &amp;&amp; len lq_tmp$x##1480 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 45: </span>
<span class=hs-linenum> 46: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>revHelper</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ys</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListUn</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 47: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1294:[a] -&gt; lq_tmp$x##1295:[a] -&gt; {VV##0 : [a] | MeasureSets.Sets.elts VV##0 == Set_cup (MeasureSets.Sets.elts lq_tmp$x##1294) (MeasureSets.Sets.elts lq_tmp$x##1295)}</span><span class='hs-definition'>revHelper</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>acc</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1327 : [a] | lq_tmp$x##1327 == acc##a2CV
                        &amp;&amp; len lq_tmp$x##1327 &gt;= 0}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum> 48: </span><span class='hs-definition'>revHelper</span> <span class='hs-varid'>acc</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1294:[a] -&gt; lq_tmp$x##1295:[a] -&gt; {VV##0 : [a] | MeasureSets.Sets.elts VV##0 == Set_cup (MeasureSets.Sets.elts lq_tmp$x##1294) (MeasureSets.Sets.elts lq_tmp$x##1295)}</span><span class='hs-varid'>revHelper</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1373 : [{lq_tmp$x##1383 : a | $k_##1382[VV##1381:=lq_tmp$x##1383][lq_tmp$x##1377:=x##a2CX][lq_tmp$x##1378:=acc##a2CV]}]&lt;\lq_tmp$x##1380 VV -&gt; {lq_tmp$x##1383 : a | $k_##1385[VV##1384:=lq_tmp$x##1383][lq_tmp$x##1377:=x##a2CX][lq_tmp$x##1378:=acc##a2CV][lq_tmp$x##1386:=lq_tmp$x##1380]}&gt; | (MeasureSets.Sets.unique lq_tmp$x##1373 &lt;=&gt; MeasureSets.Sets.unique acc##a2CV
                                                                                                                                                                                                                                                                                                                                                       &amp;&amp; not (Set_mem x##a2CX (MeasureSets.Sets.elts acc##a2CV)))
                                                                                                                                                                                                                                                                                                           &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##1373 == Set_cup (Set_sng x##a2CX) (MeasureSets.Sets.elts acc##a2CV)
                                                                                                                                                                                                                                                                                                           &amp;&amp; head lq_tmp$x##1373 == x##a2CX
                                                                                                                                                                                                                                                                                                           &amp;&amp; len lq_tmp$x##1373 == 1 + len acc##a2CV
                                                                                                                                                                                                                                                                                                           &amp;&amp; listElts lq_tmp$x##1373 == Set_cup (Set_sng x##a2CX) (listElts acc##a2CV)
                                                                                                                                                                                                                                                                                                           &amp;&amp; tail lq_tmp$x##1373 == acc##a2CV}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1388 : a | lq_tmp$x##1388 == x##a2CX}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1392 : [a] | lq_tmp$x##1392 == acc##a2CV
                        &amp;&amp; len lq_tmp$x##1392 &gt;= 0}</span><span class='hs-varid'>acc</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1427 : [a] | lq_tmp$x##1427 == xs##a2CY
                        &amp;&amp; len lq_tmp$x##1427 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 49: </span>
<span class=hs-linenum> 50: </span>
<span class=hs-linenum> 51: </span><span class='hs-comment'>{- ################################################### 
### Exercise 2: Type to halve
#######################################################-}</span>
<span class=hs-linenum> 54: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListPairFrom</span> <span class='hs-varid'>a</span> <span class='hs-conid'>Ls</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>p</span><span class='hs-conop'>:</span> <span class='hs-layout'>(</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>elts</span> <span class='hs-conid'>Ls</span> <span class='hs-varop'>==</span> <span class='hs-conid'>Set_cup</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-layout'>(</span><span class='hs-varid'>fst</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>elts</span> <span class='hs-layout'>(</span><span class='hs-varid'>snd</span> <span class='hs-varid'>p</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 55: </span>
<span class=hs-linenum> 56: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>halve</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListPairFrom</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 57: </span><span class='hs-definition'>halve</span>            <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 58: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1484:GHC.Types.Int -&gt; lq_tmp$x##1485:[a] -&gt; {VV##0 : ([a], [a]) | MeasureSets.Sets.elts lq_tmp$x##1485 == Set_cup (MeasureSets.Sets.elts (fst VV##0)) (MeasureSets.Sets.elts (snd VV##0))}</span><span class='hs-definition'>halve</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2053 : [{lq_tmp$x##2057 : a | $k_##2056[VV##2055:=lq_tmp$x##2057]}]&lt;\lq_tmp$x##2054 VV -&gt; {lq_tmp$x##2057 : a | $k_##2059[VV##2058:=lq_tmp$x##2057][lq_tmp$x##2060:=lq_tmp$x##2054]}&gt; | MeasureSets.Sets.unique lq_tmp$x##2053
                                                                                                                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##2053)
                                                                                                                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2053 == Set_empty 0
                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##2053 == 0}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##2053 : [a]&lt;\lq_tmp$x##2054 VV -&gt; {lq_tmp$x##2052 : a&lt;p lq_tmp$x##2054&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##2053
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##2053)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2053 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##2053 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2114 : [a] | lq_tmp$x##2114 == xs##a2CZ
                        &amp;&amp; len lq_tmp$x##2114 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 59: </span><span class='hs-definition'>halve</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>zs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##2004:a -&gt; lq_tmp$x##2005:{lq_tmp$x##1996 : b&lt;p2 lq_tmp$x##2004&gt; | true} -&gt; {lq_tmp$x##2001 : (a, b)&lt;\lq_tmp$x##2006 VV -&gt; {lq_tmp$x##2000 : b&lt;p2 lq_tmp$x##2006&gt; | true}&gt; | fst lq_tmp$x##2001 == lq_tmp$x##2004
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##2001 == lq_tmp$x##2005
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##2001 == lq_tmp$x##2004
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##2001 == lq_tmp$x##2005} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1958 : a | lq_tmp$x##1958 == x##a2D1}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1962 : [{lq_tmp$x##1959 : a | $k_##1824[VV##1823:=lq_tmp$x##1959][VV##1828:=lq_tmp$x##1962]}]&lt;\lq_tmp$x##1963 VV -&gt; {lq_tmp$x##1961 : a | $k_##1827[VV##1826:=lq_tmp$x##1961][VV##1828:=lq_tmp$x##1962][lq_tmp$x##1825:=lq_tmp$x##1963][lq_tmp$x##1960:=lq_tmp$x##1963]}&gt; | lq_tmp$x##1962 == xs##a2KF
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##1962 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##1829[VV##1828:=lq_tmp$x##1962]}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1988 : a | lq_tmp$x##1988 == y##a2D2}</span><span class='hs-varid'>y</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1992 : [{lq_tmp$x##1989 : a | $k_##1880[VV##1879:=lq_tmp$x##1989][VV##1884:=lq_tmp$x##1992]}]&lt;\lq_tmp$x##1993 VV -&gt; {lq_tmp$x##1991 : a | $k_##1883[VV##1882:=lq_tmp$x##1991][VV##1884:=lq_tmp$x##1992][lq_tmp$x##1881:=lq_tmp$x##1993][lq_tmp$x##1990:=lq_tmp$x##1993]}&gt; | lq_tmp$x##1992 == ys##a2KH
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##1992 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##1885[VV##1884:=lq_tmp$x##1992]}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##1828 : [{VV##1823 : a | $k_##1824}]&lt;\lq_tmp$x##1825 VV -&gt; {VV##1826 : a | $k_##1827}&gt; | $k_##1829}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##1884 : [{VV##1879 : a | $k_##1880}]&lt;\lq_tmp$x##1881 VV -&gt; {VV##1882 : a | $k_##1883}&gt; | $k_##1885}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1484:GHC.Types.Int -&gt; lq_tmp$x##1485:[a] -&gt; {VV##0 : ([a], [a]) | MeasureSets.Sets.elts lq_tmp$x##1485 == Set_cup (MeasureSets.Sets.elts (fst VV##0)) (MeasureSets.Sets.elts (snd VV##0))}</span><span class='hs-varid'>halve</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1778 : GHC.Types.Int | lq_tmp$x##1778 == ds_d3ma - lq_anf$##7205759403792806694##d3pc}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##1781 : GHC.Types.Int | lq_tmp$x##1781 == ds_d3ma}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##1762 : GHC.Types.Int | lq_tmp$x##1762 == (lq_anf$##7205759403792806693##d3pb : int)}</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1820 : [a] | lq_tmp$x##1820 == zs##a2D3
                        &amp;&amp; len lq_tmp$x##1820 &gt;= 0}</span><span class='hs-varid'>zs</span></a>
<span class=hs-linenum> 60: </span><span class='hs-definition'>halve</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>xs</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1660 : [{lq_tmp$x##1664 : a | $k_##1663[VV##1662:=lq_tmp$x##1664]}]&lt;\lq_tmp$x##1661 VV -&gt; {lq_tmp$x##1664 : a | $k_##1666[VV##1665:=lq_tmp$x##1664][lq_tmp$x##1667:=lq_tmp$x##1661]}&gt; | MeasureSets.Sets.unique lq_tmp$x##1660
                                                                                                                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##1660)
                                                                                                                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##1660 == Set_empty 0
                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##1660 == 0}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##1660 : [a]&lt;\lq_tmp$x##1661 VV -&gt; {lq_tmp$x##1659 : a&lt;p lq_tmp$x##1661&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##1660
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##1660)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##1660 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##1660 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1721 : [a] | lq_tmp$x##1721 == xs##a2CZ
                        &amp;&amp; len lq_tmp$x##1721 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>prop_halve_append</span>  <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>True</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 63: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##2119:GHC.Types.Int -&gt; lq_tmp$x##2120:[a] -&gt; {VV##0 : GHC.Types.Bool | VV##0}</span><span class='hs-definition'>prop_halve_append</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2343 : (Data.Set.Internal.Set {lq_tmp$x##2352 : a | $k_##2351[VV##2350:=lq_tmp$x##2352][lq_tmp$x##2347:=fix$36$$36$dOrd_a2MV][lq_tmp$x##2348:=xs##a2D8]}) | lq_tmp$x##2343 == MeasureSets.Sets.elts xs##a2D8}</span><span class='hs-varid'>elts</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2358 : [a] | lq_tmp$x##2358 == xs##a2D8
                        &amp;&amp; len lq_tmp$x##2358 &gt;= 0}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2368 : (Data.Set.Internal.Set {lq_tmp$x##2377 : a | $k_##2376[VV##2375:=lq_tmp$x##2377][lq_tmp$x##2372:=fix$36$$36$dOrd_a2MV][lq_tmp$x##2373:=xs'##a2D9]}) | lq_tmp$x##2368 == MeasureSets.Sets.elts xs'##a2D9}</span><span class='hs-varid'>elts</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2383 : [{lq_tmp$x##2380 : a | $k_##2323[VV##2322:=lq_tmp$x##2380][lq_tmp$x##2312:=lq_tmp$x##2383][lq_tmp$x##2317:=ys##a2Mq][lq_tmp$x##2318:=zs##a2Ms][lq_tmp$x##2324:=lq_tmp$x##2380]}] | lq_tmp$x##2383 == xs'##a2D9
                                                                                                                                                                                                     &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2383 == Set_cup (MeasureSets.Sets.elts ys##a2Mq) (MeasureSets.Sets.elts zs##a2Ms)
                                                                                                                                                                                                     &amp;&amp; len lq_tmp$x##2383 &gt;= 0}</span><span class='hs-varid'>xs'</span></a>
<span class=hs-linenum> 64: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 65: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##2312 : [{lq_tmp$x##2324 : a | $k_##2323[VV##2322:=lq_tmp$x##2324][lq_tmp$x##2317:=ys##a2Mq][lq_tmp$x##2318:=zs##a2Ms]}] | MeasureSets.Sets.elts lq_tmp$x##2312 == Set_cup (MeasureSets.Sets.elts ys##a2Mq) (MeasureSets.Sets.elts zs##a2Ms)}</span><span class='hs-varid'>xs'</span></a>      <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1156:[a] -&gt; lq_tmp$x##1157:[a] -&gt; {VV##0 : [a] | MeasureSets.Sets.elts VV##0 == Set_cup (MeasureSets.Sets.elts lq_tmp$x##1156) (MeasureSets.Sets.elts lq_tmp$x##1157)}</span><span class='hs-varid'>append'</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2328 : [{lq_tmp$x##2325 : a | $k_##2190[VV##2189:=lq_tmp$x##2325][VV##2194:=lq_tmp$x##2328]}]&lt;\lq_tmp$x##2329 VV -&gt; {lq_tmp$x##2327 : a | $k_##2193[VV##2192:=lq_tmp$x##2327][VV##2194:=lq_tmp$x##2328][lq_tmp$x##2191:=lq_tmp$x##2329][lq_tmp$x##2326:=lq_tmp$x##2329]}&gt; | lq_tmp$x##2328 == ys##a2Mq
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##2328 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##2195[VV##2194:=lq_tmp$x##2328]}</span><span class='hs-varid'>ys</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2333 : [{lq_tmp$x##2330 : a | $k_##2246[VV##2245:=lq_tmp$x##2330][VV##2250:=lq_tmp$x##2333]}]&lt;\lq_tmp$x##2334 VV -&gt; {lq_tmp$x##2332 : a | $k_##2249[VV##2248:=lq_tmp$x##2332][VV##2250:=lq_tmp$x##2333][lq_tmp$x##2247:=lq_tmp$x##2334][lq_tmp$x##2331:=lq_tmp$x##2334]}&gt; | lq_tmp$x##2333 == zs##a2Ms
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##2333 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##2251[VV##2250:=lq_tmp$x##2333]}</span><span class='hs-varid'>zs</span></a>
<span class=hs-linenum> 66: </span>    <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##2194 : [{VV##2189 : a | $k_##2190}]&lt;\lq_tmp$x##2191 VV -&gt; {VV##2192 : a | $k_##2193}&gt; | $k_##2195}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##2250 : [{VV##2245 : a | $k_##2246}]&lt;\lq_tmp$x##2247 VV -&gt; {VV##2248 : a | $k_##2249}&gt; | $k_##2251}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span>  <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##1484:GHC.Types.Int -&gt; lq_tmp$x##1485:[a] -&gt; {VV##0 : ([a], [a]) | MeasureSets.Sets.elts lq_tmp$x##1485 == Set_cup (MeasureSets.Sets.elts (fst VV##0)) (MeasureSets.Sets.elts (snd VV##0))}</span><span class='hs-varid'>halve</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2182 : GHC.Types.Int | lq_tmp$x##2182 == n##a2D7}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2186 : [a] | lq_tmp$x##2186 == xs##a2D8
                        &amp;&amp; len lq_tmp$x##2186 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span>
<span class=hs-linenum> 69: </span><span class='hs-comment'>{- ################################################### 
### Exercise 3: Type to elem
#######################################################-}</span>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>elem</span>      <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{b:</span> <span class='hs-conid'>Bool</span> <span class='hs-keyword'>| b &lt;=&gt; member x (elts xs) }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 74: </span><a class=annot href="#"><span class=annottext>forall t .
(GHC.Classes.Eq&lt;[]&gt; t) =&gt;
lq_tmp$x##2416:t -&gt; lq_tmp$x##2417:[t] -&gt; {b : GHC.Types.Bool | b &lt;=&gt; Set_mem lq_tmp$x##2416 (MeasureSets.Sets.elts lq_tmp$x##2417)}</span><span class='hs-definition'>elem</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2445 : GHC.Types.Bool | not lq_tmp$x##2445
                                   &amp;&amp; lq_tmp$x##2445 == GHC.Types.False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum> 75: </span><span class='hs-definition'>elem</span> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span><span class='hs-conop'>:</span><span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2498 : t | lq_tmp$x##2498 == ds_d3lU}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2499 : t | lq_tmp$x##2499 == y##a2Dd}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2508 : GHC.Types.Bool | lq_tmp$x##2508 &lt;=&gt; Set_mem ds_d3lU (MeasureSets.Sets.elts ys##a2De)}</span><span class='hs-varid'>elem</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2522 : t | lq_tmp$x##2522 == ds_d3lU}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2526 : [t] | lq_tmp$x##2526 == ys##a2De
                        &amp;&amp; len lq_tmp$x##2526 &gt;= 0}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum> 76: </span>
<span class=hs-linenum> 77: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>True</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 78: </span><a class=annot href="#"><span class=annottext>{VV##0 : GHC.Types.Bool | VV##0}</span><span class='hs-definition'>test1</span></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elem</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2541 : GHC.Integer.Type.Integer | lq_tmp$x##2541 == 2}</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2630 : [{lq_tmp$x##2640 : GHC.Integer.Type.Integer | $k_##2639[VV##2638:=lq_tmp$x##2640][lq_tmp$x##2634:=lq_anf$##7205759403792806707##d3pp][lq_tmp$x##2635:=lq_anf$##7205759403792806712##d3pu]}]&lt;\lq_tmp$x##2637 VV -&gt; {lq_tmp$x##2640 : GHC.Integer.Type.Integer | $k_##2642[VV##2641:=lq_tmp$x##2640][lq_tmp$x##2634:=lq_anf$##7205759403792806707##d3pp][lq_tmp$x##2635:=lq_anf$##7205759403792806712##d3pu][lq_tmp$x##2643:=lq_tmp$x##2637]}&gt; | (MeasureSets.Sets.unique lq_tmp$x##2630 &lt;=&gt; MeasureSets.Sets.unique lq_anf$##7205759403792806712##d3pu
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; not (Set_mem lq_anf$##7205759403792806707##d3pp (MeasureSets.Sets.elts lq_anf$##7205759403792806712##d3pu)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2630 == Set_cup (Set_sng lq_anf$##7205759403792806707##d3pp) (MeasureSets.Sets.elts lq_anf$##7205759403792806712##d3pu)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; head lq_tmp$x##2630 == lq_anf$##7205759403792806707##d3pp
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##2630 == 1 + len lq_anf$##7205759403792806712##d3pu
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; listElts lq_tmp$x##2630 == Set_cup (Set_sng lq_anf$##7205759403792806707##d3pp) (listElts lq_anf$##7205759403792806712##d3pu)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; tail lq_tmp$x##2630 == lq_anf$##7205759403792806712##d3pu}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2543 : GHC.Integer.Type.Integer | lq_tmp$x##2543 == 1}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2545 : GHC.Integer.Type.Integer | lq_tmp$x##2545 == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2547 : GHC.Integer.Type.Integer | lq_tmp$x##2547 == 3}</span><span class='hs-num'>3</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 79: </span>
<span class=hs-linenum> 80: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>False</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 81: </span><a class=annot href="#"><span class=annottext>{VV##0 : GHC.Types.Bool | not VV##0}</span><span class='hs-definition'>test2</span></a>      <span class='hs-keyglyph'>=</span> <span class='hs-varid'>elem</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2680 : GHC.Integer.Type.Integer | lq_tmp$x##2680 == 2}</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2737 : [{lq_tmp$x##2747 : GHC.Integer.Type.Integer | $k_##2746[VV##2745:=lq_tmp$x##2747][lq_tmp$x##2741:=lq_anf$##7205759403792806715##d3px][lq_tmp$x##2742:=lq_anf$##7205759403792806718##d3pA]}]&lt;\lq_tmp$x##2744 VV -&gt; {lq_tmp$x##2747 : GHC.Integer.Type.Integer | $k_##2749[VV##2748:=lq_tmp$x##2747][lq_tmp$x##2741:=lq_anf$##7205759403792806715##d3px][lq_tmp$x##2742:=lq_anf$##7205759403792806718##d3pA][lq_tmp$x##2750:=lq_tmp$x##2744]}&gt; | (MeasureSets.Sets.unique lq_tmp$x##2737 &lt;=&gt; MeasureSets.Sets.unique lq_anf$##7205759403792806718##d3pA
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; not (Set_mem lq_anf$##7205759403792806715##d3px (MeasureSets.Sets.elts lq_anf$##7205759403792806718##d3pA)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2737 == Set_cup (Set_sng lq_anf$##7205759403792806715##d3px) (MeasureSets.Sets.elts lq_anf$##7205759403792806718##d3pA)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; head lq_tmp$x##2737 == lq_anf$##7205759403792806715##d3px
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##2737 == 1 + len lq_anf$##7205759403792806718##d3pA
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; listElts lq_tmp$x##2737 == Set_cup (Set_sng lq_anf$##7205759403792806715##d3px) (listElts lq_anf$##7205759403792806718##d3pA)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; tail lq_tmp$x##2737 == lq_anf$##7205759403792806718##d3pA}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2682 : GHC.Integer.Type.Integer | lq_tmp$x##2682 == 1}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2684 : GHC.Integer.Type.Integer | lq_tmp$x##2684 == 3}</span><span class='hs-num'>3</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 82: </span>
<span class=hs-linenum> 83: </span><span class='hs-comment'>{- ################################################### 
### Exercise 4: Fix quicksort
#######################################################-}</span>
<span class=hs-linenum> 86: </span>
<span class=hs-linenum> 87: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span> <span class='hs-varop'>&gt;+&lt;</span>
<span class=hs-linenum> 88: </span>
<span class=hs-linenum> 89: </span><span class='hs-keyword'>{-@</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;+&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span> <span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ys</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ zs:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| elts zs == union (elts xs) (elts ys) }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 90: </span><span class='hs-layout'>(</span><span class='hs-varop'>&gt;+&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 91: </span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2789:[a] -&gt; lq_tmp$x##2790:[a] -&gt; {VV : [a] | MeasureSets.Sets.elts VV == Set_cup (MeasureSets.Sets.elts lq_tmp$x##2789) (MeasureSets.Sets.elts lq_tmp$x##2790)}</span><span class='hs-varop'>&gt;+&lt;</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2918 : a | lq_tmp$x##2918 == x##a2Df}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2871 : [{lq_tmp$x##2883 : a | $k_##2882[VV##2881:=lq_tmp$x##2883][lq_tmp$x##2876:=xs##a2Dg][lq_tmp$x##2877:=ys##a2Dh]}] | MeasureSets.Sets.elts lq_tmp$x##2871 == Set_cup (MeasureSets.Sets.elts xs##a2Dg) (MeasureSets.Sets.elts ys##a2Dh)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##2887 : [a] | lq_tmp$x##2887 == xs##a2Dg
                        &amp;&amp; len lq_tmp$x##2887 &gt;= 0}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>&gt;+&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2892 : [a] | lq_tmp$x##2892 == ys##a2Dh
                        &amp;&amp; len lq_tmp$x##2892 &gt;= 0}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 92: </span><span class='hs-conid'>[]</span> <span class='hs-varop'>&gt;+&lt;</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2822 : [a] | lq_tmp$x##2822 == ys##a2Dh
                        &amp;&amp; len lq_tmp$x##2822 &gt;= 0}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum> 93: </span>
<span class=hs-linenum> 94: </span><span class='hs-comment'>-- It's a kind of halve with a predicate a -&gt; Bool</span>
<span class=hs-linenum> 95: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>halveP</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListPairFrom</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 96: </span><span class='hs-definition'>halveP</span>          <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 97: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2927:(lq_tmp$x##2925:a -&gt; GHC.Types.Bool) -&gt; lq_tmp$x##2928:[a] -&gt; {VV##0 : ([a], [a]) | MeasureSets.Sets.elts lq_tmp$x##2928 == Set_cup (MeasureSets.Sets.elts (fst VV##0)) (MeasureSets.Sets.elts (snd VV##0))}</span><span class='hs-definition'>halveP</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##2975 : [{lq_tmp$x##2979 : a | $k_##2978[VV##2977:=lq_tmp$x##2979]}]&lt;\lq_tmp$x##2976 VV -&gt; {lq_tmp$x##2979 : a | $k_##2981[VV##2980:=lq_tmp$x##2979][lq_tmp$x##2982:=lq_tmp$x##2976]}&gt; | MeasureSets.Sets.unique lq_tmp$x##2975
                                                                                                                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##2975)
                                                                                                                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2975 == Set_empty 0
                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##2975 == 0}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##2962 : [a]&lt;\lq_tmp$x##2963 VV -&gt; {lq_tmp$x##2961 : a&lt;p lq_tmp$x##2963&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##2962
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##2962)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2962 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##2962 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##2975 : [a]&lt;\lq_tmp$x##2976 VV -&gt; {lq_tmp$x##2974 : a&lt;p lq_tmp$x##2976&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##2975
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##2975)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##2975 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##2975 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 98: </span><span class='hs-definition'>halveP</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 99: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3235 : a | lq_tmp$x##3235 == x##a2Dk}</span><span class='hs-varid'>x</span></a>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##3371:a -&gt; lq_tmp$x##3372:{lq_tmp$x##3363 : b&lt;p2 lq_tmp$x##3371&gt; | true} -&gt; {lq_tmp$x##3368 : (a, b)&lt;\lq_tmp$x##3373 VV -&gt; {lq_tmp$x##3367 : b&lt;p2 lq_tmp$x##3373&gt; | true}&gt; | fst lq_tmp$x##3368 == lq_tmp$x##3371
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##3368 == lq_tmp$x##3372
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##3368 == lq_tmp$x##3371
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##3368 == lq_tmp$x##3372} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3355 : a | lq_tmp$x##3355 == x##a2Dk}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3359 : [{lq_tmp$x##3356 : a | $k_##3120[VV##3119:=lq_tmp$x##3356][VV##3124:=lq_tmp$x##3359]}]&lt;\lq_tmp$x##3360 VV -&gt; {lq_tmp$x##3358 : a | $k_##3123[VV##3122:=lq_tmp$x##3358][VV##3124:=lq_tmp$x##3359][lq_tmp$x##3121:=lq_tmp$x##3360][lq_tmp$x##3357:=lq_tmp$x##3360]}&gt; | lq_tmp$x##3359 == ys##a2I6
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3359 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3125[VV##3124:=lq_tmp$x##3359]}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3413 : [{lq_tmp$x##3410 : a | $k_##3176[VV##3175:=lq_tmp$x##3410][VV##3180:=lq_tmp$x##3413]}]&lt;\lq_tmp$x##3414 VV -&gt; {lq_tmp$x##3412 : a | $k_##3179[VV##3178:=lq_tmp$x##3412][VV##3180:=lq_tmp$x##3413][lq_tmp$x##3177:=lq_tmp$x##3414][lq_tmp$x##3411:=lq_tmp$x##3414]}&gt; | lq_tmp$x##3413 == zs##a2I8
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3413 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3181[VV##3180:=lq_tmp$x##3413]}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>100: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      lq_tmp$x##3283:a -&gt; lq_tmp$x##3284:{lq_tmp$x##3275 : b&lt;p2 lq_tmp$x##3283&gt; | true} -&gt; {lq_tmp$x##3280 : (a, b)&lt;\lq_tmp$x##3285 VV -&gt; {lq_tmp$x##3279 : b&lt;p2 lq_tmp$x##3285&gt; | true}&gt; | fst lq_tmp$x##3280 == lq_tmp$x##3283
                                                                                                                                                                                            &amp;&amp; snd lq_tmp$x##3280 == lq_tmp$x##3284
                                                                                                                                                                                            &amp;&amp; x_Tuple21 lq_tmp$x##3280 == lq_tmp$x##3283
                                                                                                                                                                                            &amp;&amp; x_Tuple22 lq_tmp$x##3280 == lq_tmp$x##3284} | VV == GHC.Tuple.(,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##3320 : [{lq_tmp$x##3317 : a | $k_##3120[VV##3119:=lq_tmp$x##3317][VV##3124:=lq_tmp$x##3320]}]&lt;\lq_tmp$x##3321 VV -&gt; {lq_tmp$x##3319 : a | $k_##3123[VV##3122:=lq_tmp$x##3319][VV##3124:=lq_tmp$x##3320][lq_tmp$x##3121:=lq_tmp$x##3321][lq_tmp$x##3318:=lq_tmp$x##3321]}&gt; | lq_tmp$x##3320 == ys##a2I6
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3320 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3125[VV##3124:=lq_tmp$x##3320]}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3267 : a | lq_tmp$x##3267 == x##a2Dk}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3271 : [{lq_tmp$x##3268 : a | $k_##3176[VV##3175:=lq_tmp$x##3268][VV##3180:=lq_tmp$x##3271]}]&lt;\lq_tmp$x##3272 VV -&gt; {lq_tmp$x##3270 : a | $k_##3179[VV##3178:=lq_tmp$x##3270][VV##3180:=lq_tmp$x##3271][lq_tmp$x##3177:=lq_tmp$x##3272][lq_tmp$x##3269:=lq_tmp$x##3272]}&gt; | lq_tmp$x##3271 == zs##a2I8
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3271 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3181[VV##3180:=lq_tmp$x##3271]}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>101: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>102: </span>    <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##3124 : [{VV##3119 : a | $k_##3120}]&lt;\lq_tmp$x##3121 VV -&gt; {VV##3122 : a | $k_##3123}&gt; | $k_##3125}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##3180 : [{VV##3175 : a | $k_##3176}]&lt;\lq_tmp$x##3177 VV -&gt; {VV##3178 : a | $k_##3179}&gt; | $k_##3181}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##2927:(lq_tmp$x##2925:a -&gt; GHC.Types.Bool) -&gt; lq_tmp$x##2928:[a] -&gt; {VV##0 : ([a], [a]) | MeasureSets.Sets.elts lq_tmp$x##2928 == Set_cup (MeasureSets.Sets.elts (fst VV##0)) (MeasureSets.Sets.elts (snd VV##0))}</span><span class='hs-varid'>halveP</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##3112:a -&gt; GHC.Types.Bool</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3116 : [a] | lq_tmp$x##3116 == xs##a2Dl
                        &amp;&amp; len lq_tmp$x##3116 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>103: </span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>quickSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListEq</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>106: </span><span class='hs-definition'>quickSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>107: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##3419:[a] -&gt; {VV##0 : [a] | MeasureSets.Sets.elts VV##0 == MeasureSets.Sets.elts lq_tmp$x##3419}</span><span class='hs-definition'>quickSort</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##3450 : [a]&lt;\lq_tmp$x##3451 VV -&gt; {lq_tmp$x##3449 : a&lt;p lq_tmp$x##3451&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##3450
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##3450)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##3450 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##3450 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>108: </span><span class='hs-definition'>quickSort</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3862 : [{lq_tmp$x##3872 : a | $k_##3871[VV##3870:=lq_tmp$x##3872][lq_tmp$x##3866:=fix$36$$36$dOrd_a2Im][lq_tmp$x##3867:=ls##a2Iu]}] | MeasureSets.Sets.elts lq_tmp$x##3862 == MeasureSets.Sets.elts ls##a2Iu}</span><span class='hs-varid'>quickSort</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3878 : [{lq_tmp$x##3875 : a | $k_##3563[VV##3562:=lq_tmp$x##3875][VV##3567:=lq_tmp$x##3878]}]&lt;\lq_tmp$x##3879 VV -&gt; {lq_tmp$x##3877 : a | $k_##3566[VV##3565:=lq_tmp$x##3877][VV##3567:=lq_tmp$x##3878][lq_tmp$x##3564:=lq_tmp$x##3879][lq_tmp$x##3876:=lq_tmp$x##3879]}&gt; | lq_tmp$x##3878 == ls##a2Iu
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3878 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3568[VV##3567:=lq_tmp$x##3878]}</span><span class='hs-varid'>ls</span></a> <span class='hs-varop'>&gt;+&lt;</span>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##3967 : a | lq_tmp$x##3967 == x##a2Do}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##3936 : [{lq_tmp$x##3933 : a | $k_##3798[VV##3797:=lq_tmp$x##3933][VV##3802:=lq_tmp$x##3936]}]&lt;\lq_tmp$x##3937 VV -&gt; {lq_tmp$x##3935 : a | $k_##3801[VV##3800:=lq_tmp$x##3935][VV##3802:=lq_tmp$x##3936][lq_tmp$x##3799:=lq_tmp$x##3937][lq_tmp$x##3934:=lq_tmp$x##3937]}&gt; | lq_tmp$x##3936 == same##a2IN
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3936 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3803[VV##3802:=lq_tmp$x##3936]}</span><span class='hs-varid'>same</span></a> <span class='hs-varop'>&gt;+&lt;</span>  <a class=annot href="#"><span class=annottext>{lq_tmp$x##3890 : [{lq_tmp$x##3900 : a | $k_##3899[VV##3898:=lq_tmp$x##3900][lq_tmp$x##3894:=fix$36$$36$dOrd_a2Im][lq_tmp$x##3895:=gt##a2IL]}] | MeasureSets.Sets.elts lq_tmp$x##3890 == MeasureSets.Sets.elts gt##a2IL}</span><span class='hs-varid'>quickSort</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3906 : [{lq_tmp$x##3903 : a | $k_##3742[VV##3741:=lq_tmp$x##3903][VV##3746:=lq_tmp$x##3906]}]&lt;\lq_tmp$x##3907 VV -&gt; {lq_tmp$x##3905 : a | $k_##3745[VV##3744:=lq_tmp$x##3905][VV##3746:=lq_tmp$x##3906][lq_tmp$x##3743:=lq_tmp$x##3907][lq_tmp$x##3904:=lq_tmp$x##3907]}&gt; | lq_tmp$x##3906 == gt##a2IL
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3906 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3747[VV##3746:=lq_tmp$x##3906]}</span><span class='hs-varid'>gt</span></a>
<span class=hs-linenum>109: </span>    <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##3567 : [{VV##3562 : a | $k_##3563}]&lt;\lq_tmp$x##3564 VV -&gt; {VV##3565 : a | $k_##3566}&gt; | $k_##3568}</span><span class='hs-varid'>ls</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##3623 : [{VV##3618 : a | $k_##3619}]&lt;\lq_tmp$x##3620 VV -&gt; {VV##3621 : a | $k_##3622}&gt; | $k_##3624}</span><span class='hs-varid'>xs'</span></a><span class='hs-layout'>)</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>ds_d3lD:{VV##3495 : a | $k_##3496} -&gt; {lq_tmp$x##3502 : GHC.Types.Bool | lq_tmp$x##3502 &lt;=&gt; ds_d3lD &lt; x##a2Do}</span><span class='hs-varid'>halveP</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3502 : GHC.Types.Bool | lq_tmp$x##3502 &lt;=&gt; ds_d3lD &lt; x##a2Do}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3515 : a | lq_tmp$x##3515 == x##a2Do}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3559 : [a] | lq_tmp$x##3559 == xs##a2Dp
                        &amp;&amp; len lq_tmp$x##3559 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>110: </span>          <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV##3746 : [{VV##3741 : a | $k_##3742}]&lt;\lq_tmp$x##3743 VV -&gt; {VV##3744 : a | $k_##3745}&gt; | $k_##3747}</span><span class='hs-varid'>gt</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV##3802 : [{VV##3797 : a | $k_##3798}]&lt;\lq_tmp$x##3799 VV -&gt; {VV##3800 : a | $k_##3801}&gt; | $k_##3803}</span><span class='hs-varid'>same</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>ds_d3lo:{VV##3674 : a | $k_##3675} -&gt; {lq_tmp$x##3681 : GHC.Types.Bool | lq_tmp$x##3681 &lt;=&gt; ds_d3lo &gt; x##a2Do}</span><span class='hs-varid'>halveP</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3681 : GHC.Types.Bool | lq_tmp$x##3681 &lt;=&gt; ds_d3lo &gt; x##a2Do}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3694 : a | lq_tmp$x##3694 == x##a2Do}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##3738 : [{lq_tmp$x##3735 : a | $k_##3619[VV##3618:=lq_tmp$x##3735][VV##3623:=lq_tmp$x##3738]}]&lt;\lq_tmp$x##3739 VV -&gt; {lq_tmp$x##3737 : a | $k_##3622[VV##3621:=lq_tmp$x##3737][VV##3623:=lq_tmp$x##3738][lq_tmp$x##3620:=lq_tmp$x##3739][lq_tmp$x##3736:=lq_tmp$x##3739]}&gt; | lq_tmp$x##3738 == xs'##a2Iw
                                                                                                                                                                                                                                                                                       &amp;&amp; len lq_tmp$x##3738 &gt;= 0
                                                                                                                                                                                                                                                                                       &amp;&amp; $k_##3624[VV##3623:=lq_tmp$x##3738]}</span><span class='hs-varid'>xs'</span></a>
<span class=hs-linenum>111: </span>
<span class=hs-linenum>112: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>unique</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>113: </span><span class='hs-definition'>unique</span>        <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>114: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1004:[a] -&gt; {VV : GHC.Types.Bool | VV &lt;=&gt; MeasureSets.Sets.unique lq_tmp$x##1004}</span><span class='hs-definition'>unique</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1031 : GHC.Types.Bool | lq_tmp$x##1031
                                   &amp;&amp; lq_tmp$x##1031 == GHC.Types.True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum>115: </span><span class='hs-definition'>unique</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1074 : GHC.Types.Bool | lq_tmp$x##1074 &lt;=&gt; MeasureSets.Sets.unique xs##a2Dv}</span><span class='hs-varid'>unique</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1089 : [a] | lq_tmp$x##1089 == xs##a2Dv
                        &amp;&amp; len lq_tmp$x##1089 &gt;= 0}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1139 : GHC.Types.Bool | lq_tmp$x##1139 &lt;=&gt; not lq_anf$##7205759403792806680##d3oY}</span><span class='hs-varid'>not</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1122 : GHC.Types.Bool | lq_tmp$x##1122 &lt;=&gt; Set_mem x##a2Du lq_anf$##7205759403792806679##d3oX}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>member</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1134 : a | lq_tmp$x##1134 == x##a2Du}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1099 : (Data.Set.Internal.Set {lq_tmp$x##1108 : a | $k_##1107[VV##1106:=lq_tmp$x##1108][lq_tmp$x##1103:=fix$36$$36$dOrd_a2N6][lq_tmp$x##1104:=xs##a2Dv]}) | lq_tmp$x##1099 == MeasureSets.Sets.elts xs##a2Dv}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>elts</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1114 : [a] | lq_tmp$x##1114 == xs##a2Dv
                        &amp;&amp; len lq_tmp$x##1114 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>116: </span>
<span class=hs-linenum>117: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>unique</span> <span class='hs-varid'>v</span> <span class='hs-layout'>}</span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span><span class='hs-comment'>-- isUnique = [1, 2, 3]           -- accepted by LH</span>
<span class=hs-linenum>120: </span>
<span class=hs-linenum>121: </span><span class='hs-comment'>{- ################################################### 
### Exercise 5: Type to filter'
####################################################### -}</span>
<span class=hs-linenum>124: </span>
<span class=hs-linenum>125: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>filter'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span> <span class='hs-conid'>ListSub</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>| unique xs =&gt; unique v }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>126: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##4011:(lq_tmp$x##4009:a -&gt; GHC.Types.Bool) -&gt; lq_tmp$x##4012:[a] -&gt; {VV##0 : [a] | Set_sub (MeasureSets.Sets.elts VV##0) (MeasureSets.Sets.elts lq_tmp$x##4012)
                                                                                            &amp;&amp; (MeasureSets.Sets.unique lq_tmp$x##4012 =&gt; MeasureSets.Sets.unique VV##0)}</span><span class='hs-definition'>filter'</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##4043 : [a]&lt;\lq_tmp$x##4044 VV -&gt; {lq_tmp$x##4042 : a&lt;p lq_tmp$x##4044&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##4043
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##4043)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4043 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##4043 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>127: </span><span class='hs-definition'>filter'</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum>128: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4124 : a | lq_tmp$x##4124 == x##a2Dx}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4166 : a | lq_tmp$x##4166 == x##a2Dx}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4170 : [{lq_tmp$x##4167 : a | $k_##4108[VV##4107:=lq_tmp$x##4167][lq_tmp$x##4098:=lq_tmp$x##4170][lq_tmp$x##4103:=ds_d3k6][lq_tmp$x##4104:=xs##a2Dy][lq_tmp$x##4109:=lq_tmp$x##4167]}] | Set_sub (MeasureSets.Sets.elts lq_tmp$x##4170) (MeasureSets.Sets.elts xs##a2Dy)
                                                                                                                                                                                                    &amp;&amp; (MeasureSets.Sets.unique xs##a2Dy =&gt; MeasureSets.Sets.unique lq_tmp$x##4170)
                                                                                                                                                                                                    &amp;&amp; lq_tmp$x##4170 == xs'##a2Dz
                                                                                                                                                                                                    &amp;&amp; len lq_tmp$x##4170 &gt;= 0}</span><span class='hs-varid'>xs'</span></a>
<span class=hs-linenum>129: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4136 : [{lq_tmp$x##4133 : a | $k_##4108[VV##4107:=lq_tmp$x##4133][lq_tmp$x##4098:=lq_tmp$x##4136][lq_tmp$x##4103:=ds_d3k6][lq_tmp$x##4104:=xs##a2Dy][lq_tmp$x##4109:=lq_tmp$x##4133]}] | Set_sub (MeasureSets.Sets.elts lq_tmp$x##4136) (MeasureSets.Sets.elts xs##a2Dy)
                                                                                                                                                                                                    &amp;&amp; (MeasureSets.Sets.unique xs##a2Dy =&gt; MeasureSets.Sets.unique lq_tmp$x##4136)
                                                                                                                                                                                                    &amp;&amp; lq_tmp$x##4136 == xs'##a2Dz
                                                                                                                                                                                                    &amp;&amp; len lq_tmp$x##4136 &gt;= 0}</span><span class='hs-varid'>xs'</span></a>
<span class=hs-linenum>130: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>131: </span>    <a class=annot href="#"><span class=annottext>{lq_tmp$x##4098 : [{lq_tmp$x##4109 : a | $k_##4108[VV##4107:=lq_tmp$x##4109][lq_tmp$x##4103:=ds_d3k6][lq_tmp$x##4104:=xs##a2Dy]}] | Set_sub (MeasureSets.Sets.elts lq_tmp$x##4098) (MeasureSets.Sets.elts xs##a2Dy)
                                                                                                                                    &amp;&amp; (MeasureSets.Sets.unique xs##a2Dy =&gt; MeasureSets.Sets.unique lq_tmp$x##4098)}</span><span class='hs-varid'>xs'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##4011:(lq_tmp$x##4009:a -&gt; GHC.Types.Bool) -&gt; lq_tmp$x##4012:[a] -&gt; {VV##0 : [a] | Set_sub (MeasureSets.Sets.elts VV##0) (MeasureSets.Sets.elts lq_tmp$x##4012)
                                                                                            &amp;&amp; (MeasureSets.Sets.unique lq_tmp$x##4012 =&gt; MeasureSets.Sets.unique VV##0)}</span><span class='hs-varid'>filter'</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##4113:a -&gt; GHC.Types.Bool</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4117 : [a] | lq_tmp$x##4117 == xs##a2Dy
                        &amp;&amp; len lq_tmp$x##4117 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>132: </span>
<span class=hs-linenum>133: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UList</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>134: </span><a class=annot href="#"><span class=annottext>{VV##0 : [GHC.Integer.Type.Integer] | MeasureSets.Sets.unique VV##0}</span><span class='hs-definition'>test3</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filter'</span> <a class=annot href="#"><span class=annottext>ds_d3kq:{VV##4177 : GHC.Integer.Type.Integer | $k_##4178} -&gt; {lq_tmp$x##4184 : GHC.Types.Bool | lq_tmp$x##4184 &lt;=&gt; ds_d3kq &gt; ds_d3kr}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&gt;</span> <span class='hs-num'>2</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4318 : [{lq_tmp$x##4328 : GHC.Integer.Type.Integer | $k_##4327[VV##4326:=lq_tmp$x##4328][lq_tmp$x##4322:=lq_anf$##7205759403792806740##d3pW][lq_tmp$x##4323:=lq_anf$##7205759403792806747##d3q3]}]&lt;\lq_tmp$x##4325 VV -&gt; {lq_tmp$x##4328 : GHC.Integer.Type.Integer | $k_##4330[VV##4329:=lq_tmp$x##4328][lq_tmp$x##4322:=lq_anf$##7205759403792806740##d3pW][lq_tmp$x##4323:=lq_anf$##7205759403792806747##d3q3][lq_tmp$x##4331:=lq_tmp$x##4325]}&gt; | (MeasureSets.Sets.unique lq_tmp$x##4318 &lt;=&gt; MeasureSets.Sets.unique lq_anf$##7205759403792806747##d3q3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; not (Set_mem lq_anf$##7205759403792806740##d3pW (MeasureSets.Sets.elts lq_anf$##7205759403792806747##d3q3)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4318 == Set_cup (Set_sng lq_anf$##7205759403792806740##d3pW) (MeasureSets.Sets.elts lq_anf$##7205759403792806747##d3q3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; head lq_tmp$x##4318 == lq_anf$##7205759403792806740##d3pW
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##4318 == 1 + len lq_anf$##7205759403792806747##d3q3
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; listElts lq_tmp$x##4318 == Set_cup (Set_sng lq_anf$##7205759403792806740##d3pW) (listElts lq_anf$##7205759403792806747##d3q3)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; tail lq_tmp$x##4318 == lq_anf$##7205759403792806747##d3q3}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4199 : GHC.Integer.Type.Integer | lq_tmp$x##4199 == 1}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4201 : GHC.Integer.Type.Integer | lq_tmp$x##4201 == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4203 : GHC.Integer.Type.Integer | lq_tmp$x##4203 == 3}</span><span class='hs-num'>3</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4205 : GHC.Integer.Type.Integer | lq_tmp$x##4205 == 4}</span><span class='hs-num'>4</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>135: </span>
<span class=hs-linenum>136: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test4</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-keyword'>_</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>137: </span><a class=annot href="#"><span class=annottext>[GHC.Integer.Type.Integer]</span><span class='hs-definition'>test4</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>filter'</span> <a class=annot href="#"><span class=annottext>ds_d3ks:{VV##4375 : GHC.Integer.Type.Integer | $k_##4376} -&gt; {lq_tmp$x##4382 : GHC.Types.Bool | lq_tmp$x##4382 &lt;=&gt; ds_d3ks &gt; ds_d3kt}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&gt;</span> <span class='hs-num'>3</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4516 : [{lq_tmp$x##4526 : GHC.Integer.Type.Integer | $k_##4525[VV##4524:=lq_tmp$x##4526][lq_tmp$x##4520:=lq_anf$##7205759403792806750##d3q6][lq_tmp$x##4521:=lq_anf$##7205759403792806757##d3qd]}]&lt;\lq_tmp$x##4523 VV -&gt; {lq_tmp$x##4526 : GHC.Integer.Type.Integer | $k_##4528[VV##4527:=lq_tmp$x##4526][lq_tmp$x##4520:=lq_anf$##7205759403792806750##d3q6][lq_tmp$x##4521:=lq_anf$##7205759403792806757##d3qd][lq_tmp$x##4529:=lq_tmp$x##4523]}&gt; | (MeasureSets.Sets.unique lq_tmp$x##4516 &lt;=&gt; MeasureSets.Sets.unique lq_anf$##7205759403792806757##d3qd
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             &amp;&amp; not (Set_mem lq_anf$##7205759403792806750##d3q6 (MeasureSets.Sets.elts lq_anf$##7205759403792806757##d3qd)))
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4516 == Set_cup (Set_sng lq_anf$##7205759403792806750##d3q6) (MeasureSets.Sets.elts lq_anf$##7205759403792806757##d3qd)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; head lq_tmp$x##4516 == lq_anf$##7205759403792806750##d3q6
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; len lq_tmp$x##4516 == 1 + len lq_anf$##7205759403792806757##d3qd
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; listElts lq_tmp$x##4516 == Set_cup (Set_sng lq_anf$##7205759403792806750##d3q6) (listElts lq_anf$##7205759403792806757##d3qd)
                                                                                                                                                                                                                                                                                                                                                                                                                                                                 &amp;&amp; tail lq_tmp$x##4516 == lq_anf$##7205759403792806757##d3qd}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4397 : GHC.Integer.Type.Integer | lq_tmp$x##4397 == 3}</span><span class='hs-num'>3</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4399 : GHC.Integer.Type.Integer | lq_tmp$x##4399 == 1}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4401 : GHC.Integer.Type.Integer | lq_tmp$x##4401 == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4403 : GHC.Integer.Type.Integer | lq_tmp$x##4403 == 3}</span><span class='hs-num'>3</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>138: </span>
<span class=hs-linenum>139: </span><span class='hs-comment'>{- ################################################### 
### Exercise 6: Type go function
####################################################### -}</span>
<span class=hs-linenum>142: </span>
<span class=hs-linenum>143: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reverse</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>144: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##4571:{VV##0 : [a] | MeasureSets.Sets.unique VV##0} -&gt; {VV##0 : [a] | MeasureSets.Sets.unique VV##0}</span><span class='hs-definition'>reverse</span></a>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4749 : [{lq_tmp$x##4753 : a | $k_##4752[VV##4751:=lq_tmp$x##4753]}]&lt;\lq_tmp$x##4750 VV -&gt; {lq_tmp$x##4753 : a | $k_##4755[VV##4754:=lq_tmp$x##4753][lq_tmp$x##4756:=lq_tmp$x##4750]}&gt; | MeasureSets.Sets.unique lq_tmp$x##4749
                                                                                                                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##4749)
                                                                                                                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4749 == Set_empty 0
                                                                                                                                                                                                   &amp;&amp; len lq_tmp$x##4749 == 0}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {lq_tmp$x##4749 : [a]&lt;\lq_tmp$x##4750 VV -&gt; {lq_tmp$x##4748 : a&lt;p lq_tmp$x##4750&gt; | true}&gt; | MeasureSets.Sets.unique lq_tmp$x##4749
                                                                                                   &amp;&amp; Set_emp (listElts lq_tmp$x##4749)
                                                                                                   &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4749 == Set_empty 0
                                                                                                   &amp;&amp; len lq_tmp$x##4749 == 0} | VV == GHC.Types.[]}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>145: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>146: </span>    <span class='hs-keyword'>{-@</span> <span class='hs-varid'>go</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varid'>acc</span><span class='hs-conop'>:</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ys:</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| intersection (elts ys) (elts acc) == empty }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ zs:</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| union (elts acc) (elts ys) == elts zs &amp;&amp; len zs == len acc + len ys }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>147: </span>    <a class=annot href="#"><span class=annottext>lq_tmp$x##4591:{VV##0 : [a] | MeasureSets.Sets.unique VV##0} -&gt; lq_tmp$x##4592:{VV##0 : [a] | MeasureSets.Sets.unique VV##0
                                                                                              &amp;&amp; Set_cap (MeasureSets.Sets.elts VV##0) (MeasureSets.Sets.elts lq_tmp$x##4591) == Set_empty 0} -&gt; {VV##0 : [a] | MeasureSets.Sets.unique VV##0
                                                                                                                                                                                                                &amp;&amp; len VV##0 == len lq_tmp$x##4591 + len lq_tmp$x##4592
                                                                                                                                                                                                                &amp;&amp; Set_cup (MeasureSets.Sets.elts lq_tmp$x##4591) (MeasureSets.Sets.elts lq_tmp$x##4592) == MeasureSets.Sets.elts VV##0}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{VV##0 : [a] | MeasureSets.Sets.unique VV##0}</span><span class='hs-varid'>acc</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4624 : [a] | MeasureSets.Sets.unique lq_tmp$x##4624
                        &amp;&amp; lq_tmp$x##4624 == acc##a2DB
                        &amp;&amp; len lq_tmp$x##4624 &gt;= 0}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum>148: </span>    <span class='hs-varid'>go</span> <span class='hs-varid'>acc</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>lq_tmp$x##4591:{VV##0 : [a] | MeasureSets.Sets.unique VV##0} -&gt; lq_tmp$x##4592:{VV##0 : [a] | MeasureSets.Sets.unique VV##0
                                                                                              &amp;&amp; Set_cap (MeasureSets.Sets.elts VV##0) (MeasureSets.Sets.elts lq_tmp$x##4591) == Set_empty 0} -&gt; {VV##0 : [a] | MeasureSets.Sets.unique VV##0
                                                                                                                                                                                                                &amp;&amp; len VV##0 == len lq_tmp$x##4591 + len lq_tmp$x##4592
                                                                                                                                                                                                                &amp;&amp; Set_cup (MeasureSets.Sets.elts lq_tmp$x##4591) (MeasureSets.Sets.elts lq_tmp$x##4592) == MeasureSets.Sets.elts VV##0}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4670 : [{lq_tmp$x##4680 : a | $k_##4679[VV##4678:=lq_tmp$x##4680][lq_tmp$x##4674:=x##a2DD][lq_tmp$x##4675:=acc##a2DB]}]&lt;\lq_tmp$x##4677 VV -&gt; {lq_tmp$x##4680 : a | $k_##4682[VV##4681:=lq_tmp$x##4680][lq_tmp$x##4674:=x##a2DD][lq_tmp$x##4675:=acc##a2DB][lq_tmp$x##4683:=lq_tmp$x##4677]}&gt; | (MeasureSets.Sets.unique lq_tmp$x##4670 &lt;=&gt; MeasureSets.Sets.unique acc##a2DB
                                                                                                                                                                                                                                                                                                                                                       &amp;&amp; not (Set_mem x##a2DD (MeasureSets.Sets.elts acc##a2DB)))
                                                                                                                                                                                                                                                                                                           &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4670 == Set_cup (Set_sng x##a2DD) (MeasureSets.Sets.elts acc##a2DB)
                                                                                                                                                                                                                                                                                                           &amp;&amp; head lq_tmp$x##4670 == x##a2DD
                                                                                                                                                                                                                                                                                                           &amp;&amp; len lq_tmp$x##4670 == 1 + len acc##a2DB
                                                                                                                                                                                                                                                                                                           &amp;&amp; listElts lq_tmp$x##4670 == Set_cup (Set_sng x##a2DD) (listElts acc##a2DB)
                                                                                                                                                                                                                                                                                                           &amp;&amp; tail lq_tmp$x##4670 == acc##a2DB}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{lq_tmp$x##4685 : a | lq_tmp$x##4685 == x##a2DD}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{lq_tmp$x##4689 : [a] | MeasureSets.Sets.unique lq_tmp$x##4689
                        &amp;&amp; lq_tmp$x##4689 == acc##a2DB
                        &amp;&amp; len lq_tmp$x##4689 &gt;= 0}</span><span class='hs-varid'>acc</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4721 : [a] | lq_tmp$x##4721 == xs##a2DE
                        &amp;&amp; len lq_tmp$x##4721 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>149: </span>
<span class=hs-linenum>150: </span>
<span class=hs-linenum>151: </span><span class='hs-comment'>{- ################################################### 
### Exercise 7: Fix append
####################################################### -}</span>
<span class=hs-linenum>154: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>append</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ys:</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| intersection (elts xs) (elts ys) == empty }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ zs:</span> <span class='hs-conid'>UList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| elts zs == union (elts xs) (elts ys) }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>155: </span><a class=annot href="#"><span class=annottext>forall a .
lq_tmp$x##4794:{VV##0 : [a] | MeasureSets.Sets.unique VV##0} -&gt; lq_tmp$x##4795:{VV##0 : [a] | MeasureSets.Sets.unique VV##0
                                                                                              &amp;&amp; Set_cap (MeasureSets.Sets.elts lq_tmp$x##4794) (MeasureSets.Sets.elts VV##0) == Set_empty 0} -&gt; {VV##0 : [a] | MeasureSets.Sets.unique VV##0
                                                                                                                                                                                                                &amp;&amp; MeasureSets.Sets.elts VV##0 == Set_cup (MeasureSets.Sets.elts lq_tmp$x##4794) (MeasureSets.Sets.elts lq_tmp$x##4795)}</span><span class='hs-definition'>append</span></a> <span class='hs-conid'>[]</span>     <a class=annot href="#"><span class=annottext>{VV##0 : [a] | MeasureSets.Sets.unique VV##0
               &amp;&amp; Set_cap (MeasureSets.Sets.elts ds_d3jK) (MeasureSets.Sets.elts VV##0) == Set_empty 0}</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4827 : [a] | MeasureSets.Sets.unique lq_tmp$x##4827
                        &amp;&amp; lq_tmp$x##4827 == ys##a2DF
                        &amp;&amp; Set_cap (MeasureSets.Sets.elts ds_d3jK) (MeasureSets.Sets.elts lq_tmp$x##4827) == Set_empty 0
                        &amp;&amp; len lq_tmp$x##4827 &gt;= 0}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum>156: </span><span class='hs-definition'>append</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4923 : a | lq_tmp$x##4923 == x##a2DG}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4876 : [{lq_tmp$x##4888 : a | $k_##4887[VV##4886:=lq_tmp$x##4888][lq_tmp$x##4881:=xs##a2DH][lq_tmp$x##4882:=ys##a2DF]}] | MeasureSets.Sets.unique lq_tmp$x##4876
                                                                                                                                     &amp;&amp; MeasureSets.Sets.elts lq_tmp$x##4876 == Set_cup (MeasureSets.Sets.elts xs##a2DH) (MeasureSets.Sets.elts ys##a2DF)}</span><span class='hs-varid'>append</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4892 : [a] | lq_tmp$x##4892 == xs##a2DH
                        &amp;&amp; len lq_tmp$x##4892 &gt;= 0}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##4897 : [a] | MeasureSets.Sets.unique lq_tmp$x##4897
                        &amp;&amp; lq_tmp$x##4897 == ys##a2DF
                        &amp;&amp; Set_cap (MeasureSets.Sets.elts ds_d3jK) (MeasureSets.Sets.elts lq_tmp$x##4897) == Set_empty 0
                        &amp;&amp; len lq_tmp$x##4897 &gt;= 0}</span><span class='hs-varid'>ys</span></a>
</pre>
</body>
</html>