<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/Scratch/Sample2.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum> 1: </span><a class=annot href="#"><span class=annottext>{VV##1325 : GHC.Types.Module | $k_##1326}</span><span class='hs-keyword'>{-@</span></a> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 2: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span>    <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 3: </span>
<span class=hs-linenum> 4: </span>
<span class=hs-linenum> 5: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Scratch.Sample2</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 6: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>head</span><span class='hs-layout'>,</span> <span class='hs-varid'>max</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 7: </span>
<span class=hs-linenum> 8: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>die</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>String</span> <span class='hs-keyword'>| false}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 9: </span><a class=annot href="#"><span class=annottext>forall a . lq_tmp$x##614:{VV##0 : [GHC.Types.Char] | false} -&gt; a</span><span class='hs-definition'>die</span></a> <a class=annot href="#"><span class=annottext>{VV##622 : [{VV##617 : GHC.Types.Char | $k_##618}]&lt;\lq_tmp$x##619 VV -&gt; {VV##620 : GHC.Types.Char | $k_##621}&gt; | $k_##623}</span><span class='hs-varid'>msg</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##893 : [{lq_tmp$x##890 : GHC.Types.Char | $k_##618[VV##617:=lq_tmp$x##890][VV##622:=lq_tmp$x##893]}]&lt;\lq_tmp$x##894 VV -&gt; {lq_tmp$x##892 : GHC.Types.Char | $k_##621[VV##620:=lq_tmp$x##892][VV##622:=lq_tmp$x##893][lq_tmp$x##619:=lq_tmp$x##894][lq_tmp$x##891:=lq_tmp$x##894]}&gt; | lq_tmp$x##893 == msg##a3Vg
                                                                                                                                                                                                                                                                                               &amp;&amp; len lq_tmp$x##893 &gt;= 0
                                                                                                                                                                                                                                                                                               &amp;&amp; $k_##623[VV##622:=lq_tmp$x##893]}</span><span class='hs-varid'>msg</span></a>
<span class=hs-linenum>10: </span>
<span class=hs-linenum>11: </span><span class='hs-keyword'>{-@</span> 
<span class=hs-linenum>12: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conop'>:&lt;</span><span class='hs-layout'>)</span> <span class='hs-layout'>{</span> <span class='hs-varid'>hd</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>tl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IncList</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>hd</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span><span class='hs-layout'>}</span>
<span class=hs-linenum>13: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum>14: </span>
<span class=hs-linenum>15: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>|</span> <span class='hs-layout'>(</span><span class='hs-conop'>:&lt;</span><span class='hs-layout'>)</span> <span class='hs-layout'>{</span> <span class='hs-varid'>hd</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>tl</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span> <span class='hs-layout'>}</span>
<span class=hs-linenum>16: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>9</span> <span class='hs-conop'>:&lt;</span>
<span class=hs-linenum>17: </span>
<span class=hs-linenum>18: </span><a class=annot href="#"><span class=annottext>(Scratch.Sample2.IncList GHC.Integer.Type.Integer)</span><span class='hs-definition'>okList</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##899 : GHC.Integer.Type.Integer | lq_tmp$x##899 == 1}</span><span class='hs-num'>1</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##901 : GHC.Integer.Type.Integer | lq_tmp$x##901 == 2}</span><span class='hs-num'>2</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##903 : GHC.Integer.Type.Integer | lq_tmp$x##903 == 3}</span><span class='hs-num'>3</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Scratch.Sample2.IncList a) | VV == Scratch.Sample2.Emp}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>19: </span>
<span class=hs-linenum>20: </span><span class='hs-definition'>insertSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>21: </span><a class=annot href="#"><span class=annottext>forall a .
(Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1210:[a] -&gt; (Scratch.Sample2.IncList a)</span><span class='hs-definition'>insertSort</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Scratch.Sample2.IncList a) | VV == Scratch.Sample2.Emp}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>22: </span><span class='hs-definition'>insertSort</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##960:a -&gt; lq_tmp$x##961:(Scratch.Sample2.IncList a) -&gt; (Scratch.Sample2.IncList a)</span><span class='hs-varid'>insert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1321 : a | lq_tmp$x##1321 == x##a3Vh}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>(Scratch.Sample2.IncList {lq_tmp$x##1294 : a | $k_##1293[VV##1292:=lq_tmp$x##1294][lq_tmp$x##1289:=fix$36$$36$dOrd_a3Xk][lq_tmp$x##1290:=xs##a3Vi]})</span><span class='hs-layout'>(</span></a><span class='hs-varid'>insertSort</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1300 : [a] | lq_tmp$x##1300 == xs##a3Vi
                        &amp;&amp; len lq_tmp$x##1300 &gt;= 0}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>23: </span>
<span class=hs-linenum>24: </span><span class='hs-definition'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>25: </span><a class=annot href="#"><span class=annottext>forall a .
(Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##960:a -&gt; lq_tmp$x##961:(Scratch.Sample2.IncList a) -&gt; (Scratch.Sample2.IncList a)</span><span class='hs-definition'>insert</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>y</span></a> <span class='hs-conid'>Emp</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##995 : a | lq_tmp$x##995 == y##a3Vj}</span><span class='hs-varid'>y</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Scratch.Sample2.IncList a) | VV == Scratch.Sample2.Emp}</span><span class='hs-conid'>Emp</span></a>
<span class=hs-linenum>26: </span><span class='hs-definition'>insert</span> <span class='hs-varid'>y</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-conop'>:&lt;</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum>27: </span>    <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1036 : a | lq_tmp$x##1036 == y##a3Vj}</span><span class='hs-varid'>y</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1037 : a | lq_tmp$x##1037 == x##a3Vl}</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1116 : a | lq_tmp$x##1116 == y##a3Vj}</span><span class='hs-varid'>y</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1100 : a | lq_tmp$x##1100 == x##a3Vl}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1102 : (Scratch.Sample2.IncList {lq_tmp$x##1101 : a | x##a3Vl &lt;= lq_tmp$x##1101}) | lq_tmp$x##1102 == xs##a3Vm}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>28: </span>    <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1080 : a | lq_tmp$x##1080 == x##a3Vl}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:&lt;</span> <a class=annot href="#"><span class=annottext>(Scratch.Sample2.IncList {lq_tmp$x##1061 : a | $k_##1060[VV##1059:=lq_tmp$x##1061][lq_tmp$x##1056:=fix$36$$36$dOrd_a3WD][lq_tmp$x##1057:=y##a3Vj][lq_tmp$x##1058:=xs##a3Vm]})</span><span class='hs-varid'>insert</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1064 : a | lq_tmp$x##1064 == y##a3Vj}</span><span class='hs-varid'>y</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1066 : (Scratch.Sample2.IncList {lq_tmp$x##1065 : a | x##a3Vl &lt;= lq_tmp$x##1065}) | lq_tmp$x##1066 == xs##a3Vm}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>29: </span>
<span class=hs-linenum>30: </span><span class='hs-comment'>-- se usa el foldr en vez del foldl porque si se usara foldl despues</span>
<span class=hs-linenum>31: </span><span class='hs-comment'>-- habria que aplicarle un reverse, y serian dos recorridos</span>
<span class=hs-linenum>32: </span><span class='hs-definition'>insertSort'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IncList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>33: </span><a class=annot href="#"><span class=annottext>forall a .
(Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##1124:[a] -&gt; (Scratch.Sample2.IncList a)</span><span class='hs-definition'>insertSort'</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(Scratch.Sample2.IncList {lq_tmp$x##1154 : a | $k_##1153[VV##1152:=lq_tmp$x##1154]})</span><span class='hs-varid'>foldr</span></a> <a class=annot href="#"><span class=annottext>lq_tmp$x##1197:{lq_tmp$x##1190 : a | $k_##1145[VV##1144:=lq_tmp$x##1190][lq_tmp$x##1141:=fix$36$$36$dOrd_a3WQ][lq_tmp$x##1146:=lq_tmp$x##1190]} -&gt; lq_tmp$x##1198:(Scratch.Sample2.IncList {lq_tmp$x##1191 : a | $k_##1145[VV##1144:=lq_tmp$x##1191][lq_tmp$x##1135:=lq_tmp$x##1192][lq_tmp$x##1141:=fix$36$$36$dOrd_a3WQ][lq_tmp$x##1142:=lq_tmp$x##1197][lq_tmp$x##1146:=lq_tmp$x##1191]}) -&gt; (Scratch.Sample2.IncList {lq_tmp$x##1193 : a | $k_##1145[VV##1144:=lq_tmp$x##1193][lq_tmp$x##1137:=lq_tmp$x##1194][lq_tmp$x##1141:=fix$36$$36$dOrd_a3WQ][lq_tmp$x##1142:=lq_tmp$x##1197][lq_tmp$x##1143:=lq_tmp$x##1198][lq_tmp$x##1146:=lq_tmp$x##1193]})</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Scratch.Sample2.IncList a) | VV == Scratch.Sample2.Emp
                                    &amp;&amp; VV == b##a3Vp}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>{lq_tmp$x##1204 : [a] | lq_tmp$x##1204 == xs##a3Vn
                        &amp;&amp; len lq_tmp$x##1204 &gt;= 0}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>34: </span>    <span class='hs-keyword'>where</span>
<span class=hs-linenum>35: </span>        <a class=annot href="#"><span class=annottext>lq_tmp$x##1142:{lq_tmp$x##1146 : a | $k_##1145[VV##1144:=lq_tmp$x##1146][lq_tmp$x##1141:=fix$36$$36$dOrd_a3WQ]} -&gt; lq_tmp$x##1143:(Scratch.Sample2.IncList {lq_tmp$x##1146 : a | $k_##1145[VV##1144:=lq_tmp$x##1146][lq_tmp$x##1141:=fix$36$$36$dOrd_a3WQ]}) -&gt; (Scratch.Sample2.IncList {lq_tmp$x##1146 : a | $k_##1145[VV##1144:=lq_tmp$x##1146][lq_tmp$x##1141:=fix$36$$36$dOrd_a3WQ]})</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(Ord&lt;[]&gt; a) =&gt;
lq_tmp$x##960:a -&gt; lq_tmp$x##961:(Scratch.Sample2.IncList a) -&gt; (Scratch.Sample2.IncList a)</span><span class='hs-varid'>insert</span></a>
<span class=hs-linenum>36: </span>        <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Scratch.Sample2.IncList a) | VV == Scratch.Sample2.Emp}</span><span class='hs-varid'>b</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      (Scratch.Sample2.IncList a) | VV == Scratch.Sample2.Emp}</span><span class='hs-conid'>Emp</span></a>
</pre>
</body>
</html>