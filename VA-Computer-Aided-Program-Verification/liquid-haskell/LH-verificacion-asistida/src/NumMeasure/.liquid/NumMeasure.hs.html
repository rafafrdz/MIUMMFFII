<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>src/NumMeasure/NumMeasure.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-keyword'>{-@</span></a> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--short-names"</span>    <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  2: </span><span class='hs-keyword'>{-@</span> <span class='hs-conid'>LIQUID</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  3: </span>
<span class=hs-linenum>  4: </span><span class='hs-comment'>{-
  Author: Rafael Fernandez Ortiz
  Language: Haskell with Liquid Haskell
-}</span>
<span class=hs-linenum>  8: </span>
<span class=hs-linenum>  9: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>NumMeasure.NumMeasure</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span>  <span class='hs-varid'>hiding</span>  <span class='hs-layout'>(</span><span class='hs-varid'>map</span><span class='hs-layout'>,</span> <span class='hs-varid'>zipWith</span><span class='hs-layout'>,</span> <span class='hs-varid'>zip</span><span class='hs-layout'>,</span> <span class='hs-varid'>take</span><span class='hs-layout'>,</span> <span class='hs-varid'>drop</span><span class='hs-layout'>,</span> <span class='hs-varid'>reverse</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 11: </span>
<span class=hs-linenum> 12: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>TRUE</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Bool</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 13: </span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>die</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| false}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 15: </span><a class=annot href="#"><span class=annottext>forall a . {v : [GHC.Types.Char] | false} -&gt; a</span><span class='hs-definition'>die</span></a> <a class=annot href="#"><span class=annottext>{VV : [GHC.Types.Char] | false}</span><span class='hs-varid'>msg</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>error</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Char] | false}</span><span class='hs-varid'>msg</span></a>
<span class=hs-linenum> 16: </span><span class='hs-definition'>take</span><span class='hs-layout'>,</span> <span class='hs-varid'>drop</span><span class='hs-layout'>,</span> <span class='hs-varid'>take'</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 17: </span><span class='hs-definition'>txgo</span>              <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-layout'>(</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-layout'>(</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 18: </span><span class='hs-definition'>quickSort</span>         <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 19: </span><span class='hs-definition'>size</span>              <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 20: </span><span class='hs-definition'>flatten</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-layout'>(</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 21: </span>
<span class=hs-linenum> 22: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>invariant</span> <span class='hs-keyword'>{v:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| 0 &lt;= size v}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 23: </span>
<span class=hs-linenum> 24: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V</span> <span class='hs-layout'>{</span> <a class=annot href="#"><span class=annottext>forall a .
x1:(NumMeasure.NumMeasure.Vector a) -&gt; {VV : GHC.Types.Int | VV == vDim x1
                                                             &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>vDim</span></a>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 25: </span>                  <span class='hs-layout'>,</span> <span class='hs-varid'>vElts</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 26: </span>                  <span class='hs-layout'>}</span>
<span class=hs-linenum> 27: </span>              <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 28: </span>
<span class=hs-linenum> 29: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mRow</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 30: </span>                  <span class='hs-layout'>,</span> <span class='hs-varid'>mCol</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 31: </span>                  <span class='hs-layout'>,</span> <span class='hs-varid'>mElts</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Vector</span> <span class='hs-layout'>(</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 32: </span>                  <span class='hs-layout'>}</span>
<span class=hs-linenum> 33: </span>              <span class='hs-keyword'>deriving</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span><span class='hs-layout'>,</span> <span class='hs-conid'>Show</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 34: </span>
<span class=hs-linenum> 35: </span>
<span class=hs-linenum> 36: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>size</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 37: </span><a class=annot href="#"><span class=annottext>forall a . x1:[a] -&gt; {VV : GHC.Types.Int | VV == size x1}</span><span class='hs-definition'>size</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == 0}</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 38: </span><span class='hs-definition'>size</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>rs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == size rs}</span><span class='hs-varid'>size</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == rs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>rs</span></a>
<span class=hs-linenum> 39: </span>
<span class=hs-linenum> 40: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>notEmpty</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 41: </span><span class='hs-definition'>notEmpty</span>       <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum> 42: </span><a class=annot href="#"><span class=annottext>forall a . x1:[a] -&gt; {VV : GHC.Types.Bool | VV &lt;=&gt; notEmpty x1}</span><span class='hs-definition'>notEmpty</span></a> <span class='hs-conid'>[]</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum> 43: </span><span class='hs-definition'>notEmpty</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a>
<span class=hs-linenum> 44: </span>
<span class=hs-linenum> 45: </span><span class='hs-keyword'>type</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 46: </span>
<span class=hs-linenum> 47: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 48: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span>        <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 49: </span>
<span class=hs-linenum> 50: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>map</span>      <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-conid'>List</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>| size v == size xs}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 51: </span><a class=annot href="#"><span class=annottext>forall a b . (a -&gt; b) -&gt; x3:[a] -&gt; {VV : [b] | size VV == size x3}</span><span class='hs-definition'>map</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 52: </span><span class='hs-definition'>map</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size xs}</span><span class='hs-varid'>map</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 53: </span>
<span class=hs-linenum> 54: </span>
<span class=hs-linenum> 55: </span><span class='hs-comment'>{- ########################################
## Exercise 1
######################################## -}</span>
<span class=hs-linenum> 58: </span>
<span class=hs-linenum> 59: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reverse</span>       <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 60: </span><a class=annot href="#"><span class=annottext>forall a . x1:[a] -&gt; {VV : [a] | size VV == size x1}</span><span class='hs-definition'>reverse</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | not (notEmpty v)
           &amp;&amp; len v == 0
           &amp;&amp; size v == 0}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 61: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum> 62: </span>    <span class='hs-keyword'>{-@</span> <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span> <span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{y:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| (size xs) == (size x) + (size y)}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 63: </span>    <a class=annot href="#"><span class=annottext>x1:[a] -&gt; {VV : [a] | size xs == size x1 + size VV} -&gt; {VV : [a] | size VV == size xs}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>acc</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == acc
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum> 64: </span>    <span class='hs-varid'>go</span> <span class='hs-varid'>acc</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[a] -&gt; {VV : [a] | size xs == size x1 + size VV} -&gt; {VV : [a] | size VV == size xs}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | notEmpty v
           &amp;&amp; head v == x
           &amp;&amp; len v == 1 + len acc
           &amp;&amp; size v == 1 + size acc
           &amp;&amp; tail v == acc}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{v : [a] | v == acc
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>acc</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum> 65: </span>
<span class=hs-linenum> 66: </span><span class='hs-comment'>{- ######################################## -}</span>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>zipWith</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 69: </span>                             <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>b</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 70: </span>                             <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>c</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 71: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 72: </span><a class=annot href="#"><span class=annottext>forall a b c .
(a -&gt; b -&gt; c) -&gt; x4:[a] -&gt; {VV : [b] | size VV == size x4} -&gt; {VV : [c] | size VV == size x4}</span><span class='hs-definition'>zipWith</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b -&gt; c</span><span class='hs-varid'>f</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-varid'>bs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == a}</span><span class='hs-varid'>a</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == b}</span><span class='hs-varid'>b</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size as}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b -&gt; c</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == as
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-keyword'>as</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == bs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>bs</span></a>
<span class=hs-linenum> 73: </span><span class='hs-definition'>zipWith</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span> <span class='hs-conid'>[]</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 74: </span><span class='hs-definition'>zipWith</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>  <span class='hs-keyword'>_</span>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : [GHC.Types.Char] | false} -&gt; a | VV == die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"no other cases"</span></a>
<span class=hs-linenum> 75: </span>
<span class=hs-linenum> 76: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>zip</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>as</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>bs</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| Tinier v as bs}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 77: </span><a class=annot href="#"><span class=annottext>forall a b .
x1:[a] -&gt; x2:[b] -&gt; {v : [(a, b)] | (not (size x1 &lt; size x2) =&gt; size v == size x2)
                                    &amp;&amp; (size x1 &lt; size x2 =&gt; size v == size x1)}</span><span class='hs-definition'>zip</span></a> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-conop'>:</span><span class='hs-keyword'>as</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-varid'>bs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (a, b) | fst v == a
              &amp;&amp; snd v == b
              &amp;&amp; x_Tuple21 v == a
              &amp;&amp; x_Tuple22 v == b}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == a}</span><span class='hs-varid'>a</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == b}</span><span class='hs-varid'>b</span></a><span class='hs-layout'>)</span> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{v : [(a, b)] | (not (size as &lt; size bs) =&gt; size v == size bs)
                &amp;&amp; (size as &lt; size bs =&gt; size v == size as)}</span><span class='hs-varid'>zip</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == as
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-keyword'>as</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == bs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>bs</span></a>
<span class=hs-linenum> 78: </span><span class='hs-definition'>zip</span> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span>          <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 79: </span><span class='hs-definition'>zip</span> <span class='hs-keyword'>_</span>  <span class='hs-conid'>[]</span>         <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 80: </span>
<span class=hs-linenum> 81: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Tinier</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Min</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-conid'>Y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 82: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Min</span> <span class='hs-conid'>X</span> <span class='hs-conid'>Y</span> <span class='hs-conid'>Z</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-keyword'>if</span> <span class='hs-conid'>Y</span> <span class='hs-varop'>&lt;</span> <span class='hs-conid'>Z</span> <span class='hs-keyword'>then</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Y</span> <span class='hs-keyword'>else</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Z</span><span class='hs-layout'>)</span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span>
<span class=hs-linenum> 85: </span><span class='hs-comment'>{- ########################################
## Exercise 2
######################################## -}</span>
<span class=hs-linenum> 88: </span>
<span class=hs-linenum> 89: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>zipOrNull</span> <span class='hs-keyglyph'>::</span>  <span class='hs-keyword'>as</span><span class='hs-conop'>:</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 90: </span>                  <span class='hs-keyword'>{ bs:</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| (size as) != 0 =&gt; (size bs) == (size as) || (size bs) == 0 }</span> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum> 91: </span>                  <span class='hs-keyword'>{ rs:</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span><span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>| ((size as) != 0 &amp;&amp; (size bs) != 0 =&gt; (size rs) == (size as)) &amp;&amp;
                                  ((size as) = 0 || (size bs) = 0 =&gt; (size rs) == 0) }</span>
<span class=hs-linenum> 93: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-definition'>zipOrNull</span>       <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>b</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 96: </span><a class=annot href="#"><span class=annottext>forall a b .
x1:[a] -&gt; x2:{bs : [b] | size x1 /= 0 =&gt; size bs == size x1
                                         || size bs == 0} -&gt; {rs : [(a, b)] | (size x1 /= 0
                                                                               &amp;&amp; size x2 /= 0 =&gt; size rs == size x1)
                                                                              &amp;&amp; (size x1 == 0
                                                                                  || size x2 == 0 =&gt; size rs == 0)}</span><span class='hs-definition'>zipOrNull</span></a> <span class='hs-conid'>[]</span> <span class='hs-keyword'>_</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 97: </span><span class='hs-definition'>zipOrNull</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum> 98: </span><span class='hs-definition'>zipOrNull</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:a -&gt; x2:b -&gt; {v : (a, b) | fst v == x1
                              &amp;&amp; snd v == x2
                              &amp;&amp; x_Tuple21 v == x1
                              &amp;&amp; x_Tuple22 v == x2}</span><span class='hs-varid'>zipWith</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | fst v == x1
                                                                                           &amp;&amp; snd v == x2
                                                                                           &amp;&amp; x_Tuple21 v == x1
                                                                                           &amp;&amp; x_Tuple22 v == x2} | VV == (,)}</span><span class='hs-conid'>(,)</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test1</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>| size v = 2}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>101: </span><a class=annot href="#"><span class=annottext>{v : [(GHC.Integer.Type.Integer, GHC.Types.Bool)] | size v == 2}</span><span class='hs-definition'>test1</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>zipOrNull</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 0}</span><span class='hs-num'>0</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-keyglyph'>]</span> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | notEmpty v
                        &amp;&amp; head v == True}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>102: </span>
<span class=hs-linenum>103: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test2</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>| size v = 0}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>104: </span><a class=annot href="#"><span class=annottext>forall a . {v : [(a, GHC.Types.Bool)] | size v == 0}</span><span class='hs-definition'>test2</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>zipOrNull</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Types.Bool] | notEmpty v
                        &amp;&amp; head v == True}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test3</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{v:</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>| size v = 0}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>107: </span><a class=annot href="#"><span class=annottext>forall a . {v : [([GHC.Types.Char], a)] | size v == 0}</span><span class='hs-definition'>test3</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-varid'>zipOrNull</span> <a class=annot href="#"><span class=annottext>{v : [[GHC.Types.Char]] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"cat"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"dog"</span></a><span class='hs-keyglyph'>]</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>108: </span>
<span class=hs-linenum>109: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>take'</span>     <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListGE</span> <span class='hs-varid'>a</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>110: </span><a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : [a] | x1 &lt;= size VV} -&gt; {VV : [a] | size VV == x1}</span><span class='hs-definition'>take'</span></a> <span class='hs-num'>0</span> <span class='hs-keyword'>_</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>111: </span><span class='hs-definition'>take'</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>take'</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>112: </span><span class='hs-definition'>take'</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : [GHC.Types.Char] | false} -&gt; a | VV == die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"won't  happen"</span></a>
<span class=hs-linenum>113: </span>
<span class=hs-linenum>114: </span>
<span class=hs-linenum>115: </span><span class='hs-comment'>{- ########################################
## Exercise 3
######################################## -}</span>
<span class=hs-linenum>118: </span>
<span class=hs-linenum>119: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>ListGE</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>N</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>120: </span>
<span class=hs-linenum>121: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>drop</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>as</span><span class='hs-conop'>:</span> <span class='hs-conid'>ListGE</span> <span class='hs-varid'>a</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ v:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size v = (size as) - n }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>122: </span><a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; x2:{VV : [a] | x1 &lt;= size VV} -&gt; {VV : [a] | size VV == size x2 - x1}</span><span class='hs-definition'>drop</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>123: </span><span class='hs-definition'>drop</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; x2:{VV : [a] | x1 &lt;= size VV} -&gt; {VV : [a] | size VV == size x2 - x1}</span><span class='hs-varid'>drop</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>124: </span><span class='hs-definition'>drop</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : [GHC.Types.Char] | false} -&gt; a | VV == die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"won't happen"</span></a>
<span class=hs-linenum>125: </span>
<span class=hs-linenum>126: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test4</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>String</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>127: </span><a class=annot href="#"><span class=annottext>{VV : [[GHC.Types.Char]] | size VV == 2}</span><span class='hs-definition'>test4</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>drop</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>{v : [[GHC.Types.Char]] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"cat"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"dog"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"mouse"</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>128: </span>
<span class=hs-linenum>129: </span><span class='hs-comment'>{- ########################################
## Exercise 4
######################################## -}</span>
<span class=hs-linenum>132: </span>
<span class=hs-linenum>133: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>take</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>as</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{rs:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| Min (size rs) (size as) n }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>134: </span><a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; x2:[a] -&gt; {VV : [a] | (not (size x2 &lt; x1) =&gt; size VV == x1)
                                                           &amp;&amp; (size x2 &lt; x1 =&gt; size VV == size x2)}</span><span class='hs-definition'>take</span></a> <span class='hs-num'>0</span> <span class='hs-keyword'>_</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>135: </span><span class='hs-definition'>take</span> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>136: </span><span class='hs-definition'>take</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>take</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>137: </span>
<span class=hs-linenum>138: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test5</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-conid'>ListN</span> <span class='hs-conid'>String</span> <span class='hs-num'>2</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>139: </span><a class=annot href="#"><span class=annottext>[{VV : [[GHC.Types.Char]] | size VV == 2}]</span><span class='hs-definition'>test5</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Char]]</span><span class='hs-varid'>take</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a>  <a class=annot href="#"><span class=annottext>{v : [[GHC.Types.Char]] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"cat"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"dog"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"mouse"</span></a><span class='hs-keyglyph'>]</span> <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[[GHC.Types.Char]]</span><span class='hs-varid'>take</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>20</span></a> <a class=annot href="#"><span class=annottext>{v : [[GHC.Types.Char]] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"cow"</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"goat"</span></a><span class='hs-keyglyph'>]</span>        <span class='hs-keyglyph'>]</span>
<span class=hs-linenum>140: </span>
<span class=hs-linenum>141: </span>
<span class=hs-linenum>142: </span><span class='hs-comment'>{- ########################################
## Exercise 5
######################################## -}</span>
<span class=hs-linenum>145: </span>
<span class=hs-linenum>146: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Sum2</span> <span class='hs-conid'>X</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span> <span class='hs-layout'>(</span><span class='hs-varid'>fst</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-varop'>+</span> <span class='hs-varid'>size</span> <span class='hs-layout'>(</span><span class='hs-varid'>snd</span> <span class='hs-conid'>X</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>147: </span>
<span class=hs-linenum>148: </span>
<span class=hs-linenum>149: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>partition</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| Sum2 v (size xs)}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>150: </span>
<span class=hs-linenum>151: </span><span class='hs-definition'>partition</span>          <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>,</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum>152: </span><a class=annot href="#"><span class=annottext>forall a .
(a -&gt; GHC.Types.Bool) -&gt; x3:[a] -&gt; {v : ([a], [a]) | size (fst v) + size (snd v) == size x3}</span><span class='hs-definition'>partition</span></a> <span class='hs-keyword'>_</span> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | not (notEmpty v)
           &amp;&amp; len v == 0
           &amp;&amp; size v == 0}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>153: </span><span class='hs-definition'>partition</span> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum>154: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | fst v == x1
                                                                                           &amp;&amp; snd v == x2
                                                                                           &amp;&amp; x_Tuple21 v == x1
                                                                                           &amp;&amp; x_Tuple22 v == x2} | VV == (,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{v : [a] | v == ys
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == zs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>155: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a b &lt;p2 :: a b -&gt; Bool&gt;.
      x1:a -&gt; x2:{VV : b&lt;p2 x1&gt; | true} -&gt; {v : (a, b)&lt;\x5 VV -&gt; {VV : b&lt;p2 x5&gt; | true}&gt; | fst v == x1
                                                                                           &amp;&amp; snd v == x2
                                                                                           &amp;&amp; x_Tuple21 v == x1
                                                                                           &amp;&amp; x_Tuple22 v == x2} | VV == (,)}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : [a] | v == ys
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{v : [a] | v == zs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>156: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>157: </span>    <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : [a] | len VV &gt;= 0}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : [a] | len VV &gt;= 0}</span><span class='hs-varid'>zs</span></a><span class='hs-layout'>)</span>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(a -&gt; GHC.Types.Bool) -&gt; x3:[a] -&gt; {v : ([a], [a]) | size (fst v) + size (snd v) == size x3}</span><span class='hs-varid'>partition</span></a> <a class=annot href="#"><span class=annottext>a -&gt; GHC.Types.Bool</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>158: </span>
<span class=hs-linenum>159: </span>
<span class=hs-linenum>160: </span><span class='hs-keyword'>infixr</span> <span class='hs-num'>5</span> <span class='hs-varop'>&gt;+&lt;</span>
<span class=hs-linenum>161: </span>
<span class=hs-linenum>162: </span><span class='hs-keyword'>{-@</span> <span class='hs-layout'>(</span><span class='hs-varop'>&gt;+&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span> <span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ys</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ zs :</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| (size zs) = (size xs) + (size ys) }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>163: </span><span class='hs-layout'>(</span><span class='hs-varop'>&gt;+&lt;</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>164: </span><span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>forall a .
x1:[a] -&gt; x2:[a] -&gt; {VV : [a] | size VV == size x1 + size x2}</span><span class='hs-varop'>&gt;+&lt;</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-conop'>:</span> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size xs + size ys}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>&gt;+&lt;</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == ys
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>165: </span><span class='hs-conid'>[]</span> <span class='hs-varop'>&gt;+&lt;</span> <span class='hs-varid'>ys</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == ys
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>ys</span></a>
<span class=hs-linenum>166: </span>
<span class=hs-linenum>167: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>quickSort</span>    <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ord</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListX</span> <span class='hs-varid'>a</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>168: </span>
<span class=hs-linenum>169: </span><a class=annot href="#"><span class=annottext>forall a . (Ord&lt;[]&gt; a) =&gt; x2:[a] -&gt; {VV : [a] | size VV == size x2}</span><span class='hs-definition'>quickSort</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>170: </span><span class='hs-definition'>quickSort</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size lss}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>quickSort</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == lss
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>lss</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;+&lt;</span> <a class=annot href="#"><span class=annottext>{v : [a] | notEmpty v
           &amp;&amp; head v == x
           &amp;&amp; len v == 1 + len same
           &amp;&amp; size v == 1 + size same
           &amp;&amp; tail v == same}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{v : [a] | v == same
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>same</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>&gt;+&lt;</span> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size gtt}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>quickSort</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == gtt
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>gtt</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>171: </span>  <span class='hs-keyword'>where</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : [a] | len VV &gt;= 0}</span><span class='hs-varid'>lss</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : [a] | len VV &gt;= 0}</span><span class='hs-varid'>same'</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:a -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1 &lt; x}</span><span class='hs-varid'>partition</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>172: </span>        <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : [a] | len VV &gt;= 0}</span><span class='hs-varid'>gtt</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : [a] | len VV &gt;= 0}</span><span class='hs-varid'>same</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:a -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1 &gt; x}</span><span class='hs-varid'>partition</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == same'
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>same'</span></a>
<span class=hs-linenum>173: </span>
<span class=hs-linenum>174: </span>
<span class=hs-linenum>175: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>test10</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-conid'>String</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>176: </span><a class=annot href="#"><span class=annottext>{VV : [[GHC.Types.Char]] | size VV == 2}</span><span class='hs-definition'>test10</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quickSort</span> <a class=annot href="#"><span class=annottext>{v : [[GHC.Types.Char]] | v == test4
                          &amp;&amp; size v == 2
                          &amp;&amp; len v &gt;= 0
                          &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>test4</span></a>
<span class=hs-linenum>177: </span>
<span class=hs-linenum>178: </span>
<span class=hs-linenum>179: </span><span class='hs-comment'>{- ########################################
## Exercise 6
######################################## -}</span>
<span class=hs-linenum>182: </span>
<span class=hs-linenum>183: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V</span> <span class='hs-layout'>{</span> <span class='hs-varid'>vDim</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum>184: </span>                      <span class='hs-layout'>,</span> <span class='hs-varid'>vElts</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>vDim</span> <span class='hs-layout'>}</span>         <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>185: </span>
<span class=hs-linenum>186: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vDim</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{v:</span> <span class='hs-conid'>Nat</span> <span class='hs-keyword'>| v = vDim x}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>187: </span>
<span class=hs-linenum>188: </span><a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-definition'>okVec</span></a>  <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 10}</span><span class='hs-num'>10</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 20}</span><span class='hs-num'>20</span></a><span class='hs-keyglyph'>]</span>       <span class='hs-comment'>-- accepted by LH</span>
<span class=hs-linenum>189: </span>
<span class=hs-linenum>190: </span><span class='hs-comment'>-- badVec = V 2 [10, 20, 30]   -- rejected by LH</span>
<span class=hs-linenum>191: </span>
<span class=hs-linenum>192: </span><span class='hs-comment'>-- | Non Empty Vectors</span>
<span class=hs-linenum>193: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>VectorNE</span> <span class='hs-varid'>a</span>  <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>vDim</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>194: </span>
<span class=hs-linenum>195: </span><span class='hs-comment'>-- | Vectors of size N</span>
<span class=hs-linenum>196: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>vDim</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>197: </span>
<span class=hs-linenum>198: </span><span class='hs-comment'>-- | Vectors of Size Equal to Another Vector X</span>
<span class=hs-linenum>199: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>VectorX</span> <span class='hs-varid'>a</span> <span class='hs-conid'>X</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>{</span><span class='hs-varid'>vDim</span> <span class='hs-conid'>X</span><span class='hs-layout'>}</span>        <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>200: </span>
<span class=hs-linenum>201: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vEmp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>202: </span><a class=annot href="#"><span class=annottext>forall a . {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == 0}</span><span class='hs-definition'>vEmp</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>V</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a>
<span class=hs-linenum>203: </span>
<span class=hs-linenum>204: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vCons</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{vDim x + 1}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>205: </span><a class=annot href="#"><span class=annottext>forall a .
a -&gt; x2:(NumMeasure.NumMeasure.Vector a) -&gt; {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == vDim x2 + 1}</span><span class='hs-definition'>vCons</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-varid'>n</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; x2:{v : [a] | size v == x1} -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x1
                                                                                                                &amp;&amp; vElts v == x2} | VV == V}</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | notEmpty v
           &amp;&amp; head v == x
           &amp;&amp; len v == 1 + len xs
           &amp;&amp; size v == 1 + size xs
           &amp;&amp; tail v == xs}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a><span class='hs-conop'>:</span><a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; size v == n
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>206: </span>
<span class=hs-linenum>207: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vHd</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VectorNE</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>208: </span><a class=annot href="#"><span class=annottext>forall a .
{VV : (NumMeasure.NumMeasure.Vector a) | vDim VV &gt; 0} -&gt; a</span><span class='hs-definition'>vHd</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a>
<span class=hs-linenum>209: </span><span class='hs-definition'>vHd</span> <span class='hs-keyword'>_</span>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : [GHC.Types.Char] | false} -&gt; a | VV == die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"nope"</span></a>
<span class=hs-linenum>210: </span>
<span class=hs-linenum>211: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vTl</span>          <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>VectorNE</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{vDim x - 1}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>212: </span><a class=annot href="#"><span class=annottext>forall a .
x1:{VV : (NumMeasure.NumMeasure.Vector a) | vDim VV &gt; 0} -&gt; {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == vDim x1 - 1}</span><span class='hs-definition'>vTl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; x2:{v : [a] | size v == x1} -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x1
                                                                                                                &amp;&amp; vElts v == x2} | VV == V}</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>213: </span><span class='hs-definition'>vTl</span> <span class='hs-keyword'>_</span>            <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : [GHC.Types.Char] | false} -&gt; a | VV == die}</span><span class='hs-varid'>die</span></a> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"nope"</span></a>
<span class=hs-linenum>214: </span>
<span class=hs-linenum>215: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>for</span>        <span class='hs-keyglyph'>::</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorX</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>216: </span><a class=annot href="#"><span class=annottext>forall a b .
x1:(NumMeasure.NumMeasure.Vector a) -&gt; (a -&gt; b) -&gt; {VV : (NumMeasure.NumMeasure.Vector b) | vDim VV == vDim x1}</span><span class='hs-definition'>for</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-varid'>n</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; x2:{v : [a] | size v == x1} -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x1
                                                                                                                &amp;&amp; vElts v == x2} | VV == V}</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size xs}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>a -&gt; b</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; size v == n
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>217: </span>
<span class=hs-linenum>218: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vBin</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>219: </span>                          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorX</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>220: </span>                          <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorX</span> <span class='hs-varid'>c</span> <span class='hs-varid'>x</span>
<span class=hs-linenum>221: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>222: </span><a class=annot href="#"><span class=annottext>forall a b c .
(a -&gt; b -&gt; c) -&gt; x4:(NumMeasure.NumMeasure.Vector a) -&gt; {VV : (NumMeasure.NumMeasure.Vector b) | vDim VV == vDim x4} -&gt; {VV : (NumMeasure.NumMeasure.Vector c) | vDim VV == vDim x4}</span><span class='hs-definition'>vBin</span></a> <a class=annot href="#"><span class=annottext>a -&gt; b -&gt; c</span><span class='hs-varid'>op</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-varid'>n</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; x2:{v : [a] | size v == x1} -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x1
                                                                                                                &amp;&amp; vElts v == x2} | VV == V}</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size xs}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>zipWith</span> <a class=annot href="#"><span class=annottext>a -&gt; b -&gt; c</span><span class='hs-varid'>op</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; size v == n
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | v == ys
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>223: </span>
<span class=hs-linenum>224: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>dotProduct</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorX</span> <span class='hs-varid'>a</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>225: </span><a class=annot href="#"><span class=annottext>forall a .
(Num&lt;[]&gt; a) =&gt;
x2:(NumMeasure.NumMeasure.Vector a) -&gt; {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == vDim x2} -&gt; a</span><span class='hs-definition'>dotProduct</span></a> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector a)</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == vDim x}</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[a] -&gt; a</span><span class='hs-varid'>sum</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:(NumMeasure.NumMeasure.Vector a) -&gt; {v : [a] | v == vElts x1
                                                        &amp;&amp; size v == vDim x1} | VV == vElts}</span><span class='hs-varid'>vElts</span></a> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | vDim v == vDim x}</span><span class='hs-varid'>vBin</span></a> <a class=annot href="#"><span class=annottext>x1:a -&gt; x2:a -&gt; {VV : a | VV == x1 * x2}</span><span class='hs-layout'>(</span></a><span class='hs-varop'>*</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | v == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | v == y
                                        &amp;&amp; vDim v == vDim x}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>226: </span>
<span class=hs-linenum>227: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>vecFromList</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>l</span> <span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>228: </span><span class='hs-definition'>vecFromList</span>     <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Vector</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>229: </span><a class=annot href="#"><span class=annottext>forall a .
x1:[a] -&gt; {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == size x1}</span><span class='hs-definition'>vecFromList</span></a> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>xs</span></a>  <span class='hs-keyglyph'>=</span>  <span class='hs-conid'>V</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == size xs}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>size</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a>
<span class=hs-linenum>230: </span>
<span class=hs-linenum>231: </span><a class=annot href="#"><span class=annottext>GHC.Integer.Type.Integer</span><span class='hs-definition'>test6</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Num.Num GHC.Integer.Type.Integer) | v == $fNumInteger}</span><span class='hs-varid'>dotProduct</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer) | v == vx}</span><span class='hs-varid'>vx</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer) | v == vy}</span><span class='hs-varid'>vy</span></a>
<span class=hs-linenum>232: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>233: </span>    <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-varid'>vx</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-varid'>vecFromList</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 3}</span><span class='hs-num'>3</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>234: </span>    <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-varid'>vy</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-varid'>vecFromList</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 4}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 5}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 6}</span><span class='hs-num'>6</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>235: </span>
<span class=hs-linenum>236: </span>
<span class=hs-linenum>237: </span><span class='hs-comment'>{- ########################################
## Exercise 7 - Implement flatten
######################################## -}</span>
<span class=hs-linenum>240: </span>
<span class=hs-linenum>241: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>flatten</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span>
<span class=hs-linenum>242: </span>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>m</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span>
<span class=hs-linenum>243: </span>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-layout'>(</span><span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-varid'>n</span>
<span class=hs-linenum>244: </span>            <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{m * n}</span>
<span class=hs-linenum>245: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>246: </span>
<span class=hs-linenum>247: </span><a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; x2:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : (NumMeasure.NumMeasure.Vector {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == x2}) | vDim VV == x1} -&gt; {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == x2 * x1}</span><span class='hs-definition'>flatten</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0}</span><span class='hs-varid'>m</span></a> <a class=annot href="#"><span class=annottext>{VV : (NumMeasure.NumMeasure.Vector {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == m}) | vDim VV == n}</span><span class='hs-varid'>v</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:[a] -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == size x1} | VV == vecFromList}</span><span class='hs-varid'>vecFromList</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | size v == m * n}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>flatten'</span> <a class=annot href="#"><span class=annottext>[[a]]</span><span class='hs-layout'>(</span></a><span class='hs-varid'>map</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:(NumMeasure.NumMeasure.Vector a) -&gt; {v : [a] | v == vElts x1
                                                        &amp;&amp; size v == vDim x1} | VV == vElts}</span><span class='hs-varid'>vElts</span></a> <a class=annot href="#"><span class=annottext>{v' : [(NumMeasure.NumMeasure.Vector a)] | v' == vElts v
                                           &amp;&amp; size v' == vDim v}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vElts</span> <a class=annot href="#"><span class=annottext>{v' : (NumMeasure.NumMeasure.Vector {v : (NumMeasure.NumMeasure.Vector a) | vDim v == m}) | v' == v
                                                                                            &amp;&amp; vDim v' == n}</span><span class='hs-varid'>v</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{VV : forall a &lt;p :: a a -&gt; Bool&gt;.
      {v : [a]&lt;\x3 VV -&gt; {VV : a&lt;p x3&gt; | true}&gt; | not (notEmpty v)
                                                  &amp;&amp; len v == 0
                                                  &amp;&amp; size v == 0} | VV == []}</span><span class='hs-conid'>[]</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>248: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>249: </span>    <span class='hs-keyword'>{-@</span> <span class='hs-varid'>flatten'</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xss</span><span class='hs-conop'>:</span> <span class='hs-conid'>List</span> <span class='hs-layout'>(</span><span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{m * (n - (size xss))}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>ListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{m * n}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>250: </span>    <a class=annot href="#"><span class=annottext>x1:[{VV : [a] | size VV == m}] -&gt; {VV : [a] | size VV == m * (n - size x1)} -&gt; {VV : [a] | size VV == m * n}</span><span class='hs-varid'>flatten'</span></a> <span class='hs-conid'>[]</span> <a class=annot href="#"><span class=annottext>[a]</span><span class='hs-varid'>acc</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == acc
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum>251: </span>    <span class='hs-varid'>flatten'</span> <span class='hs-layout'>(</span><span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-varid'>xss</span><span class='hs-layout'>)</span> <span class='hs-varid'>acc</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[{VV : [a] | size VV == m}] -&gt; {VV : [a] | size VV == m * (n - size x1)} -&gt; {VV : [a] | size VV == m * n}</span><span class='hs-varid'>flatten'</span></a> <a class=annot href="#"><span class=annottext>{v : [{v : [a] | size v == m}] | v == xss
                                 &amp;&amp; len v &gt;= 0
                                 &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xss</span></a> <a class=annot href="#"><span class=annottext>{v : [a] | size v == size acc + size xs}</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : [a] | v == acc
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>acc</span></a> <span class='hs-varop'>&gt;+&lt;</span> <a class=annot href="#"><span class=annottext>{v : [a] | v == xs
           &amp;&amp; size v == m
           &amp;&amp; len v &gt;= 0
           &amp;&amp; 0 &lt;= size v}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>252: </span>
<span class=hs-linenum>253: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>product</span>   <span class='hs-keyglyph'>::</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-keyword'>_</span>
<span class=hs-linenum>254: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ys</span><span class='hs-conop'>:</span><span class='hs-conid'>Vector</span> <span class='hs-keyword'>_</span>
<span class=hs-linenum>255: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>{vDim xs * vDim ys}</span>
<span class=hs-linenum>256: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>257: </span><a class=annot href="#"><span class=annottext>forall a .
(Num&lt;[]&gt; a) =&gt;
x2:(NumMeasure.NumMeasure.Vector a) -&gt; x3:(NumMeasure.NumMeasure.Vector a) -&gt; {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == vDim x2 * vDim x3}</span><span class='hs-definition'>product</span></a> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector a)</span><span class='hs-varid'>xs</span></a> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector a)</span><span class='hs-varid'>ys</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; x2:{v : GHC.Types.Int | v &gt;= 0} -&gt; {v : (NumMeasure.NumMeasure.Vector {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x2}) | vDim v == x1} -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x2 * x1} | VV == flatten}</span><span class='hs-varid'>flatten</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == vDim ys
                     &amp;&amp; v &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vDim</span> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | v == ys}</span><span class='hs-varid'>ys</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == vDim xs
                     &amp;&amp; v &gt;= 0}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>vDim</span> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | v == xs}</span><span class='hs-varid'>xs</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a)) | v == xys
                                                                       &amp;&amp; vDim v == vDim ys}</span><span class='hs-varid'>xys</span></a>
<span class=hs-linenum>258: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>259: </span>    <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a)) | vDim v == vDim ys}</span><span class='hs-varid'>xys</span></a>       <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a -&gt; (NumMeasure.NumMeasure.Vector a)) -&gt; {v : (NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a)) | vDim v == vDim ys}</span><span class='hs-varid'>for</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | v == ys}</span><span class='hs-varid'>ys</span></a> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>y</span></a> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>260: </span>                  <a class=annot href="#"><span class=annottext>(a -&gt; a) -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == vDim xs}</span><span class='hs-varid'>for</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | v == xs}</span><span class='hs-varid'>xs</span></a> <span class='hs-varop'>$</span> <span class='hs-keyglyph'>\</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-keyglyph'>-&gt;</span>
<span class=hs-linenum>261: </span>                    <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>*</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == y}</span><span class='hs-varid'>y</span></a>
<span class=hs-linenum>262: </span>
<span class=hs-linenum>263: </span>
<span class=hs-linenum>264: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>265: </span>      <span class='hs-conid'>M</span> <span class='hs-layout'>{</span> <span class='hs-varid'>mRow</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos</span>
<span class=hs-linenum>266: </span>        <span class='hs-layout'>,</span> <span class='hs-varid'>mCol</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Pos</span>
<span class=hs-linenum>267: </span>        <span class='hs-layout'>,</span> <span class='hs-varid'>mElts</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>VectorN</span> <span class='hs-layout'>(</span><span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>mCol</span><span class='hs-layout'>)</span> <span class='hs-varid'>mRow</span>
<span class=hs-linenum>268: </span>        <span class='hs-layout'>}</span>
<span class=hs-linenum>269: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>270: </span>
<span class=hs-linenum>271: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>Pos</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Int</span> <span class='hs-keyglyph'>|</span> <span class='hs-num'>0</span> <span class='hs-varop'>&lt;</span> <span class='hs-varid'>v</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>272: </span>
<span class=hs-linenum>273: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>MatrixN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>R</span> <span class='hs-conid'>C</span>   <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-conid'>Dims</span> <span class='hs-varid'>v</span> <span class='hs-conid'>R</span> <span class='hs-conid'>C</span> <span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>274: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>predicate</span> <span class='hs-conid'>Dims</span> <span class='hs-conid'>M</span> <span class='hs-conid'>R</span> <span class='hs-conid'>C</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>mRow</span> <span class='hs-conid'>M</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>R</span> <span class='hs-varop'>&amp;&amp;</span> <span class='hs-varid'>mCol</span> <span class='hs-conid'>M</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>C</span>   <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>275: </span>
<span class=hs-linenum>276: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ok23</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>MatrixN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>2</span> <span class='hs-num'>3</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>277: </span><a class=annot href="#"><span class=annottext>{VV : (NumMeasure.NumMeasure.Matrix GHC.Integer.Type.Integer) | mCol VV == 3
                                                                &amp;&amp; mRow VV == 2}</span><span class='hs-definition'>ok23</span></a>     <span class='hs-keyglyph'>=</span> <span class='hs-conid'>M</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>3</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>V</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a> <span class='hs-keyglyph'>[</span> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>3</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 1}</span><span class='hs-num'>1</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 2}</span><span class='hs-num'>2</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 3}</span><span class='hs-num'>3</span></a><span class='hs-keyglyph'>]</span>
<span class=hs-linenum>278: </span>                      <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector GHC.Integer.Type.Integer)</span><span class='hs-conid'>V</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>3</span></a> <a class=annot href="#"><span class=annottext>{v : [GHC.Integer.Type.Integer] | notEmpty v}</span><span class='hs-keyglyph'>[</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 4}</span><span class='hs-num'>4</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 5}</span><span class='hs-num'>5</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Integer.Type.Integer | v == 6}</span><span class='hs-num'>6</span></a><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<span class=hs-linenum>279: </span>
<span class=hs-linenum>280: </span><span class='hs-comment'>-- bad1 :: Matrix Int</span>
<span class=hs-linenum>281: </span><span class='hs-comment'>-- bad1 = M 2 3 (V 2 [ V 3 [1, 2   ]</span>
<span class=hs-linenum>282: </span><span class='hs-comment'>--                   , V 3 [4, 5, 6]])</span>
<span class=hs-linenum>283: </span>
<span class=hs-linenum>284: </span><span class='hs-comment'>-- bad2 :: Matrix Int</span>
<span class=hs-linenum>285: </span><span class='hs-comment'>-- bad2 = M 2 3 (V 2 [ V 2 [1, 2]</span>
<span class=hs-linenum>286: </span><span class='hs-comment'>--                   , V 2 [4, 5] ])</span>
<span class=hs-linenum>287: </span>
<span class=hs-linenum>288: </span><span class='hs-comment'>{- #########################################################
## Exercise 8 - complete and refine the type of matFromList
######################################################### -}</span>
<span class=hs-linenum>291: </span>
<span class=hs-linenum>292: </span><span class='hs-comment'>-- {-@ matFromList :: xss: List (List a) -&gt; Maybe (MatrixN a (size xss) (size (head xss))) @-}</span>
<span class=hs-linenum>293: </span><span class='hs-comment'>-- matFromList      :: [[a]] -&gt; Maybe (Matrix a)</span>
<span class=hs-linenum>294: </span><span class='hs-comment'>-- matFromList []   = Nothing</span>
<span class=hs-linenum>295: </span><span class='hs-comment'>-- matFromList xss@(xs:_)</span>
<span class=hs-linenum>296: </span><span class='hs-comment'>--   | ok           = fmap (M r c) vs</span>
<span class=hs-linenum>297: </span><span class='hs-comment'>--   | otherwise    = Nothing</span>
<span class=hs-linenum>298: </span><span class='hs-comment'>--   where</span>
<span class=hs-linenum>299: </span><span class='hs-comment'>--     r            = size xss</span>
<span class=hs-linenum>300: </span><span class='hs-comment'>--     c            = size xs</span>
<span class=hs-linenum>301: </span><span class='hs-comment'>--     ok           = c &gt; 0 &amp;&amp; all ((==c) . size) xss</span>
<span class=hs-linenum>302: </span><span class='hs-comment'>--     vs           = fmap vecFromList (planeVector $ tryToVector c xss)</span>
<span class=hs-linenum>303: </span>
<span class=hs-linenum>304: </span><span class='hs-comment'>-- planeVector :: [Maybe (Vector a)] -&gt; Maybe [Vector a]</span>
<span class=hs-linenum>305: </span><span class='hs-comment'>-- planeVector [] = return []</span>
<span class=hs-linenum>306: </span><span class='hs-comment'>-- planeVector (mv:mvv) = do v &lt;- mv</span>
<span class=hs-linenum>307: </span><span class='hs-comment'>--                           vs &lt;- planeVector(mvv)</span>
<span class=hs-linenum>308: </span><span class='hs-comment'>--                           return (v:vs)</span>
<span class=hs-linenum>309: </span>
<span class=hs-linenum>310: </span><span class='hs-comment'>-- tryToVector :: Int -&gt; [[a]] -&gt; [Maybe (Vector a)]</span>
<span class=hs-linenum>311: </span><span class='hs-comment'>-- tryToVector _ [] = []</span>
<span class=hs-linenum>312: </span><span class='hs-comment'>-- tryToVector cleng (xs:xss)</span>
<span class=hs-linenum>313: </span><span class='hs-comment'>--   | size xs == cleng = Just(V cleng xs) : tryToVector cleng (xss)</span>
<span class=hs-linenum>314: </span><span class='hs-comment'>--   | otherwise =  Nothing : tryToVector cleng (xss)</span>
<span class=hs-linenum>315: </span>
<span class=hs-linenum>316: </span>
<span class=hs-linenum>317: </span><span class='hs-comment'>-- {-@ mat23 :: Maybe (MatrixN Integer 2 2) @-}</span>
<span class=hs-linenum>318: </span><span class='hs-comment'>-- mat23     = matFromList [ [1, 2]</span>
<span class=hs-linenum>319: </span><span class='hs-comment'>--                         , [3, 4] ]</span>
<span class=hs-linenum>320: </span>
<span class=hs-linenum>321: </span><span class='hs-comment'>-- {-@ matProduct :: (Num a) =&gt; x:Matrix a</span>
<span class=hs-linenum>322: </span><span class='hs-comment'>--                           -&gt; y:{Matrix a  | mCol x = mRow y}</span>
<span class=hs-linenum>323: </span><span class='hs-comment'>--                           -&gt; MatrixN a (mRow x) (mCol y)</span>
<span class=hs-linenum>324: </span><span class='hs-comment'>--   @-}</span>
<span class=hs-linenum>325: </span><span class='hs-comment'>-- matProduct (M rx _ xs) my@(M _ cy _)</span>
<span class=hs-linenum>326: </span><span class='hs-comment'>--                  = M rx cy elts</span>
<span class=hs-linenum>327: </span><span class='hs-comment'>--   where</span>
<span class=hs-linenum>328: </span><span class='hs-comment'>--     elts         = for xs $ \xi -&gt;</span>
<span class=hs-linenum>329: </span><span class='hs-comment'>--                      for ys' $ \yj -&gt;</span>
<span class=hs-linenum>330: </span><span class='hs-comment'>--                        dotProduct xi yj</span>
<span class=hs-linenum>331: </span><span class='hs-comment'>--     M _ _ ys'    = transpose my</span>
<span class=hs-linenum>332: </span>
<span class=hs-linenum>333: </span>
<span class=hs-linenum>334: </span><span class='hs-comment'>-- ok32 = M 3 2 (V 3 [ V 2 [1, 4]</span>
<span class=hs-linenum>335: </span><span class='hs-comment'>--                   , V 2 [2, 5]</span>
<span class=hs-linenum>336: </span><span class='hs-comment'>--                   , V 2 [3, 6] ])</span>
<span class=hs-linenum>337: </span>
<span class=hs-linenum>338: </span><span class='hs-comment'>{- #########################################################
## Exercise 8 - complete and refine the type of matFromList
######################################################### -}</span>
<span class=hs-linenum>341: </span>
<span class=hs-linenum>342: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>transpose</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>m</span><span class='hs-conop'>:</span><span class='hs-conid'>Matrix</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>MatrixN</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>mCol</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>mRow</span> <span class='hs-varid'>m</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>343: </span><a class=annot href="#"><span class=annottext>forall a .
x1:(NumMeasure.NumMeasure.Matrix a) -&gt; {VV : (NumMeasure.NumMeasure.Matrix a) | mCol VV == mRow x1
                                                                                &amp;&amp; mRow VV == mCol x1}</span><span class='hs-definition'>transpose</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>M</span> <span class='hs-varid'>r</span> <span class='hs-varid'>c</span> <span class='hs-varid'>rows</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : GHC.Types.Int | 0 &lt; v} -&gt; x2:{v : GHC.Types.Int | 0 &lt; v} -&gt; x3:{v : (NumMeasure.NumMeasure.Vector {v : (NumMeasure.NumMeasure.Vector a) | vDim v == x2}) | vDim v == x1} -&gt; {v : (NumMeasure.NumMeasure.Matrix a) | mCol v == x2
                                                                                                                                                                                                                                  &amp;&amp; mElts v == x3
                                                                                                                                                                                                                                  &amp;&amp; mRow v == x1} | VV == M}</span><span class='hs-conid'>M</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == c
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == r
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector {v : (NumMeasure.NumMeasure.Vector a) | vDim v == r}) | vDim v == c}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>txgo</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == c
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>c</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == r
                     &amp;&amp; 0 &lt; v}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector {v : (NumMeasure.NumMeasure.Vector a) | vDim v == c}) | v == rows
                                                                                           &amp;&amp; vDim v == r}</span><span class='hs-varid'>rows</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>344: </span>
<span class=hs-linenum>345: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>txgo</span>      <span class='hs-keyglyph'>::</span> <span class='hs-varid'>c</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>r</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span>
<span class=hs-linenum>346: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-layout'>(</span><span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>c</span><span class='hs-layout'>)</span> <span class='hs-varid'>r</span>
<span class=hs-linenum>347: </span>              <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>VectorN</span> <span class='hs-layout'>(</span><span class='hs-conid'>VectorN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-varid'>c</span>
<span class=hs-linenum>348: </span>  <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>349: </span>
<span class=hs-linenum>350: </span><a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; x2:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : (NumMeasure.NumMeasure.Vector {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == x1}) | vDim VV == x2} -&gt; {VV : (NumMeasure.NumMeasure.Vector {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == x2}) | vDim VV == x1}</span><span class='hs-definition'>txgo</span></a> <span class='hs-num'>0</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {v : (NumMeasure.NumMeasure.Vector a) | vDim v == 0} | VV == vEmp}</span><span class='hs-varid'>vEmp</span></a>
<span class=hs-linenum>351: </span><span class='hs-definition'>txgo</span> <span class='hs-varid'>c</span> <span class='hs-varid'>r</span> <span class='hs-varid'>rows</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : forall a .
      a -&gt; x2:(NumMeasure.NumMeasure.Vector a) -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == vDim x2 + 1} | VV == vCons}</span><span class='hs-varid'>vCons</span></a> <a class=annot href="#"><span class=annottext>{v' : (NumMeasure.NumMeasure.Vector a) | v' == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a)) | v == vss}</span><span class='hs-varid'>vss</span></a>
<span class=hs-linenum>352: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>353: </span>    <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector a)</span><span class='hs-varid'>v</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (NumMeasure.NumMeasure.Vector a) | vDim v &gt; 0} -&gt; a</span><span class='hs-varid'>for</span></a> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a))</span><span class='hs-varid'>rows</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      {v : (NumMeasure.NumMeasure.Vector a) | vDim v &gt; 0} -&gt; a | VV == vHd}</span><span class='hs-varid'>vHd</span></a>
<span class=hs-linenum>354: </span>    <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a))</span><span class='hs-varid'>vss</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
x1:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; x2:{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : (NumMeasure.NumMeasure.Vector {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == x1}) | vDim VV == x2} -&gt; {VV : (NumMeasure.NumMeasure.Vector {VV : (NumMeasure.NumMeasure.Vector a) | vDim VV == x2}) | vDim VV == x1}</span><span class='hs-varid'>txgo</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0}</span><span class='hs-varid'>c</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0}</span><span class='hs-varid'>r</span></a> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a))</span><span class='hs-layout'>(</span></a><span class='hs-varid'>for</span> <a class=annot href="#"><span class=annottext>(NumMeasure.NumMeasure.Vector (NumMeasure.NumMeasure.Vector a))</span><span class='hs-varid'>rows</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a .
      x1:{v : (NumMeasure.NumMeasure.Vector a) | vDim v &gt; 0} -&gt; {v : (NumMeasure.NumMeasure.Vector a) | vDim v == vDim x1 - 1} | VV == vTl}</span><span class='hs-varid'>vTl</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>355: </span>
</pre>
</body>
</html>