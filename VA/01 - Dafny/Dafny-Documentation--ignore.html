<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="Dafny-Documentation--ignore_files/main.css">
  <link rel="icon" type="image/svg+xml" href="https://dafny-lang.github.io/dafny/dafny-favicon.svg">
  <link rel="icon" type="image/png" href="https://dafny-lang.github.io/dafny/dafny-favicon.png"><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Dafny Documentation | This site contains links to Dafny documentation. The most significant is the Dafny Reference Manual.</title>
<meta name="generator" content="Jekyll v3.9.2">
<meta property="og:title" content="Dafny Documentation">
<meta property="og:locale" content="en_US">
<meta name="description" content="This site contains links to Dafny documentation. The most significant is the Dafny Reference Manual.">
<meta property="og:description" content="This site contains links to Dafny documentation. The most significant is the Dafny Reference Manual.">
<link rel="canonical" href="https://dafny-lang.github.io/dafny/DafnyRef/DafnyRef.html">
<meta property="og:url" content="https://dafny-lang.github.io/dafny/DafnyRef/DafnyRef.html">
<meta property="og:site_name" content="Dafny Documentation">
<meta property="og:type" content="website">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="Dafny Documentation">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"This site contains links to Dafny documentation. The most significant is the Dafny Reference Manual.","headline":"Dafny Documentation","url":"https://dafny-lang.github.io/dafny/DafnyRef/DafnyRef.html"}</script>
<!-- End Jekyll SEO tag -->


<script src="Dafny-Documentation--ignore_files/MathJax.js" id=""></script><script type="text/x-mathjax-config;executed=true">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ["\\(","\\)"]], displayMath: [ ["$$","$$"], ["\\[","\\]"] ]
        }});
</script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>



  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div><header class="site-header">

  <div class="wrapper"><font size="+1">
    <a class="site-title" rel="author" href="https://dafny-lang.github.io/dafny">Dafny Documentation</a>
    </font>


  </div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title"></h1>
  </header>

  <div class="post-content">
    <link rel="stylesheet" href="Dafny-Documentation--ignore_files/main.css">

<script src="Dafny-Documentation--ignore_files/MathJax.js" id=""></script>

<font size="+4"><p style="text-align: center;">Dafny Reference Manual</p></font>
<p><!-- PDFOMIT --></p>
<p style="text-align: center;">The dafny-lang community</p>
<p><!-- PDFOMIT --></p>
<p style="text-align: center;"><script> document.write(new Date(document.lastModified)); </script>Tue May 17 2022 13:10:14 GMT+0200 (hora de verano de Europa central)</p>
<p><!-- PDFOMIT --></p>

<!--PDF NEWPAGE-->

<p><strong>Abstract:</strong>
This is the Dafny reference manual; it describes the Dafny programming
language and how to use the Dafny verification system.
Parts of this manual are more tutorial in nature in order to help the
user understand how to do proofs with Dafny.</p>

<p><a href="https://dafny-lang.github.io/dafny/DafnyRef/DafnyRef">(Link to current document as html)</a></p>

<ul id="markdown-toc">
  <li><a href="#1-introduction" id="markdown-toc-1-introduction">1. Introduction</a>    <ul>
      <li><a href="#11-dafny-example" id="markdown-toc-11-dafny-example">1.1. Dafny Example</a></li>
    </ul>
  </li>
  <li><a href="#2-lexical-and-low-level-grammar" id="markdown-toc-2-lexical-and-low-level-grammar">2. Lexical and Low Level Grammar</a>    <ul>
      <li><a href="#sec-unicode" id="markdown-toc-sec-unicode">2.1. Dafny Input</a></li>
      <li><a href="#22-tokens-and-whitespace" id="markdown-toc-22-tokens-and-whitespace">2.2. Tokens and whitespace</a></li>
      <li><a href="#sec-character-classes" id="markdown-toc-sec-character-classes">2.3. Character Classes</a></li>
      <li><a href="#24-comments" id="markdown-toc-24-comments">2.4. Comments</a></li>
      <li><a href="#sec-tokens" id="markdown-toc-sec-tokens">2.5. Tokens</a>        <ul>
          <li><a href="#251-reserved-words" id="markdown-toc-251-reserved-words">2.5.1. Reserved Words</a></li>
          <li><a href="#252-identifiers" id="markdown-toc-252-identifiers">2.5.2. Identifiers</a></li>
          <li><a href="#253-digits" id="markdown-toc-253-digits">2.5.3. Digits</a></li>
          <li><a href="#254-escaped-character" id="markdown-toc-254-escaped-character">2.5.4. Escaped Character</a></li>
          <li><a href="#255-character-constant-token" id="markdown-toc-255-character-constant-token">2.5.5. Character Constant Token</a></li>
          <li><a href="#256-string-constant-token" id="markdown-toc-256-string-constant-token">2.5.6. String Constant Token</a></li>
          <li><a href="#257-ellipsis" id="markdown-toc-257-ellipsis">2.5.7. Ellipsis</a></li>
        </ul>
      </li>
      <li><a href="#sec-grammar" id="markdown-toc-sec-grammar">2.6. Low Level Grammar Productions</a>        <ul>
          <li><a href="#261-identifier-variations" id="markdown-toc-261-identifier-variations">2.6.1. Identifier Variations</a></li>
          <li><a href="#262-nousident-synonyms" id="markdown-toc-262-nousident-synonyms">2.6.2. NoUSIdent Synonyms</a></li>
          <li><a href="#263-qualified-names" id="markdown-toc-263-qualified-names">2.6.3. Qualified Names</a></li>
          <li><a href="#264-identifier-type-combinations" id="markdown-toc-264-identifier-type-combinations">2.6.4. Identifier-Type Combinations</a></li>
          <li><a href="#265-numeric-literals" id="markdown-toc-265-numeric-literals">2.6.5. Numeric Literals</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#3-programs" id="markdown-toc-3-programs">3. Programs</a>    <ul>
      <li><a href="#31-include-directives" id="markdown-toc-31-include-directives">3.1. Include Directives</a></li>
      <li><a href="#32-top-level-declarations" id="markdown-toc-32-top-level-declarations">3.2. Top Level Declarations</a></li>
      <li><a href="#33-declaration-modifiers" id="markdown-toc-33-declaration-modifiers">3.3. Declaration Modifiers</a></li>
    </ul>
  </li>
  <li><a href="#4-modules" id="markdown-toc-4-modules">4. Modules</a>    <ul>
      <li><a href="#41-declaring-new-modules" id="markdown-toc-41-declaring-new-modules">4.1. Declaring New Modules</a></li>
      <li><a href="#42-declaring-nested-modules-standalone" id="markdown-toc-42-declaring-nested-modules-standalone">4.2. Declaring nested modules standalone</a></li>
      <li><a href="#43-importing-modules" id="markdown-toc-43-importing-modules">4.3. Importing Modules</a></li>
      <li><a href="#44-opening-modules" id="markdown-toc-44-opening-modules">4.4. Opening Modules</a></li>
      <li><a href="#45-export-sets-and-access-control" id="markdown-toc-45-export-sets-and-access-control">4.5. Export Sets and Access Control</a>        <ul>
          <li><a href="#451-provided-and-revealed-names" id="markdown-toc-451-provided-and-revealed-names">4.5.1. Provided and revealed names</a></li>
          <li><a href="#452-extends-list" id="markdown-toc-452-extends-list">4.5.2. Extends list</a></li>
        </ul>
      </li>
      <li><a href="#sec-module-abstraction" id="markdown-toc-sec-module-abstraction">4.6. Module Abstraction</a></li>
      <li><a href="#47-module-ordering-and-dependencies" id="markdown-toc-47-module-ordering-and-dependencies">4.7. Module Ordering and Dependencies</a></li>
      <li><a href="#sec-name-resolution" id="markdown-toc-sec-name-resolution">4.8. Name Resolution</a>        <ul>
          <li><a href="#481-modules-and-name-spaces" id="markdown-toc-481-modules-and-name-spaces">4.8.1. Modules and name spaces</a></li>
          <li><a href="#482-module-id-context-name-resolution" id="markdown-toc-482-module-id-context-name-resolution">4.8.2. Module Id Context Name Resolution</a></li>
          <li><a href="#483-module-id-context-name-resolution" id="markdown-toc-483-module-id-context-name-resolution">4.8.3. Module Id Context Name Resolution</a></li>
          <li><a href="#484-expression-context-name-resolution" id="markdown-toc-484-expression-context-name-resolution">4.8.4. Expression Context Name Resolution</a></li>
          <li><a href="#485-type-context-name-resolution" id="markdown-toc-485-type-context-name-resolution">4.8.5. Type Context Name Resolution</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#5-specifications" id="markdown-toc-5-specifications">5. Specifications</a>    <ul>
      <li><a href="#51-specification-clauses" id="markdown-toc-51-specification-clauses">5.1. Specification Clauses</a>        <ul>
          <li><a href="#sec-requires-clause" id="markdown-toc-sec-requires-clause">5.1.1. Requires Clause</a></li>
          <li><a href="#sec-ensures-clause" id="markdown-toc-sec-ensures-clause">5.1.2. Ensures Clause</a></li>
          <li><a href="#sec-decreases-clause" id="markdown-toc-sec-decreases-clause">5.1.3. Decreases Clause</a></li>
          <li><a href="#sec-frame-expression" id="markdown-toc-sec-frame-expression">5.1.4. Framing</a></li>
          <li><a href="#sec-reads-clause" id="markdown-toc-sec-reads-clause">5.1.5. Reads Clause</a></li>
          <li><a href="#sec-modifies-clause" id="markdown-toc-sec-modifies-clause">5.1.6. Modifies Clause</a></li>
          <li><a href="#sec-invariant-clause" id="markdown-toc-sec-invariant-clause">5.1.7. Invariant Clause</a></li>
        </ul>
      </li>
      <li><a href="#sec-method-specification" id="markdown-toc-sec-method-specification">5.2. Method Specification</a></li>
      <li><a href="#sec-function-specification" id="markdown-toc-sec-function-specification">5.3. Function Specification</a></li>
      <li><a href="#sec-lambda-specification" id="markdown-toc-sec-lambda-specification">5.4. Lambda Specification</a></li>
      <li><a href="#sec-iterator-specification" id="markdown-toc-sec-iterator-specification">5.5. Iterator Specification</a></li>
      <li><a href="#56-loop-specification" id="markdown-toc-56-loop-specification">5.6. Loop Specification</a></li>
      <li><a href="#57-auto-generated-boilerplate-specifications" id="markdown-toc-57-auto-generated-boilerplate-specifications">5.7. Auto-generated boilerplate specifications</a></li>
    </ul>
  </li>
  <li><a href="#sec-types" id="markdown-toc-sec-types">6. Types</a>    <ul>
      <li><a href="#61-value-types" id="markdown-toc-61-value-types">6.1. Value Types</a></li>
      <li><a href="#sec-reference-types" id="markdown-toc-sec-reference-types">6.2. Reference Types</a></li>
      <li><a href="#63-named-types" id="markdown-toc-63-named-types">6.3. Named Types</a></li>
    </ul>
  </li>
  <li><a href="#7-basic-types" id="markdown-toc-7-basic-types">7. Basic types</a>    <ul>
      <li><a href="#sec-booleans" id="markdown-toc-sec-booleans">7.1. Booleans</a>        <ul>
          <li><a href="#sec-equivalence-operator" id="markdown-toc-sec-equivalence-operator">7.1.1. Equivalence Operator</a></li>
          <li><a href="#sec-conjunction-and-disjunction" id="markdown-toc-sec-conjunction-and-disjunction">7.1.2. Conjunction and Disjunction</a></li>
          <li><a href="#sec-implication-and-reverse-implication" id="markdown-toc-sec-implication-and-reverse-implication">7.1.3. Implication and  Reverse Implication</a></li>
        </ul>
      </li>
      <li><a href="#sec-numeric-types" id="markdown-toc-sec-numeric-types">7.2. Numeric Types</a></li>
      <li><a href="#sec-bit-vector-types" id="markdown-toc-sec-bit-vector-types">7.3. Bit-vector Types</a></li>
      <li><a href="#74-ordinal-type" id="markdown-toc-74-ordinal-type">7.4. Ordinal type</a></li>
      <li><a href="#sec-characters" id="markdown-toc-sec-characters">7.5. Characters</a></li>
    </ul>
  </li>
  <li><a href="#sec-type-parameters" id="markdown-toc-sec-type-parameters">8. Type parameters</a>    <ul>
      <li><a href="#sec-type-characteristics" id="markdown-toc-sec-type-characteristics">8.1. Declaring restrictions on type parameters</a>        <ul>
          <li><a href="#sec-equality-supporting" id="markdown-toc-sec-equality-supporting">8.1.1. Equality-supporting type parameters: <code>T(==)</code></a></li>
          <li><a href="#812-auto-initializable-types-t0" id="markdown-toc-812-auto-initializable-types-t0">8.1.2. Auto-initializable types: <code>T(0)</code></a></li>
          <li><a href="#813-nonempty-types-t00" id="markdown-toc-813-nonempty-types-t00">8.1.3. Nonempty types: <code>T(00)</code></a></li>
          <li><a href="#sec-non-heap-based" id="markdown-toc-sec-non-heap-based">8.1.4. Non-heap based: <code>T(!new)</code></a></li>
        </ul>
      </li>
      <li><a href="#82-type-parameter-variance" id="markdown-toc-82-type-parameter-variance">8.2. Type parameter variance</a></li>
    </ul>
  </li>
  <li><a href="#9-generic-instantiation" id="markdown-toc-9-generic-instantiation">9. Generic Instantiation</a></li>
  <li><a href="#sec-collection-types" id="markdown-toc-sec-collection-types">10. Collection types</a>    <ul>
      <li><a href="#sec-sets" id="markdown-toc-sec-sets">10.1. Sets</a></li>
      <li><a href="#sec-multisets" id="markdown-toc-sec-multisets">10.2. Multisets</a></li>
      <li><a href="#sec-sequences" id="markdown-toc-sec-sequences">10.3. Sequences</a>        <ul>
          <li><a href="#1031-sequence-displays" id="markdown-toc-1031-sequence-displays">10.3.1. Sequence Displays</a></li>
          <li><a href="#1032-sequence-relational-operators" id="markdown-toc-1032-sequence-relational-operators">10.3.2. Sequence Relational Operators</a></li>
          <li><a href="#1033-sequence-concatenation" id="markdown-toc-1033-sequence-concatenation">10.3.3. Sequence Concatenation</a></li>
          <li><a href="#1034-other-sequence-expressions" id="markdown-toc-1034-other-sequence-expressions">10.3.4. Other Sequence Expressions</a></li>
          <li><a href="#sec-strings" id="markdown-toc-sec-strings">10.3.5. Strings</a></li>
        </ul>
      </li>
      <li><a href="#sec-maps" id="markdown-toc-sec-maps">10.4. Finite and Infinite Maps</a></li>
      <li><a href="#105-iterating-over-collections" id="markdown-toc-105-iterating-over-collections">10.5. Iterating over collections</a>        <ul>
          <li><a href="#1051-sequences-and-arrays" id="markdown-toc-1051-sequences-and-arrays">10.5.1. Sequences and arrays</a></li>
          <li><a href="#1052-sets" id="markdown-toc-1052-sets">10.5.2. Sets</a></li>
          <li><a href="#1053-maps" id="markdown-toc-1053-maps">10.5.3. Maps</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#11-types-that-stand-for-other-types" id="markdown-toc-11-types-that-stand-for-other-types">11. Types that stand for other types</a>    <ul>
      <li><a href="#sec-synonym-type" id="markdown-toc-sec-synonym-type">11.1. Type synonyms</a></li>
      <li><a href="#sec-opaque-types" id="markdown-toc-sec-opaque-types">11.2. Opaque types</a></li>
      <li><a href="#sec-subset-types" id="markdown-toc-sec-subset-types">11.3. Subset types</a>        <ul>
          <li><a href="#1131-type-nat" id="markdown-toc-1131-type-nat">11.3.1. Type <code>nat</code></a></li>
          <li><a href="#1132-non-null-types" id="markdown-toc-1132-non-null-types">11.3.2. Non-null types</a></li>
          <li><a href="#sec-arrow-subset-types" id="markdown-toc-sec-arrow-subset-types">11.3.3. Arrow types: <code>-&gt;</code>, <code>--&gt;</code>, and <code>~&gt;</code></a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#sec-newtypes" id="markdown-toc-sec-newtypes">12. Newtypes</a>    <ul>
      <li><a href="#sec-conversion" id="markdown-toc-sec-conversion">12.1. Conversion operations</a></li>
    </ul>
  </li>
  <li><a href="#sec-class-types" id="markdown-toc-sec-class-types">13. Class Types</a>    <ul>
      <li><a href="#131-field-declarations" id="markdown-toc-131-field-declarations">13.1. Field Declarations</a></li>
      <li><a href="#132-constant-field-declarations" id="markdown-toc-132-constant-field-declarations">13.2. Constant Field Declarations</a></li>
      <li><a href="#sec-method-declarations" id="markdown-toc-sec-method-declarations">13.3. Method Declarations</a>        <ul>
          <li><a href="#1331-ordinary-methods" id="markdown-toc-1331-ordinary-methods">13.3.1. Ordinary methods</a></li>
          <li><a href="#sec-constructor-methods" id="markdown-toc-sec-constructor-methods">13.3.2. Constructors</a>            <ul>
              <li><a href="#13321-classes-with-no-explicit-constructors" id="markdown-toc-13321-classes-with-no-explicit-constructors">13.3.2.1. Classes with no explicit constructors</a></li>
              <li><a href="#13322-classes-with-one-or-more-constructors" id="markdown-toc-13322-classes-with-one-or-more-constructors">13.3.2.2. Classes with one or more constructors</a></li>
              <li><a href="#13323-two-phase-constructors" id="markdown-toc-13323-two-phase-constructors">13.3.2.3. Two-phase constructors</a></li>
            </ul>
          </li>
          <li><a href="#1333-lemmas" id="markdown-toc-1333-lemmas">13.3.3. Lemmas</a></li>
          <li><a href="#sec-two-state" id="markdown-toc-sec-two-state">13.3.4. Two-state lemmas and functions</a></li>
        </ul>
      </li>
      <li><a href="#sec-function-declarations" id="markdown-toc-sec-function-declarations">13.4. Function Declarations</a>        <ul>
          <li><a href="#1341-functions" id="markdown-toc-1341-functions">13.4.1. Functions</a></li>
          <li><a href="#1342-predicates" id="markdown-toc-1342-predicates">13.4.2. Predicates</a></li>
          <li><a href="#1343-function-transparency" id="markdown-toc-1343-function-transparency">13.4.3. Function Transparency</a></li>
          <li><a href="#1344-extreme-least-or-greatest-predicates-and-lemmas" id="markdown-toc-1344-extreme-least-or-greatest-predicates-and-lemmas">13.4.4. Extreme (Least or Greatest) Predicates and Lemmas</a></li>
          <li><a href="#1345-older-parameters-in-predicates" id="markdown-toc-1345-older-parameters-in-predicates">13.4.5. <code>older</code> parameters in predicates</a></li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#sec-trait-types" id="markdown-toc-sec-trait-types">14. Trait Types</a>    <ul>
      <li><a href="#141-type-object" id="markdown-toc-141-type-object">14.1. Type <code>object</code></a></li>
      <li><a href="#sec-inheritance" id="markdown-toc-sec-inheritance">14.2. Inheritance</a></li>
      <li><a href="#143-example-of-traits" id="markdown-toc-143-example-of-traits">14.3. Example of traits</a></li>
    </ul>
  </li>
  <li><a href="#sec-array-types" id="markdown-toc-sec-array-types">15. Array Types</a>    <ul>
      <li><a href="#151-one-dimensional-arrays" id="markdown-toc-151-one-dimensional-arrays">15.1. One-dimensional arrays</a></li>
      <li><a href="#152-multi-dimensional-arrays" id="markdown-toc-152-multi-dimensional-arrays">15.2. Multi-dimensional arrays</a></li>
      <li><a href="#sec-array-to-seq" id="markdown-toc-sec-array-to-seq">15.3. Converting arrays to sequences</a></li>
    </ul>
  </li>
  <li><a href="#sec-iterator-types" id="markdown-toc-sec-iterator-types">16. Iterator types</a></li>
  <li><a href="#sec-arrow-types" id="markdown-toc-sec-arrow-types">17. Arrow types</a>    <ul>
      <li><a href="#sec-tuple-types" id="markdown-toc-sec-tuple-types">17.1.  Tuple types</a></li>
    </ul>
  </li>
  <li><a href="#sec-algebraic-datatype" id="markdown-toc-sec-algebraic-datatype">18. Algebraic Datatypes</a>    <ul>
      <li><a href="#181-inductive-datatypes" id="markdown-toc-181-inductive-datatypes">18.1. Inductive datatypes</a></li>
      <li><a href="#182-co-inductive-datatypes" id="markdown-toc-182-co-inductive-datatypes">18.2. Co-inductive datatypes</a></li>
      <li><a href="#sec-coinduction" id="markdown-toc-sec-coinduction">18.3. Co-induction</a>        <ul>
          <li><a href="#1831-well-founded-functionmethod-definitions" id="markdown-toc-1831-well-founded-functionmethod-definitions">18.3.1. Well-Founded Function/Method Definitions</a></li>
          <li><a href="#1832-defining-co-inductive-datatypes" id="markdown-toc-1832-defining-co-inductive-datatypes">18.3.2. Defining Co-inductive Datatypes</a></li>
          <li><a href="#1833-creating-values-of-co-datatypes" id="markdown-toc-1833-creating-values-of-co-datatypes">18.3.3. Creating Values of Co-datatypes</a></li>
          <li><a href="#sec-copredicates" id="markdown-toc-sec-copredicates">18.3.4. Greatest predicates</a>            <ul>
              <li><a href="#18341-co-equality" id="markdown-toc-18341-co-equality">18.3.4.1. Co-Equality</a></li>
            </ul>
          </li>
          <li><a href="#1835-co-inductive-proofs" id="markdown-toc-1835-co-inductive-proofs">18.3.5. Co-inductive Proofs</a>            <ul>
              <li><a href="#18351-properties-about-prefix-predicates" id="markdown-toc-18351-properties-about-prefix-predicates">18.3.5.1. Properties About Prefix Predicates</a></li>
              <li><a href="#sec-colemmas" id="markdown-toc-sec-colemmas">18.3.5.2. Greatest lemmas</a></li>
              <li><a href="#sec-prefix-lemmas" id="markdown-toc-sec-prefix-lemmas">18.3.5.3. Prefix Lemmas</a></li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li><a href="#19-statements" id="markdown-toc-19-statements">19. Statements</a>    <ul>
      <li><a href="#sec-labeled-stmt" id="markdown-toc-sec-labeled-stmt">19.1. Labeled Statement</a></li>
      <li><a href="#sec-break-continue" id="markdown-toc-sec-break-continue">19.2. Break and Continue Statements</a></li>
      <li><a href="#193-block-statement" id="markdown-toc-193-block-statement">19.3. Block Statement</a></li>
      <li><a href="#sec-return-statement" id="markdown-toc-sec-return-statement">19.4. Return Statement</a></li>
      <li><a href="#sec-yield-statement" id="markdown-toc-sec-yield-statement">19.5. Yield Statement</a></li>
      <li><a href="#sec-update-and-call-statement" id="markdown-toc-sec-update-and-call-statement">19.6. Update and Call Statements</a></li>
      <li><a href="#sec-update-failure" id="markdown-toc-sec-update-failure">19.7. Update with Failure Statement (<code>:-</code>)</a>        <ul>
          <li><a href="#1971-failure-compatible-types" id="markdown-toc-1971-failure-compatible-types">19.7.1. Failure compatible types</a></li>
          <li><a href="#1972-simple-status-return-with-no-other-outputs" id="markdown-toc-1972-simple-status-return-with-no-other-outputs">19.7.2. Simple status return with no other outputs</a></li>
          <li><a href="#1973-status-return-with-additional-outputs" id="markdown-toc-1973-status-return-with-additional-outputs">19.7.3. Status return with additional outputs</a></li>
          <li><a href="#1974-failure-returns-with-additional-data" id="markdown-toc-1974-failure-returns-with-additional-data">19.7.4. Failure-returns with additional data</a></li>
          <li><a href="#1975-rhs-with-expression-list" id="markdown-toc-1975-rhs-with-expression-list">19.7.5. RHS with expression list</a></li>
          <li><a href="#1976-failure-with-initialized-declaration" id="markdown-toc-1976-failure-with-initialized-declaration">19.7.6. Failure with initialized declaration.</a></li>
          <li><a href="#sec-failure-return-keyword" id="markdown-toc-sec-failure-return-keyword">19.7.7. Keyword alternative</a></li>
          <li><a href="#1978-key-points" id="markdown-toc-1978-key-points">19.7.8. Key points</a></li>
          <li><a href="#1979-failure-returns-and-exceptions" id="markdown-toc-1979-failure-returns-and-exceptions">19.7.9. Failure returns and exceptions</a></li>
        </ul>
      </li>
      <li><a href="#sec-var-decl-statement" id="markdown-toc-sec-var-decl-statement">19.8. Variable Declaration Statement</a></li>
      <li><a href="#199-guards" id="markdown-toc-199-guards">19.9. Guards</a></li>
      <li><a href="#1910-binding-guards" id="markdown-toc-1910-binding-guards">19.10. Binding Guards</a></li>
      <li><a href="#sec-if-statement" id="markdown-toc-sec-if-statement">19.11. If Statement</a></li>
      <li><a href="#1912-while-statement" id="markdown-toc-1912-while-statement">19.12. While Statement</a></li>
      <li><a href="#1913-for-loops" id="markdown-toc-1913-for-loops">19.13. For Loops</a></li>
      <li><a href="#sec-loop-specification" id="markdown-toc-sec-loop-specification">19.14. Loop Specifications</a>        <ul>
          <li><a href="#19141-loop-invariants" id="markdown-toc-19141-loop-invariants">19.14.1. Loop invariants</a></li>
          <li><a href="#sec-loop-termination" id="markdown-toc-sec-loop-termination">19.14.2. Loop termination</a></li>
          <li><a href="#sec-loop-framing" id="markdown-toc-sec-loop-framing">19.14.3. Loop framing</a></li>
          <li><a href="#19144-body-less-methods-functions-loops-and-aggregate-statements" id="markdown-toc-19144-body-less-methods-functions-loops-and-aggregate-statements">19.14.4. Body-less methods, functions, loops, and aggregate statements</a></li>
        </ul>
      </li>
      <li><a href="#sec-match-statement" id="markdown-toc-sec-match-statement">19.15. Match Statement</a></li>
      <li><a href="#sec-assert-statement" id="markdown-toc-sec-assert-statement">19.16. Assert Statement</a></li>
      <li><a href="#sec-assume-statement" id="markdown-toc-sec-assume-statement">19.17. Assume Statement</a></li>
      <li><a href="#sec-expect-statement" id="markdown-toc-sec-expect-statement">19.18. Expect Statement</a></li>
      <li><a href="#1919-print-statement" id="markdown-toc-1919-print-statement">19.19. Print Statement</a></li>
      <li><a href="#sec-reveal-statement" id="markdown-toc-sec-reveal-statement">19.20. Reveal Statement</a></li>
      <li><a href="#sec-forall-statement" id="markdown-toc-sec-forall-statement">19.21. Forall Statement</a></li>
      <li><a href="#sec-modify-statement" id="markdown-toc-sec-modify-statement">19.22. Modify Statement</a></li>
      <li><a href="#sec-calc-statement" id="markdown-toc-sec-calc-statement">19.23. Calc Statement</a></li>
      <li><a href="#1924-skeleton-statement" id="markdown-toc-1924-skeleton-statement">19.24. Skeleton Statement</a></li>
    </ul>
  </li>
  <li><a href="#sec-expressions" id="markdown-toc-sec-expressions">20. Expressions</a>    <ul>
      <li><a href="#sec-top-level-expression" id="markdown-toc-sec-top-level-expression">20.1. Top-level expressions</a></li>
      <li><a href="#sec-equivalence" id="markdown-toc-sec-equivalence">20.2. Equivalence Expressions</a></li>
      <li><a href="#sec-implication" id="markdown-toc-sec-implication">20.3. Implies or Explies Expressions</a></li>
      <li><a href="#204-logical-expressions" id="markdown-toc-204-logical-expressions">20.4. Logical Expressions</a></li>
      <li><a href="#205-relational-expressions" id="markdown-toc-205-relational-expressions">20.5. Relational Expressions</a></li>
      <li><a href="#206-bit-shifts" id="markdown-toc-206-bit-shifts">20.6. Bit Shifts</a></li>
      <li><a href="#207-terms" id="markdown-toc-207-terms">20.7. Terms</a></li>
      <li><a href="#208-factors" id="markdown-toc-208-factors">20.8. Factors</a></li>
      <li><a href="#209-bit-vector-operations" id="markdown-toc-209-bit-vector-operations">20.9. Bit-vector Operations</a></li>
      <li><a href="#sec-as-expression" id="markdown-toc-sec-as-expression">20.10. As (Conversion) and Is (type test) Expressions</a></li>
      <li><a href="#2011-unary-expressions" id="markdown-toc-2011-unary-expressions">20.11. Unary Expressions</a></li>
      <li><a href="#2012-primary-expressions" id="markdown-toc-2012-primary-expressions">20.12. Primary Expressions</a></li>
      <li><a href="#sec-lambda-expressions" id="markdown-toc-sec-lambda-expressions">20.13. Lambda expressions</a></li>
      <li><a href="#2014-left-hand-side-expressions" id="markdown-toc-2014-left-hand-side-expressions">20.14. Left-Hand-Side Expressions</a></li>
      <li><a href="#2015-right-hand-side-expressions" id="markdown-toc-2015-right-hand-side-expressions">20.15. Right-Hand-Side Expressions</a></li>
      <li><a href="#2016-array-allocation" id="markdown-toc-2016-array-allocation">20.16. Array Allocation</a></li>
      <li><a href="#2017-object-allocation" id="markdown-toc-2017-object-allocation">20.17. Object Allocation</a></li>
      <li><a href="#2018-havoc-right-hand-side" id="markdown-toc-2018-havoc-right-hand-side">20.18. Havoc Right-Hand-Side</a></li>
      <li><a href="#2019-constant-or-atomic-expressions" id="markdown-toc-2019-constant-or-atomic-expressions">20.19. Constant Or Atomic Expressions</a></li>
      <li><a href="#2020-literal-expressions" id="markdown-toc-2020-literal-expressions">20.20. Literal Expressions</a></li>
      <li><a href="#sec-fresh-expression" id="markdown-toc-sec-fresh-expression">20.21. Fresh Expressions</a></li>
      <li><a href="#sec-allocated-expression" id="markdown-toc-sec-allocated-expression">20.22. Allocated Expressions</a></li>
      <li><a href="#sec-unchanged-expression" id="markdown-toc-sec-unchanged-expression">20.23. Unchanged Expressions</a></li>
      <li><a href="#sec-old-expression" id="markdown-toc-sec-old-expression">20.24. Old and Old@ Expressions</a></li>
      <li><a href="#sec-cardinality-expression" id="markdown-toc-sec-cardinality-expression">20.25. Cardinality Expressions</a></li>
      <li><a href="#2026-parenthesized-expression" id="markdown-toc-2026-parenthesized-expression">20.26. Parenthesized Expression</a></li>
      <li><a href="#sec-seq-comprehension" id="markdown-toc-sec-seq-comprehension">20.27. Sequence Display Expression</a></li>
      <li><a href="#2028-set-display-expression" id="markdown-toc-2028-set-display-expression">20.28. Set Display Expression</a></li>
      <li><a href="#sec-map-display-expression" id="markdown-toc-sec-map-display-expression">20.29. Map Display Expression</a></li>
      <li><a href="#2030-endless-expression" id="markdown-toc-2030-endless-expression">20.30. Endless Expression</a></li>
      <li><a href="#2031-if-expression" id="markdown-toc-2031-if-expression">20.31. If Expression</a></li>
      <li><a href="#sec-case-pattern" id="markdown-toc-sec-case-pattern">20.32. Case and Extended Patterns</a></li>
      <li><a href="#sec-match-expression" id="markdown-toc-sec-match-expression">20.33. Match Expression</a></li>
      <li><a href="#sec-quantifier-expression" id="markdown-toc-sec-quantifier-expression">20.34. Quantifier Expression</a></li>
      <li><a href="#sec-set-comprehension-expression" id="markdown-toc-sec-set-comprehension-expression">20.35. Set Comprehension Expressions</a></li>
      <li><a href="#sec-statement-in-an-expression" id="markdown-toc-sec-statement-in-an-expression">20.36. Statements in an Expression</a></li>
      <li><a href="#sec-let-expression" id="markdown-toc-sec-let-expression">20.37. Let Expression</a></li>
      <li><a href="#2038-let-or-fail-expression" id="markdown-toc-2038-let-or-fail-expression">20.38. Let or Fail Expression</a></li>
      <li><a href="#sec-map-comprehension-expression" id="markdown-toc-sec-map-comprehension-expression">20.39. Map Comprehension Expression</a></li>
      <li><a href="#sec-name-segment" id="markdown-toc-sec-name-segment">20.40. Name Segment</a></li>
      <li><a href="#sec-hash-call" id="markdown-toc-sec-hash-call">20.41. Hash Call</a></li>
      <li><a href="#2042-suffix" id="markdown-toc-2042-suffix">20.42. Suffix</a>        <ul>
          <li><a href="#20421-augmented-dot-suffix" id="markdown-toc-20421-augmented-dot-suffix">20.42.1. Augmented Dot Suffix</a></li>
          <li><a href="#sec-datatype-update-suffix" id="markdown-toc-sec-datatype-update-suffix">20.42.2. Datatype Update Suffix</a></li>
          <li><a href="#20423-subsequence-suffix" id="markdown-toc-20423-subsequence-suffix">20.42.3. Subsequence Suffix</a></li>
          <li><a href="#20424-slices-by-length-suffix" id="markdown-toc-20424-slices-by-length-suffix">20.42.4. Slices By Length Suffix</a></li>
          <li><a href="#20425-sequence-update-suffix" id="markdown-toc-20425-sequence-update-suffix">20.42.5. Sequence Update Suffix</a></li>
          <li><a href="#20426-selection-suffix" id="markdown-toc-20426-selection-suffix">20.42.6. Selection Suffix</a></li>
          <li><a href="#20427-argument-list-suffix" id="markdown-toc-20427-argument-list-suffix">20.42.7. Argument List Suffix</a></li>
        </ul>
      </li>
      <li><a href="#2043-expression-lists" id="markdown-toc-2043-expression-lists">20.43. Expression Lists</a></li>
      <li><a href="#2044-parameter-bindings" id="markdown-toc-2044-parameter-bindings">20.44. Parameter Bindings</a></li>
      <li><a href="#2045-formal-parameters-and-default-value-expressions" id="markdown-toc-2045-formal-parameters-and-default-value-expressions">20.45. Formal Parameters and Default-Value Expressions</a></li>
      <li><a href="#sec-compile-time-constants" id="markdown-toc-sec-compile-time-constants">20.46. Compile-Time Constants</a></li>
      <li><a href="#sec-list-of-specification-expressions" id="markdown-toc-sec-list-of-specification-expressions">20.47. List of specification expressions</a></li>
    </ul>
  </li>
  <li><a href="#sec-module-refinement" id="markdown-toc-sec-module-refinement">21. Refinement</a>    <ul>
      <li><a href="#211-export-set-declarations" id="markdown-toc-211-export-set-declarations">21.1. Export set declarations</a></li>
      <li><a href="#212-import-declarations" id="markdown-toc-212-import-declarations">21.2. Import declarations</a></li>
      <li><a href="#213-sub-module-declarations" id="markdown-toc-213-sub-module-declarations">21.3. Sub-module declarations</a></li>
      <li><a href="#214-const-declarations" id="markdown-toc-214-const-declarations">21.4. Const declarations</a></li>
      <li><a href="#215-method-declarations" id="markdown-toc-215-method-declarations">21.5. Method declarations</a></li>
      <li><a href="#216-lemma-declarations" id="markdown-toc-216-lemma-declarations">21.6. Lemma declarations</a></li>
      <li><a href="#217-function-and-predicate-declarations" id="markdown-toc-217-function-and-predicate-declarations">21.7. Function and predicate declarations</a></li>
      <li><a href="#218-iterator-declarations" id="markdown-toc-218-iterator-declarations">21.8. Iterator declarations</a></li>
      <li><a href="#219-class-and-trait-declarations" id="markdown-toc-219-class-and-trait-declarations">21.9. Class and trait declarations</a></li>
      <li><a href="#2110-type-declarations" id="markdown-toc-2110-type-declarations">21.10. Type declarations</a></li>
    </ul>
  </li>
  <li><a href="#sec-attributes" id="markdown-toc-sec-attributes">22. Attributes</a>    <ul>
      <li><a href="#221-attributes-on-top-level-declarations" id="markdown-toc-221-attributes-on-top-level-declarations">22.1. Attributes on top-level declarations</a>        <ul>
          <li><a href="#2211-autocontracts" id="markdown-toc-2211-autocontracts">22.1.1. <code>{:autocontracts}</code></a></li>
          <li><a href="#sec-nativetype" id="markdown-toc-sec-nativetype">22.1.2. <code>{:nativeType}</code></a></li>
          <li><a href="#2213-ignore-deprecated" id="markdown-toc-2213-ignore-deprecated">22.1.3. <code>{:ignore}</code> (deprecated)</a></li>
          <li><a href="#sec-extern" id="markdown-toc-sec-extern">22.1.4. <code>{:extern}</code></a></li>
        </ul>
      </li>
      <li><a href="#222-attributes-on-functions-and-methods" id="markdown-toc-222-attributes-on-functions-and-methods">22.2. Attributes on functions and methods</a>        <ul>
          <li><a href="#2221-autoreq" id="markdown-toc-2221-autoreq">22.2.1. <code>{:autoReq}</code></a></li>
          <li><a href="#sec-axiom" id="markdown-toc-sec-axiom">22.2.2. <code>{:axiom}</code></a></li>
          <li><a href="#2223-compile" id="markdown-toc-2223-compile">22.2.3. <code>{:compile}</code></a></li>
          <li><a href="#sec-extern-method" id="markdown-toc-sec-extern-method">22.2.4. <code>{:extern &lt;name&gt;}</code></a></li>
          <li><a href="#sec-fuel" id="markdown-toc-sec-fuel">22.2.5. <code>{:fuel X}</code></a></li>
          <li><a href="#2226-id-string" id="markdown-toc-2226-id-string">22.2.6. <code>{:id &lt;string&gt;}</code></a></li>
          <li><a href="#sec-induction" id="markdown-toc-sec-induction">22.2.7. <code>{:induction}</code></a></li>
          <li><a href="#sec-print" id="markdown-toc-sec-print">22.2.8. <code>{:print}</code></a></li>
          <li><a href="#sec-opaque" id="markdown-toc-sec-opaque">22.2.9. <code>{:opaque}</code></a></li>
          <li><a href="#22210-priority-n" id="markdown-toc-22210-priority-n">22.2.10. <code>{:priority N}</code></a></li>
          <li><a href="#22211-selective_checking" id="markdown-toc-22211-selective_checking">22.2.11. <code>{:selective_checking}</code></a></li>
          <li><a href="#22212-tailrecursion" id="markdown-toc-22212-tailrecursion">22.2.12. <code>{:tailrecursion}</code></a></li>
          <li><a href="#22213-test" id="markdown-toc-22213-test">22.2.13. <code>{:test}</code></a></li>
          <li><a href="#22214-timelimit-n" id="markdown-toc-22214-timelimit-n">22.2.14. <code>{:timeLimit N}</code></a></li>
          <li><a href="#22215-timelimitmultiplier-x" id="markdown-toc-22215-timelimitmultiplier-x">22.2.15. <code>{:timeLimitMultiplier X}</code></a></li>
          <li><a href="#sec-verify" id="markdown-toc-sec-verify">22.2.16. <code>{:verify false}</code></a></li>
          <li><a href="#sec-vcs_max_cost" id="markdown-toc-sec-vcs_max_cost">22.2.17. <code>{:vcs_max_cost N}</code></a></li>
          <li><a href="#sec-vcs_max_keep_going_splits" id="markdown-toc-sec-vcs_max_keep_going_splits">22.2.18. <code>{:vcs_max_keep_going_splits N}</code></a></li>
          <li><a href="#sec-vcs_max_splits" id="markdown-toc-sec-vcs_max_splits">22.2.19. <code>{:vcs_max_splits N}</code></a></li>
          <li><a href="#sec-vcs_split_on_every_assert" id="markdown-toc-sec-vcs_split_on_every_assert">22.2.20. <code>{:vcs_split_on_every_assert}</code></a></li>
          <li><a href="#sec-synthesize-attr" id="markdown-toc-sec-synthesize-attr">22.2.21. <code>{:synthesize}</code></a></li>
          <li><a href="#sec-attr-options" id="markdown-toc-sec-attr-options">22.2.22. <code>{:options OPT0, OPT1, ... }</code></a></li>
        </ul>
      </li>
      <li><a href="#sec-verification-attributes-on-assert-statements" id="markdown-toc-sec-verification-attributes-on-assert-statements">22.3. Attributes on assertions, preconditions and postconditions</a>        <ul>
          <li><a href="#sec-focus" id="markdown-toc-sec-focus">22.3.1. <code>{:focus}</code></a></li>
          <li><a href="#sec-split_here" id="markdown-toc-sec-split_here">22.3.2. <code>{:split_here}</code></a></li>
          <li><a href="#2233-subsumption-n" id="markdown-toc-2233-subsumption-n">22.3.3. <code>{:subsumption n}</code></a></li>
        </ul>
      </li>
      <li><a href="#224-attributes-on-variable-declarations" id="markdown-toc-224-attributes-on-variable-declarations">22.4. Attributes on variable declarations</a>        <ul>
          <li><a href="#2241-assumption" id="markdown-toc-2241-assumption">22.4.1. <code>{:assumption}</code></a></li>
        </ul>
      </li>
      <li><a href="#225-attributes-on-quantifier-expressions-forall-exists" id="markdown-toc-225-attributes-on-quantifier-expressions-forall-exists">22.5. Attributes on quantifier expressions (forall, exists)</a>        <ul>
          <li><a href="#2251-heapquantifier" id="markdown-toc-2251-heapquantifier">22.5.1. <code>{:heapQuantifier}</code></a></li>
          <li><a href="#sec-induction-quantifier" id="markdown-toc-sec-induction-quantifier">22.5.2. <code>{:induction}</code></a></li>
          <li><a href="#2253-layerquantifier" id="markdown-toc-2253-layerquantifier">22.5.3. <code>{:layerQuantifier}</code></a></li>
          <li><a href="#sec-trigger" id="markdown-toc-sec-trigger">22.5.4. <code>{:trigger}</code></a></li>
        </ul>
      </li>
      <li><a href="#226-other-undocumented-verification-attributes" id="markdown-toc-226-other-undocumented-verification-attributes">22.6. Other undocumented verification attributes</a></li>
    </ul>
  </li>
  <li><a href="#sec-advanced-topics" id="markdown-toc-sec-advanced-topics">23. Advanced Topics</a>    <ul>
      <li><a href="#sec-type-parameter-completion" id="markdown-toc-sec-type-parameter-completion">23.1. Type Parameter Completion</a></li>
      <li><a href="#sec-type-inference" id="markdown-toc-sec-type-inference">23.2. Type Inference</a></li>
      <li><a href="#233-ghost-inference" id="markdown-toc-233-ghost-inference">23.3. Ghost Inference</a></li>
      <li><a href="#234-well-founded-functions-and-extreme-predicates" id="markdown-toc-234-well-founded-functions-and-extreme-predicates">23.4. Well-founded Functions and Extreme Predicates</a>        <ul>
          <li><a href="#2341-function-definitions" id="markdown-toc-2341-function-definitions">23.4.1. Function Definitions</a>            <ul>
              <li><a href="#23411-well-founded-functions" id="markdown-toc-23411-well-founded-functions">23.4.1.1. Well-founded Functions</a></li>
              <li><a href="#sec-fib-example" id="markdown-toc-sec-fib-example">23.4.1.2. Example with Well-founded Functions</a></li>
              <li><a href="#23413-extreme-solutions" id="markdown-toc-23413-extreme-solutions">23.4.1.3. Extreme Solutions</a></li>
            </ul>
          </li>
          <li><a href="#2342-working-with-extreme-predicates" id="markdown-toc-2342-working-with-extreme-predicates">23.4.2. Working with Extreme Predicates</a>            <ul>
              <li><a href="#sec-example-least-solution" id="markdown-toc-sec-example-least-solution">23.4.2.1. Example with Least Solution</a></li>
              <li><a href="#sec-example-greatest-solution" id="markdown-toc-sec-example-greatest-solution">23.4.2.2. Example with Greatest Solution</a></li>
            </ul>
          </li>
          <li><a href="#2343-other-techniques" id="markdown-toc-2343-other-techniques">23.4.3. Other Techniques</a></li>
        </ul>
      </li>
      <li><a href="#235-functions-in-dafny" id="markdown-toc-235-functions-in-dafny">23.5. Functions in Dafny</a>        <ul>
          <li><a href="#2351-well-founded-functions-in-dafny" id="markdown-toc-2351-well-founded-functions-in-dafny">23.5.1. Well-founded Functions in Dafny</a></li>
          <li><a href="#sec-proofs-in-dafny" id="markdown-toc-sec-proofs-in-dafny">23.5.2. Proofs in Dafny</a></li>
          <li><a href="#sec-friendliness" id="markdown-toc-sec-friendliness">23.5.3. Extreme Predicates in Dafny</a></li>
          <li><a href="#2354-proofs-about-extreme-predicates" id="markdown-toc-2354-proofs-about-extreme-predicates">23.5.4. Proofs about Extreme Predicates</a></li>
          <li><a href="#sec-nicer-proofs-of-extremes" id="markdown-toc-sec-nicer-proofs-of-extremes">23.5.5. Nicer Proofs of Extreme Predicates</a></li>
        </ul>
      </li>
      <li><a href="#sec-definite-assignment" id="markdown-toc-sec-definite-assignment">23.6. Variable Initialization and Definite Assignment</a></li>
      <li><a href="#sec-well-founded-orders" id="markdown-toc-sec-well-founded-orders">23.7. Well-founded Orders</a></li>
    </ul>
  </li>
  <li><a href="#sec-user-guide" id="markdown-toc-sec-user-guide">24. Dafny Users Guide</a>    <ul>
      <li><a href="#241-introduction" id="markdown-toc-241-introduction">24.1. Introduction</a></li>
      <li><a href="#242-dafny-programs-and-files" id="markdown-toc-242-dafny-programs-and-files">24.2. Dafny Programs and Files</a></li>
      <li><a href="#243-installing-dafny" id="markdown-toc-243-installing-dafny">24.3. Installing Dafny</a></li>
      <li><a href="#244-dafny-code-style" id="markdown-toc-244-dafny-code-style">24.4. Dafny Code Style</a></li>
      <li><a href="#245-ides-for-dafny" id="markdown-toc-245-ides-for-dafny">24.5. IDEs for Dafny</a></li>
      <li><a href="#246-the-dafny-server" id="markdown-toc-246-the-dafny-server">24.6. The Dafny Server</a></li>
      <li><a href="#247-using-dafny-from-the-command-line" id="markdown-toc-247-using-dafny-from-the-command-line">24.7. Using Dafny From the Command Line</a></li>
      <li><a href="#248-verification" id="markdown-toc-248-verification">24.8. Verification</a>        <ul>
          <li><a href="#sec-verification-debugging" id="markdown-toc-sec-verification-debugging">24.8.1. Verification debugging when verification fails</a>            <ul>
              <li><a href="#sec-failing-postconditions" id="markdown-toc-sec-failing-postconditions">24.8.1.1. Failing postconditions</a></li>
              <li><a href="#sec-failing-asserts" id="markdown-toc-sec-failing-asserts">24.8.1.2. Failing asserts</a></li>
              <li><a href="#sec-failing-asserts-special-cases" id="markdown-toc-sec-failing-asserts-special-cases">24.8.1.3. Failing asserts cases</a></li>
            </ul>
          </li>
          <li><a href="#sec-verification-debugging-slow" id="markdown-toc-sec-verification-debugging-slow">24.8.2. Verification debugging when verification is slow</a>            <ul>
              <li><a href="#sec-assume-false" id="markdown-toc-sec-assume-false">24.8.2.1. <code>assume false;</code></a></li>
              <li><a href="#sec-verification-debugging-assert-by" id="markdown-toc-sec-verification-debugging-assert-by">24.8.2.2. <code>assert ... by {}</code></a></li>
              <li><a href="#sec-labeling-revealing-assertions" id="markdown-toc-sec-labeling-revealing-assertions">24.8.2.3. Labeling and revealing assertions</a></li>
              <li><a href="#sec-non-opaque-function-method" id="markdown-toc-sec-non-opaque-function-method">24.8.2.4. Non-opaque <code>function method</code></a></li>
              <li><a href="#sec-conversion-to-and-from-bitvectors" id="markdown-toc-sec-conversion-to-and-from-bitvectors">24.8.2.5. Conversion to and from bitvectors</a></li>
              <li><a href="#sec-nested-loops" id="markdown-toc-sec-nested-loops">24.8.2.6. Nested loops</a></li>
            </ul>
          </li>
          <li><a href="#sec-assertion-batches" id="markdown-toc-sec-assertion-batches">24.8.3. Assertion batches</a>            <ul>
              <li><a href="#sec-assertion-batches-control" id="markdown-toc-sec-assertion-batches-control">24.8.3.1. Controlling assertion batches</a></li>
            </ul>
          </li>
          <li><a href="#sec-command-line-options-and-attributes-for-verification" id="markdown-toc-sec-command-line-options-and-attributes-for-verification">24.8.4. Command-line options and other attributes to control verification</a></li>
        </ul>
      </li>
      <li><a href="#sec-compilation" id="markdown-toc-sec-compilation">24.9. Compilation</a>        <ul>
          <li><a href="#sec-user-guide-main" id="markdown-toc-sec-user-guide-main">24.9.1. Main method</a></li>
          <li><a href="#2492-extern-declarations" id="markdown-toc-2492-extern-declarations">24.9.2. extern declarations</a></li>
          <li><a href="#2493-c" id="markdown-toc-2493-c">24.9.3. C#</a></li>
          <li><a href="#2494-java" id="markdown-toc-2494-java">24.9.4. Java</a></li>
          <li><a href="#2495-javascript" id="markdown-toc-2495-javascript">24.9.5. Javascript</a></li>
          <li><a href="#2496-go" id="markdown-toc-2496-go">24.9.6. Go</a></li>
          <li><a href="#2497-c" id="markdown-toc-2497-c">24.9.7. C++</a></li>
        </ul>
      </li>
      <li><a href="#sec-command-line-options" id="markdown-toc-sec-command-line-options">24.10. Dafny Command Line Options</a>        <ul>
          <li><a href="#sec-controlling-help" id="markdown-toc-sec-controlling-help">24.10.1. Help and version information</a></li>
          <li><a href="#sec-controlling-input" id="markdown-toc-sec-controlling-input">24.10.2. Controlling input</a></li>
          <li><a href="#sec-controlling-plugins" id="markdown-toc-sec-controlling-plugins">24.10.3. Controlling plugins</a></li>
          <li><a href="#sec-controlling-output" id="markdown-toc-sec-controlling-output">24.10.4. Controlling output</a></li>
          <li><a href="#sec-controlling-language" id="markdown-toc-sec-controlling-language">24.10.5. Controlling language features</a></li>
          <li><a href="#sec-controlling-warnings" id="markdown-toc-sec-controlling-warnings">24.10.6. Controlling warnings</a></li>
          <li><a href="#sec-controlling-verification" id="markdown-toc-sec-controlling-verification">24.10.7. Controlling verification</a></li>
          <li><a href="#sec-controlling-boogie" id="markdown-toc-sec-controlling-boogie">24.10.8. Controlling boogie</a></li>
          <li><a href="#sec-controlling-prover" id="markdown-toc-sec-controlling-prover">24.10.9. Controlling the prover</a></li>
          <li><a href="#sec-controlling-test-gen" id="markdown-toc-sec-controlling-test-gen">24.10.10. Controlling test generation</a></li>
          <li><a href="#sec-controlling-compilation" id="markdown-toc-sec-controlling-compilation">24.10.11. Controlling compilation</a></li>
        </ul>
      </li>
      <li><a href="#2411-full-list-of--command-line-options-" id="markdown-toc-2411-full-list-of--command-line-options-">24.11. Full list of -command-line options <!-- PDFOMIT --></a></li>
    </ul>
  </li>
  <li><a href="#26-references" id="markdown-toc-26-references">26. References</a></li>
</ul>

<h2 id="1-introduction">1. Introduction</h2>

<p>Dafny [@Leino:Dafny:LPAR16] is a programming language with built-in specification constructs,
so that verifying a programs correctness with respect to those specifications
is a natural part of writing software.
The Dafny static program verifier can be used to verify the functional
correctness of programs.
This document is a reference manual for the programming language and a user guide
for the dafny tool that performs verification and compilation to an
executable form.</p>

<p>The Dafny programming language is designed to support the static
verification of programs. It is imperative, sequential, supports generic
classes, inheritance and abstraction, methods and functions, dynamic allocation, inductive and
co-inductive datatypes, and specification constructs. The
specifications include pre- and postconditions, frame specifications
(read and write sets), and termination metrics. To further support
specifications, the language also offers updatable ghost variables,
recursive functions, and types like sets and sequences. Specifications
and ghost constructs are used only during verification; the compiler
omits them from the executable code.</p>

<p>The <code>dafny</code> verifier is run as part of the compiler. As such, a programmer
interacts with it in much the same way as with the static type
checkerwhen the tool produces errors, the programmer responds by
changing the programs type declarations, specifications, and statements.</p>

<p>(This document typically uses Dafny to refer to the programming language
and dafny to refer to the software tool that verifies and compiles programs
in the Dafny language.)</p>

<p>The easiest way to try out Dafny is to <a href="https://github.com/dafny-lang/dafny/releases">download</a> it
to run it on your machine as you follow along with the <a href="https://dafny-lang.github.io/dafny/OnlineTutorial/guide">Dafny tutorial</a>.
Dafny can be run from the command line (on Linux, MacOS, Windows or other platforms) or from an IDE
such as emacs or an editor such as VSCode, which can provide syntax highlighting without
the built-in verification.</p>

<p>The verifier is powered
by <a href="http://research.microsoft.com/boogie">Boogie</a>
[@Boogie:Architecture;@Leino:Boogie2-RefMan;@LeinoRuemmer:Boogie2]
and <a href="https://github.com/z3prover">Z3</a> [@deMouraBjorner:Z3:overview].</p>

<p>From verified programs, the <code>dafny</code> compiler can produce code for a number
of different backends:
the .NET platform via intermediate C# files, Java, Javascript, Go, and C++.
Each language provides a basic Foreign Function Interface (through uses of <code>:extern</code>)
and a supporting runtime library.
However, there is no automatic FFI generator, so <code>:extern</code> stubs must be written by hand.</p>

<p>This reference manual for the Dafny verification system is
based on the following references:
[@Leino:Dafny:LPAR16],
[@MSR:dafny:main],
[@LEINO:Dafny:Calc],
[@LEINO:Dafny:Coinduction],
<a href="http://research.microsoft.com/en-us/um/people/leino/papers/krml230.pdf">Co-induction Simply</a>.</p>

<p>The main part of the reference manual is in top down order except for an
initial section that deals with the lowest level constructs.</p>

<p>The details of using (and contributing to) the dafny tool are described in the User Guide (<a href="#sec-user-guide">Section 24</a>).</p>

<h3 id="11-dafny-example">1.1. Dafny Example</h3>
<p>To give a flavor of Dafny, here is the solution to a competition problem.</p>

<pre><code class="language-dafny">// VSComp 2010, problem 3, find a 0 in a linked list and return
// how many nodes were skipped until the first 0 (or end-of-list)
// was found.
// Rustan Leino, 18 August 2010.
//
// The difficulty in this problem lies in specifying what the
// return value 'r' denotes and in proving that the program
// terminates.  Both of these are addressed by declaring a ghost
// field 'List' in each linked-list node, abstractly representing
// the linked-list elements from the node to the end of the linked
// list.  The specification can now talk about that sequence of
// elements and can use 'r' as an index into the sequence, and
// termination can be proved from the fact that all sequences in
// Dafny are finite.
//
// We only want to deal with linked lists whose 'List' field is
// properly filled in (which can only happen in an acyclic list,
// for example).  To that end, the standard idiom in Dafny is to
// declare a predicate 'Valid()' that is true of an object when
// the data structure representing that object's abstract value
// is properly formed.  The definition of 'Valid()' is what one
// intuitively would think of as the ''object invariant'', and
// it is mentioned explicitly in method pre- and postconditions.
//
// As part of this standard idiom, one also declares a ghost
// variable 'Repr' that is maintained as the set of objects that
// make up the representation of the aggregate object--in this
// case, the Node itself and all its successors.

class Node {
  ghost var List: seq&lt;int&gt;
  ghost var Repr: set&lt;Node&gt;
  var head: int
  var next: Node? // Node? means a Node value or null

  predicate Valid()
    reads this, Repr
  {
    this in Repr &amp;&amp;
    1 &lt;= |List| &amp;&amp; List[0] == head &amp;&amp;
    (next == null ==&gt; |List| == 1) &amp;&amp;
    (next != null ==&gt;
      next in Repr &amp;&amp; next.Repr &lt;= Repr &amp;&amp; this !in next.Repr &amp;&amp;
      next.Valid() &amp;&amp; next.List == List[1..])
  }

  static method Cons(x: int, tail: Node?) returns (n: Node)
    requires tail == null || tail.Valid()
    ensures n.Valid()
    ensures if tail == null then n.List == [x]
                            else n.List == [x] + tail.List
  {
    n := new Node;
    n.head, n.next := x, tail;
    if (tail == null) {
      n.List := [x];
      n.Repr := {n};
    } else {
      n.List := [x] + tail.List;
      n.Repr := {n} + tail.Repr;
    }
  }
}

method Search(ll: Node?) returns (r: int)
  requires ll == null || ll.Valid()
  ensures ll == null ==&gt; r == 0
  ensures ll != null ==&gt;
            0 &lt;= r &amp;&amp; r &lt;= |ll.List| &amp;&amp;
            (r &lt; |ll.List| ==&gt; ll.List[r] == 0 &amp;&amp;
            0 !in ll.List[..r]) &amp;&amp;
            (r == |ll.List| ==&gt; 0 !in ll.List)
{
  if (ll == null) {
    r := 0;
  } else {
    var jj,i := ll,0;
    while (jj != null &amp;&amp; jj.head != 0)
      invariant jj != null ==&gt; jj.Valid() &amp;&amp;
            i + |jj.List| == |ll.List| &amp;&amp;
            ll.List[i..] == jj.List
      invariant jj == null ==&gt; i == |ll.List|
      invariant 0 !in ll.List[..i]
      decreases |ll.List| - i
    {
      jj := jj.next;
      i := i + 1;
    }
    r := i;
  }
}

method Main()
{
  var list: Node? := null;
  list := list.Cons(0, list);
  list := list.Cons(5, list);
  list := list.Cons(0, list);
  list := list.Cons(8, list);
  var r := Search(list);
  print "Search returns ", r, "\n";
  assert r == 1;
}


</code></pre>

<!--PDF NEWPAGE-->
<h2 id="2-lexical-and-low-level-grammar">2. Lexical and Low Level Grammar</h2>
<p>Dafny uses the Coco/R lexer and parser generator for its lexer and parser
(<a href="http://www.ssw.uni-linz.ac.at/Research/Projects/Coco">http://www.ssw.uni-linz.ac.at/Research/Projects/Coco</a>)[@Linz:Coco].
The Dafny input file to Coco/R is the <code>Dafny.atg</code> file in the source tree.
A Coco/R input file consists of code written in the target language
(C# for the <code>dafny</code> tool) intermixed with these special sections:</p>

<ol>
  <li>The <a href="#sec-character-classes">Characters section</a>
 which defines classes of characters that are used
in defining the lexer.</li>
  <li>The <a href="#sec-tokens">Tokens section</a> which defines the lexical tokens.</li>
  <li>The <a href="#sec-grammar">Productions section</a>
 which defines the grammar. The grammar productions
are distributed in the later parts of this document in the places where
those constructs are explained.</li>
</ol>

<p>The grammar presented in this document was derived from the <code>Dafny.atg</code>
file but has been simplified by removing details that, though needed by
the parser, are not needed to understand the grammar. In particular, the
following transformations have been performed.</p>

<ul>
  <li>The semantics actions, enclosed by (. and .), were removed.</li>
  <li>There are some elements in the grammar used for error recovery
(SYNC). These were removed.</li>
  <li>There are some elements in the grammar for resolving conflicts
(IF(b)). These have been removed.</li>
  <li>Some comments related to Coco/R parsing details have been removed.</li>
  <li>A Coco/R grammar is an attributed grammar where the attributes enable
the productions to have input and output parameters. These attributes
were removed except that boolean input parameters that affect
the parsing are kept.
    <ul>
      <li>In our representation we represent these
in a definition by giving the names of the parameters following
the non-terminal name. For example <code>entity1(allowsX)</code>.</li>
      <li>In the case of uses of the parameter, the common case is that the
parameter is just passed to a lower-level non-terminal. In that
case we just give the name, e.g. <code>entity2(allowsX)</code>.</li>
      <li>If we want to give an explicit value to a parameter, we specify it in
a keyword notation like this: <code>entity2(allowsX: true)</code>.</li>
      <li>
        <p>In some cases the value to be passed depends on the grammatical context.
In such cases we give a description of the conditions under which the
parameter is true, enclosed in parenthesis. For example:</p>

        <p><code>FunctionSignatureOrEllipsis_(allowGhostKeyword: ("method" present))</code></p>

        <p>means that the <code>allowGhostKeyword</code> parameter is true if the
method keyword was given in the associated <code>FunctionDecl</code>.</p>
      </li>
      <li>Where a parameter affects the parsing of a non-terminal we will
explain the effect of the parameter.</li>
    </ul>
  </li>
</ul>

<p>The names of character sets and tokens start with a lower case
letter; the names of grammar non-terminals start with
an upper-case letter.</p>

<p>The grammar uses Extended BNF notation. See the <a href="http://www.ssw.uni-linz.ac.at/Research/Projects/Coco/Doc/UserManual.pdf">Coco/R Referenced
manual</a>
for details. In summary:</p>

<ul>
  <li>identifiers starting with a lower case letter denote
terminal symbols</li>
  <li>identifiers starting with an upper case letter denote nonterminal
symbols</li>
  <li>strings (a sequence of characters enclosed by double quote characters)
denote the sequence of enclosed characters</li>
  <li><code>=</code> separates the sides of a production, e.g. <code>A = a b c</code></li>
  <li>in the Coco grammars . terminates a production, but for readability
in this document a production starts with the defined identifier in
the left margin and may be continued on subsequent lines if they
are indented</li>
  <li><code>|</code> separates alternatives, e.g. <code>a b | c | d e</code> means <code>a b</code> or <code>c or d e</code></li>
  <li><code>(</code> <code>)</code> groups alternatives, e.g. <code>(a | b) c</code> means <code>a c</code> or <code>b c</code></li>
  <li><code>[ ]</code> option, e.g. <code>[a] b</code> means <code>a b</code> or <code>b</code></li>
  <li><code>{ }</code> iteration (0 or more times), e.g. <code>{a} b</code> means <code>b</code> or <code>a b</code> or <code>a a b</code> or </li>
  <li>We allow <code>|</code> inside <code>[ ]</code> and <code>{ }</code>. So <code>[a | b]</code> is short for <code>[(a | b)]</code>
and <code>{a | b}</code> is short for <code>{(a | b)}</code>.</li>
  <li>The first production defines the name of the grammar, in this case <code>Dafny</code>.</li>
</ul>

<p>In addition to the Coco rules, for the sake of readability we have adopted
these additional conventions.</p>

<ul>
  <li>We allow <code>-</code> to be used. <code>a - b</code> means it matches if it matches <code>a</code> but not <code>b</code>.</li>
  <li>To aid in explaining the grammar we have added some additional productions
that are not present in the original grammar. We name these with a trailing
underscore. If you inline these where they are referenced, the result should
let you reconstruct the original grammar.</li>
</ul>

<!-- TODO: grammar hyperlinks are not implemented -->

<h3 id="sec-unicode">2.1. Dafny Input</h3>

<p>Dafny source code files are readable text encoded as UTF-8 Unicode
(because this is what the Coco/R-generated scanner and parser read).
All program text other than the contents of comments, character, string and verbatim string literals
are printable and white-space ASCII characters,
that is, ASCII characters in the range <code>!</code> to <code>~</code>, plus space, tab, cr and nl (ASCII, 9, 10, 13, 32)  characters.</p>

<p>However, a current limitation of the Coco/R tool used by <code>dafny</code>
is that only printable and white-space ASCII characters can be used.
Use <code>\u</code> escapes in string and character literals to insert unicode characters.
Unicode in comments will work fine unless the unicode is interpreted as an end-of-comment indication.
Unicode in verbatim strings will likely not be interpreted as intended. [Outstanding issue #818].</p>

<h3 id="22-tokens-and-whitespace">2.2. Tokens and whitespace</h3>
<p>The characters used in a Dafny program fall into four groups:</p>

<ul>
  <li>White space characters</li>
  <li>alphanumerics: letters, digits, underscore (<code>_</code>), apostrophe (<code>'</code>), and question mark (<code>?</code>)</li>
  <li>punctuation: <code>(){}[],.`;</code></li>
  <li>operator characters (the other printable characters)</li>
</ul>

<p>Each Dafny token consists of a sequence of consecutive characters from just one of these
groups, excluding white-space. White-space is ignored except that it
separates tokens.</p>

<p>A sequence of alphanumeric characters (with no preceding or following additional
alphanumeric characters) is a <em>single</em> token. This is true even if the token
is syntactically or semantically invalid and the sequence could be separated into
more than one valid token. For example, <code>assert56</code> is one identifier token,
not a keyword <code>assert</code> followed by a number; <code>ifb!=0</code> begins with the token
<code>ifb</code> and not with the keyword <code>if</code> and token <code>b</code>; <code>0xFFFFZZ</code> is an illegal
token, not a valid hex number <code>0xFFFF</code> followed by an identifier <code>ZZ</code>.
White-space must be used to separate two such tokens in a program.</p>

<p>Somewhat differently, operator tokens need not be separated.
Only specific sequences of operator characters are recognized and these
are somewhat context-sensitive. For example, in <code>seq&lt;set&lt;int&gt;&gt;</code>, the grammar
knows that <code>&gt;&gt;</code> is two individual <code>&gt;</code> tokens terminating the nested
type parameter lists; the right shift operator <code>&gt;&gt;</code> would never be valid here. Similarly, the
sequence <code>==&gt;</code> is always one token; even if it were invalid in its context,
separating it into <code>==</code> and <code>&gt;</code> would always still be invalid.</p>

<p>In summary, except for required white space between alphanumeric tokens,
adding white space between tokens or removing white space can never result in changing the meaning of a Dafny program.
For the rest of this document, we consider Dafny programs as sequences of tokens.</p>

<h3 id="sec-character-classes">2.3. Character Classes</h3>
<p>This section defines character classes used later in the token definitions.
In this section a backslash is used to start an escape sequence; so for example
<code>'\n'</code> denotes the single linefeed character. Also in this section, double quotes
enclose the set of characters constituting a character class; enclosing single
quotes are used when there is just one character in the class. <code>+</code> indicates
the union of two character classes; <code>-</code> is the set-difference between the
two classes. <code>ANY</code> designates all <a href="#sec-unicode">unicode characters</a>.</p>

<pre><code class="language-grammar">letter = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"
</code></pre>
<p>At present, a letter is an ASCII upper or lowercase letter. Other Unicode letters
are not supported.</p>

<pre><code class="language-grammar">digit = "0123456789"
</code></pre>
<p>A digit is just one of the base-10 digits.</p>

<pre><code class="language-grammar">posDigit = "123456789"
posDigitFrom2 = "23456789"
</code></pre>
<p>A <code>posDigit</code> is a digit, excluding 0. <code>posDigitFrom2</code> excludes both 0 and 1.</p>

<pre><code class="language-grammar">hexdigit = "0123456789ABCDEFabcdef"
</code></pre>
<p>A <code>hexdigit</code> character is a digit or one of the letters from A to F in either case.</p>

<pre><code class="language-grammar">special = "'_?"
</code></pre>
<p>The <em>special</em> characters are the characters in addition to alphanumeric characters
that are allowed to appear in a Dafny identifier. These are</p>

<ul>
  <li><code>'</code> because mathematicians like to put primes on identifiers and some ML
programmers like to start names of type parameters with a <code>'</code>,</li>
  <li><code>_</code> because computer scientists expect to be able to have underscores in identifiers, and</li>
  <li><code>?</code> because it is useful to have <code>?</code> at the end of names of predicates,
e.g., Cons?.</li>
</ul>

<pre><code class="language-grammar">cr        = '\r'
</code></pre>
<p>A carriage return character.</p>

<pre><code class="language-grammar">lf        = '\n'
</code></pre>
<p>A line feed character.</p>

<pre><code class="language-grammar">tab       = '\t'
</code></pre>
<p>A tab character.</p>

<pre><code class="language-grammar">space     = ' '
</code></pre>
<p>A space character.</p>

<pre><code class="language-grammar">nondigitIdChar = letter + special
</code></pre>
<p>The characters that can be used in an identifier minus the digits.</p>

<pre><code class="language-grammar">idchar = nondigitIdChar + digit
</code></pre>
<p>The characters that can be used in an identifier.</p>

<pre><code class="language-grammar">nonidchar = ANY - idchar
</code></pre>
<p>Any character except those that can be used in an identifier.
Here the scanner generator will interpret <code>ANY</code> as any unicode character.
However, <code>nonidchar</code> is used only to mark the end of the <code>!in</code> token;
in this context any character other than <a href="#sec-unicode">whitespace or printable ASCII</a>
will trigger a subsequent scanning or parsing error.</p>

<pre><code class="language-grammar">charChar = ANY - '\'' - '\\' - cr - lf
</code></pre>
<p>Characters that can appear in a character constant.
See the <a href="#sec-unicode">discussion on unicode support</a>.</p>

<pre><code class="language-grammar">stringChar = ANY - '"' - '\\' - cr - lf
</code></pre>
<p>Characters that can appear in a string constant.
See the <a href="#sec-unicode">discussion on unicode support</a>.</p>

<pre><code class="language-grammar">verbatimStringChar = ANY - '"'
</code></pre>
<p>Characters that can appear in a verbatim string.
See the <a href="#sec-unicode">discussion on unicode support</a>.</p>

<h3 id="24-comments">2.4. Comments</h3>
<p>Comments are in two forms.</p>

<ul>
  <li>They may go from <code>/*</code> to <code>*/</code> .</li>
  <li>They may go from <code>//</code> to the end of the line.</li>
</ul>

<p>Comments may be nested,
but note that the nesting of multi-line comments is behavior that is different
from most programming languages. In Dafny,</p>
<pre><code class="language-dafny">method m() {
  /* comment
     /* nested comment
     */
     rest of outer comment
  */
}
</code></pre>
<p>is permitted; this feature is convenient for commenting out blocks of
program statements that already have multi-line comments within them.
Other than looking for  end-of-comment delimiters,
the contents of a comment are not interpreted.
Comments may contain any unicode character, but see the <a href="#sec-unicode">discussion on unicode support</a> for more information.</p>

<p>Note that the nesting is not fool-proof. In</p>
<pre><code class="language-dafny">method m() {
  /* var i: int;
     // */ line comment
     var j: int;
  */
}
</code></pre>
<p>and</p>
<pre><code class="language-dafny">method m() {
  /* var i: int;
     var s: string := "a*/b";
     var j: int;
   */
}
</code></pre>
<p>the <code>*/</code> inside the line comment and the string are seen as the end of the outer
comment, leaving trailing text that will provoke parsing errors.</p>

<h3 id="sec-tokens">2.5. Tokens</h3>
<p>As with most languages, Dafny syntax is defined in two levels. First the stream
of input characters is broken up into <em>tokens</em>. Then these tokens are parsed
using the Dafny grammar. The Dafny tokens are defined in this section.</p>

<h4 id="251-reserved-words">2.5.1. Reserved Words</h4>
<p>The following reserved words appear in the Dafny grammar and may not be used
as identifiers of user-defined entities:</p>

<pre><code class="language-grammar">reservedword =
    "abstract" | "allocated" | "as" | "assert" | "assume" |
    "bool" | "break" | "by" |
    "calc" | "case" | "char" | "class" | "codatatype" |
    "const" | "constructor" |
    "datatype" | "decreases" |
    "else" | "ensures" | "exists" | "export" | "extends" |
    "false" | "forall" | "fresh" | "function" | "ghost" |
    "if" | "imap" | "import" | "in" | "include" |
    "int" | "invariant" | "is" | "iset" | "iterator" |
    "label" | "lemma" | "map" | "match" | "method" |
    "modifies" | "modify" | "module" | "multiset" |
    "nameonly" | "nat" | "new" | "newtype" | "null" |
    "object" | "object?" | "old" | "opened" | "ORDINAL"
    "predicate" | "print" | "provides" |
    "reads" | "real" | "refines" | "requires" | "return" |
    "returns" | "reveal" | "reveals" |
    "seq" | "set" | "static" | "string" |
    "then" | "this" | "trait" | "true" | "twostate" | "type" |
    "unchanged" | "var" | "while" | "witness" |
    "yield" | "yields" |
    arrayToken | bvToken

arrayToken = "array" [ posDigitFrom2 | posDigit digit { digit }]["?"]

bvToken = "bv" ( 0 | posDigit { digit } )
</code></pre>

<p>An <code>arrayToken</code> is a reserved word that denotes an array type of
given rank. <code>array</code> is an array type of rank 1 (aka a vector). <code>array2</code>
is the type of two-dimensional arrays, etc.
<code>array1</code> and <code>array1?</code> are not reserved words; they are just ordinary identifiers.
Similarly, <code>bv0</code>, <code>bv1</code>, and <code>bv8</code> are reserved words, but <code>bv02</code> is an
ordinary identifier.</p>

<h4 id="252-identifiers">2.5.2. Identifiers</h4>

<pre><code class="language-grammar">ident = nondigitIdChar { idchar } - charToken - reservedword
</code></pre>
<p>In general Dafny identifiers are sequences of <code>idchar</code> characters where
the first character is a <code>nondigitIdChar</code>. However tokens that fit this pattern
are not identifiers if they look like a character literal
or a reserved word (including array or bit-vector type tokens).
Also, <code>ident</code> tokens that begin with an <code>_</code> are not permitted as user identifiers.</p>

<h4 id="253-digits">2.5.3. Digits</h4>
<pre><code class="language-grammar">digits = digit {['_'] digit}
</code></pre>

<p>A sequence of decimal digits, possibly interspersed with underscores 
for readability (but not beginning or ending with an underscore).
Example: <code>1_234_567</code>.</p>
<pre><code class="language-grammar">hexdigits = "0x" hexdigit {['_'] hexdigit}
</code></pre>

<p>A hexadecimal constant, possibly interspersed with underscores for readability (but not beginning or ending with an underscore).
Example: <code>0xffff_ffff</code>.</p>

<pre><code class="language-grammar">decimaldigits = digit {['_'] digit} '.' digit {['_'] digit}
</code></pre>
<p>A decimal fraction constant, possibly interspersed with underscores 
for readability (but not beginning or ending with an underscore).
Example: <code>123_456.789_123</code>.</p>

<h4 id="254-escaped-character">2.5.4. Escaped Character</h4>
<p>In this section the \ characters are literal.</p>
<pre><code class="language-grammar">escapedChar =
    ( "\'" | "\"" | "\\" | "\0" | "\n" | "\r" | "\t"
      | "\u" hexdigit hexdigit hexdigit hexdigit
    )
</code></pre>

<p>In Dafny character or string literals, escaped characters may be used
to specify the presence of a single- or double-quote character, backslash,
null, new line, carriage return, tab, or a
Unicode character with given hexadecimal representation.</p>

<h4 id="255-character-constant-token">2.5.5. Character Constant Token</h4>
<pre><code class="language-grammar">charToken = "'" ( charChar | escapedChar ) "'"
</code></pre>

<p>A character constant is enclosed by <code>'</code> and includes either a character
from the <code>charChar</code> set or an escaped character. Note that although Unicode
letters are not allowed in Dafny identifiers, Dafny does support <a href="#sec-unicode">Unicode
in its character, string, and verbatim strings constants and in its comments</a>. A character
constant has type <code>char</code>.</p>

<h4 id="256-string-constant-token">2.5.6. String Constant Token</h4>
<pre><code class="language-grammar">stringToken =
    '"' { stringChar | escapedChar }  '"'
  | '@' '"' { verbatimStringChar | '"' '"' } '"'
</code></pre>

<p>A string constant is either a normal string constant or a verbatim string constant.
A normal string constant is enclosed by <code>"</code> and can contain characters from the
<code>stringChar</code> set and escapes.</p>

<p>A verbatim string constant is enclosed between <code>@"</code> and <code>"</code> and can
consist of any characters (including newline characters) except that two
successive double quotes represent one quote character inside
the string. This is the mechanism for escaping a double quote character,
which is the only character needing escaping in a verbatim string.</p>

<h4 id="257-ellipsis">2.5.7. Ellipsis</h4>
<pre><code class="language-grammar">ellipsis = "..."
</code></pre>
<p>The ellipsis symbol is typically used to designate something missing that will
later be inserted through refinement or is already present in a parent declaration..</p>

<h3 id="sec-grammar">2.6. Low Level Grammar Productions</h3>

<h4 id="261-identifier-variations">2.6.1. Identifier Variations</h4>

<pre><code class="language-grammar">Ident = ident
</code></pre>
<p>The <code>Ident</code> non-terminal is just an <code>ident</code> token and represents an ordinary
identifier.</p>

<pre><code class="language-grammar">DotSuffix =
  ( ident | digits | "requires" | "reads" )
</code></pre>
<p>When using the <em>dot</em> notation to denote a component of a compound entity,
the token following the . may be an identifier,
 a natural number, or one of the keywords <code>requires</code> or <code>reads</code>.</p>

<ul>
  <li>Digits can be used to name fields of classes and destructors of
datatypes. For example, the built-in tuple datatypes have destructors
named 0, 1, 2, etc. Note that as a field or destructor name a digit sequence
is treated as a string, not a number: internal
underscores matter, so <code>10</code> is different from <code>1_0</code> and from <code>010</code>.</li>
  <li><code>m.requires</code> is used to denote the precondition for method <code>m</code>.</li>
  <li><code>m.reads</code> is used to denote the things that method <code>m</code> may read.</li>
</ul>

<pre><code class="language-grammar">NoUSIdent = ident - "_" { idchar }
</code></pre>
<p>A <code>NoUSIdent</code> is an identifier except that identifiers with a <strong>leading</strong>
underscore are not allowed. The names of user-defined entities are
required to be <code>NoUSIdent</code>s or, in some contexts, a <code>digits</code>.
 We introduce more mnemonic names
for these below (e.g. <code>ClassName</code>).</p>

<pre><code class="language-grammar">WildIdent = NoUSIdent | "_"
</code></pre>
<p>Identifier, disallowing leading underscores, except the wildcard
identifier <code>_</code>. When <code>_</code> appears it is replaced by a unique generated
identifier distinct from user identifiers. This wildcard has several uses
in the language, but it is not used as part of expressions.</p>

<h4 id="262-nousident-synonyms">2.6.2. NoUSIdent Synonyms</h4>
<p>In the productions for the declaration of user-defined entities the name of the
user-defined entity is required to be an identifier that does not start
with an underscore, i.e., a <code>NoUSIdent</code>. To make the productions more
mnemonic, we introduce the following synonyms for <code>NoUSIdent</code>
and other identifier-related symbols.</p>

<pre><code class="language-grammar">IdentOrDigits = Ident | digits
NoUSIdentOrDigits = NoUSIdent | digits
ModuleName = NoUSIdent
ClassName = NoUSIdent    // also traits
DatatypeName = NoUSIdent
DatatypeMemberName = NoUSIdentOrDigits
NewtypeName = NoUSIdent
SynonymTypeName = NoUSIdent
IteratorName = NoUSIdent
TypeVariableName = NoUSIdent
MethodFunctionName = NoUSIdentOrDigits
LabelName = NoUSIdentOrDigits
AttributeName = NoUSIdent
ExportId = NoUSIdentOrDigits
TypeNameOrCtorSuffix = NoUSIdentOrDigits
</code></pre>

<p>Some parsing contexts</p>

<h4 id="263-qualified-names">2.6.3. Qualified Names</h4>
<pre><code class="language-grammar">QualifiedModuleName = ModuleName { "." ModuleName }
</code></pre>
<p>A qualified name starts with the name of the top-level entity and then is followed by
zero or more <code>DotSuffix</code>s which denote a component. Examples:</p>

<ul>
  <li><code>Module.MyType1</code></li>
  <li><code>MyTuple.1</code></li>
  <li><code>MyMethod.requires</code></li>
  <li><code>A.B.C.D</code></li>
</ul>

<p>The grammar does not actually have a production for qualified names
except in the special case of a qualified name that is known to be
a module name, i.e. a <code>QualifiedModuleName</code>.</p>

<h4 id="264-identifier-type-combinations">2.6.4. Identifier-Type Combinations</h4>
<p>In this section, we describe some nonterminals that combine an identifier and a type.</p>

<pre><code class="language-grammar">IdentType = WildIdent ":" Type
</code></pre>
<p>In Dafny, a variable or field is typically declared by giving its name followed by
a <code>colon</code> and its type. An <code>IdentType</code> is such a construct.</p>

<pre><code class="language-grammar">FIdentType = NoUSIdentOrDigits ":" Type
</code></pre>
<p>A <code>FIdentType</code> is used to declare a field. The Type is required because there is no initializer.</p>

<pre><code class="language-grammar">CIdentType = NoUSIdentOrDigits [ ":" Type ]
</code></pre>
<p>A <code>CIdentType</code> is used for a <code>const</code> declaration. The Type is optional because it may be inferred from
the initializer.</p>

<pre><code class="language-grammar">GIdentType(allowGhostKeyword, allowNewKeyword, allowOlderKeyword, allowNameOnlyKeyword, allowDefault) =
    { "ghost" | "new" | "nameonly" | "older" } IdentType
    [ ":=" Expression(allowLemma: true, allowLambda: true) ]
</code></pre>
<p>A <code>GIdentType</code> is a typed entity declaration optionally preceded by <code>ghost</code> or <code>new</code>. The <em>ghost</em>
qualifier means the entity is only used during verification and not in the generated code.
Ghost variables are useful for abstractly representing internal state in specifications.
If <code>allowGhostKeyword</code> is false, then <code>ghost</code> is not allowed.
If <code>allowNewKeyword</code> is false, then <code>new</code> is not allowed.
If <code>allowNameOnlyKeyword</code> is false, then <code>nameonly</code> is not allowed.
If <code>allowDefault</code> is false, then <code>:= Expression</code> is not allowed.</p>

<p><code>older</code> is a context-sensitive keyword. It is recognized as a keyword only by <code>GIdentType</code> and
only when <code>allowOlderKeyword</code> is true. If <code>allowOlderKeyword</code> is false, then a use of <code>older</code>
is parsed by the <code>IdentType</code> production in <code>GIdentType</code>.</p>

<pre><code class="language-grammar">LocalIdentTypeOptional = WildIdent [ ":" Type ]
</code></pre>
<p>A <code>LocalIdentTypeOptional</code> is used when declaring local variables.
If a value is specified for the variable, the
type may be omitted because it can be inferred from the initial value.
An initial value is not required.</p>

<pre><code class="language-grammar">IdentTypeOptional = WildIdent [ ":" Type ]
</code></pre>
<p>A <code>IdentTypeOptional</code> is typically used in a context where the type of the identifier
may be inferred from the context. Examples are in pattern matching or quantifiers.</p>

<pre><code class="language-grammar">TypeIdentOptional =
    { "ghost" | "nameonly" } [ NoUSIdentOrDigits ":" ] Type
    [ ":=" Expression(allowLemma: true, allowLambda: true) ]
</code></pre>
<p><code>TypeIdentOptional</code>s are used in <code>FormalsOptionalIds</code>. This represents situations
where a type is given but there may not be an identifier. The default-value expression
<code>:= Expression</code> is allowed only if <code>NoUSIdentOrDigits :</code> is also provided.
If modifier <code>nameonly</code> is given, then <code>NoUSIdentOrDigits</code> must also be used.</p>

<pre><code class="language-grammar">FormalsOptionalIds = "(" [ TypeIdentOptional
                           { "," TypeIdentOptional } ] ")"
</code></pre>
<p>A <code>FormalsOptionalIds</code> is a formal parameter list in which the types are required
but the names of the parameters are optional. This is used in algebraic
datatype definitions.</p>

<h4 id="265-numeric-literals">2.6.5. Numeric Literals</h4>
<pre><code class="language-grammar">Nat = ( digits | hexdigits )
</code></pre>
<p>A <code>Nat</code> represents a natural number expressed in either decimal or hexadecimal.</p>

<pre><code class="language-grammar">Dec = decimaldigits
</code></pre>
<p>A <code>Dec</code> represents a decimal fraction literal.</p>

<!--PDF NEWPAGE-->
<h2 id="3-programs">3. Programs</h2>
<pre><code class="language-grammar">Dafny = { IncludeDirective_ } { TopDecl } EOF
</code></pre>
<p>At the top level, a Dafny program (stored as files with extension <code>.dfy</code>)
is a set of declarations. The declarations introduce (module-level)
constants, methods, functions, lemmas, types (classes, traits, inductive and
co-inductive datatypes, newtypes, type synonyms, opaque types, and
iterators) and modules, where the order of introduction is irrelevant. A
class also contains a set of declarations, introducing fields, methods,
and functions.</p>

<p>When asked to compile a program, Dafny looks for the existence of a
Main() method. If a legal Main() method is found, the compiler will emit
an executable appropriate to the target language; otherwise it will emit
a library or individual files.
The conditions for a legal Main() method are described in the User Guide
(<a href="#sec-user-guide-main">Section 24.9.1</a>).
If there is more than one Main(), Dafny will emit an error message.</p>

<p>An invocation of Dafny may specify a number of source files.
Each Dafny file follows the grammar of the <code>Dafny</code> non-terminal.</p>

<p>A file consists of a sequence of optional <em>include</em> directives followed by top
level declarations followed by the end of the file.</p>

<h3 id="31-include-directives">3.1. Include Directives</h3>
<pre><code class="language-grammar">IncludeDirective_ = "include" stringToken
</code></pre>

<p>Include directives have the form <code>"include" stringToken</code> where
the string token is either a normal string token or a
verbatim string token. The <code>stringToken</code> is interpreted as the name of
a file that will be included in the Dafny source. These included
files also obey the <code>Dafny</code> grammar. Dafny parses and processes the
transitive closure of the original source files and all the included files,
but will not invoke the verifier on the included files unless they have been listed
explicitly on the command line.</p>

<p>The file name may be a path using the customary <code>/</code>, <code>.</code>, and <code>..</code> specifiers.
The interpretation of the name (e.g., case-sensitivity) will depend on the
underlying operating system. A path not beginning with <code>/</code> is looked up in
the underlying file system relative to the current working directory (the
one in which the dafny tool is invoked). Paths beginning with a device
designator (e.g., <code>C:</code>) are only permitted on Windows systems.</p>

<h3 id="32-top-level-declarations">3.2. Top Level Declarations</h3>
<pre><code class="language-grammar">TopDecl = {
  { DeclModifier }
  ( SubModuleDecl
  | ClassDecl
  | DatatypeDecl
  | NewtypeDecl
  | SynonymTypeDecl  // includes opaque types
  | IteratorDecl
  | TraitDecl
  | ClassMemberDecl(moduleLevelDecl: true)
  )
  }
</code></pre>
<p>Top-level declarations may appear either at the top level of a Dafny file,
or within a <code>SubModuleDecl</code>. A top-level declaration is one of
various kinds of declarations described later. Top-level declarations are
implicitly members of a default (unnamed) top-level module.</p>

<p>The <code>ClassDecl</code>, <code>DatatypeDecl</code>, <code>NewtypeDecl</code>,
<code>SynonymTypeDecl</code>, <code>IteratorDecl</code>, and <code>TraitDecl</code> declarations are
type declarations and are described in <a href="#sec-types">Section 6</a> and
the following sections. Ordinarily
<code>ClassMemberDecl</code>s appear in class declarations but they can also
appear at the top level. In that case they are included as part of an
implicit top-level class and are implicitly <code>static</code> (but cannot be
declared as static). In addition a <code>ClassMemberDecl</code> that appears at
the top level cannot be a <code>FieldDecl</code>.</p>

<h3 id="33-declaration-modifiers">3.3. Declaration Modifiers</h3>
<pre><code class="language-grammar">DeclModifier = ( "abstract" | "ghost" | "static" )
</code></pre>

<p>Top level declarations may be preceded by zero or more declaration
modifiers. Not all of these are allowed in all contexts.</p>

<p>The <code>abstract</code> modifiers may only be used for module declarations.
An abstract module can leave some entities underspecified.
Abstract modules are not compiled.</p>

<p>The <code>ghost</code> modifier is used to mark entities as being used for
specification only, not for compilation to code.</p>

<p>The <code>static</code> modifier is used for class members that that
are associated with the class as a whole rather than with
an instance of the class.</p>

<p>The following table shows modifiers that are available
for each of the kinds of declaration. In the table
we use already-ghost (already-non-ghost) to denote that the item is not
allowed to have the ghost modifier because it is already
implicitly ghost (non-ghost).</p>

<table>
  <thead>
    <tr>
      <th>Declaration</th>
      <th>allowed modifiers</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>module</td>
      <td>abstract</td>
    </tr>
    <tr>
      <td>class</td>
      <td>-</td>
    </tr>
    <tr>
      <td>trait</td>
      <td>-</td>
    </tr>
    <tr>
      <td>datatype or codatatype</td>
      <td>-</td>
    </tr>
    <tr>
      <td>field</td>
      <td>ghost</td>
    </tr>
    <tr>
      <td>newtype</td>
      <td>-</td>
    </tr>
    <tr>
      <td>synonym types</td>
      <td>-</td>
    </tr>
    <tr>
      <td>iterators</td>
      <td>-</td>
    </tr>
    <tr>
      <td>method</td>
      <td>ghost static</td>
    </tr>
    <tr>
      <td>lemma</td>
      <td>already-ghost static</td>
    </tr>
    <tr>
      <td>least lemma</td>
      <td>already-ghost static</td>
    </tr>
    <tr>
      <td>greatest lemma</td>
      <td>already-ghost static</td>
    </tr>
    <tr>
      <td>constructor</td>
      <td>-</td>
    </tr>
    <tr>
      <td>function (non-method)</td>
      <td>already-ghost static</td>
    </tr>
    <tr>
      <td>function method</td>
      <td>already-non-ghost static</td>
    </tr>
    <tr>
      <td>predicate (non-method)</td>
      <td>already-ghost static</td>
    </tr>
    <tr>
      <td>predicate method</td>
      <td>already-non-ghost static</td>
    </tr>
    <tr>
      <td>least predicate</td>
      <td>already-ghost static</td>
    </tr>
    <tr>
      <td>greatest predicate</td>
      <td>already-ghost static</td>
    </tr>
  </tbody>
</table>

<!--PDF NEWPAGE-->
<h2 id="4-modules">4. Modules</h2>

<pre><code class="language-grammar">SubModuleDecl = ( ModuleDefinition | ModuleImport | ModuleExport )
</code></pre>

<p>Structuring a program by breaking it into parts is an important part of
creating large programs. In Dafny, this is accomplished via <em>modules</em>.
Modules provide a way to group together related types, classes, methods,
functions, and other modules, as well as to control the scope of
declarations. Modules may import each other for code reuse, and it is
possible to abstract over modules to separate an implementation from an
interface.</p>

<h3 id="41-declaring-new-modules">4.1. Declaring New Modules</h3>
<pre><code class="language-grammar">ModuleDefinition = "module" { Attribute } ModuleQualifiedName
        [ "refines" ModuleQualifiedName ]
        "{" { TopDecl } "}"

ModuleQualifiedName = ModuleName { "." ModuleName }
</code></pre>
<p>A <code>ModuleQualifiedName</code> is a qualified name that is expected to refer to a module;
a <em>qualified name</em> is a sequence of <code>.</code>-separated identifiers, which designates
a program entity by representing increasingly-nested scopes.</p>

<p>A new module is declared with the <code>module</code> keyword, followed by the name
of the new module, and a pair of curly braces ({}) enclosing the body
of the module:</p>

<pre><code class="language-dafny">module Mod {
  ...
}
</code></pre>

<p>A module body can consist of anything that you could put at the top
level. This includes classes, datatypes, types, methods, functions, etc.</p>

<pre><code class="language-dafny">module Mod {
  class C {
    var f: int
    method m()
  }
  datatype Option = A(int) | B(int)
  type T
  method m()
  function f(): int
}
</code></pre>

<p>You can also put a module inside another, in a nested fashion:</p>

<pre><code class="language-dafny">module Mod {
  module Helpers {
    class C {
      method doIt()
      var f: int
    }
  }
}
</code></pre>

<p>Then you can refer to the members of the <code>Helpers</code> module within the
<code>Mod</code> module by prefixing them with Helpers.. For example:</p>

<pre><code class="language-dafny">module Mod {
  module Helpers { ... }
  method m() {
    var x := new Helpers.C;
    x.doIt();
    x.f := 4;
  }
}
</code></pre>

<p>Methods and functions defined at the module level are available like
classes, with just the module name prefixing them. They are also
available in the methods and functions of the classes in the same
module.</p>

<pre><code class="language-dafny">module Mod {
  module Helpers {
    function method addOne(n: nat): nat {
      n + 1
    }
  }
  method m() {
    var x := 5;
    x := Helpers.addOne(x); // x is now 6
  }
}
</code></pre>

<p>Note that everything declared at the top-level
(in all the files constituting the program) is implicitly part
of a single implicit unnamed global module.</p>

<h3 id="42-declaring-nested-modules-standalone">4.2. Declaring nested modules standalone</h3>

<p>As described in the previous section, module declarations can be nested.
It is also permitted to declare a nested module <em>outside</em> of its
enclosing module. So instead of</p>
<pre><code class="language-dafny">module A {
  module B {
  }
}
</code></pre>
<p>one can write</p>
<pre><code class="language-dafny">module A {
}
module A.B {
}
</code></pre>
<p>The second module is completely separate; for example, it can be in
a different file.
This feature provides flexibility in writing and maintenance;
for example, it can reduce the size of module <code>A</code> by extracting module <code>A.B</code>
into a separate body of text.</p>

<p>However, it can also lead to confusion and program authors need to take care.
It may not be apparent to a reader of module <code>A</code> that module <code>A.B</code> exists;
the existence of <code>A.B</code> might cause names to be resolved differently and
the semantics of the program might be (silently) different if <code>A.B</code> is
present or absent.</p>

<h3 id="43-importing-modules">4.3. Importing Modules</h3>
<pre><code class="language-grammar">ModuleImport =
    "import"
    [ "opened" ]
    ( QualifiedModuleExport
    | ModuleName "=" QualifiedModuleExport
    | ModuleName ":" QualifiedModuleExport
    )

QualifiedModuleExport =
    ModuleQualifiedName [ "`" ModuleExportSuffix ]

ModuleExportSuffix =
    ( ExportId
    | "{" ExportId { "," ExportId } "}"
    )
</code></pre>

<p>Sometimes you want to refer to
things from an existing module, such as a library. In this case, you
can <em>import</em> one module into another. This is done via the <code>import</code>
keyword, which has two forms with different meanings.
The simplest form is the concrete import, which has
the form <code>import A = B</code>. This declaration creates a reference to the
module <code>B</code> (which must already exist), and binds it to the new name
<code>A</code>. This form can also be used to create a reference to a nested
module, as in <code>import A = B.C</code>. The other form, using a <code>:</code>, is
described in <a href="#sec-module-abstraction">Section 4.6</a>.</p>

<p>As modules in the same scope must have different names, this ability
to bind a module to a new name allows disambiguating separately developed
external modules that have the same name.
Note that the new name is only bound in the scope containing
the import declaration; it does not create a global alias. For
example, if <code>Helpers</code> was defined outside of <code>Mod</code>, then we could import
it:</p>

<pre><code class="language-dafny">module Helpers {
  ...
}
module Mod {
  import A = Helpers
  method m() {
    assert A.addOne(5) == 6;
  }
}
</code></pre>

<p>Note that inside <code>m()</code>, we have to use <code>A</code> instead of <code>Helpers</code>, as we bound
it to a different name. The name <code>Helpers</code> is not available inside <code>m()</code>,
as only names that have been bound inside <code>Mod</code> are available. In order
to use the members from another module, that other module either has to be declared
there with <code>module</code> or imported with <code>import</code>. (As described below, the
resolution of the <code>ModuleQualifiedName</code> that follows the <code>=</code> in the <code>import</code>
statement or the <code>refines</code> in a module declaration uses slightly
different rules.)</p>

<p>We dont have to give <code>Helpers</code> a new name, though, if we dont want
to. We can write <code>import Helpers = Helpers</code> to import the module under
its own name; Dafny
even provides the shorthand <code>import Helpers</code> for this behavior. You
cant bind two modules with the same name at the same time, so
sometimes you have to use the = version to ensure the names do not
clash. When importing nested modules, <code>import B.C</code> means <code>import C = B.C</code>;
the implicit name is always the last name segment of the module designation.</p>

<p>The <code>ModuleQualifiedName</code> in the <code>ModuleImport</code> starts with a
sibling module of the importing module, or with a submodule of the
importing module. There is no way to refer to the parent module, only
sibling modules (and their submodules).</p>

<p>Import statements may occur at the top-level of a program
(that is, in the implicit top-level module of the program) as well.
There they serve simply as a way to give a new name, perhaps a
shorthand name, to a module. For example,</p>

<pre><code class="language-dafny">module MyModule { ... } // declares module MyModule
import MyModule  // error: cannot add a module named MyModule
                 // because there already is one
import M = MyModule // OK. M and MyModule are equivalent
</code></pre>

<h3 id="44-opening-modules">4.4. Opening Modules</h3>

<p>Sometimes, prefixing the members of the module you imported with the
name is tedious and ugly, even if you select a short name when
importing it. In this case, you can import the module as <code>opened</code>,
which causes all of its members to be available without adding the
module name. The <code>opened</code> keyword, if present, must immediately follow <code>import</code>.
For example, we could write the previous example as:</p>

<pre><code class="language-dafny">module Mod {
  import opened Helpers
  method m() {
    assert addOne(5) == 6;
  }
}
</code></pre>

<p>When opening modules, the newly bound members have lower priority
than local definitions. This means if you define
a local function called <code>addOne</code>, the function from <code>Helpers</code> will no
longer be available under that name. When modules are opened, the
original name binding is still present however, so you can always use
the name that was bound to get to anything that is hidden.</p>

<pre><code class="language-dafny">module Mod {
  import opened Helpers
  function addOne(n: nat): nat {
    n - 1
  }
  method m() {
    assert addOne(5) == 6; // this is now false,
                           // as this is the function just defined
    assert Helpers.addOne(5) == 6; // this is still true
  }
}
</code></pre>

<p>If you open two modules that both declare members with the same name,
then neither member can be referred to without a module prefix, as it
would be ambiguous which one was meant. Just opening the two modules
is not an error, however, as long as you dont attempt to use members
with common names. However, if the ambiguous references actually
refer to the same declaration, then they are permitted.
The <code>opened</code> keyword may be used with any kind of
<code>import</code> declaration, including the module abstraction form.</p>

<p>An <code>import opened</code> may occur at the top-level as well. For example,</p>
<pre><code class="language-dafny">module MyModule { ... } // declares MyModule
import opened MyModule // does not declare a new module, but does
                       // make all names in MyModule available in
                       // the current scope, without needing
                       // qualification
import opened M = MyModule // names in MyModule are available in
                       // the current scope without qualification
                       // or qualified with either M or MyModule
</code></pre>

<p>The Dafny style guidelines suggest using opened imports sparingly.
They are best used when the names being imported have obvious
and unambiguous meanings and when using qualified names would be
verbose enough to impede understanding.</p>

<h3 id="45-export-sets-and-access-control">4.5. Export Sets and Access Control</h3>
<pre><code class="language-grammar">ModuleExport =
  "export"
  [ ExportId ]
  [ "..." ]
  {
    "extends"  ExportId { "," ExportId }
  | "provides" ( ExportSignature { "," ExportSignature } | "*" )
  | "reveals"  ( ExportSignature { "," ExportSignature } | "*" )
  }

ExportSignature = TypeNameOrCtorSuffix [ "." TypeNameOrCtorSuffix ]
</code></pre>

<p>In some programming languages, keywords such as <code>public</code>, <code>private</code>, and <code>protected</code>
are used to control access to (that is, visibility of) declared program entities.
In Dafny, modules and export sets provide that capability.
Modules combine declarations into logically related groups.
Export sets then permit selectively exposing subsets of declarations;
another module can import the export set appropriate to its needs.
A user can define as many export sets as are needed to provide different
kinds of access to the modules declarations.
Each export set designates a list of names, which must be
names that are declared in the module (or in a refinement parent).</p>

<p>By default all the names declared in a module are available outside the
module using the <code>import</code> mechanism.
An <em>export set</em> enables a module to disallow the
use of some declarations outside the module.</p>

<p>Export sets have names; those names are used in <code>import</code> statements to
designate which export set of a module is being imported.
If a module <code>M</code> has export sets
<code>E1</code> and <code>E2</code>, we can write <code>import A = M`E1</code> to create a module alias
<code>A</code> that contains only the
names in <code>E1</code>. Or we can write <code>import A = M`{E1,E2}</code> to import the union
of names in <code>E1</code> and <code>E2</code> as module alias <code>A</code>.
As before, <code>import M`E1</code> is an
abbreviation of <code>import M = M`E1</code>.</p>

<p>If no export set is given in an import
statement, the default export set of the module is used.</p>

<p>There are various
defaults that apply differently in different cases.
The following description is with respect to an example module <code>M</code>:</p>

<p><em><code>M</code> has no export sets declared</em>. Then another module may simply <code>import Z = M</code>
to obtain access to all of Ms declarations.</p>

<p><em><code>M</code> has one or more named export sets (e.g., <code>E</code>, <code>F</code>)</em>. Then another module can
write <code>import Z = M`E</code> or <code>import Z = M`{E,F}</code> to obtain access to the
names that are listed in export set <code>E</code> or to the union of those in export sets
<code>E</code> and <code>F</code>, respectively. If no export set has the same name as the module,
then an export set designator must be used: in that case you cannot write
simply <code>import Z = M</code>.</p>

<p><em><code>M</code> has an unnamed export set, along with other export sets (e.g., <code>E</code>)</em>. The unnamed
export set is the default export set and implicitly has the same name as
the module. Because there is a default export set, another module may write
either <code>import Z = M</code> or <code>import Z = M`M</code> to import the names in that
default export set. You can also still use the other export sets with the
explicit designator: <code>import Z = M`E</code></p>

<p><em><code>M</code> declares an export set with the same name as the module</em>. This is equivalent
to declaring an export set without a name. <code>import M</code> and <code>import M`M</code>
perform the same function in either case; the export set with or without
the name of the module is the default export set for the module.</p>

<p>Note that names of module aliases (declared by import statements) are
just like other names in a module; they can be included or omitted from
export sets.
Names brought into a module by <a href="#sec-module-refinement"><em>refinement</em></a> are treated the same as
locally declared names and can be listed in export set declarations.
However, names brought into a module by <code>import opened</code> (either into a module
or a refinement parent of a module) may
not be further exported. For example,</p>
<pre><code class="language-dafny">module A {
  const a := 10;
  const z := 10;
}
module B {
  import opened Z = A // includes a, declares Z
  const b := Z.a; // OK
}
module C {
  import opened B // includes b, Z, but not a
  //assert b == a; // error: a is not known
  //assert b == B.a; // error: B.a is not valid
  //assert b == A.a; // error: A is not known
  assert b == Z.a; // OK: module Z is known and includes a
}
</code></pre>

<p>However, in the above example,</p>

<ul>
  <li>if <code>A</code> has one export set <code>export Y reveals a</code>
then the import in module <code>B</code> is invalid because <code>A</code> has no default
export set;</li>
  <li>if <code>A</code> has one export set <code>export Y reveals a</code> and <code>B</code> has <code>import Z = A`Y</code>
then Bs import is OK. So is the use of <code>Z.a</code> in the assert because <code>B</code>
declares <code>Z</code> and <code>C</code> brings in <code>Z</code> through the <code>import opened</code> and
<code>Z</code> contains <code>a</code> by virtue of its declaration. (The alias <code>Z</code> is not able to
have export sets; all of its names are visible.)</li>
  <li>if <code>A</code> has one export set <code>export provides z</code> then <code>A</code> does have a
default export set, so the import in <code>B</code> is OK, but neither the use of <code>a</code>
in <code>B</code> nor as <code>Z.a</code> in C would be valid, because <code>a</code> is not in <code>Z</code>.</li>
</ul>

<p>The default export set is important in the resolution of qualified
names, as described in <a href="#sec-name-resolution">Section 4.8</a>.</p>

<h4 id="451-provided-and-revealed-names">4.5.1. Provided and revealed names</h4>

<p>Names can be exported from modules in two ways, designated by <code>provides</code>
and <code>reveals</code> in the export set declaration.</p>

<p>When a name is exported as <em>provided</em>, then inside a module that has
imported the name only the name is known, not the details of the
names declaration.</p>

<p>For example, in the following code the constant <code>a</code> is exported as provided.</p>
<pre><code class="language-dafny">module A {
  export provides a
  const a := 10;
  const b := 20;
}

module B {
  import A
  method m() {
    assert A.a == 10; // a is known, but not its value
    // assert A.b == 20; // b is not known through A`A
  }
}

</code></pre>
<p>Since <code>a</code> is imported into module <code>B</code> through the default export set <code>A`A</code>,
it can be referenced in the assert statement. The constant <code>b</code> is not
exported, so it is not available. But the assert about <code>a</code> is not provable
because the value of <code>a</code> is not known in module <code>B</code>.</p>

<p>In contrast, if <code>a</code> is exported as <em>revealed</em>, as shown in the next example,
its value is known and the assertion can be proved.</p>
<pre><code class="language-dafny">module A {
  export reveals a
  const a := 10;
  const b := 20;
}

module B {
  import A
  method m() {
    assert A.a == 10; // a and its value are known
    // assert A.b == 20; // b is not known through A`A
  }
}

</code></pre>

<p>The following table shows which parts of a declaration are exported by an
export set that <code>provides</code> or <code>reveals</code> the declaration.</p>

<p>declaration    | what is exported with <code>provides</code>  | what is exported with <code>reveals</code>
|-|
<code>const x: X := E</code>   | <code>const x: X</code>   | <code>const x: X := E</code>
|-|-
<code>var x: X</code>          | <code>var x: X</code>     | not allowed
||-
<code>function F(x: X): Y</code>  | <code>function F(x: X): Y</code> | <code>function F(x: X): Y</code>
`  specification<code>   | </code>  specification<code>  | </code>  specification<code>
</code>{<code>                    |                       | </code>{<code>
</code>  Body<code>               |                       | </code>  Body<code>
</code>}<code>                    |                       | </code>}<code>
-----------------------|-----------------------|-------------------------------
</code>method M(x: X) returns (y: Y)<code> | </code>method M(x: X) returns (y: Y)<code> | not allowed
</code>  specification<code>            | </code>  specification<code>            |
</code>{<code>                             |                                 |
</code>  Body;<code>                       |                                 |
</code>}<code>                             |                                 |
----------------------|----------------|-------------------
</code>type Opaque<code>         | </code>type Opaque<code>  | </code>type Opaque<code>
</code>{<code>                   |                |
</code>  // members<code>     |                |
</code>}<code>                   |                |
----------------------|----------------|-------------------
</code>type Synonym = T<code>    | </code>type Synonym<code> | </code>type Synonym = T<code>
---------------------|--------------|----------------------
</code>type S = x: X | P witness E<code>    | </code>type S<code> | </code>type S = x: X | P witness E<code>
---------------------------------|----------|---------------------------------
</code>newtype N = x: X | P witness E<code> | </code>type N<code> | </code>newtype N = x: X | P witness E<code>
</code>{<code>                              |          |
</code>  // members<code>                |          |
</code>}<code>                              |          |
-------------------------------|--------|-------------------------------
</code>datatype D = Ctor0(x0: X0) | Ctor1(x1: X1) | <code> | </code>type D<code> | </code>datatype D = Ctor0(x0: X0) | Ctor1(x1: X1) | <code>
</code>{<code>                                                |          |
</code>  // members<code>                                  |          |
</code>}<code>                                                |          |
-------------------------|---------|-------------------------------
</code>class Cl extends T0, <code> | </code>type Cl<code> | </code>class Cl extends T0, <code>
</code>{<code>                        |           | </code>{<code>
</code>  constructor ()<code>         |           | </code>  constructor ()<code>
</code>    specification<code>     |           | </code>    specification<code>
</code>  {<code>                      |           | 
</code>    Body;<code>                |           | 
</code>  }<code>                      |           | 
</code>  // other members<code>    |           | 
</code>}<code>                        |           | </code>}<code>
-------------------------|---------|-------------------------------
</code>trait Tr extends T0, <code> | </code>type Tr<code> | </code>trait Tr extends T0, <code>
</code>{<code>                        |           |
</code>  // members<code>          |           |
</code>}<code>                        |           |
------------------------------------|-------------|------------------------------------
</code>iterator Iter(x: X) yields (y: Y)<code> | </code>type Iter<code> | </code>iterator Iter(x: X) yields (y: Y)<code>
</code>  specification<code>                |             | </code>  specification<code>
</code>{<code>                                 |             |
</code>  Body;<code>                           |             |
</code>}<code>                                 |             |
-----------------------|--------------|----------------------
</code>module SubModule <code>   | </code>module SubModule <code>   | not allowed
</code>{<code>                      | </code>{<code>                      |
</code>  export SubModule <code> | </code>  export SubModule <code> |
</code>  export A <code>         |                          |
</code>  // declarations<code>   | </code>  // declarations<code>   |
</code>}<code>                      | </code>}<code>                      |
-----------------------|------------------------|------------
</code><code>import L = M</code>S<code>    |</code>import L = M<code>S</code>`     | not allowed
||</p>

<p>Variations of functions (e.g., <code>predicate</code>, <code>twostate function</code>) are
handled like <code>function</code> above, and variations of methods (e.g.,
<code>lemma</code> and <code>twostate lemma</code>) are treated like <code>method</code> above. Since
the whole signature is exported, a function or method is exported to
be of the same kind, even through <code>provides</code>. For example, an exported
<code>twostate lemma</code> is exported as a <code>twostate lemma</code> (and thus is known
by importers to have two implicit heap parameters), and an exported
<code>least predicate P</code> is exported as a <code>least predicate P</code> (and thus
importers can use both <code>P</code> and its prefix predicate <code>P#</code>).</p>

<p>If <code>C</code> is a <code>class</code>, <code>trait</code>, or <code>iterator</code>, then <code>provides C</code> exports
the non-null reference type <code>C</code> as an opaque type. This does not reveal
that <code>C</code> is a reference type, nor does it export the nullable type <code>C?</code>.</p>

<p>In most cases, exporting a <code>class</code>, <code>trait</code>, <code>datatype</code>, <code>codatatype</code>, or
opaque type does not automatically export its members. Instead, any member
to be exported must be listed explicitly. For example, consider the type
declaration</p>

<pre><code class="language-dafny">trait Tr {
  function F(x: int): int { 10 }
  function G(x: int): int { 12 }
  function H(x: int): int { 14 }
}
</code></pre>

<p>An export set that contains only <code>reveals Tr</code> has the effect of exporting</p>

<pre><code class="language-dafny">trait Tr {
}
</code></pre>

<p>and an export set that contains only <code>provides Tr, Tr.F reveals Tr.H</code> has
the effect of exporting</p>

<pre><code class="language-dafny">type Tr {
  function F(x: int): int
  function H(x: int): int { 14 }
}
</code></pre>

<p>There is no syntax (for example, <code>Tr.*</code>) to export all members of a type.</p>

<p>Some members are exported automatically when the type is revealed.
Specifically:</p>
<ul>
  <li>Revealing a <code>datatype</code> or <code>codatatype</code> automatically exports the types
discriminators and destructors.</li>
  <li>Revealing an <code>iterator</code> automatically exports the iterators members.</li>
  <li>Revealing a class automatically exports the classs anonymous constructor, if any.</li>
</ul>

<p>For a <code>class</code>, a <code>constructor</code> member can be exported only if the class is revealed.
For a <code>class</code> or <code>trait</code>, a <code>var</code> member can be exported only if the class or trait is revealed
(but a <code>const</code> member can be exported even if the enclosing class or trait is only provided).</p>

<p>When exporting a sub-module, only the sub-modules eponymous export set is exported.
There is no way for a parent module to export any other export set of a sub-module, unless
it is done via an <code>import</code> declaration of the parent module.</p>

<p>The effect of declaring an import as <code>opened</code> is confined to the importing module. That
is, the ability of use such imported names as unqualified is not passed on to further
imports, as the following example illustrates:</p>

<pre><code class="language-dafny">module Library {
  const xyz := 16
}

module M {
  export
    provides Lib
    provides xyz // error: 'xyz' is not declared locally

  import opened Lib = Library

  const k0 := Lib.xyz
  const k1 := xyz
}

module Client {
  import opened M

  const a0 := M.Lib.xyz
  const a1 := Lib.xyz
  const a2 := M.xyz // error: M does not have a declaration 'xyz'
  const a3 := xyz // error: unresolved identifier 'xyz'
}
</code></pre>

<p>As highlighted in this example, module <code>M</code> can use <code>xyz</code> as if it were a local
name (see declaration <code>k1</code>), but the unqualified name <code>xyz</code> is not made available
to importers of <code>M</code> (see declarations <code>a2</code> and <code>a3</code>), nor is it possible for
<code>M</code> to export the name <code>xyz</code>.</p>

<p>A few other notes:</p>

<ul>
  <li>A <code>provides</code> list can mention <code>*</code>, which means that all local names
(except export set names) in the module are exported as <code>provides</code>.</li>
  <li>A <code>reveals</code> list can mention <code>*</code>, which means that all local names
(except export set names) in the module are exported as <code>reveals</code>, if
the declaration is allowed to appear in a <code>reveals</code> clause, or as
<code>provides</code>, if the declaration is not allowed to appear in a <code>reveals</code>
clause.</li>
  <li>If no export sets are declared, then the implicit
export set is <code>export reveals *</code></li>
  <li>A refinement module acquires all the export sets from its refinement parent.</li>
  <li>Names acquired by a module from its refinement parent are also subject to
export lists. (These are local names just like those declared directly.)</li>
</ul>

<h4 id="452-extends-list">4.5.2. Extends list</h4>
<p>An export set declaration may include an <em>extends</em> list, which is a list of
one or more export set names from the same module containing the declaration
(including export set names obtained from a refinement parent).
The effect is to include in the declaration the union of all the names in
the export sets in the extends list, along with any other names explicitly
included in the declaration. So for example in</p>
<pre><code class="language-dafny">module M {
  const a := 10;
  const b := 10;
  const c := 10;
  export A reveals a
  export B reveals b
  export C extends A, B
    reveals c
}
</code></pre>
<p>export set C will contain the names <code>a</code>, <code>b</code>, and <code>c</code>.</p>

<h3 id="sec-module-abstraction">4.6. Module Abstraction</h3>

<p>Sometimes, using a specific implementation is unnecessary; instead,
all that is needed is a module that implements some interface.  In
that case, you can use an <em>abstract</em> module import. In Dafny, this is
written <code>import A : B</code>.  This means bind the name <code>A</code> as before, but
instead of getting the exact module <code>B</code>, you get any module which
<em>adheres</em> to <code>B</code>.  Typically, the module <code>B</code> may have abstract type
definitions, classes with bodiless methods, or otherwise be unsuitable
to use directly.  Because of the way refinement is defined, any
refinement of <code>B</code> can be used safely. For example, if we start with:</p>

<pre><code class="language-dafny">module Interface {
  function method addSome(n: nat): nat
    ensures addSome(n) &gt; n
}
abstract module Mod {
  import A : Interface
  method m() {
    assert 6 &lt;= A.addSome(5);
  }
}
</code></pre>

<p>We can be more precise if we know that <code>addSome</code> actually adds
exactly one. The following module has this behavior. Further, the
postcondition is stronger, so this is actually a refinement of the
Interface module.</p>

<pre><code class="language-dafny">module Implementation {
  function method addSome(n: nat): nat
    ensures addSome(n) == n + 1
  {
    n + 1
  }
}
</code></pre>

<p>We can then substitute <code>Implementation</code> for <code>A</code> in a new module, by
declaring a refinement of <code>Mod</code> which defines  <code>A</code> to be <code>Implementation</code>.</p>

<pre><code class="language-dafny">module Mod2 refines Mod {
  import A = Implementation
  ...
}
</code></pre>

<p>When you refine an abstract import into a concrete one
Dafny checks that the concrete module is a
refinement of the abstract one. This means that the methods must have
compatible signatures, all the classes and datatypes with their
constructors and fields in the abstract one must be present in the
concrete one, the specifications must be compatible, etc.</p>

<p>A module that includes an abstract import must be declared <code>abstract</code>.</p>

<h3 id="47-module-ordering-and-dependencies">4.7. Module Ordering and Dependencies</h3>

<p>Dafny isnt particular about the textual order in which modules are
declared, but
they must follow some rules to be well formed. In particular,
there must be a way to order the modules in a program such that each
only refers to things defined <strong>before</strong> it in the ordering. That
doesnt mean the modules have to be given textually in that order in
the source text. Dafny will
figure out that order for you, assuming you havent made any circular
references. For example, this is pretty clearly meaningless:</p>

<pre><code class="language-dafny">import A = B
import B = A // error: circular
</code></pre>

<p>You can have import statements at the toplevel and you can import
modules defined at the same level:</p>

<pre><code class="language-dafny">import A = B
method m() {
  A.whatever();
}
module B { ... }
</code></pre>

<p>In this case, everything is well defined because we can put <code>B</code> first,
followed by the <code>A</code> import, and then finally <code>m()</code>. If there is no
permitted ordering, then Dafny will give an error, complaining about a cyclic
dependency.</p>

<p>Note that when rearranging modules and imports, they have to be kept
in the same containing module, which disallows some pathological
module structures. Also, the imports and submodules are always
considered to be before their containing module, even at the toplevel. This means that the
following is not well formed:</p>

<pre><code class="language-dafny">method doIt() { }
module M {
  method m() {
    doIt(); // error: M precedes doIt
  }
}
</code></pre>

<p>because the module <code>M</code> must come before any other kind of members, such
as methods. To define global functions like this, you can put them in
a module (called <code>Globals</code>, say) and open it into any module that needs
its functionality. Finally, if you import via a path, such as <code>import A
= B.C</code>, then this creates a dependency of <code>A</code> on <code>B</code>, and <code>B</code> itself
depends on its own nested module <code>B.C</code>.</p>

<h3 id="sec-name-resolution">4.8. Name Resolution</h3>

<p>When Dafny sees something like <code>A&lt;T&gt;.B&lt;U&gt;.C&lt;V&gt;</code>, how does it know what each part
refers to? The process Dafny uses to determine what identifier
sequences like this refer to is name resolution. Though the rules may
seem complex, usually they do what you would expect. Dafny first looks
up the initial identifier. Depending on what the first identifier
refers to, the rest of the identifier is looked up in the appropriate
context.</p>

<p>In terms of the grammar, sequences like the above are represented as
a <code>NameSegment</code> followed by 0 or more <code>Suffix</code>es.
The form shown above contains three instances of
<code>AugmentedDotSuffix_</code>.</p>

<p>The resolution is different depending on whether it is in
a module context, an expression context or a type context.</p>

<h4 id="481-modules-and-name-spaces">4.8.1. Modules and name spaces</h4>

<p>A module is a collection of declarations, each of which has a name.
These names are held in two namespaces.</p>

<ul>
  <li>The names of export sets</li>
  <li>The names of all other declarations, including submodules and aliased modules</li>
</ul>

<p>In addition names can be classified as <em>local</em> or <em>imported</em>.</p>

<ul>
  <li>Local declarations of a module are the declarations
 that are explicit in the module and the
local declarations of the refinement parent. This includes, for
example, the <code>N</code> of <code>import N = </code> in the refinement parent, recursively.</li>
  <li>Imported names of a module are those brought in by <code>import opened</code> plus
the imported names in the refinement parent.</li>
</ul>

<p>Within each namespace, the local names are unique. Thus a module may
not reuse a name that a refinement parent has declared (unless it is a
refining declaration, which replaces both declarations, as described
in <a href="#sec-modiu;e-refinement">Section 0</a>).</p>

<p>Local names take precedence over imported names. If a name is used more than
once among imported names (coming from different imports), then it is
ambiguous to <em>use</em> the name without qualification.</p>

<h4 id="482-module-id-context-name-resolution">4.8.2. Module Id Context Name Resolution</h4>

<p>A qualified name may be used to refer to a module in an import statement or a refines clause of a module declaration.
Such a qualified name is resolved as follows, with respect to its syntactic
location within a module <code>Z</code>:</p>

<ol>
  <li>
    <p>The leading <code>NameSegment</code> is resolved as a local or imported module name of <code>Z</code>, if there
is one with a matching name. The target of a <code>refines</code> clause does not
consider local names, that is, in <code>module Z refines A.B.C</code>, any contents of <code>Z</code>
are not considered in finding <code>A</code>.</p>
  </li>
  <li>
    <p>Otherwise, it is resolved as a local or imported module name of the most enclosing module of <code>Z</code>,
iterating outward to each successive enclosing module until a match is
found or the default toplevel module is reached without a match.
No consideration of export sets, default or otherwise, is used in this step.
However, if at any stage a matching name is found that is not a module
declaration, the resolution fails. See the examples below.</p>
  </li>
</ol>

<p>2a. Once the leading <code>NameSegment</code> is resolved as say module <code>M</code>, the next <code>NameSegment</code>
   is resolved as a local or imported  module name within <code>M</code>
   The resolution is restricted to the default export set of <code>M</code>.</p>

<p>2b. If the resolved module name is a module alias (from an <code>import</code> statement)
   then the target of the alias is resolved as a new qualified name
   with respect to its syntactic context (independent of any resolutions or
modules so far). Since <code>Z</code> depends on <code>M</code>, any such alias target will
already have been resolved, because modules are resolved in order of
dependency.</p>

<ol>
  <li>Step 2 is iterated for each <code>NameSegment</code> in the qualified module id,
resulting in a module that is the final resolution of the complete
qualified id.</li>
</ol>

<p>Ordinarily a module must be <em>imported</em> in order for its constituent
declarations to be visible inside a given module <code>M</code>. However, for the
resolution of qualified names this is not the case.</p>

<p>This example shows that the resolution of the refinement parent does not
use any local names:</p>
<pre><code class="language-dafny">module A {
  const a := 10
}

module B refines A { // the top-level A, not the submodule A
  module A { const a := 30 }
  method m() { assert a == 10; } // true
}

</code></pre>
<p>In the example, the <code>A</code> in <code>refines A</code> refers to the global <code>A</code>, not the submodule <code>A</code>.</p>

<p>A module is a collection of declarations, each of which has a name.
These names are held in two namespaces.</p>

<ul>
  <li>The names of export sets</li>
  <li>The names of all other declarations, including submodules and aliased modules</li>
</ul>

<p>In addition names can be classified as <em>local</em> or <em>imported</em>.</p>

<ul>
  <li>Local declarations of a module are the declarations
 that are explicit in the module and the
local declarations of the refinement parent. This includes, for
example, the <code>N</code> of <code>import N = </code> in the refinement parent, recursively.</li>
  <li>Imported names of a module are those brought in by <code>import opened</code> plus
the imported names in the refinement parent.</li>
</ul>

<p>Within each namespace, the local names are unique. Thus a module may
not reuse a name that a refinement parent has declared (unless it is a
refining declaration, which replaces both declarations, as described
in <a href="#sec-module-refinement">Section 21</a>).</p>

<p>Local names take precedence over imported names. If a name is used more than
once among imported names (coming from different imports), then it is
ambiguous to <em>use</em> the name without qualification, unless they refer to the
same entity or to equal types.</p>

<h4 id="483-module-id-context-name-resolution">4.8.3. Module Id Context Name Resolution</h4>

<p>A qualified name may be used to refer to a module in an import statement or a refines clause of a module declaration.
Such a qualified name is resolved as follows, with respect to its syntactic
location within a module <code>Z</code>:</p>

<ol>
  <li>
    <p>The leading <code>NameSegment</code> is resolved as a local or imported module name of <code>Z</code>, if there
is one with a matching name. The target of a <code>refines</code> clause does not
consider local names, that is, in <code>module Z refines A.B.C</code>, any contents of <code>Z</code>
are not considered in finding <code>A</code>.</p>
  </li>
  <li>
    <p>Otherwise, it is resolved as a local or imported module name of the most enclosing module of <code>Z</code>,
iterating outward to each successive enclosing module until a match is
found or the default toplevel module is reached without a match.
No consideration of export sets, default or otherwise, is used in this step.
However, if at any stage a matching name is found that is not a module
declaration, the resolution fails. See the examples below.</p>
  </li>
</ol>

<p>2a. Once the leading <code>NameSegment</code> is resolved as say module <code>M</code>, the next <code>NameSegment</code>
   is resolved as a local or imported  module name within <code>M</code>
   The resolution is restricted to the default export set of <code>M</code>.</p>

<p>2b. If the resolved module name is a module alias (from an <code>import</code> statement)
   then the target of the alias is resolved as a new qualified name
   with respect to its syntactic context (independent of any resolutions or
modules so far). Since <code>Z</code> depends on <code>M</code>, any such alias target will
already have been resolved, because modules are resolved in order of
dependency.</p>

<ol>
  <li>Step 2 is iterated for each <code>NameSegment</code> in the qualified module id,
resulting in a module that is the final resolution of the complete
qualified id.</li>
</ol>

<p>Ordinarily a module must be <em>imported</em> in order for its constituent
declarations to be visible inside a given module <code>M</code>. However, for the
resolution of qualified names this is not the case.</p>

<p>Ths example shows that the resolution of the refinement parent does not
use any local names:</p>
<pre><code class="language-dafny">module A {
  const a := 10
}

module B refines A { // the top-level A, not the submodule A
  module A { const a := 30 }
  method m() { assert a == 10; } // true
}

</code></pre>
<p>The <code>A</code> in <code>refines A</code> refers to the submodule <code>A</code>, not the global <code>A</code>.</p>

<h4 id="484-expression-context-name-resolution">4.8.4. Expression Context Name Resolution</h4>

<p>The leading <code>NameSegment</code> is resolved using the first following
rule that succeeds.</p>

<ol>
  <li>
    <p>Local variables, parameters and bound variables. These are things like
<code>x</code>, <code>y</code>, and <code>i</code> in <code>var x;, ... returns (y: int)</code>, and
<code>forall i :: ....</code> The declaration chosen is the match from the
innermost matching scope.</p>
  </li>
  <li>
    <p>If in a class, try to match a member of the class. If the member that
is found is not static an implicit <code>this</code> is inserted. This works for
fields, functions, and methods of the current class (if in a static
context, then only static methods and functions are allowed). You can
refer to fields of the current class either as <code>this.f</code> or <code>f</code>,
assuming of course that <code>f</code> is not hidden by one of the above. You
can always prefix <code>this</code> if needed, which cannot be hidden. (Note, a
field whose name is a string of digits must always have some prefix.)</p>
  </li>
  <li>
    <p>If there is no <code>Suffix</code>, then look for a datatype constructor, if
unambiguous. Any datatypes that dont need qualification (so the
datatype name itself doesnt need a prefix) and also have a uniquely
named constructor can be referred to just by name.  So if
<code>datatype List = Cons(List) | Nil</code> is the only datatype that declares
<code>Cons</code> and <code>Nil</code> constructors, then you can write <code>Cons(Cons(Nil))</code>.
If the constructor name is not unique, then you need to prefix it with
the name of the datatype (for example <code>List.Cons(List.Nil)))</code>. This is
done per constructor, not per datatype.</p>
  </li>
  <li>
    <p>Look for a member of the enclosing module.</p>
  </li>
  <li>
    <p>Module-level (static) functions and methods</p>
  </li>
</ol>

<p>TODO: Not sure about the following paragraph.
In each module, names from opened modules are also potential matches, but
only after names declared in the module.
If a ambiguous name is found or  name of the wrong kind (e.g. a module
instead of an expression identifier), an error is generated, rather than continuing
down the list.</p>

<p>After the first identifier, the rules are basically the
same, except in the new context. For example, if the first identifier is
a module, then the next identifier looks into that module. Opened modules
only apply within the module it is opened into. When looking up into
another module, only things explicitly declared in that module are
considered.</p>

<p>To resolve expression <code>E.id</code>:</p>

<p>First resolve expression E and any type arguments.</p>

<ul>
  <li>If <code>E</code> resolved to a module <code>M</code>:
    <ol>
      <li>If <code>E.id&lt;T&gt;</code> is not followed by any further suffixes, look for
unambiguous datatype constructor.</li>
      <li>Member of module M: a sub-module (including submodules of imports),
class, datatype, etc.</li>
      <li>Static function or method.</li>
    </ol>
  </li>
  <li>If <code>E</code> denotes a type:
    <ol>
      <li>Look up id as a member of that type</li>
    </ol>
  </li>
  <li>If <code>E</code> denotes an expression:
    <ol>
      <li>Let T be the type of E. Look up id in T.</li>
    </ol>
  </li>
</ul>

<h4 id="485-type-context-name-resolution">4.8.5. Type Context Name Resolution</h4>

<p>In a type context the priority of <code>NameSegment</code> resolution is:</p>

<ol>
  <li>
    <p>Type parameters.</p>
  </li>
  <li>
    <p>Member of enclosing module (type name or the name of a module).</p>
  </li>
</ol>

<p>To resolve expression <code>E.id</code>:</p>

<ul>
  <li>If <code>E</code> resolved to a module <code>M</code>:
    <ol>
      <li>Member of module M: a sub-module (including submodules of imports),
class, datatype, etc.</li>
    </ol>
  </li>
  <li>If <code>E</code> denotes a type:
    <ol>
      <li>If <code>allowDanglingDotName</code>: Return the type of <code>E</code> and the given <code>E.id</code>,
letting the caller try to make sense of the final dot-name.
TODO: I dont under this sentence. What is <code>allowDanglingDotName</code>?</li>
    </ol>
  </li>
</ul>

<!--PDF NEWPAGE-->
<h2 id="5-specifications">5. Specifications</h2>
<p>Specifications describe logical properties of Dafny methods, functions,
lambdas, iterators and loops. They specify preconditions, postconditions,
invariants, what memory locations may be read or modified, and
termination information by means of <em>specification clauses</em>.
For each kind of specification, zero or more specification
clauses (of the type accepted for that type of specification)
may be given, in any order.</p>

<p>We document specifications at these levels:</p>

<ul>
  <li>At the lowest level are the various kinds of specification clauses,
e.g., a <code>RequiresClause</code>.</li>
  <li>Next are the specifications for entities that need them,
e.g., a <code>MethodSpec</code>, which typically consist of a sequence of
specification clauses.</li>
  <li>At the top level are the entity declarations that include
the specifications, e.g., <code>MethodDecl</code>.</li>
</ul>

<p>This section documents the first two of these in a bottom-up manner.
We first document the clauses and then the specifications
that use them.</p>

<h3 id="51-specification-clauses">5.1. Specification Clauses</h3>

<h4 id="sec-requires-clause">5.1.1. Requires Clause</h4>

<pre><code class="language-grammar">RequiresClause(allowLabel) =
  "requires" { Attribute }
  [ LabelName ":" ]  // Label allowed only if allowLabel is true
  Expression(allowLemma: false, allowLambda: false)
</code></pre>

<p>The <code>requires</code> clauses specify preconditions for methods,
functions, lambda expressions and iterators. Dafny checks
that the preconditions are met at all call sites. The
callee may then assume the preconditions hold on entry.</p>

<p>If no <code>requires</code> clause is specified it is taken to be <code>true</code>.</p>

<p>If more than one <code>requires</code> clause is given, then the
precondition is the conjunction of all of the expressions
from all of the <code>requires</code> clauses, with a collected list
of all the given Attributes. The order of conjunctions
(and hence the order of <code>requires</code> clauses with respect to each other)
can be important: earlier conjuncts can set conditions that
establish that later conjuncts are well-defined.</p>

<h4 id="sec-ensures-clause">5.1.2. Ensures Clause</h4>

<pre><code class="language-grammar">EnsuresClause(allowLambda) =
  "ensures" { Attribute } Expression(allowLemma: false,
                                     allowLambda)
</code></pre>

<p>An <code>ensures</code> clause specifies the post condition for a
method, function or iterator.</p>

<p>If no <code>ensures</code> clause is specified it is taken to be <code>true</code>.</p>

<p>If more than one <code>ensures</code> clause is given, then the
postcondition is the conjunction of all of the expressions
from all of the <code>ensures</code> clauses, with a
collected list of all the given Attributes.
The order of conjunctions
(and hence the order of <code>ensures</code> clauses with respect to each other)
can be important: earlier conjuncts can set conditions that
establish that later conjuncts are well-defined.</p>

<p>Within an ensures clause, you can of course make use of
<a href="#sec-list-of-specification-expressions">specification expressions</a> along with any <a href="#sec-expressions">other expressions</a> you need.</p>

<h4 id="sec-decreases-clause">5.1.3. Decreases Clause</h4>
<pre><code class="language-grammar">DecreasesClause(allowWildcard, allowLambda) =
  "decreases" { Attribute } DecreasesList(allowWildcard,
                                          allowLambda)

DecreasesList(allowWildcard, allowLambda) =
  PossiblyWildExpression(allowLambda, allowWildcard)
  { "," PossiblyWildExpression(allowLambda, allowWildcard) }

PossiblyWildExpression(allowLambda, allowWild) =
  ( "*"  // if allowWild is false, using '*' provokes an error
  | Expression(allowLemma: false, allowLambda)
  )
</code></pre>
<p>If <code>allowWildcard</code> is false but one of the
<code>PossiblyWildExpression</code>s is a wild-card, an error is
reported.</p>

<p>Decreases clauses are used to prove termination in the
presence of recursion. If more than one <code>decreases</code> clause is given
it is as if a single <code>decreases</code> clause had been given with the
collected list of arguments and a collected list of Attributes. That is,</p>

<pre><code class="language-dafny">decreases A, B
decreases C, D
</code></pre>

<p>is equivalent to</p>

<pre><code class="language-dafny">decreases A, B, C, D
</code></pre>
<p>Note that changing the order of multiple <code>decreases</code> clauses will change
the order of the expressions within the equivalent single <code>decreases</code>
clause, and will therefore have different semantics.</p>

<p>Loops and compiled methods (but not functions and not ghost methods,
including lemmas) can be specified to be possibly non-terminating.
This is done by declaring the method or loop with <code>decreases *</code>, which
causes the proof of termination to be skipped. If a <code>*</code> is present
in a <code>decreases</code> clause, no other expressions are allowed in the
<code>decreases</code> clause. A method that contains a possibly non-terminating
loop or a call to a possibly non-terminating method must itself be
declared as possibly non-terminating.</p>

<p>Termination metrics in Dafny, which are declared by <code>decreases</code> clauses,
are lexicographic tuples of expressions. At each recursive (or mutually
recursive) call to a function or method, Dafny checks that the effective
<code>decreases</code> clause of the callee is strictly smaller than the effective
<code>decreases</code> clause of the caller.</p>

<p>What does strictly smaller mean? Dafny provides a built-in
 well-founded order for every type and, in some cases, between types. For
 example, the Boolean false is strictly smaller than true, the
 integer 78 is strictly smaller than 102, the set <code>{2,5}</code> is strictly
 smaller than the set <code>{2,3,5}</code>, and for s of type <code>seq&lt;Color&gt;</code> where
 <code>Color</code> is some inductive datatype, the color <code>s[0]</code> is strictly less than
 <code>s</code> (provided <code>s</code> is nonempty).</p>

<p>What does effective decreases clause mean? Dafny always appends a
top element to the lexicographic tuple given by the user. This top
element cannot be syntactically denoted in a Dafny program and it never
occurs as a run-time value either. Rather, it is a fictitious value,
which here we will denote <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mi" id="MathJax-Span-3" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-1">\top</script>, such that each value that can ever occur
in a Dafny program is strictly less than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mi" id="MathJax-Span-6" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-2">\top</script>. Dafny sometimes also
prepends expressions to the lexicographic tuple given by the user. The
effective decreases clause is any such prefix, followed by the
user-provided decreases clause, followed by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-7" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-8"><span class="mi" id="MathJax-Span-9" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-3">\top</script>. We said user-provided
decreases clause, but if the user completely omits a <code>decreases</code> clause,
then Dafny will usually make a guess at one, in which case the effective
decreases clause is any prefix followed by the guess followed by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-10" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-11"><span class="mi" id="MathJax-Span-12" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-4">\top</script>.</p>

<p>Here is a simple but interesting example: the Fibonacci function.</p>

<pre><code class="language-dafny">function Fib(n: nat) : nat
{
  if n &lt; 2 then n else Fib(n-2) + Fib(n-1)
}

</code></pre>

<p>In this example, Dafny supplies a <code>decreases n</code> clause.</p>

<p>Lets take a look at the kind of example where a mysterious-looking
decreases clause like Rank, 0 is useful.</p>

<p>Consider two mutually recursive methods, <code>A</code> and <code>B</code>:</p>
<pre><code class="language-dafny">method A(x: nat)
{
  B(x);
}

method B(x: nat)
{
  if x != 0 { A(x-1); }
}
</code></pre>

<p>To prove termination of <code>A</code> and <code>B</code>, Dafny needs to have effective
decreases clauses for A and B such that:</p>

<ul>
  <li>
    <p>the measure for the callee <code>B(x)</code> is strictly smaller than the measure
for the caller <code>A(x)</code>, and</p>
  </li>
  <li>
    <p>the measure for the callee <code>A(x-1)</code> is strictly smaller than the measure
for the caller <code>B(x)</code>.</p>
  </li>
</ul>

<p>Satisfying the second of these conditions is easy, but what about the
first? Note, for example, that declaring both <code>A</code> and <code>B</code> with decreases x
does not work, because that wont prove a strict decrease for the call
from <code>A(x)</code> to <code>B(x)</code>.</p>

<p>Heres one possibility (for brevity, we will omit the method bodies):</p>
<pre><code class="language-dafny">method A(x: nat)
  decreases x, 1

method B(x: nat)
  decreases x, 0
</code></pre>

<p>For the call from <code>A(x)</code> to <code>B(x)</code>, the lexicographic tuple <code>"x, 0"</code> is
strictly smaller than <code>"x, 1"</code>, and for the call from <code>B(x)</code> to <code>A(x-1)</code>, the
lexicographic tuple <code>"x-1, 1"</code> is strictly smaller than <code>"x, 0"</code>.</p>

<p>Two things to note: First, the choice of 0 and 1 as the second
 components of these lexicographic tuples is rather arbitrary. It could
 just as well have been false and true, respectively, or the sets
 <code>{2,5}</code> and <code>{2,3,5}</code>. Second, the keyword <code>decreases</code> often gives rise to
 an intuitive English reading of the declaration. For example, you might
 say that the recursive calls in the definition of the familiar Fibonacci
 function <code>Fib(n)</code> decreases n. But when the lexicographic tuple contains
 constants, the English reading of the declaration becomes mysterious and
 may give rise to questions like how can you decrease the constant 0?.
 The keyword is just thata keyword. It says here comes a list of
 expressions that make up the lexicographic tuple we want to use for the
 termination measure. What is important is that one effective decreases
 clause is compared against another one, and it certainly makes sense to
 compare something to a constant (and to compare one constant to
 another).</p>

<p>We can simplify things a little bit by remembering that Dafny appends
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-13" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-14"><span class="mi" id="MathJax-Span-15" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-5">\top</script> to the user-supplied decreases clause. For the A-and-B example,
 this lets us drop the constant from the <code>decreases</code> clause of A:</p>

<pre><code class="language-dafny">method A(x: nat)
   decreases x

method B(x: nat)
  decreases x, 0
</code></pre>

<p>The effective decreases clause of <code>A</code> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-16" style="width: 3.101em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.574em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.48em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-17"><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-19" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-21" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">(x, \top)</script> and the effective
decreases clause of <code>B</code> is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-23" style="width: 4.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.519em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1003.42em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-24"><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-26" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-30" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-7">(x, 0, \top)</script>. These tuples still satisfy the two
conditions <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" style="width: 8.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.405em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1007.31em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="mo" id="MathJax-Span-34" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-35" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-37" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-41" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-45" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo><mo>&lt;</mo><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">(x, 0, \top) < (x, \top)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 10.874em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.139em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1009.04em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mo" id="MathJax-Span-49" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-52" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-55" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-56" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-59" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-60" style="font-family: MathJax_Main; padding-left: 0.167em;">0</span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>1</mn><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo><mo>&lt;</mo><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mn>0</mn><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">(x-1, \top) < (x, 0, \top)</script>. And
as before, the constant 0 is arbitrary; anything less than <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-64" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-65"><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-10">\top</script> (which
is any Dafny expression) would work.</p>

<p>Lets take a look at one more example that better illustrates the utility
of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-67" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-68"><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-11">\top</script>. Consider again two mutually recursive methods, call them <code>Outer</code>
and <code>Inner</code>, representing the recursive counterparts of what iteratively
might be two nested loops:</p>
<pre><code class="language-dafny">method Outer(x: nat)
{
  // set y to an arbitrary non-negative integer
  var y :| 0 &lt;= y;
  Inner(x, y);
}

method Inner(x: nat, y: nat)
{
  if y != 0 {
    Inner(x, y-1);
  } else if x != 0 {
    Outer(x-1);
  }
}
</code></pre>
<p>The body of <code>Outer</code> uses an assign-such-that statement to represent some
computation that takes place before <code>Inner</code> is called. It sets y to some
arbitrary non-negative value. In a more concrete example, <code>Inner</code> would do
some work for each y and then continue as <code>Outer</code> on the next smaller
x.</p>

<p>Using a <code>decreases</code> clause <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-70" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-71"><span class="mo" id="MathJax-Span-72" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-73" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-74" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-75" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-76" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">(x, y)</script> for <code>Inner</code> seems natural, but if
we dont have any bound on the size of the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-77" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">y</script> computed by <code>Outer</code>,
there is no expression we can write in the <code>decreases</code> clause of <code>Outer</code>
that is sure to lead to a strictly smaller value for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">y</script> when <code>Inner</code>
is called. <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-15">\top</script> to the rescue. If we arrange for the effective
decreases clause of <code>Outer</code> to be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 3.101em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.574em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.48em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-92" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">(x, \top)</script> and the effective decreases
clause for <code>Inner</code> to be <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 4.204em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.519em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1003.42em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-97" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-99" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-100" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-101" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-17">(x, y, \top)</script>, then we can show the strict
decreases as required. Since <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-102" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-18">\top</script> is implicitly appended, the two
decreases clauses declared in the program text can be:</p>
<pre><code class="language-dafny">method Outer(x: nat)
  decreases x

method Inner(x: nat, y: nat)
  decreases x, y
</code></pre>
<p>Moreover, remember that if a function or method has no user-declared
<code>decreases</code> clause, Dafny will make a guess. The guess is (usually)
the list of arguments of the function/method, in the order given. This is
exactly the decreases clauses needed here. Thus, Dafny successfully
verifies the program without any explicit <code>decreases</code> clauses:</p>
<pre><code class="language-dafny">method Outer(x: nat)
{
  var y :| 0 &lt;= y;
  Inner(x, y);
}

method Inner(x: nat, y: nat)
{
  if y != 0 {
    Inner(x, y-1);
  } else if x != 0 {
    Outer(x-1);
  }
}
</code></pre>
<p>The ingredients are simple, but the end result may seem like magic. 
For many users, however, there may be no magic at all  the end result 
may be so natural that the user never even has to be bothered to think 
about that there was a need to prove termination in the first place.</p>

<p>TODO: Should there be user-level syntax to invoke this termination ordering</p>

<h4 id="sec-frame-expression">5.1.4. Framing</h4>
<pre><code class="language-grammar">FrameExpression(allowLemma, allowLambda) =
  ( Expression(allowLemma, allowLambda) [ FrameField ]
  | FrameField
  )

FrameField = "`" IdentOrDigits

PossiblyWildFrameExpression(allowLemma, allowLambda, allowWild) =
  ( "*"  // error if !allowWild and '*'
  | FrameExpression(allowLemma, allowLambda)
  )
</code></pre>

<p>Frame expressions are used to denote the set of memory locations
that a Dafny program element may read or write. A frame
expression is a set expression. The form <code>{}</code> (that is, the empty set)
says that no memory locations may be modified,
which is also the default if no <code>modifies</code> clause is given explicitly.</p>

<p>Note that framing only applies to the heap, or memory accessed through
references. Local variables are not stored on the heap, so they cannot be
mentioned (well, they are not in scope in the declaration) in reads
annotations. Note also that types like sets, sequences, and multisets are
value types, and are treated like integers or local variables. Arrays and
objects are reference types, and they are stored on the heap (though as
always there is a subtle distinction between the reference itself and the
value it points to.)</p>

<p>The <code>FrameField</code> construct is used to specify a field of a
class object. The identifier following the back-quote is the
name of the field being referenced.
If the <code>FrameField</code> is preceded by an expression the expression
must be a reference to an object having that field.
If the <code>FrameField</code> is not preceded by an expression then
the frame expression is referring to that field of the current
object. This form is only used within a method of a class or trait.</p>

<p>The use of <code>FrameField</code> is discouraged as in practice it has not
been shown to either be more concise or to perform better.
Also, theres (unfortunately) no form of it for array
elementsone could imagine</p>

<pre><code class="language-dafny">  modifies a`[j]
</code></pre>
<p>Also, <code>FrameField</code> is not taken into consideration for
lambda expressions.</p>

<h4 id="sec-reads-clause">5.1.5. Reads Clause</h4>
<pre><code class="language-grammar">ReadsClause(allowLemma, allowLambda, allowWild) =
  "reads"
  { Attribute }
  PossiblyWildFrameExpression(allowLemma, allowLambda, allowWild)
  { "," PossiblyWildFrameExpression(allowLemma, allowLambda, allowWild) }
</code></pre>

<p>Functions are not allowed to have side effects; they may also be restricted in
what they can read. The <em>reading frame</em> of a function (or predicate) is all
the memory locations that the function is allowed to read. The reason we
might limit what a function can read is so that when we write to memory,
we can be sure that functions that did not read that part of memory have
the same value they did before. For example, we might have two arrays,
one of which we know is sorted. If we did not put a reads annotation on
the sorted predicate, then when we modify the unsorted array, we cannot
determine whether the other array stopped being sorted. While we might be
able to give invariants to preserve it in this case, it gets even more
complex when manipulating data structures. In this case, framing is
essential to making the verification process feasible.</p>

<p>It is not just the body of a function that is subject to <code>reads</code>
checks, but also its precondition and the <code>reads</code> clause itself.</p>

<p>A <code>reads</code> clause can list a wildcard <code>*</code>, which allows the enclosing
function to read anything. In many cases, and in particular in all cases
where the function is defined recursively, this makes it next to
impossible to make any use of the function. Nevertheless, as an
experimental feature, the language allows it (and it is sound).
If a <code>reads</code> clause uses <code>*</code>, then the <code>reads</code> clause is not allowed to
mention anything else (since anything else would be irrelevant, anyhow).</p>

<p>A <code>reads</code> clause specifies the set of memory locations that a function,
lambda, or iterator may read. If more than one <code>reads</code> clause is given
in a specification the effective read set is the union of the sets
specified. If there are no <code>reads</code> clauses the effective read set is
empty. If <code>*</code> is given in a <code>reads</code> clause it means any memory may be
read.</p>

<p>TO BE WRITTEN: multiset of objects allowed in reads clauses</p>

<h4 id="sec-modifies-clause">5.1.6. Modifies Clause</h4>

<pre><code class="language-grammar">ModifiesClause(allowLambda) =
  "modifies" { Attribute }
  FrameExpression(allowLemma: false, allowLambda)
  { "," FrameExpression(allowLemma: false, allowLambda) }
</code></pre>

<p>Frames also affect methods. Methods are not
required to list the things they read. Methods are allowed to read
whatever memory they like, but they are required to list which parts of
memory they modify, with a <code>modifies</code> annotation. These are almost identical
to their <code>reads</code> cousins, except they say what can be changed, rather than
what the value of the function depends on. In combination with reads,
modification restrictions allow Dafny to prove properties of code that
would otherwise be very difficult or impossible. Reads and modifies are
one of the tools that allow Dafny to work on one method at a time,
because they restrict what would otherwise be arbitrary modifications of
memory to something that Dafny can reason about.</p>

<p>If an object is newly allocated within the body of a method
or within the scope of a <code>modifies</code> statement or a loops <code>modifies</code> clause,
 then the fields of that object may always be modified.</p>

<p>It is also possible to frame what can be modified by a block statement
by means of the block form of the
<code>modify</code> statement (cf. <a href="#sec-modify-statement">Section 19.22</a>).</p>

<p>A <code>modifies</code> clause specifies the set of memory locations that a
method, iterator or loop body may modify. If more than one <code>modifies</code>
clause is given in a specification, the effective modifies set is the
union of the sets specified. If no <code>modifies</code> clause is given the
effective modifies set is empty. A loop can also have a
<code>modifies</code> clause. If none is given, the loop may modify anything
the enclosing context is allowed to modify.</p>

<p>Note that <em>modifies</em> here is used in the sense of <em>writes</em>. That is, a field
that may not be modified may not be written to, even with the same value it
already has or even if the value is restored later. The terminology and
semantics varies among specification languages. Some define frame conditions
in this sense (a) of <em>writes</em> and others in the sense (b) that allows writing
a field with the same value or changing the value so long as the original
value is restored by the end of the scope. For example, JML defines
<code>assignable</code> and <code>modifies</code> as synonyms in the sense (a), though KeY
interprets JMLs <code>assigns/modifies</code> in sense (b).
ACSL and ACSL++ use the <code>assigns</code> keyword, but with <em>modify</em> (b) semantics.
Ada/SPARKs dataflow contracts encode <em>write</em> (a) semantics.</p>

<h4 id="sec-invariant-clause">5.1.7. Invariant Clause</h4>
<pre><code class="language-grammar">InvariantClause_ =
  "invariant" { Attribute }
  Expression(allowLemma: false, allowLambda: true)
</code></pre>

<p>An <code>invariant</code> clause is used to specify an invariant
for a loop. If more than one <code>invariant</code> clause is given for
a loop the effective invariant is the conjunction of
the conditions specified.</p>

<p>The invariant must hold on entry to the loop. And assuming it
is valid on entry, Dafny must be able to prove that it then
holds at the end of the loop.</p>

<h3 id="sec-method-specification">5.2. Method Specification</h3>
<pre><code class="language-grammar">MethodSpec =
  { ModifiesClause(allowLambda: false)
  | RequiresClause(allowLabel: true)
  | EnsuresClause(allowLambda: false)
  | DecreasesClause(allowWildcard: true, allowLambda: false)
  }
</code></pre>

<p>A method specification is zero or more <code>modifies</code> <code>requires</code>
<code>ensures</code> or <code>decreases</code> clauses, in any order.
A method does not have <code>reads</code> clauses because methods are allowed to
read any memory.</p>

<h3 id="sec-function-specification">5.3. Function Specification</h3>
<pre><code class="language-grammar">FunctionSpec =
  { RequiresClause(allowLabel: true)
  | ReadsClause(allowLemma: false, allowLambda: false,
                                   allowWild: true)
  | EnsuresClause(allowLambda: false)
  | DecreasesClause(allowWildcard: false, allowLambda: false)
  }
</code></pre>

<p>A function specification is zero or more <code>reads</code> <code>requires</code>
<code>ensures</code> or <code>decreases</code> clauses, in any order. A function
specification does not have <code>modifies</code> clauses because functions are not
allowed to modify any memory.</p>

<h3 id="sec-lambda-specification">5.4. Lambda Specification</h3>
<pre><code class="language-grammar">LambdaSpec =
  { ReadsClause(allowLemma: true, allowLambda: false,
                                  allowWild: true)
  | RequiresClause(allowLabel: false)
  }
</code></pre>
<p>// TODO - the above grammar is not quite right for Requires</p>

<p>A lambda specification is zero or more <code>reads</code> or <code>requires</code> clauses.
Lambda specifications do not have <code>ensures</code> clauses because the body
is never opaque.
Lambda specifications do not have <code>decreases</code>
clauses because they do not have names and thus cannot be recursive. A
lambda specification does not have <code>modifies</code> clauses because lambdas
are not allowed to modify any memory.</p>

<h3 id="sec-iterator-specification">5.5. Iterator Specification</h3>
<pre><code class="language-grammar">IteratorSpec =
  { ReadsClause(allowLemma: false, allowLambda: false,
                                  allowWild: false)
  | ModifiesClause(allowLambda: false)
  | [ "yield" ] RequiresClause(allowLabel: !isYield)
  | [ "yield" ] EnsuresClause(allowLambda: false)
  | DecreasesClause(allowWildcard: false, allowLambda: false)
  }
</code></pre>

<p>An iterator specification applies both to the iterators constructor
method and to its <code>MoveNext</code> method. The <code>reads</code> and <code>modifies</code>
clauses apply to both of them. For the <code>requires</code> and <code>ensures</code>
clauses, if <code>yield</code> is not present they apply to the constructor,
but if <code>yield</code> is present they apply to the <code>MoveNext</code> method.</p>

<p>TODO: What is the meaning of a <code>decreases</code> clause on an iterator?
Does it apply to <code>MoveNext</code>? Make sure our description of
iterators explains these.</p>

<p>TODO: What is the relationship between the post condition and
the <code>Valid()</code> predicate?</p>

<h3 id="56-loop-specification">5.6. Loop Specification</h3>
<pre><code class="language-grammar">LoopSpec =
  { InvariantClause_
  | DecreasesClause(allowWildcard: true, allowLambda: true)
  | ModifiesClause(allowLambda: true)
  }
</code></pre>

<p>A loop specification provides the information Dafny needs to
prove properties of a loop. The <code>InvariantClause_</code> clause
is effectively a precondition and it along with the
negation of the loop test condition provides the postcondition.
The <code>DecreasesClause</code> clause is used to prove termination.</p>

<h3 id="57-auto-generated-boilerplate-specifications">5.7. Auto-generated boilerplate specifications</h3>

<p>TO BE WRITTEN - {:autocontracts}</p>

<!--PDF NEWPAGE-->
<h2 id="sec-types">6. Types</h2>
<pre><code class="language-grammar">Type = DomainType_ | ArrowType_
</code></pre>
<p>A Dafny type is a domain type (i.e., a type that can be the domain of an
arrow type) optionally followed by an arrow and a range type.</p>

<pre><code class="language-grammar">DomainType_ =
  ( BoolType_ | CharType_ | IntType_ | RealType_
  | OrdinalType_ | BitVectorType_ | ObjectType_
  | FiniteSetType_ | InfiniteSetType_
  | MultisetType_
  | FiniteMapType_ | InfiniteMapType_
  | SequenceType_
  | NatType_
  | StringType_
  | ArrayType_
  | TupleType
  | NamedType
  )
</code></pre>
<p>The domain types comprise the builtin scalar types, the builtin
collection types, tuple types (including as a special case
a parenthesized type) and reference types.</p>

<p>Dafny types may be categorized as either value types or reference types.</p>

<h3 id="61-value-types">6.1. Value Types</h3>
<p>The value types are those whose values do not lie in the program heap.
These are:</p>

<ul>
  <li>The basic scalar types: <code>bool</code>, <code>char</code>, <code>int</code>, <code>real</code>, <code>ORDINAL</code>, bitvector types</li>
  <li>The built-in collection types: <code>set</code>, <code>iset</code>, <code>multiset</code>, <code>seq</code>, <code>string</code>, <code>map</code>, <code>imap</code></li>
  <li>Tuple Types</li>
  <li>Inductive and co-inductive types</li>
  <li>Function (arrow) types</li>
  <li>Subset and newtypes that are based on value types</li>
</ul>

<p>Data items having value types are passed by value. Since they are not
considered to occupy <em>memory</em>, framing expressions do not reference them.</p>

<p>The <code>nat</code> type is a pre-defined <a href="#sec-subset-types">subset type</a> of <code>int</code>.</p>

<p>Dafny does not include types themselves as values, nor is there a type of types.</p>

<h3 id="sec-reference-types">6.2. Reference Types</h3>
<p>Dafny offers a host of <em>reference types</em>.  These represent
<em>references</em> to objects allocated dynamically in the program heap.  To
access the members of an object, a reference to (that is, a <em>pointer</em>
to or <em>object identity</em> of) the object is <em>dereferenced</em>.</p>

<p>The reference types are class types, traits and array types.
Dafny supports both reference types that contain the special <code>null</code> value
(<em>nullable types</em>) and reference types that do not (<em>non-null types</em>).</p>

<h3 id="63-named-types">6.3. Named Types</h3>
<pre><code class="language-grammar">NamedType = NameSegmentForTypeName { "." NameSegmentForTypeName }
</code></pre>

<p>A <code>NamedType</code> is used to specify a user-defined type by name
(possibly module-qualified). Named types are introduced by
class, trait, inductive, co-inductive, synonym and opaque
type declarations. They are also used to refer to type variables.</p>

<pre><code class="language-grammar">NameSegmentForTypeName = Ident [ GenericInstantiation ]
</code></pre>
<p>A <code>NameSegmentForTypeName</code> is a type name optionally followed by a
<code>GenericInstantiation</code>, which supplies type parameters to a generic
type, if needed. It is a special case of a <code>NameSegment</code>
(<a href="#sec-name-segment">Section 20.40</a>)
that does not allow a <code>HashCall</code>.</p>

<p>The following sections describe each of these kinds of types in more detail.</p>

<!--PDF NEWPAGE-->
<h2 id="7-basic-types">7. Basic types</h2>

<p>Dafny offers these basic types: <code>bool</code> for booleans, <code>char</code> for
characters, <code>int</code> and <code>nat</code> for integers, <code>real</code> for reals,
<code>ORDINAL</code>, and bit-vector types.</p>

<h3 id="sec-booleans">7.1. Booleans</h3>
<pre><code class="language-grammar">BoolType_ = "bool"
</code></pre>

<p>There are two boolean values and each has a corresponding literal in
the language:  <code>false</code> and <code>true</code>.</p>

<p>Type <code>bool</code> supports the following operations:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;==&gt;</code></td>
      <td>equivalence (if and only if)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>==&gt;</code></td>
      <td>implication (implies)</td>
    </tr>
    <tr>
      <td><code>&lt;==</code></td>
      <td>reverse implication (follows from)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>&amp;&amp;</code></td>
      <td>conjunction (and)</td>
    </tr>
    <tr>
      <td><code>||</code></td>
      <td>disjunction (or)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>==</code></td>
      <td>equality</td>
    </tr>
    <tr>
      <td><code>!=</code></td>
      <td>disequality</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>!</code></td>
      <td>negation (not)</td>
    </tr>
  </tbody>
</table>

<p>Negation is unary; the others are binary.  The table shows the operators
in groups of increasing binding power, with equality binding stronger
than conjunction and disjunction, and weaker than negation.  Within
each group, different operators do not associate, so parentheses need
to be used.  For example,</p>
<pre><code class="language-dafny">A &amp;&amp; B || C    // error
</code></pre>
<p>would be ambiguous and instead has to be written as either</p>
<pre><code class="language-dafny">(A &amp;&amp; B) || C
</code></pre>
<p>or</p>
<pre><code class="language-dafny">A &amp;&amp; (B || C)
</code></pre>
<p>depending on the intended meaning.</p>

<h4 id="sec-equivalence-operator">7.1.1. Equivalence Operator</h4>
<p>The expressions <code>A &lt;==&gt; B</code> and <code>A == B</code> give the same value, but note
that <code>&lt;==&gt;</code> is <em>associative</em> whereas <code>==</code> is <em>chaining</em> and they have
different precedence.  So,</p>
<pre><code class="language-dafny">A &lt;==&gt; B &lt;==&gt; C
</code></pre>
<p>is the same as</p>
<pre><code class="language-dafny">A &lt;==&gt; (B &lt;==&gt; C)
</code></pre>
<p>and</p>
<pre><code class="language-dafny">(A &lt;==&gt; B) &lt;==&gt; C
</code></pre>
<p>whereas</p>
<pre><code class="language-dafny">A == B == C
</code></pre>
<p>is simply a shorthand for</p>
<pre><code class="language-dafny">A == B &amp;&amp; B == C
</code></pre>

<h4 id="sec-conjunction-and-disjunction">7.1.2. Conjunction and Disjunction</h4>
<p>Conjunction and disjunction are associative.  These operators are
<em>short circuiting (from left to right)</em>, meaning that their second
argument is evaluated only if the evaluation of the first operand does
not determine the value of the expression.  Logically speaking, the
expression <code>A &amp;&amp; B</code> is defined when <code>A</code> is defined and either <code>A</code>
evaluates to <code>false</code> or <code>B</code> is defined.  When <code>A &amp;&amp; B</code> is defined, its
meaning is the same as the ordinary, symmetric mathematical
conjunction <code>&amp;</code>.  The same holds for <code>||</code> and <code>|</code>.</p>

<h4 id="sec-implication-and-reverse-implication">7.1.3. Implication and  Reverse Implication</h4>
<p>Implication is <em>right associative</em> and is short-circuiting from left
to right.  Reverse implication <code>B &lt;== A</code> is exactly the same as
<code>A ==&gt; B</code>, but gives the ability to write the operands in the opposite
order.  Consequently, reverse implication is <em>left associative</em> and is
short-circuiting from <em>right to left</em>.  To illustrate the
associativity rules, each of the following four lines expresses the
same property, for any <code>A</code>, <code>B</code>, and <code>C</code> of type <code>bool</code>:</p>
<pre><code class="language-dafny">A ==&gt; B ==&gt; C
A ==&gt; (B ==&gt; C) // parentheses redundant, ==&gt; is right associative
C &lt;== B &lt;== A
(C &lt;== B) &lt;== A // parentheses redundant, &lt;== is left associative
</code></pre>
<p>To illustrate the short-circuiting rules, note that the expression
<code>a.Length</code> is defined for an array <code>a</code> only if <code>a</code> is not <code>null</code> (see
<a href="#sec-reference-types">Section 6.2</a>), which means the following two
expressions are well-formed:</p>
<pre><code class="language-dafny">a != null ==&gt; 0 &lt;= a.Length
0 &lt;= a.Length &lt;== a != null
</code></pre>
<p>The contrapositives of these two expressions would be:</p>
<pre><code class="language-dafny">a.Length &lt; 0 ==&gt; a == null  // not well-formed
a == null &lt;== a.Length &lt; 0  // not well-formed
</code></pre>
<p>but these expressions are not well-formed, since well-formedness
requires the left (and right, respectively) operand, <code>a.Length &lt; 0</code>,
to be well-formed by itself.</p>

<p>Implication <code>A ==&gt; B</code> is equivalent to the disjunction <code>!A || B</code>, but
is sometimes (especially in specifications) clearer to read.  Since,
<code>||</code> is short-circuiting from left to right, note that</p>
<pre><code class="language-dafny">a == null || 0 &lt;= a.Length
</code></pre>
<p>is well-formed, whereas</p>
<pre><code class="language-dafny">0 &lt;= a.Length || a == null  // not well-formed
</code></pre>
<p>is not.</p>

<p>In addition, booleans support <em>logical quantifiers</em> (forall and
exists), described in <a href="#sec-quantifier-expression">Section 20.34</a>.</p>

<h3 id="sec-numeric-types">7.2. Numeric Types</h3>

<pre><code class="language-grammar">IntType_ = "int"
RealType_ = "real"
</code></pre>

<p>Dafny supports <em>numeric types</em> of two kinds, <em>integer-based</em>, which
includes the basic type <code>int</code> of all integers, and <em>real-based</em>, which
includes the basic type <code>real</code> of all real numbers.  User-defined
numeric types based on <code>int</code> and <code>real</code>, either <em>subset types</em> or <em>newtypes</em>,
are described in <a href="#sec-subset-types">Section 11.3</a> and <a href="#sec-newtypes">Section 12</a>.</p>

<p>There is one built-in <a href="#sec-subset-types"><em>subset type</em></a>,
<code>nat</code>, representing the non-negative subrange of <code>int</code>.</p>

<p>The language includes a literal for each integer, like
<code>0</code>, <code>13</code>, and <code>1985</code>.  Integers can also be written in hexadecimal
using the prefix <code>0x</code>, as in <code>0x0</code>, <code>0xD</code>, and <code>0x7c1</code> (always with
a lower case <code>x</code>, but the hexadecimal digits themselves are case
insensitive).  Leading zeros are allowed.  To form negative literals,
use the unary minus operator, as in <code>-12</code>, but not -(12).</p>

<p>There are also literals for some of the reals.  These are
written as a decimal point with a nonempty sequence of decimal digits
on both sides, optionally prefixed by a <code>-</code> character.
For example, <code>1.0</code>, <code>1609.344</code>, <code>-12.5</code>, and <code>0.5772156649</code>.</p>

<p>For integers (in both decimal and hexadecimal form) and reals,
any two digits in a literal may be separated by an underscore in order
to improve human readability of the literals.  For example:</p>
<pre><code class="language-dafny">1_000_000        // easier to read than 1000000
0_12_345_6789    // strange but legal formatting of 123456789
0x8000_0000      // same as 0x80000000 -- hex digits are
                 // often placed in groups of 4
0.000_000_000_1  // same as 0.0000000001 -- 1 Angstrom
</code></pre>

<p>In addition to equality and disequality, numeric types
support the following relational operations, which have the
same precedence as equality:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;</code></td>
      <td>less than</td>
    </tr>
    <tr>
      <td><code>&lt;=</code></td>
      <td>at most</td>
    </tr>
    <tr>
      <td><code>&gt;=</code></td>
      <td>at least</td>
    </tr>
    <tr>
      <td><code>&gt;</code></td>
      <td>greater than</td>
    </tr>
  </tbody>
</table>

<p>Like equality and disequality, these operators are chaining, as long
as they are chained in the same direction.  That is,</p>
<pre><code class="language-dafny">A &lt;= B &lt; C == D &lt;= E
</code></pre>
<p>is simply a shorthand for</p>
<pre><code class="language-dafny">A &lt;= B &amp;&amp; B &lt; C &amp;&amp; C == D &amp;&amp; D &lt;= E
</code></pre>
<p>whereas</p>
<pre><code class="language-dafny">A &lt; B &gt; C
</code></pre>
<p>is not allowed.</p>

<p>There are also operators on each numeric type:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>+</code></td>
      <td>addition (plus)</td>
    </tr>
    <tr>
      <td><code>-</code></td>
      <td>subtraction (minus)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>*</code></td>
      <td>multiplication (times)</td>
    </tr>
    <tr>
      <td><code>/</code></td>
      <td>division (divided by)</td>
    </tr>
    <tr>
      <td><code>%</code></td>
      <td>modulus (mod)   int only</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>-</code></td>
      <td>negation (unary minus)</td>
    </tr>
  </tbody>
</table>

<p>The binary operators are left associative, and they associate with
each other in the two groups.
The groups are listed in order of
increasing binding power, with equality binding less strongly than any of these operators.
There is no implicit conversion between <code>int</code> and <code>real</code>: use <code>as int</code> or
<code>as real</code> conversions to write an explicit conversion (cf. <a href="#sec-as-expression">Section 20.10</a>).</p>

<p>Modulus is supported only for integer-based numeric types.  Integer
division and modulus are the <em>Euclidean division and modulus</em>.  This
means that modulus always returns a non-negative value, regardless of the
signs of the two operands.  More precisely, for any integer <code>a</code> and
non-zero integer <code>b</code>,</p>
<pre><code class="language-dafny">a == a / b * b + a % b
0 &lt;= a % b &lt; B
</code></pre>
<p>where <code>B</code> denotes the absolute value of <code>b</code>.</p>

<p>Real-based numeric types have a member <code>Floor</code> that returns the
<em>floor</em> of the real value (as an int value), that is, the largest integer not exceeding
the real value.  For example, the following properties hold, for any
<code>r</code> and <code>r'</code> of type <code>real</code>:</p>
<pre><code class="language-dafny">3.14.Floor == 3
(-2.5).Floor == -3
-2.5.Floor == -2 // This is -(2.5.Floor)
r.Floor as real &lt;= r
r &lt;= r' ==&gt; r.Floor &lt;= r'.Floor
</code></pre>
<p>Note in the third line that member access (like <code>.Floor</code>) binds
stronger than unary minus.  The fourth line uses the conversion
function <code>as real</code> from <code>int</code> to <code>real</code>, as described in
<a href="#sec-as-expression">Section 20.10</a>.</p>

<h3 id="sec-bit-vector-types">7.3. Bit-vector Types</h3>
<pre><code class="language-grammar">BitVectorType_ = bvToken
</code></pre>

<p>Dafny includes a family of bit-vector types, each type having a specific,
constant length, the number of bits in its values.
Each such type is
distinct and is designated by the prefix <code>bv</code> followed (without white space) by
a positive integer (without leading zeros) stating the number of bits. For example,
<code>bv1</code>, <code>bv8</code>, and <code>bv32</code> are legal bit-vector type names.
The type <code>bv0</code> is also legal; it is a bit-vector type with no bits and just one value, <code>0x0</code>.</p>

<p>Constant literals of bit-vector types are given by integer literals converted automatically
to the designated type, either by an implicit or explicit conversion operation or by initialization in a declaration.
Dafny checks that the constant literal is in the correct range. For example,</p>
<pre><code class="language-dafny">const i: bv1 := 1
const j: bv8 := 195
const k: bv2 := 5 // error - out of range
const m := (194 as bv8) | (7 as bv8)

</code></pre>

<p>Bit-vector values can be converted to and from <code>int</code> and other bit-vector types, as long as
the values are in range for the target type. Bit-vector values are always considered unsigned.</p>

<p>Bit-vector operations include bit-wise operators and arithmetic operators
(as well as equality, disequality, and comparisons).
The arithmetic operations
truncate the high-order bits from the results; that is, they perform
unsigned arithmetic modulo 2^{number of bits}, like 2s-complement machine arithmetic.</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;&lt;</code></td>
      <td>bit-limited bit-shift left</td>
    </tr>
    <tr>
      <td><code>&gt;&gt;</code></td>
      <td>unsigned bit-shift right</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>+</code></td>
      <td>bit-limited addition</td>
    </tr>
    <tr>
      <td><code>-</code></td>
      <td>bit-limited subtraction</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>*</code></td>
      <td>bit-limited multiplication</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>&amp;</code></td>
      <td>bit-wise and</td>
    </tr>
    <tr>
      <td><code>|</code></td>
      <td>bit-wise or</td>
    </tr>
    <tr>
      <td><code>^</code></td>
      <td>bit-wise exclusive-or</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>-</code></td>
      <td>bit-limited negation (unary minus)</td>
    </tr>
    <tr>
      <td><code>!</code></td>
      <td>bit-wise complement</td>
    </tr>
  </tbody>
</table>

<p>The groups of operators lower in the table above bind more tightly.<sup id="fnref:binding" role="doc-noteref"><a href="#fn:binding" class="footnote" rel="footnote">1</a></sup>
All operators bind more tightly than equality, disequality, and comparisons.
All binary operators are left-associative, but the bit-wise <code>&amp;</code>, <code>|</code>, and <code>^</code> do not associate together (parentheses are required to disambiguate).</p>

<p>The right-hand operand of bit-shift operations is an <code>int</code> value,
must be non-negative, and
no more than the number of bits in the type.
There is no signed right shift as all bit-vector values correspond to
non-negative integers.</p>

<p>Here are examples of the various operations (all the assertions are true except where indicated):</p>
<pre><code class="language-dafny">const i: bv4 := 9
const j: bv4 := 3

method m() {
  assert (i &amp; j) == (1 as bv4);
  assert (i | j) == (11 as bv4);
  assert (i ^ j) == (10 as bv4);
  assert !i == (6 as bv4);
  assert -i == (7 as bv4);
  assert (i + i) == (2 as bv4);
  assert (j - i) == (10 as bv4);
  assert (i * j) == (11 as bv4);
  assert (i as int) / (j as int) == 3;
  assert (j &lt;&lt; 1) == (6 as bv4);
  assert (i &lt;&lt; 1) == (2 as bv4);
  assert (i &gt;&gt; 1) == (4 as bv4);
  assert i == 9; // auto conversion of literal to bv4
  assert i * 4 == j + 8 + 9; // arithmetic is modulo 16
  assert i + j &gt;&gt; 1 == (i + j) &gt;&gt; 1; // + - bind tigher than &lt;&lt; &gt;&gt;
  assert i + j ^ 2 == i + (j^2);
  assert i * j &amp; 1 == i * (j&amp;1); // &amp; | ^ bind tighter than + - *
}

</code></pre>
<p>The following are incorrectly formed:</p>
<pre><code class="language-dafny">const i: bv4 := 9
const j: bv4 := 3

method m() {
  assert i &amp; 4 | j == 0 ; // parentheses required
}


const k: bv4 := 9

method p() {
  assert k as bv5 == 9 as bv6; // error: mismatched types
}

</code></pre>
<p>These produce assertion errors:</p>
<pre><code class="language-dafny">const i: bv4 := 9

method m() {
  assert i as bv3 == 1; // error: i is out of range for bv3
}

const j: bv4 := 9

method n() {
  assert j == 25; // error: 25 is out of range for bv4
}

</code></pre>

<h3 id="74-ordinal-type">7.4. Ordinal type</h3>
<pre><code class="language-grammar">OrdinalType_ = "ORDINAL"
</code></pre>

<p>TO BE WRITTEN</p>

<h3 id="sec-characters">7.5. Characters</h3>

<pre><code class="language-grammar">CharType_ = "char"
</code></pre>

<p>Dafny supports a type <code>char</code> of <em>characters</em>.  Character literals are
enclosed in single quotes, as in <code>'D'</code>. Their form is described
by the <code>charToken</code> nonterminal in the grammar.  To write a single quote as a
character literal, it is necessary to use an <em>escape sequence</em>.
Escape sequences can also be used to write other characters.  The
supported escape sequences are the following:</p>

<table>
  <thead>
    <tr>
      <th>escape sequence</th>
      <th>meaning</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>\'</code></td>
      <td>the character <code>'</code></td>
    </tr>
    <tr>
      <td><code>\"</code></td>
      <td>the character <code>"</code></td>
    </tr>
    <tr>
      <td><code>\\</code></td>
      <td>the character <code>\</code></td>
    </tr>
    <tr>
      <td><code>\0</code></td>
      <td>the null character, same as <code>\u0000</code></td>
    </tr>
    <tr>
      <td><code>\n</code></td>
      <td>line feed</td>
    </tr>
    <tr>
      <td><code>\r</code></td>
      <td>carriage return</td>
    </tr>
    <tr>
      <td><code>\t</code></td>
      <td>horizontal tab</td>
    </tr>
    <tr>
      <td><code>\u</code><em>xxxx</em></td>
      <td>universal character whose hexadecimal code is <em>xxxx</em>,  where each <em>x</em> is a hexadecimal digit</td>
    </tr>
  </tbody>
</table>

<p>The escape sequence for a double quote is redundant, because
<code>'"'</code> and <code>'\"'</code> denote the same
characterboth forms are provided in order to support the same
escape sequences in string literals (<a href="#sec-strings">Section 10.3.5</a>).
In the form <code>\u</code><em>xxxx</em>, the <code>u</code> is always lower case, but the four
hexadecimal digits are case insensitive.</p>

<p>Character values are ordered and can be compared using the standard
relational operators:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;</code></td>
      <td>less than</td>
    </tr>
    <tr>
      <td><code>&lt;=</code></td>
      <td>at most</td>
    </tr>
    <tr>
      <td><code>&gt;=</code></td>
      <td>at least</td>
    </tr>
    <tr>
      <td><code>&gt;</code></td>
      <td>greater than</td>
    </tr>
  </tbody>
</table>

<p>Sequences of characters represent <em>strings</em>, as described in
<a href="#sec-strings">Section 10.3.5</a>.</p>

<p>Character values can be converted to and from <code>int</code> values using the
<code>as int</code> and <code>as char</code> conversion operations. The result is what would
be expected in other programming languages, namely, the <code>int</code> value of a
<code>char</code> is the ASCII or unicode numeric value.</p>

<p>The only other operations on characters are obtaining a character
by indexing into a string, and the implicit conversion to string
when used as a parameter of a <code>print</code> statement.</p>

<!--PDF NEWPAGE-->
<h2 id="sec-type-parameters">8. Type parameters</h2>

<pre><code class="language-grammar">GenericParameters(allowVariance) =
  "&lt;" [ Variance ] TypeVariableName { TypeParameterCharacteristics }
  { "," [ Variance ] TypeVariableName { TypeParameterCharacteristics } }
  "&gt;"

// The optional Variance indicator is permitted only if allowVariance is true
Variance = ( "*" | "+" | "!" | "-" )

TypeParameterCharacteristics = "(" TPCharOption { "," TPCharOption } ")"

TPCharOption = ( "==" | "0" | "00" | "!" "new" )
</code></pre>
<p>Many of the types, functions, and methods in Dafny can be
parameterized by types.  These <em>type parameters</em> are typically
declared inside angle brackets and can stand for any type.</p>

<p>Dafny has some inference support that makes certain signatures less
cluttered (described in <a href="#sec-type-inference">Section 23.2</a>).</p>

<h3 id="sec-type-characteristics">8.1. Declaring restrictions on type parameters</h3>

<p>It is sometimes necessary to restrict type parameters so that
they can only be instantiated by certain families of types, that is,
by types that have certain properties. These properties are known as
<em>type characteristics</em>. The following subsections
describe the type characteristics that Dafny supports.</p>

<p>In some cases, type inference will infer that a type-parameter
must be restricted in a particular way, in which case Dafny
will add the appropriate suffix, such as <code>(==)</code>, automatically.</p>

<p>If more than one restriction is needed, they are either
listed comma-separated,
inside the parentheses or as multiple parenthesized elements:
 <code>T(==,0)</code> or <code>T(==)(0)</code>.</p>

<h4 id="sec-equality-supporting">8.1.1. Equality-supporting type parameters: <code>T(==)</code></h4>

<p>Designating a type parameter with the <code>(==)</code> suffix indicates that
the parameter may only be replaced in non-ghost contexts
with types that are known to
support run-time equality comparisons (<code>==</code> and <code>!=</code>).
All types support equality in ghost contexts,
as if, for some types, the equality function is ghost.</p>

<p>For example,</p>
<pre><code class="language-dafny">method Compare&lt;T(==)&gt;(a: T, b: T) returns (eq: bool)
{
  if a == b { eq := true; } else { eq := false; }
}
</code></pre>
<p>is a method whose type parameter is restricted to equality-supporting
types when used in a non-ghost context.
Again, note that <em>all</em> types support equality in <em>ghost</em>
contexts; the difference is only for non-ghost (that is, compiled)
code.  Co-inductive datatypes, arrow types, and inductive
datatypes with ghost parameters are examples of types that are not
equality supporting.</p>

<h4 id="812-auto-initializable-types-t0">8.1.2. Auto-initializable types: <code>T(0)</code></h4>

<p>At every access of a variable <code>x</code> of a type <code>T</code>, Dafny ensures that
<code>x</code> holds a legal value of type <code>T</code>.
If no explicit initialization is given, then an arbitrary value is
assumed by the verifier and supplied by the compiler,
that is, the variable is <em>auto-initialized</em>.
For example,</p>
<pre><code class="language-dafny">method m() {
  var n: nat; // Auto-initialized to an arbitrary value of type `nat`
  assert n &gt;= 0; // true, regardless of the value of n
  var i: int;
  assert i &gt;= 0; // possibly false, arbitrary ints may be negative
}
</code></pre>

<p>For some types (known as <em>auto-init types</em>), the compiler can choose an
initial value, but for others it does not.
Variables and fields whose type the compiler does not auto-initialize
are subject to <em>definite-assignment</em> rules. These ensure that the program
explicitly assigns a value to a variable before it is used.
For more details see <a href="#sec-definite-assignment">Section 23.6</a> and the <code>-definiteAssignment</code> command-line option.</p>

<p>Dafny supports auto-init as a type characteristic.
To restrict a type parameter to auto-init types, mark it with the
<code>(0)</code> suffix. For example,</p>
<pre><code class="language-dafny">method AutoInitExamples&lt;A(0), X&gt;() returns (a: A, x: X)
{
  // 'a' does not require an explicit initialization, since A is auto-init
  // error: out-parameter 'x' has not been given a value
}
</code></pre>
<p>In this example, an error is reported because out-parameter <code>x</code> has not
been assignedsince nothing is known about type <code>X</code>, variables of
type <code>X</code> are subject to definite-assignment rules. In contrast, since
type parameter <code>A</code> is declared to be restricted to auto-init types,
the program does not need to explicitly assign any value to the
out-parameter <code>a</code>.</p>

<h4 id="813-nonempty-types-t00">8.1.3. Nonempty types: <code>T(00)</code></h4>

<p>Auto-init types are important in compiled contexts. In ghost contexts, it
may still be important to know that a type is nonempty. Dafny supports
a type characteristic for nonempty types, written with the suffix <code>(00)</code>.
For example,</p>
<pre><code class="language-dafny">method NonemptyExamples&lt;B(00), X&gt;() returns (b: B, ghost g: B, ghost h: X)
{
  // error: non-ghost out-parameter 'b' has not been given a value
  // ghost out-parameter 'g' is fine, since its type is nonempty
  // error: 'h' has not been given a value
}
</code></pre>
<p>Because of <code>B</code>s nonempty type characteristic, ghost parameter <code>g</code> does not
need to be explicitly assigned. However, Dafny reports an error for the
non-ghost <code>b</code>, since <code>B</code> is not an auto-init type, and reports an error
for <code>h</code>, since the type <code>X</code> could be empty.</p>

<p>Note that every auto-init type is nonempty.</p>

<h4 id="sec-non-heap-based">8.1.4. Non-heap based: <code>T(!new)</code></h4>

<p>Dafny makes a distinction between types whose values are on the heap,
i.e. references, like
classes and arrays, and those that are strictly value-based, like basic
types and datatypes.
The practical implication is that references depend on allocation state
(e.g., are affected by the <code>old</code> operation) whereas non-reference values
are not.
Thus it can be relevant to know whether the values of a type parameter
are heap-based or not. This is indicated by the mode suffix <code>(!new)</code>.</p>

<p>A type parameter characterized by <code>(!new)</code> is <em>recursively</em> independent
of the allocation state. For example, a datatype is not a reference, but for
a parameterized data type such as</p>
<pre><code class="language-dafny">datatype Result&lt;T&gt; = Failure(error: string) | Success(value: T)
</code></pre>
<p>the instantiation <code>Result&lt;int&gt;</code> satisfies <code>(!new)</code>, whereas
<code>Result&lt;array&lt;int&gt;&gt;</code> does not.</p>

<p>Note that this characteristic of a type parameter is operative for both
verification and compilation.
Also, opaque types at the topmost scope are always implicitly <code>(!new)</code>.</p>

<p>Here are some examples:</p>
<pre><code class="language-dafny">datatype Result&lt;T&gt; = Failure(error: string) | Success(v: T)
datatype ResultN&lt;T(!new)&gt; = Failure(error: string) | Success(v: T)

class C {}

method m() {
  var x1: Result&lt;int&gt;;
  var x2: ResultN&lt;int&gt;;
  var x3: Result&lt;C&gt;;
  var x4: ResultN&lt;C&gt;; // error
  var x5: Result&lt;array&lt;int&gt;&gt;;
  var x6: ResultN&lt;array&lt;int&gt;&gt;; // error
}



</code></pre>

<h3 id="82-type-parameter-variance">8.2. Type parameter variance</h3>

<p>TO BE WRITTEN: Type parameter variance</p>

<!--PDF NEWPAGE-->
<h2 id="9-generic-instantiation">9. Generic Instantiation</h2>
<pre><code class="language-grammar">GenericInstantiation = "&lt;" Type { "," Type } "&gt;"
</code></pre>
<p>When a generic entity is used, actual types must be specified for each
generic parameter. This is done using a <code>GenericInstantiation</code>.
If the <code>GenericInstantiation</code> is omitted, type inference will try
to fill these in (cf. <a href="#sec-type-inference">Section 23.2</a>).</p>

<!--PDF NEWPAGE-->
<h2 id="sec-collection-types">10. Collection types</h2>

<p>Dafny offers several built-in collection types.</p>

<h3 id="sec-sets">10.1. Sets</h3>
<pre><code class="language-grammar">FiniteSetType_ = "set" [ GenericInstantiation ]

InfiniteSetType_ = "iset" [ GenericInstantiation ]
</code></pre>

<p>For any type <code>T</code>, each value of type <code>set&lt;T&gt;</code> is a finite set of
<code>T</code> values.</p>

<p>Set membership is determined by equality in the type <code>T</code>,
so <code>set&lt;T&gt;</code> can be used in a non-ghost context only if <code>T</code> is
<a href="#sec-equality-supporting">equality supporting</a>.</p>

<p>For any type <code>T</code>, each value of type <code>iset&lt;T&gt;</code> is a potentially infinite
set of <code>T</code> values.</p>

<p>A set can be formed using a <em>set display</em> expression, which is a
possibly empty, unordered, duplicate-insensitive list of expressions
enclosed in curly braces.  To illustrate,</p>
<pre><code class="language-dafny">{}        {2, 7, 5, 3}        {4+2, 1+5, a*b}
</code></pre>
<p>are three examples of set displays. There is also a <em>set comprehension</em>
expression (with a binder, like in logical quantifications), described in
<a href="#sec-set-comprehension-expression">Section 20.35</a>.</p>

<p>In addition to equality and disequality, set types
support the following relational operations:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;</code></td>
      <td>proper subset</td>
    </tr>
    <tr>
      <td><code>&lt;=</code></td>
      <td>subset</td>
    </tr>
    <tr>
      <td><code>&gt;=</code></td>
      <td>superset</td>
    </tr>
    <tr>
      <td><code>&gt;</code></td>
      <td>proper superset</td>
    </tr>
  </tbody>
</table>

<p>Like the arithmetic relational operators, these operators are
chaining.</p>

<p>Sets support the following binary operators, listed in order of
increasing binding power:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>!!</code></td>
      <td>disjointness</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>+</code></td>
      <td>set union</td>
    </tr>
    <tr>
      <td><code>-</code></td>
      <td>set difference</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>*</code></td>
      <td>set intersection</td>
    </tr>
  </tbody>
</table>

<p>The associativity rules of <code>+</code>, <code>-</code>, and <code>*</code> are like those of the
arithmetic operators with the same names.  The expression <code>A !! B</code>,
whose binding power is the same as equality (but which neither
associates nor chains with equality), says that sets <code>A</code> and <code>B</code> have
no elements in common, that is, it is equivalent to</p>
<pre><code class="language-dafny">A * B == {}
</code></pre>
<p>However, the disjointness operator is chaining, so <code>A !! B !! C !! D</code>
means:</p>
<pre><code class="language-dafny">A * B == {} &amp;&amp; (A + B) * C == {} &amp;&amp; (A + B + C) * D == {}
</code></pre>

<p>In addition, for any set <code>s</code> of type <code>set&lt;T&gt;</code> or <code>iset&lt;T&gt;</code> and any
expression <code>e</code> of type <code>T</code>, sets support the following operations:</p>

<table>
  <thead>
    <tr>
      <th>expression</th>
      <th style="text-align: center">result type</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>|s|</code></td>
      <td style="text-align: center"><code>nat</code></td>
      <td>set cardinality (not for <code>iset</code>)</td>
    </tr>
    <tr>
      <td><code>e in s</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>set membership</td>
    </tr>
    <tr>
      <td><code>e !in s</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>set non-membership</td>
    </tr>
  </tbody>
</table>

<p>The expression <code>e !in s</code> is a syntactic shorthand for <code>!(e in s)</code>.</p>

<h3 id="sec-multisets">10.2. Multisets</h3>
<pre><code class="language-grammar">MultisetType_ = "multiset" [ GenericInstantiation ]
</code></pre>

<p>A <em>multiset</em> is similar to a set, but keeps track of the multiplicity
of each element, not just its presence or absence.  For any type <code>T</code>,
each value of type <code>multiset&lt;T&gt;</code> is a map from <code>T</code> values to natural
numbers denoting each elements multiplicity.  Multisets in Dafny
are finite, that is, they contain a finite number of each of a finite
set of elements.  Stated differently, a multiset maps only a finite
number of elements to non-zero (finite) multiplicities.</p>

<p>Like sets, multiset membership is determined by equality in the type
<code>T</code>, so <code>multiset&lt;T&gt;</code> can be used in a non-ghost context only if <code>T</code>
is <a href="#sec-equality-supporting">equality supporting</a>.</p>

<p>A multiset can be formed using a <em>multiset display</em> expression, which
is a possibly empty, unordered list of expressions enclosed in curly
braces after the keyword <code>multiset</code>.  To illustrate,</p>
<pre><code class="language-dafny">multiset{}   multiset{0, 1, 1, 2, 3, 5}   multiset{4+2, 1+5, a*b}
</code></pre>
<p>are three examples of multiset displays.  There is no multiset
comprehension expression.</p>

<p>In addition to equality and disequality, multiset types
support the following relational operations:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>&lt;</code></td>
      <td>proper multiset subset</td>
    </tr>
    <tr>
      <td><code>&lt;=</code></td>
      <td>multiset subset</td>
    </tr>
    <tr>
      <td><code>&gt;=</code></td>
      <td>multiset superset</td>
    </tr>
    <tr>
      <td><code>&gt;</code></td>
      <td>proper multiset superset</td>
    </tr>
  </tbody>
</table>

<p>Like the arithmetic relational operators, these operators are
chaining.</p>

<p>Multisets support the following binary operators, listed in order of
increasing binding power:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>!!</code></td>
      <td>multiset disjointness</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>+</code></td>
      <td>multiset union</td>
    </tr>
    <tr>
      <td><code>-</code></td>
      <td>multiset difference</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>*</code></td>
      <td>multiset intersection</td>
    </tr>
  </tbody>
</table>

<p>The associativity rules of <code>+</code>, <code>-</code>, and <code>*</code> are like those of the
arithmetic operators with the same names. The <code>+</code> operator
adds the multiplicity of corresponding elements, the <code>-</code> operator
subtracts them (but 0 is the minimum multiplicity),
and the <code>*</code> has multiplicity that is the minimum of the
multiplicity of the operands.</p>

<p>The expression <code>A !! B</code>
says that multisets <code>A</code> and <code>B</code> have no elements in common, that is,
it is equivalent to</p>
<pre><code class="language-dafny">A * B == multiset{}
</code></pre>
<p>Like the analogous set operator, <code>!!</code> is chaining.</p>

<p>In addition, for any multiset <code>s</code> of type <code>multiset&lt;T&gt;</code>,
expression <code>e</code> of type <code>T</code>, and non-negative integer-based numeric
<code>n</code>, multisets support the following operations:</p>

<table>
  <thead>
    <tr>
      <th>expression</th>
      <th style="text-align: center">result type</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>|s|</code></td>
      <td style="text-align: center"><code>nat</code></td>
      <td>multiset cardinality</td>
    </tr>
    <tr>
      <td><code>e in s</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>multiset membership</td>
    </tr>
    <tr>
      <td><code>e !in s</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>multiset non-membership</td>
    </tr>
    <tr>
      <td><code>s[e]</code></td>
      <td style="text-align: center"><code>nat</code></td>
      <td>multiplicity of <code>e</code> in <code>s</code></td>
    </tr>
    <tr>
      <td><code>s[e := n]</code></td>
      <td style="text-align: center"><code>multiset&lt;T&gt;</code></td>
      <td>multiset update (change of multiplicity)</td>
    </tr>
  </tbody>
</table>

<p>The expression <code>e in s</code> returns <code>true</code> if and only if <code>s[e] != 0</code>.
The expression <code>e !in s</code> is a syntactic shorthand for <code>!(e in s)</code>.
The expression <code>s[e := n]</code> denotes a multiset like
<code>s</code>, but where the multiplicity of element <code>e</code> is <code>n</code>.  Note that
the multiset update <code>s[e := 0]</code> results in a multiset like <code>s</code> but
without any occurrences of <code>e</code> (whether or not <code>s</code> has occurrences of
<code>e</code> in the first place).  As another example, note that
<code>s - multiset{e}</code> is equivalent to:</p>
<pre><code class="language-dafny">if e in s then s[e := s[e] - 1] else s
</code></pre>

<h3 id="sec-sequences">10.3. Sequences</h3>
<pre><code class="language-grammar">SequenceType_ = "seq" [ GenericInstantiation ]
</code></pre>

<p>For any type <code>T</code>, a value of type <code>seq&lt;T&gt;</code> denotes a <em>sequence</em> of <code>T</code>
elements, that is, a mapping from a finite downward-closed set of natural
numbers (called <em>indices</em>) to <code>T</code> values.</p>

<h4 id="1031-sequence-displays">10.3.1. Sequence Displays</h4>
<p>A sequence can be formed using a <em>sequence display</em> expression, which
is a possibly empty, ordered list of expressions enclosed in square
brackets.  To illustrate,</p>
<pre><code class="language-dafny">[]        [3, 1, 4, 1, 5, 9, 3]        [4+2, 1+5, a*b]
</code></pre>
<p>are three examples of sequence displays.</p>

<p>There is also a sequence
comprehension expression (<a href="#sec-seq-comprehension">Section 20.27</a>):</p>
<pre><code class="language-dafny">seq(5, i =&gt; i*i)
</code></pre>
<p>is equivalent to <code>[0, 1, 4, 9, 16]</code>.</p>

<h4 id="1032-sequence-relational-operators">10.3.2. Sequence Relational Operators</h4>
<p>In addition to equality and disequality, sequence types
support the following relational operations:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>&lt;</td>
      <td>proper prefix</td>
    </tr>
    <tr>
      <td>&lt;=</td>
      <td>prefix</td>
    </tr>
  </tbody>
</table>

<p>Like the arithmetic relational operators, these operators are
chaining.  Note the absence of <code>&gt;</code> and <code>&gt;=</code>.</p>

<h4 id="1033-sequence-concatenation">10.3.3. Sequence Concatenation</h4>
<p>Sequences support the following binary operator:</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>+</code></td>
      <td>concatenation</td>
    </tr>
  </tbody>
</table>

<p>Operator <code>+</code> is associative, like the arithmetic operator with the
same name.</p>

<h4 id="1034-other-sequence-expressions">10.3.4. Other Sequence Expressions</h4>
<p>In addition, for any sequence <code>s</code> of type <code>seq&lt;T&gt;</code>, expression <code>e</code>
of type <code>T</code>, integer-based numeric <code>i</code> satisfying <code>0 &lt;= i &lt; |s|</code>, and
integer-based numerics <code>lo</code> and <code>hi</code> satisfying
<code>0 &lt;= lo &lt;= hi &lt;= |s|</code>, sequences support the following operations:</p>

<table>
  <thead>
    <tr>
      <th>expression</th>
      <th style="text-align: center">result type</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>|s|</code></td>
      <td style="text-align: center"><code>nat</code></td>
      <td>sequence length</td>
    </tr>
    <tr>
      <td><code>s[i]</code></td>
      <td style="text-align: center"><code>T</code></td>
      <td>sequence selection</td>
    </tr>
    <tr>
      <td><code>s[i := e]</code></td>
      <td style="text-align: center"><code>seq&lt;T&gt;</code></td>
      <td>sequence update</td>
    </tr>
    <tr>
      <td><code>e in s</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>sequence membership</td>
    </tr>
    <tr>
      <td><code>e !in s</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>sequence non-membership</td>
    </tr>
    <tr>
      <td><code>s[lo..hi]</code></td>
      <td style="text-align: center"><code>seq&lt;T&gt;</code></td>
      <td>subsequence</td>
    </tr>
    <tr>
      <td><code>s[lo..]</code></td>
      <td style="text-align: center"><code>seq&lt;T&gt;</code></td>
      <td>drop</td>
    </tr>
    <tr>
      <td><code>s[..hi]</code></td>
      <td style="text-align: center"><code>seq&lt;T&gt;</code></td>
      <td>take</td>
    </tr>
    <tr>
      <td><code>s[</code><em>slices</em><code>]</code></td>
      <td style="text-align: center"><code>seq&lt;seq&lt;T&gt;&gt;</code></td>
      <td>slice</td>
    </tr>
    <tr>
      <td><code>multiset(s)</code></td>
      <td style="text-align: center"><code>multiset&lt;T&gt;</code></td>
      <td>sequence conversion to a <code>multiset&lt;T&gt;</code></td>
    </tr>
  </tbody>
</table>

<p>Expression <code>s[i := e]</code> returns a sequence like <code>s</code>, except that the
element at index <code>i</code> is <code>e</code>.  The expression <code>e in s</code> says there
exists an index <code>i</code> such that <code>s[i] == e</code>.  It is allowed in non-ghost
contexts only if the element type <code>T</code> is
<a href="#sec-equality-supporting">equality supporting</a>.
The expression <code>e !in s</code> is a syntactic shorthand for <code>!(e in s)</code>.</p>

<p>Expression <code>s[lo..hi]</code> yields a sequence formed by taking the first
<code>hi</code> elements and then dropping the first <code>lo</code> elements.  The
resulting sequence thus has length <code>hi - lo</code>.  Note that <code>s[0..|s|]</code>
equals <code>s</code>.  If the upper bound is omitted, it
defaults to <code>|s|</code>, so <code>s[lo..]</code> yields the sequence formed by dropping
the first <code>lo</code> elements of <code>s</code>.  If the lower bound is omitted, it
defaults to <code>0</code>, so <code>s[..hi]</code> yields the sequence formed by taking the
first <code>hi</code> elements of <code>s</code>.</p>

<p>In the sequence slice operation, <em>slices</em> is a nonempty list of
length designators separated and optionally terminated by a colon, and
there is at least one colon.  Each length designator is a non-negative
integer-based numeric, whose sum is no greater than <code>|s|</code>.  If there
are <em>k</em> colons, the operation produces <em>k + 1</em> consecutive subsequences
from <code>s</code>, each of the length indicated by the corresponding length
designator, and returns these as a sequence of
sequences.
If <em>slices</em> is terminated by a
colon, then the length of the last slice extends until the end of <code>s</code>,
that is, its length is <code>|s|</code> minus the sum of the given length
designators.  For example, the following equalities hold, for any
sequence <code>s</code> of length at least <code>10</code>:</p>
<pre><code class="language-dafny">var t := [3.14, 2.7, 1.41, 1985.44, 100.0, 37.2][1:0:3];
assert |t| == 3 &amp;&amp; t[0] == [3.14] &amp;&amp; t[1] == [];
assert t[2] == [2.7, 1.41, 1985.44];
var u := [true, false, false, true][1:1:];
assert |u| == 3 &amp;&amp; u[0][0] &amp;&amp; !u[1][0] &amp;&amp; u[2] == [false, true];
assert s[10:][0] == s[..10];
assert s[10:][1] == s[10..];


</code></pre>

<p>The operation <code>multiset(s)</code> yields the multiset of elements of
sequence <code>s</code>.  It is allowed in non-ghost contexts only if the element
type <code>T</code> is <a href="#sec-equality-supporting">equality supporting</a>.</p>

<h4 id="sec-strings">10.3.5. Strings</h4>
<pre><code class="language-grammar">StringType_ = "string"
</code></pre>

<p>A special case of a sequence type is <code>seq&lt;char&gt;</code>, for which Dafny
provides a synonym: <code>string</code>.  Strings are like other sequences, but
provide additional syntax for sequence display expressions, namely
<em>string literals</em>.  There are two forms of the syntax for string
literals:  the <em>standard form</em> and the <em>verbatim form</em>.</p>

<p>String literals of the standard form are enclosed in double quotes, as
in <code>"Dafny"</code>.  To include a double quote in such a string literal,
it is necessary to use an escape sequence.  Escape sequences can also
be used to include other characters.  The supported escape sequences
are the same as those for character literals (<a href="#sec-characters">Section 7.5</a>).
For example, the Dafny expression <code>"say \"yes\""</code> represents the
string <code>'say "yes"'</code>.
The escape sequence for a single quote is redundant, because
<code>"\'"</code> and <code>"\'"</code> denote the same
stringboth forms are provided in order to support the same
escape sequences as do character literals.</p>

<p>String literals of the verbatim form are bracketed by
<code>@"</code> and <code>"</code>, as in <code>@"Dafny"</code>.  To include
a double quote in such a string literal, it is necessary to use the
escape sequence <code>""</code>, that is, to write the character
twice.  In the verbatim form, there are no other escape sequences.
Even characters like newline can be written inside the string literal
(hence spanning more than one line in the program text).</p>

<p>For example, the following three expressions denote the same string:</p>
<pre><code class="language-dafny">"C:\\tmp.txt"
@"C:\tmp.txt"
['C', ':', '\\', 't', 'm', 'p', '.', 't', 'x', 't']
</code></pre>

<p>Since strings are sequences, the relational operators <code>&lt;</code>
and <code>&lt;=</code> are defined on them.  Note, however, that these operators
still denote proper prefix and prefix, respectively, not some kind of
alphabetic comparison as might be desirable, for example, when
sorting strings.</p>

<h3 id="sec-maps">10.4. Finite and Infinite Maps</h3>
<pre><code class="language-grammar">FiniteMapType_ = "map" [ GenericInstantiation ]

InfiniteMapType_ = "imap" [ GenericInstantiation ]
</code></pre>

<p>For any types <code>T</code> and <code>U</code>, a value of type <code>map&lt;T,U&gt;</code> denotes a
<em>(finite) map</em>
from <code>T</code> to <code>U</code>.  In other words, it is a look-up table indexed by
<code>T</code>.  The <em>domain</em> of the map is a finite set of <code>T</code> values that have
associated <code>U</code> values.  Since the keys in the domain are compared
using equality in the type <code>T</code>, type <code>map&lt;T,U&gt;</code> can be used in a
non-ghost context only if <code>T</code> is
<a href="#sec-equality-supporting">equality supporting</a>.</p>

<p>Similarly, for any types <code>T</code> and <code>U</code>, a value of type <code>imap&lt;T,U&gt;</code>
denotes a <em>(possibly) infinite map</em>.  In most regards, <code>imap&lt;T,U&gt;</code> is
like <code>map&lt;T,U&gt;</code>, but a map of type <code>imap&lt;T,U&gt;</code> is allowed to have an
infinite domain.</p>

<p>A map can be formed using a <em>map display</em> expression (see <a href="#sec-map-display-expression"><code>MapDisplayExpr</code></a>),
which is a possibly empty, ordered list of <em>maplets</em>, each maplet having the
form <code>t := u</code> where <code>t</code> is an expression of type <code>T</code> and <code>u</code> is an
expression of type <code>U</code>, enclosed in square brackets after the keyword
<code>map</code>.  To illustrate,</p>
<pre><code class="language-dafny">map[]
map[20 := true, 3 := false, 20 := false]
map[a+b := c+d]
</code></pre>
<p>are three examples of map displays.  By using the keyword <code>imap</code>
instead of <code>map</code>, the map produced will be of type <code>imap&lt;T,U&gt;</code>
instead of <code>map&lt;T,U&gt;</code>.  Note that an infinite map (<code>imap</code>) is allowed
to have a finite domain, whereas a finite map (<code>map</code>) is not allowed
to have an infinite domain.
If the same key occurs more than
once in a map display expression, only the last occurrence appears in the resulting
map.<sup id="fnref:fn-map-display" role="doc-noteref"><a href="#fn:fn-map-display" class="footnote" rel="footnote">2</a></sup>  There is also a <em>map comprehension expression</em>,
explained in <a href="#sec-map-comprehension-expression">Section 20.39</a>.</p>

<p>For any map <code>fm</code> of type <code>map&lt;T,U&gt;</code>,
any map <code>m</code> of type <code>map&lt;T,U&gt;</code> or <code>imap&lt;T,U&gt;</code>,
any expression <code>t</code> of type <code>T</code>,
any expression <code>u</code> of type <code>U</code>, and any <code>d</code> in the domain of <code>m</code> (that
is, satisfying <code>d in m</code>), maps support the following operations:</p>

<table>
  <thead>
    <tr>
      <th>expression</th>
      <th style="text-align: center">result type</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>|fm|</code></td>
      <td style="text-align: center"><code>nat</code></td>
      <td>map cardinality</td>
    </tr>
    <tr>
      <td><code>m[d]</code></td>
      <td style="text-align: center"><code>U</code></td>
      <td>map selection</td>
    </tr>
    <tr>
      <td><code>m[t := u]</code></td>
      <td style="text-align: center"><code>map&lt;T,U&gt;</code></td>
      <td>map update</td>
    </tr>
    <tr>
      <td><code>t in m</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>map domain membership</td>
    </tr>
    <tr>
      <td><code>t !in m</code></td>
      <td style="text-align: center"><code>bool</code></td>
      <td>map domain non-membership</td>
    </tr>
    <tr>
      <td><code>m.Keys</code></td>
      <td style="text-align: center">(i)<code>set&lt;T&gt;</code></td>
      <td>the domain of <code>m</code></td>
    </tr>
    <tr>
      <td><code>m.Values</code></td>
      <td style="text-align: center">(i)<code>set&lt;U&gt;</code></td>
      <td>the range of <code>m</code></td>
    </tr>
    <tr>
      <td><code>m.Items</code></td>
      <td style="text-align: center">(i)<code>set&lt;(T,U)&gt;</code></td>
      <td>set of pairs (t,u) in <code>m</code></td>
    </tr>
  </tbody>
</table>

<p><code>|fm|</code> denotes the number of mappings in <code>fm</code>, that is, the
cardinality of the domain of <code>fm</code>.  Note that the cardinality operator
is not supported for infinite maps.
Expression <code>m[d]</code> returns the <code>U</code> value that <code>m</code> associates with <code>d</code>.
Expression <code>m[t := u]</code> is a map like <code>m</code>, except that the
element at key <code>t</code> is <code>u</code>.  The expression <code>t in m</code> says <code>t</code> is in the
domain of <code>m</code> and <code>t !in m</code> is a syntactic shorthand for
<code>!(t in m)</code>.<sup id="fnref:fn-map-membership" role="doc-noteref"><a href="#fn:fn-map-membership" class="footnote" rel="footnote">3</a></sup></p>

<p>The expressions <code>m.Keys</code>, <code>m.Values</code>, and <code>m.Items</code> return, as sets,
the domain, the range, and the 2-tuples holding the key-value
associations in the map. Note that <code>m.Values</code> will have a different
cardinality than <code>m.Keys</code> and <code>m.Items</code> if different keys are
associated with the same value. If <code>m</code> is an <code>imap</code>, then these
expressions return <code>iset</code> values.</p>

<p>Here is a small example, where a map <code>cache</code> of type <code>map&lt;int,real&gt;</code>
is used to cache computed values of Joule-Thomson coefficients for
some fixed gas at a given temperature:</p>
<pre><code class="language-dafny">if K in cache {  // check if temperature is in domain of cache
  coeff := cache[K];  // read result in cache
} else {
  coeff := ComputeJTCoefficient(K); // do expensive computation
  cache := cache[K := coeff];  // update the cache
}
</code></pre>

<p>Dafny also overloads the <code>+</code> and <code>-</code> binary operators for maps.
The <code>+</code> operator merges two maps or imaps of the same type, as if each
(key,value) pair of the RHS is added in turn to the LHS (i)map.
In this use, <code>+</code> is not commutative; if a key exists in both
(i)maps, it is the value from the RHS (i)map that is present in the result.</p>

<p>The <code>-</code> operator implements a map difference operator. Here the LHS
is a <code>map&lt;K,V&gt;</code> or <code>imap&lt;K,V&gt;</code> and the RHS is a <code>set&lt;K&gt;</code> (but not an <code>iset</code>); the operation removes
from the LHS all the (key,value) pairs whose key is a member of the RHS set.</p>

<h3 id="105-iterating-over-collections">10.5. Iterating over collections</h3>

<p>Collections are very commonly used in programming and one frequently
needs to iterate over the elements of a collection. Dafny does not have
built-in iterator methods, but the idioms by which to do so are straightforward.
The subsections below give some introductory examples; more
detail can be found in this <a href="http://leino.science/papers/krml275.html">power user note</a>.</p>

<p>TODO: Add examples of using an iterator class
TODO: Should a foreach statment be added to Dafny</p>

<h4 id="1051-sequences-and-arrays">10.5.1. Sequences and arrays</h4>

<p>Sequences and arrays are indexable and have a length. So the idiom to
iterate over the contents is well-known. For an array:</p>
<pre><code class="language-dafny">  var i := 0;
  var sum := 0;
  while i &lt; a.Length {
    sum := sum + a[i];
    i := i + 1;
  }
}
</code></pre>
<p>For a sequence, the only difference is the length operator:</p>
<pre><code class="language-dafny">  var i := 0;
  var sum := 0;
  while i &lt; |s| {
    sum := sum + s[i];
    i := i + 1;
  }
</code></pre>

<p>The <code>forall</code> statement (<a href="#sec-forall-statement">Section 19.21</a>) can also be used
with arrays where parallel assignment is needed:</p>
<pre><code class="language-dafny">  var rev := new int[s.Length];
  forall i | 0 &lt;= i &lt; s.Length {
    rev[i] := s[s.Length-i-1];
  }
</code></pre>

<p>See <a href="#sec-array-to-seq">Section 15.3</a> on how to convert an array to a sequence.</p>

<h4 id="1052-sets">10.5.2. Sets</h4>
<p>There is no intrinsic order to the elements of a set. Nevertheless, we can
extract an arbitrary element of a nonempty set, performing an iteration
as follows:</p>
<pre><code class="language-dafny">// s is a set&lt;int&gt;
  var ss := s;
  while ss != {}
    decreases |ss|
  {
    var i: int :| i in ss;
    ss := ss - {i};
    print i, "\n";
  }
</code></pre>

<p>Because <code>iset</code>s may be infinite, Dafny does not permit iteration over an <code>iset</code>.</p>

<h4 id="1053-maps">10.5.3. Maps</h4>

<p>Iterating over the contents of a <code>map</code> uses the component sets: <code>Keys</code>, <code>Values</code>, and <code>Items</code>. The iteration loop follows the same patterns as for sets:</p>

<pre><code class="language-dafny">  var items := m.Items;
  while items != {}
    decreases |items|
  {
    var item :| item in items;
    items := items - { item };
    print item.0, " ", item.1, "\n";
  }
</code></pre>

<p>There are no mechanisms currently defined in Dafny for iterating over <code>imap</code>s.</p>

<!--PDF NEWPAGE-->
<h2 id="11-types-that-stand-for-other-types">11. Types that stand for other types</h2>

<pre><code class="language-grammar">SynonymTypeDecl =
  SynonymTypeDecl_ | OpaqueTypeDecl_ | SubsetTypeDecl_
</code></pre>

<p>It is sometimes useful to know a type by several names or to treat a
type abstractly. There are several mechanisms in Dafny to do this:</p>

<ul>
  <li>(<a href="#sec-synonym-type">Section 11.1</a>) A typical <em>synonym type</em>, in which a type name is a synonym for another type</li>
  <li>(<a href="#sec-opaque-types">Section 11.2</a>) An <em>opaque type</em>, in which a new type name is declared as an uninterpreted type</li>
  <li>(<a href="#sec-subset-types">Section 11.3</a>) A <em>subset type</em>, in which a new type name is given to a subset of the values of a given type</li>
</ul>

<h3 id="sec-synonym-type">11.1. Type synonyms</h3>
<pre><code class="language-grammar">SynonymTypeName = NoUSIdent

SynonymTypeDecl_ =
  "type" { Attribute } SynonymTypeName
   { TypeParameterCharacteristics }
   [ GenericParameters ]
   "=" Type
</code></pre>

<p>A <em>type synonym</em> declaration:</p>
<pre><code class="language-dafny">type Y&lt;T&gt; = G
</code></pre>
<p>declares <code>Y&lt;T&gt;</code> to be a synonym for the type <code>G</code>.
If the <code>= G</code> is omitted then the declaration just declares a name as an uninterpreted
<em>opaque</em> type, as described in <a href="#sec-opaque-types">Section 11.2</a>.  Such types may be
given a definition elsewhere in the Dafny program.</p>

<p>Here, <code>T</code> is a
nonempty list of type parameters (each of which optionally
has a <a href="#sec-type-characteristics">type characteristics suffix</a>), which can be used as free type
variables in <code>G</code>.  If the synonym has no type parameters, the <code>&lt;T&gt;</code>
is dropped.  In all cases, a type synonym is just a synonym.  That is,
there is never a difference, other than possibly in error messages
produced, between <code>Y&lt;T&gt;</code> and <code>G</code>.</p>

<p>For example, the names of the following type synonyms may improve the
readability of a program:</p>
<pre><code class="language-dafny">type Replacements&lt;T&gt; = map&lt;T,T&gt;
type Vertex = int
</code></pre>

<p>The new type name itself may have type characteristics declared, though these are typically
inferred from the definition, if there is one.</p>

<p>As already described in <a href="#sec-strings">Section 10.3.5</a>, <code>string</code> is a built-in
type synonym for <code>seq&lt;char&gt;</code>, as if it would have been declared as
follows:</p>
<pre><code class="language-dafny">type string(==,0,!new) = seq&lt;char&gt;
</code></pre>
<p>If the implicit declaration did not include the type characteristics, they would be inferred in any case.</p>

<h3 id="sec-opaque-types">11.2. Opaque types</h3>
<pre><code class="language-grammar">OpaqueTypeDecl_ =
  "type" { Attribute } SynonymTypeName
   { TypeParameterCharacteristics }
   [ GenericParameters ]
   [ TypeMembers ]

TypeMembers =
  "{"
  {
    { DeclModifier }
    ClassMemberDecl(allowConstructors: false,
                    isValueType: true,
                    moduleLevelDecl: false,
                    isWithinAbstractModule: module.IsAbstract)
  }
  "}"
</code></pre>

<p>An opaque type is a special case of a type synonym that is underspecified.  Such
a type is declared simply by:</p>
<pre><code class="language-dafny">type Y&lt;T&gt;
</code></pre>
<p>Its definition can be revealed in a
refining module.  The name <code>Y</code> can be immediately followed by
a type characteristics suffix (<a href="#sec-type-characteristics">Section 8.1</a>).
Because there is no defining RHS, the type characteristics cannot be inferred and so
must be stated. If, in some refining module, a definition of the type is given, the
type characteristics must match those of the new definition.</p>

<p>For example, the declarations</p>
<pre><code class="language-dafny">type T
function F(t: T): T
</code></pre>
<p>can be used to model an uninterpreted function <code>F</code> on some
arbitrary type <code>T</code>.  As another example,</p>
<pre><code class="language-dafny">type Monad&lt;T&gt;
</code></pre>
<p>can be used abstractly to represent an arbitrary parameterized monad.</p>

<p>Even as an opaque type, the type
may be given members such as constants, methods or functions.</p>

<h3 id="sec-subset-types">11.3. Subset types</h3>

<pre><code class="language-grammar">SubsetTypeDecl_ =
  "type"
  { Attribute }
  SynonymTypeName [ GenericParameters ]
  "="
  LocalIdentTypeOptional
  "|"
  Expression(allowLemma: false, allowLambda: true)
  [ "ghost" "witness" Expression(allowLemma: false, allowLambda: true)
  | "witness" Expression((allowLemma: false, allowLambda: true)
  | "witness" "*"
  ]
</code></pre>

<pre><code class="language-grammar">NatType_ = "nat"
</code></pre>

<p>A <em>subset type</em> is a restricted use of an existing type, called
the <em>base type</em> of the subset type.  A subset type is like a
combined use of the base type and a predicate on the base
type.</p>

<p>An assignment from a subset type to its base type is always
allowed.  An assignment in the other direction, from the base type to
a subset type, is allowed provided the value assigned does indeed
satisfy the predicate of the subset type. This condition is checked
by the verifier, not by the type checker. Similarly, assignments from
one subset type to another (both with the same base type) are also
permitted, as long as it can be established that the value being assigned
satisfies the predicate defining the receiving subset type.
(Note, in contrast, assignments between a newtype and its base type
are never allowed, even if the value assigned is a value of the target
type.  For such assignments, an explicit conversion must be used, see
<a href="#sec-as-expression">Section 20.10</a>.)</p>

<p>Dafny builds in three families of subset types, as described next.</p>

<h4 id="1131-type-nat">11.3.1. Type <code>nat</code></h4>

<p>The built-in type <code>nat</code>, which represents the non-negative integers
(that is, the natural numbers), is a subset type:</p>
<pre><code class="language-dafny">type nat = n: int | 0 &lt;= n
</code></pre>

<p>A simple example that
puts subset type <code>nat</code> to good use is the standard Fibonacci
function:</p>
<pre><code class="language-dafny">function Fib(n: nat): nat
{
  if n &lt; 2 then n else Fib(n-2) + Fib(n-1)
}
</code></pre>
<p>An equivalent, but clumsy, formulation of this function (modulo the
wording of any error messages produced at call sites) would be to use
type <code>int</code> and to write the restricting predicate in pre- and
postconditions:</p>
<pre><code class="language-dafny">function Fib(n: int): int
  requires 0 &lt;= n  // the function argument must be non-negative
  ensures 0 &lt;= Fib(n)  // the function result is non-negative
{
  if n &lt; 2 then n else Fib(n - 2) + Fib(n - 1)
}
</code></pre>

<h4 id="1132-non-null-types">11.3.2. Non-null types</h4>

<p>Every class, trait, and iterator declaration <code>C</code> gives rise to two types.</p>

<p>One type has the name <code>C?</code> (that is, the name of the class, trait,
or iterator declaration with a <code>?</code> character appended to the end).
The values of <code>C?</code> are the references to <code>C</code> objects, and also
the value <code>null</code>.
In other words, <code>C?</code> is the type of <em>possibly null</em> references
(aka, <em>nullable</em> references) to <code>C</code> objects.</p>

<p>The other type has the name <code>C</code> (that is, the same name as the
class, trait, or iterator declaration).
Its values are the references to <code>C</code> objects, and does not contain
the value <code>null</code>.
In other words, <code>C</code> is the type of <em>non-null</em> references to <code>C</code>
objects.</p>

<p>The type <code>C</code> is a subset type of <code>C?</code>:</p>
<pre><code class="language-dafny">type C = c: C? | c != null
</code></pre>
<p>(It may be natural to think of the type <code>C?</code> as the union of
type <code>C</code> and the value <code>null</code>, but, technically, Dafny defines
<code>C</code> as a subset type with base type <code>C?</code>.)</p>

<p>From being a subset type, we get that <code>C</code> is a subtype of <code>C?</code>.
Moreover, if a class or trait <code>C</code> extends a trait <code>B</code>, then
type <code>C</code> is a subtype of <code>B</code> and type <code>C?</code> is a subtype of <code>B?</code>.</p>

<p>Every possibly-null reference type is a subtype of the
built-in possibly-null trait type <code>object?</code>, and
every non-null reference type is a subtype of the
built-in non-null trait type <code>object</code>. (And, from the fact
that <code>object</code> is a subset type of <code>object?</code>, we also have that
<code>object</code> is a subtype of <code>object?</code>.)</p>

<p>Arrays are references and array types also come in these two flavors.
For example,
<code>array?</code> and <code>array2?</code> are possibly-null (1- and 2-dimensional) array types, and
<code>array</code> and <code>array2</code> are their respective non-null types.</p>

<p>Note that <code>?</code> is not an operator. Instead, it is simply the last
character of the name of these various possibly-null types.</p>

<h4 id="sec-arrow-subset-types">11.3.3. Arrow types: <code>-&gt;</code>, <code>--&gt;</code>, and <code>~&gt;</code></h4>

<p>The built-in type <code>-&gt;</code> stands for total functions, <code>--&gt;</code> stands for
partial functions (that is, functions with possible <code>requires</code> clauses),
and <code>~&gt;</code> stands for all functions. More precisely, these are type constructors
that exist for any arity (<code>() -&gt; X</code>, <code>A -&gt; X</code>, <code>(A, B) -&gt; X</code>, <code>(A, B, C) -&gt; X</code>,
etc.).</p>

<p>For a list of types <code>TT</code> and a type <code>U</code>, the values of the arrow type <code>(TT) ~&gt; U</code>
are functions from <code>TT</code> to <code>U</code>. This includes functions that may read the
heap and functions that are not defined on all inputs. It is not common
to need this generality (and working with such general functions is
difficult). Therefore, Dafny defines two subset types that are more common
(and much easier to work with).</p>

<p>The type <code>(TT) --&gt; U</code> denotes the subset of <code>(TT) ~&gt; U</code> where the functions
do not read the (mutable parts of the) heap.
Values of type <code>(TT) --&gt; U</code> are called <em>partial functions</em>,
and the subset type <code>(TT) --&gt; U</code> is called the <em>partial arrow type</em>.
(As a mnemonic to help you remember that this is the partial arrow, you may
think of the little gap between the two hyphens in <code>--&gt;</code> as showing a broken
arrow.)</p>

<p>The built-in partial arrow type is defined as follows (here shown
for arrows with arity 1):</p>
<pre><code class="language-dafny">type A --&gt; B = f: A ~&gt; B | forall a :: f.reads(a) == {}
</code></pre>
<p>(except that what is shown here left of the <code>=</code> is not legal Dafny syntax).
That is, the partial arrow type is defined as those functions <code>f</code>
whose reads frame is empty for all inputs.
More precisely, taking variance into account, the partial arrow type
is defined as</p>
<pre><code class="language-dafny">type -A --&gt; +B = f: A ~&gt; B | forall a :: f.reads(a) == {}
</code></pre>

<p>The type <code>(TT) -&gt; U</code> is, in turn, a subset type of <code>(TT) --&gt; U</code>, adding the
restriction that the functions must not impose any precondition. That is,
values of type <code>(TT) -&gt; U</code> are <em>total functions</em>, and the subset type
<code>(TT) -&gt; U</code> is called the <em>total arrow type</em>.</p>

<p>The built-in total arrow type is defined as follows (here shown
for arrows with arity 1):</p>
<pre><code class="language-dafny">type -A -&gt; +B = f: A --&gt; B | forall a :: f.requires(a)
</code></pre>
<p>That is, the total arrow type is defined as those partial functions <code>f</code>
whose precondition evaluates to <code>true</code> for all inputs.</p>

<p>Among these types, the most commonly used are the total arrow types.
They are also the easiest to work with. Because they are common, they
have the simplest syntax (<code>-&gt;</code>).</p>

<p>Note, informally, we tend to speak of all three of these types as arrow types,
even though, technically, the <code>~&gt;</code> types are the arrow types and the
<code>--&gt;</code> and <code>-&gt;</code> types are subset types thereof. The one place where you may need to
remember that <code>--&gt;</code> and <code>-&gt;</code> are subset types is in some error messages.
For example, if you try to assign a partial function to a variable whose
type is a total arrow type and the verifier is not able to prove that the
partial function really is total, then youll get an error say the subset-type
constraint may not be satisfied.</p>

<p>For more information about arrow types, see <a href="#sec-arrow-types">Section 17</a>.</p>

<!--PDF NEWPAGE-->
<h2 id="sec-newtypes">12. Newtypes</h2>
<pre><code class="language-grammar">NewtypeDecl = "newtype" { Attribute } NewtypeName "="
  [ ellipsis ]
  ( LocalIdentTypeOptional
    "|"
    Expression(allowLemma: false, allowLambda: true)
    [ "ghost" "witness" Expression(allowLemma: false, allowLambda: true)
    | "witness" Expression((allowLemma: false, allowLambda: true)
    | "witness" "*"
    ]
  | Type
  )
  [ TypeMembers ]
</code></pre>
<p>A newtype is like a type synonym or subset type except that it declares a wholly new type
name that is distinct from its base type.</p>

<p>A new type can be declared with the <em>newtype</em>
declaration, for example:</p>
<pre><code class="language-dafny">newtype N = x: M | Q
</code></pre>
<p>where <code>M</code> is a type and <code>Q</code> is a boolean expression that can
use <code>x</code> as a free variable.  If <code>M</code> is an integer-based numeric type,
then so is <code>N</code>; if <code>M</code> is real-based, then so is <code>N</code>.  If the type <code>M</code>
can be inferred from <code>Q</code>, the <code>: M</code> can be omitted.  If <code>Q</code> is just
<code>true</code>, then the declaration can be given simply as:</p>
<pre><code class="language-dafny">newtype N = M
</code></pre>
<p>Type <code>M</code> is known as the <em>base type</em> of <code>N</code>. At present, Dafny only supports
<code>int</code> and <code>real</code> as base types of newtypes.</p>

<p>A newtype is a type that supports the same operations as its
base type.  The newtype is distinct from and incompatible with other
types; in particular, it is not assignable to its base type
without an explicit conversion.  An important difference between the
operations on a newtype and the operations on its base type is that
the newtype operations are defined only if the result satisfies the
predicate <code>Q</code>, and likewise for the literals of the
newtype.</p>

<p>For example, suppose <code>lo</code> and <code>hi</code> are integer-based numerics that
satisfy <code>0 &lt;= lo &lt;= hi</code> and consider the following code fragment:</p>
<pre><code class="language-dafny">var mid := (lo + hi) / 2;
</code></pre>
<p>If <code>lo</code> and <code>hi</code> have type <code>int</code>, then the code fragment is legal; in
particular, it never overflows, since <code>int</code> has no upper bound.  In
contrast, if <code>lo</code> and <code>hi</code> are variables of a newtype <code>int32</code> declared
as follows:</p>
<pre><code class="language-dafny">newtype int32 = x | -0x8000_0000 &lt;= x &lt; 0x8000_0000
</code></pre>
<p>then the code fragment is erroneous, since the result of the addition
may fail to satisfy the predicate in the definition of <code>int32</code>.  The
code fragment can be rewritten as</p>
<pre><code class="language-dafny">var mid := lo + (hi - lo) / 2;
</code></pre>
<p>in which case it is legal for both <code>int</code> and <code>int32</code>.</p>

<p>Since a newtype is incompatible with its base type and since all
results of the newtypes operations are members of the newtype, a
compiler for Dafny is free to specialize the run-time representation
of the newtype.  For example, by scrutinizing the definition of
<code>int32</code> above, a compiler may decide to store <code>int32</code> values using
signed 32-bit integers in the target hardware.</p>

<p>The incompatibility of a newtype and its basetype is intentional,
as newtypes are meant to be used as distinct types from the basetype.
If numeric types are desired that mix more readily with the basetype,
the subset types described in <a href="#sec-subset-types">Section 11.3</a>
 may be more appropriate.</p>

<p>Note that the bound variable <code>x</code> in <code>Q</code> has type <code>M</code>, not <code>N</code>.
Consequently, it may not be possible to state <code>Q</code> about the <code>N</code>
value.  For example, consider the following type of 8-bit 2s
complement integers:</p>
<pre><code class="language-dafny">newtype int8 = x: int | -128 &lt;= x &lt; 128
</code></pre>
<p>and consider a variable <code>c</code> of type <code>int8</code>.  The expression</p>
<pre><code class="language-dafny">-128 &lt;= c &lt; 128
</code></pre>
<p>is not well-defined, because the comparisons require each operand to
have type <code>int8</code>, which means the literal <code>128</code> is checked to be of
type <code>int8</code>, which it is not.  A proper way to write this expression
is to use a conversion operation, described in <a href="#sec-conversion">Section 12.1</a>, on <code>c</code> to
convert it to the base type:</p>
<pre><code class="language-dafny">-128 &lt;= c as int &lt; 128
</code></pre>

<p>If possible, Dafny compilers will represent values of the newtype using
a native type for the sake of efficiency. This action can
be inhibited or a specific native data type selected by
using the <code>{:nativeType}</code> attribute, as explained in
<a href="#sec-nativetype">Section 22.1.2</a>.</p>

<p>Furthermore, for the compiler to be able to make an appropriate choice of
representation, the constants in the defining expression as shown above must be
known constants at compile-time. They need not be numeric literals; combinations
of basic operations and symbolic constants are also allowed as described
in <a href="#sec-compile-time-constants">Section 20.46</a>.</p>

<h3 id="sec-conversion">12.1. Conversion operations</h3>

<p>For every type <code>N</code>, there is a conversion operation with the
name <code>as N</code>, described more fully in <a href="#sec-as-expression">Section 20.10</a>.
It is a partial function defined when the
given value, which can be of any type, is a member of the type
converted to.  When the conversion is from a real-based numeric type
to an integer-based numeric type, the operation requires that the
real-based argument have no fractional part.  (To round a real-based
numeric value down to the nearest integer, use the <code>.Floor</code> member,
see <a href="#sec-numeric-types">Section 7.2</a>.)</p>

<p>To illustrate using the example from above, if <code>lo</code> and <code>hi</code> have type
<code>int32</code>, then the code fragment can legally be written as follows:</p>
<pre><code class="language-dafny">var mid := (lo as int + hi as int) / 2;
</code></pre>
<p>where the type of <code>mid</code> is inferred to be <code>int</code>.  Since the result
value of the division is a member of type <code>int32</code>, one can introduce
yet another conversion operation to make the type of <code>mid</code> be <code>int32</code>:</p>
<pre><code class="language-dafny">var mid := ((lo as int + hi as int) / 2) as int32;
</code></pre>
<p>If the compiler does specialize the run-time representation for
<code>int32</code>, then these statements come at the expense of two,
respectively three, run-time conversions.</p>

<p>The <code>as N</code> conversion operation is grammatically a suffix operation like
<code>.</code>field and array indexing, but binds less tightly than unary operations:
<code>- x as int</code> is <code>(- x) as int</code>; <code>a + b as int</code> is <code>a + (b as int)</code>.</p>

<p>The <code>as N</code> conversion can also be used with reference types. For example,
if <code>C</code> is a class, <code>c</code> is an expression of type <code>C</code>, and <code>o</code> is an expression
of type <code>object</code>, then <code>c as object</code> and <code>c as object?</code> are upcasts
and <code>o is C</code> is a downcast. A downcast requires the LHS expression to
have the RHS type, as is enforced by the verifier.</p>

<p>For some types (in particular, reference types), there is also a
corresponding <code>is</code> operation (<a href="#sec-as-expression">Section 20.10</a>) that
tests whether a value is valid for a given type.</p>

<!--PDF NEWPAGE-->
<h2 id="sec-class-types">13. Class Types</h2>

<pre><code class="language-grammar">ClassDecl = "class" { Attribute } ClassName [ GenericParameters ]
  ["extends" Type {"," Type} | ellipsis ]
  "{" { { DeclModifier }
        ClassMemberDecl(allowConstructors: true,
                        isValueType: false,
                        moduleLevelDecl: false,
                        isWithinAbstractModule: false) }
  "}"

ClassMemberDecl(allowConstructors, isValueType,
                moduleLevelDecl, isWithinAbstractModule) =
  ( FieldDecl(isValueType) // allowed iff moduleLevelDecl is false
  | ConstantFieldDecl(moduleLevelDecl)
  | FunctionDecl(isWithinAbstractModule)
  | MethodDecl(isGhost: "ghost" was present,
               allowConstructors, isWithinAbstractModule)
  )
</code></pre>
<p>The <code>ClassMemberDecl</code> parameter <code>moduleLevelDecl</code> will be true if
the member declaration is at the top level or directly within a
module declaration. It will be false for <code>ClassMemberDecl</code>s
that are part of a class or trait declaration. If <code>moduleLevelDecl</code> is
true <code>FieldDecl</code>s are not allowed.</p>

<p>A <em>class</em> <code>C</code> is a reference type declared as follows:</p>
<pre><code class="language-dafny">class C&lt;T&gt; extends J1, ..., Jn
{
  _members_
}
</code></pre>
<p>where the list of type parameters <code>T</code> is optional. The text
<code>extends J1, ..., Jn</code> is also optional and says that the class extends traits <code>J1</code>  <code>Jn</code>.
The members of a class are <em>fields</em>, <em>functions</em>, and
<em>methods</em>.  These are accessed or invoked by dereferencing a reference
to a <code>C</code> instance.</p>

<p>A function or method is invoked on an <em>instance</em>
of <code>C</code>, unless the function or method is declared <code>static</code>.
A function or method that is not <code>static</code> is called an
<em>instance</em> function or method.</p>

<p>An instance function or method takes an implicit <em>receiver</em>
parameter, namely, the instance used to access the member.  In the
specification and body of an instance function or method, the receiver
parameter can be referred to explicitly by the keyword <code>this</code>.
However, in such places, members of <code>this</code> can also be mentioned
without any qualification.  To illustrate, the qualified <code>this.f</code> and
the unqualified <code>f</code> refer to the same field of the same object in the
following example:</p>
<pre><code class="language-dafny">class C {
  var f: int
  var x: int
  method Example() returns (b: bool)
  {
    var x: int;
    b := f == this.f;
  }
}
</code></pre>
<p>so the method body always assigns <code>true</code> to the out-parameter <code>b</code>.
However, in this example, <code>x</code> and <code>this.x</code> are different because
the field <code>x</code> is shadowed by the declaration of the local variable <code>x</code>.
There is no semantic difference between qualified and
unqualified accesses to the same receiver and member.</p>

<p>A <code>C</code> instance is created using <code>new</code>. There are three forms of <code>new</code>,
depending on whether or not the class declares any <em>constructors</em>
(see <a href="#sec-constructor-methods">Section 13.3.2</a>):</p>

<pre><code class="language-dafny">c := new C;
c := new C.Init(args);
c := new C(args);
</code></pre>

<p>For a class with no constructors, the first two forms can be used.
The first form simply allocates a new instance of a <code>C</code> object, initializing
its fields to values of their respective types (and initializing each <code>const</code> field
with a RHS to its specified value). The second form additionally invokes
an <em>initialization method</em> (here, named <code>Init</code>) on the newly allocated object
and the given arguments. It is therefore a shorthand for</p>
<pre><code class="language-dafny">c := new C;
c.Init(args);
</code></pre>
<p>An initialization method is an ordinary method that has no out-parameters and
that modifies no more than <code>this</code>.</p>

<p>For a class that declares one or more constructors, the second and third forms
of <code>new</code> can be used. For such a class, the second form invokes the indicated
constructor (here, named <code>Init</code>), which allocates and initializes the object.
The third form is the same as the second, but invokes the <em>anonymous constructor</em>
of the class (that is, a constructor declared with the empty-string name).</p>

<h3 id="131-field-declarations">13.1. Field Declarations</h3>
<pre><code class="language-grammar">FieldDecl(isValueType) =
  "var" { Attribute } FIdentType { "," FIdentType }
</code></pre>
<p>A <code>FieldDecl</code> is not permitted in a value type (i.e., if <code>isValueType</code> is true).</p>

<p>An <code>FIdentType</code> is used to declare a field. The field name is either an
identifier (that is not allowed to start with a leading underscore) or
some digits. Digits are used if you want to number your fields, e.g. 0,
1, etc.</p>

<p>A field x of some type T is declared as:</p>
<pre><code class="language-dafny">var x: T
</code></pre>

<p>A field declaration declares one or more fields of the enclosing class.
Each field is a named part of the state of an object of that class. A
field declaration is similar to but distinct from a variable declaration
statement. Unlike for local variables and bound variables, the type is
required and will not be inferred.</p>

<p>Unlike method and function declarations, a field declaration
cannot be given at the top level. Fields can be declared in either a
class or a trait. A class that inherits from multiple traits will
have all the fields declared in any of its parent traits.</p>

<p>Fields that are declared as <code>ghost</code> can only be used in specifications,
not in code that will be compiled into executable code.</p>

<p>Fields may not be declared static.</p>

<h3 id="132-constant-field-declarations">13.2. Constant Field Declarations</h3>
<pre><code class="language-grammar">ConstantFieldDecl(moduleLeavelDecl) =
  "const" { Attribute } CIdentType [ ellipsis ]
   [ ":=" Expression(allowLemma: false, allowLambda:true) ]
</code></pre>

<p>A <code>const</code> declaration declares a name bound to a value,
which value is fixed after initialization.</p>

<p>The declaration must either have a type or an initializing expression (or both).
If the type is omitted, it is inferred from the initializing expression.</p>

<ul>
  <li>A const declaration may include the <code>ghost</code> and <code>static</code> modifiers, but no
others.</li>
  <li>A const declaration may appear within a module or within any declaration
that may contain members (class, trait, datatype, newtype).</li>
  <li>If it is in a module, it is implicitly <code>static</code>, and may not also be declared
<code>static</code>.</li>
  <li>If the declaration has an initializing expression that is a ghost
expression, then the ghost-ness of the declaration is inferred; the <code>ghost</code>
modifier may be omitted.</li>
</ul>

<h3 id="sec-method-declarations">13.3. Method Declarations</h3>
<pre><code class="language-grammar">MethodDecl(isGhost, allowConstructors, isWithinAbstractModule) =
  MethodKeyword_ { Attribute } [ MethodFunctionName ]
  ( MethodSignature_(isGhost, isExtreme: true iff this is a least
                                   or greatest lemma declaration)
  | ellipsis
  )
  MethodSpec(isConstructor: true iff
                       this is a constructor declaration)
  [ BlockStmt ]
</code></pre>
<p>The <code>isGhost</code> parameter is true iff the <code>ghost</code> keyword
preceded the method declaration.</p>

<p>If the <code>allowConstructor</code> parameter is false then
the <code>MethodDecl</code> must not be a <code>constructor</code>
declaration.</p>

<pre><code class="language-grammar">MethodKeyword_ = ( "method"
                 | "constructor"
                 | "lemma"
                 | "twostate" "lemma"
                 | "least" "lemma"
                 | "greatest" "lemma"
                 )
</code></pre>
<p>The method keyword is used to specify special kinds of methods
as explained below.</p>

<pre><code class="language-grammar">MethodSignature_(isGhost, isExtreme) =
  [ GenericParameters ]
  [ KType ]    // permitted only if isExtreme == true
  Formals(allowGhostKeyword: !isGhost, allowNewKeyword: isTwostateLemma, allowOlderKeyword: false, allowDefault: true))
  [ "returns" Formals(allowGhostKeyword: !isGhost, allowNewKeyword: false, allowOlderKeyword: false, allowDefault: false) ]
</code></pre>
<p>A method signature specifies the method generic parameters,
input parameters and return parameters.
The formal parameters are not allowed to have <code>ghost</code> specified
if <code>ghost</code> was already specified for the method.</p>

<p>A <code>ellipsis</code> is used when a method or function is being redeclared
in a module that refines another module. (cf. <a href="#sec-module-refinement">Section 21</a>)
In that case the signature is
copied from the module that is being refined. This works because
Dafny does not support method or function overloading, so the
name of the class method uniquely identifies it without the
signature.</p>

<pre><code class="language-grammar">KType = "[" ( "nat" | "ORDINAL" ) "]"
</code></pre>
<p>The <em>k-type</em> may be specified only for least and greatest lemmas and is described
in <a href="#sec-advanced-topics">Section 23</a>.</p>

<pre><code class="language-grammar">Formals(allowGhostKeyword, allowNewKeyword, allowOlderKeyword, allowDefault) =
  "(" [ GIdentType(allowGhostKeyword, allowNewKeyword, allowOlderKeyword, allowNameOnlyKeyword: true, allowDefault)
        { "," GIdentType(allowGhostKeyword, allowNewKeyword, allowOlderKeyword, allowNameOnlyKeyword: true, allowDefault) }
      ]
  ")"
</code></pre>
<p>The <code>Formals</code> specifies the names and types of the method input or
output parameters.</p>

<p>See <a href="#sec-method-specification">Section 5.2</a> for a description of <code>MethodSpec</code>.</p>

<p>A method declaration adheres to the <code>MethodDecl</code> grammar above.
Here is an example of a method declaration.</p>

<pre><code class="language-dafny">method {:att1}{:att2} M&lt;T1, T2&gt;(a: A, b: B, c: C)
                                        returns (x: X, y: Y, z: Z)
  requires Pre
  modifies Frame
  ensures Post
  decreases Rank
{
  Body
}
</code></pre>

<p>where <code>:att1</code> and <code>:att2</code> are attributes of the method,
<code>T1</code> and <code>T2</code> are type parameters of the method (if generic),
<code>a, b, c</code> are the methods in-parameters, <code>x, y, z</code> are the
methods out-parameters, <code>Pre</code> is a boolean expression denoting the
methods precondition, <code>Frame</code> denotes a set of objects whose fields may
be updated by the method, <code>Post</code> is a boolean expression denoting the
methods postcondition, <code>Rank</code> is the methods variant function, and
<code>Body</code> is a list of statements that implements the method. <code>Frame</code> can be a list
of expressions, each of which is a set of objects or a single object, the
latter standing for the singleton set consisting of that one object. The
methods frame is the union of these sets, plus the set of objects
allocated by the method body. For example, if <code>c</code> and <code>d</code> are parameters
of a class type <code>C</code>, then</p>

<pre><code class="language-dafny">modifies {c, d}
modifies {c} + {d}
modifies c, {d}
modifies c, d
</code></pre>

<p>all mean the same thing.</p>

<h4 id="1331-ordinary-methods">13.3.1. Ordinary methods</h4>

<p>A method can be declared as ghost by preceding the declaration with the
keyword <code>ghost</code> and as static by preceding the declaration with the keyword <code>static</code>.
The default is non-static (i.e., instance) and non-ghost.
An instance method has an implicit receiver parameter, <code>this</code>.
A static method M in a class C can be invoked by <code>C.M()</code>.</p>

<p>An ordinary method is declared with the <code>method</code> keyword.
Section [#sec-constructors] explains methods that instead use the
<code>constructor</code> keyword. Section [#sec-lemmas] discusses methods that are
declared with the <code>lemma</code> keyword. Methods declared with the
<code>least lemma</code> or <code>greatest lemma</code> keyword phrases
are discussed later in the context of extreme
predicates (see section [#sec-colemmas]).</p>

<p>A method without a body is <em>abstract</em>. A method is allowed to be
abstract under the following circumstances:</p>

<ul>
  <li>It contains an <code>{:axiom}</code> attribute</li>
  <li>It is a declaration in an abstract module.
Note that when there is no body, Dafny assumes that the <em>ensures</em>
clauses are true without proof. (TODO: <code>:extern</code> attribute?)</li>
</ul>

<h4 id="sec-constructor-methods">13.3.2. Constructors</h4>
<p>To write structured object-oriented programs, one often relies on
objects being constructed only in certain ways.  For this purpose, Dafny
provides <em>constructor (method)s</em>.
A constructor is declared with the keyword
<code>constructor</code> instead of <code>method</code>; constructors are permitted only in classes.
A constructor is allowed to be declared as <code>ghost</code>, in which case it
can only be used in ghost contexts.</p>

<p>A constructor can only be called at the time an object is allocated (see
object-creation examples below). Moreover, when a class contains a
constructor, every call to <code>new</code> for a class must be accompanied
by a call to one of its constructors. A class may
declare no constructors or one or more constructors.</p>

<h5 id="13321-classes-with-no-explicit-constructors">13.3.2.1. Classes with no explicit constructors</h5>

<p>For a class that declares no constructors, an instance of the class is
created with</p>
<pre><code class="language-dafny">c := new C;
</code></pre>
<p>This allocates an object and initializes its fields to values of their
respective types (and initializes each <code>const</code> field with a RHS to its specified
value). The RHS of a <code>const</code> field may depend on other <code>const</code> or <code>var</code> fields,
but circular dependencies are not allowed.</p>

<p>This simple form of <code>new</code> is allowed only if the class declares no constructors,
which is not possible to determine in every scope.
It is easy to determine whether or not a class declares any constructors if the
class is declared in the same module that performs the <code>new</code>. If the class is
declared in a different module and that module exports a constructor, then it is
also clear that the class has a constructor (and thus this simple form of <code>new</code>
cannot be used). (Note that an export set that <code>reveals</code> a class <code>C</code> also exports
the anonymous constructor of <code>C</code>, if any.)
But if the module that declares <code>C</code> does not export any constructors
for <code>C</code>, then callers outside the module do not know whether or not <code>C</code> has a
constructor. Therefore, this simple form of <code>new</code> is allowed only for classes that
are declared in the same module as the use of <code>new</code>.</p>

<p>The simple <code>new C</code> is allowed in ghost contexts. Also, unlike the forms of <code>new</code>
that call a constructor or initialization method, it can be used in a simultaneous
assignment; for example</p>
<pre><code class="language-dafny">c, d, e := new C, new C, 15;
</code></pre>
<p>is legal.</p>

<p>As a shorthand for writing</p>
<pre><code class="language-dafny">c := new C;
c.Init(args);
</code></pre>
<p>where <code>Init</code> is an initialization method (see the top of Section [#sec-class-types]),
one can write</p>
<pre><code class="language-dafny">c := new C.Init(args);
</code></pre>
<p>but it is more typical in such a case to declare a constructor for the class.</p>

<p>(The syntactic support for initialization methods is provided for historical
reasons. It may be deprecated in some future version of Dafny. In most cases,
a constructor is to be preferred.)</p>

<h5 id="13322-classes-with-one-or-more-constructors">13.3.2.2. Classes with one or more constructors</h5>

<p>Like other class members, constructors have names. And like other members,
their names must be distinct, even if their signatures are different.
Being able to name constructors promotes names like <code>InitFromList</code> or
<code>InitFromSet</code> (or just <code>FromList</code> and <code>FromSet</code>).
Unlike other members, one constructor is allowed to be <em>anonymous</em>;
in other words, an <em>anonymous constructor</em> is a constructor whose name is
essentially the empty string.  For example:</p>
<pre><code class="language-dafny">class Item {
  constructor I(xy: int) // ...
  constructor (x: int, y: int)
  // ...
}
</code></pre>
<p>The named constructor is invoked as</p>
<pre><code class="language-dafny">  i := new Item.I(42);
</code></pre>
<p>The anonymous constructor is invoked as</p>
<pre><code class="language-dafny">  m := new Item(45, 29);
</code></pre>
<p>dropping the <code>.</code>.</p>

<h5 id="13323-two-phase-constructors">13.3.2.3. Two-phase constructors</h5>

<p>The body of a constructor contains two sections,
an initialization phase and a post-initialization phase, separated by a <code>new;</code> statement.
If there is no <code>new;</code> statement, the entire body is the initialization phase.
The initialization phase is intended to initialize field variables.
In this phase, uses of the object reference <code>this</code> are restricted;
a program may use <code>this</code></p>

<ul>
  <li>as the receiver on the LHS,</li>
  <li>as the entire RHS of an assignment to a field of <code>this</code>,</li>
  <li>and as a member of a set on the RHS that is being assigned to a field of <code>this</code>.</li>
</ul>

<p>A <code>const</code> field with a RHS is not allowed to be assigned anywhere else.
A <code>const</code> field without a RHS may be assigned only in constructors, and more precisely
only in the initialization phase of constructors. During this phase, a <code>const</code> field
may be assigned more than once; whatever value the <code>const</code> field has at the end of the
initialization phase is the value it will have forever thereafter.</p>

<p>For a constructor declared as <code>ghost</code>, the initialization phase is allowed to assign
both ghost and non-ghost fields. For such an object, values of non-ghost fields at
the end of the initialization phase are in effect no longer changeable.</p>

<p>There are no restrictions on expressions or statements in the post-initialization phase.</p>

<h4 id="1333-lemmas">13.3.3. Lemmas</h4>
<p>Sometimes there are steps of logic required to prove a program correct,
but they are too complex for Dafny to discover and use on its own. When
this happens, we can often give Dafny assistance by providing a lemma.
This is done by declaring a method with the <code>lemma</code> keyword.
Lemmas are implicitly ghost methods and the <code>ghost</code> keyword cannot
be applied to them.</p>

<p>For an example, see the <code>FibProperty</code> lemma in
<a href="#sec-proofs-in-dafny">Section 23.5.2</a>.</p>

<p>See <a href="https://dafny-lang.github.io/dafny/OnlineTutorial/Lemmas">the Dafny Lemmas tutorial</a>
for more examples and hints for using lemmas.</p>

<h4 id="sec-two-state">13.3.4. Two-state lemmas and functions</h4>

<p>The heap is an implicit parameter to every function, though a function is only allowed
to read those parts of the mutable heap that it admits to in its <code>reads</code> clause.
Sometimes, it is useful for a function to take two heap parameters, for example, so
the function can return the difference between the value of a field in the two heaps.
Such a <em>two-state function</em> is declared by <code>twostate function</code> (or <code>twostate predicate</code>,
which is the same as a <code>twostate function</code> that returns a <code>bool</code>). A two-state function
is always ghost. It is appropriate to think of these two implicit heap parameters as
representing a current heap and an old heap.</p>

<p>For example, the predicate</p>
<pre><code class="language-dafny">twostate predicate Increasing(c: Cell)
  reads c
{
  old(c.data) &lt;= c.data
}

</code></pre>
<p>returns <code>true</code> if the value of <code>c.data</code> has not been reduced from the old state to the
current. Dereferences in the current heap are written as usual (e.g., <code>c.data</code>) and
must, as usual, be accounted for in the functions <code>reads</code> clause. Dereferences in the
old heap are enclosed by <code>old</code> (e.g., <code>old(c.data)</code>), just like when one dereferences
a  methods initial heap. The function is allowed to read anything in the old heap;
the <code>reads</code> clause only declares dependencies on locations in the current heap.
Consequently, the frame axiom for a two-state function is sensitive to any change
in the old-heap parameter; in other words, the frame axiom says nothing about two
invocations of the two-state function with different old-heap parameters.</p>

<p>At a call site, the two-state functions current-heap parameter is always passed in
as the callers current heap. The two-state functions old-heap parameter is by
default passed in as the callers old heap (that is, the initial heap if the caller
is a method and the old heap if the caller is a two-state function). While there is
never a choice in which heap gets passed as the current heap, the caller can use
any preceding heap as the argument to the two-state functions old-heap parameter.
This is done by labeling a state in the caller and passing in the label, just like
this is done with the built-in <code>old</code> function.</p>

<p>For example, the following assertions all hold:</p>
<pre><code class="language-dafny">method Caller(c: Cell)
  modifies c
{
  c.data := c.data + 10;
  label L:
  assert Increasing(c);
  c.data := c.data - 2;
  assert Increasing(c);
  assert !Increasing@L(c);
}

</code></pre>
<p>The first call to <code>Increasing</code> uses <code>Caller</code>s initial state as the old-heap parameter,
and so does the second call. The third call instead uses as the old-heap parameter
the heap at label <code>L</code>, which is why the third call returns <code>false</code>.
As shown in the example, an explicitly given old-heap parameter is given after
an <code>@</code>-sign (which follows the name of the function and any explicitly given type
parameters) and before the open parenthesis (after which the ordinary parameters are
given).</p>

<p>A two-state function is allowed to be called only from a two-state context, which
means a method, a two-state lemma (see below), or another two-state function.
Just like a label used with an <code>old</code> expressions, any label used in a call to a
two-state function must denote a program point that <em>dominates</em> the call. This means
that any control leading to the call must necessarily have passed through the labeled
program point.</p>

<p>Any parameter (including the receiver parameter, if any) passed to a two-state function
must have been allocated already in the old state. For example, the second call to
<code>Diff</code> in method <code>M</code> is illegal, since <code>d</code> was not allocated on entry to <code>M</code>:</p>
<pre><code class="language-dafny">twostate function Diff(c: Cell, d: Cell): int
  reads d
{
  d.data - old(c.data)
}

method M(c: Cell) {
  var d := new Cell(10);
  label L:
  ghost var x := Diff@L(c, d);
  ghost var y := Diff(c, d); // error: d is not allocated in old state
}

</code></pre>

<p>A two-state function can declare that it only assumes a parameter to be allocated
in the current heap. This is done by preceding the parameter with the <code>new</code> modifier,
as illustrated in the following example, where the first call to <code>DiffAgain</code> is legal:</p>
<pre><code class="language-dafny">twostate function DiffAgain(c: Cell, new d: Cell): int
  reads d
{
  d.data - old(c.data)
}

method P(c: Cell) {
  var d := new Cell(10);
  ghost var x := DiffAgain(c, d);
  ghost var y := DiffAgain(d, c); // error: d is not allocated in old state
}

</code></pre>

<p>A <em>two-state lemma</em> works in an analogous way. It is a lemma with both a current-heap
parameter and an old-heap parameter, it can use <code>old</code> expressions in its
specification (including in the precondition) and body, its parameters may
use the <code>new</code> modifier, and the old-heap parameter is by default passed in as
the callers old heap, which can be changed by using an <code>@</code>-parameter.</p>

<p>Here is an example of something useful that can be done with a two-state lemma:</p>
<pre><code class="language-dafny">function SeqSum(s: seq&lt;Cell&gt;): int
  reads s
{
  if s == [] then 0 else s[0].data + SeqSum(s[1..])
}

twostate lemma IncSumDiff(s: seq&lt;Cell&gt;)
  requires forall c :: c in s ==&gt; Increasing(c)
  ensures old(SeqSum(s)) &lt;= SeqSum(s)
{
  if s == [] {
  } else {
    calc {
      old(SeqSum(s));
    ==  // def. SeqSum
      old(s[0].data + SeqSum(s[1..]));
    ==  // distribute old
      old(s[0].data) + old(SeqSum(s[1..]));
    &lt;=  { assert Increasing(s[0]); }
      s[0].data + old(SeqSum(s[1..]));
    &lt;=  { IncSumDiff(s[1..]); }
      s[0].data + SeqSum(s[1..]);
    ==  // def. SeqSum
      SeqSum(s);
    }
  }
}

</code></pre>

<p>A two-state function can be used as a first-class function value, where the receiver
(if any), type parameters (if any), and old-heap parameter are determined at the
time the first-class value is mentioned. While the receiver and type parameters can
be explicitly instantiated in such a use (for example, <code>p.F&lt;int&gt;</code> for a two-state
instance function <code>F</code> that takes one type parameter), there is currently no syntactic
support for giving the old-heap parameter explicitly. A caller can work
around this restriction by using (fancy-word alert!) eta-expansion, meaning
wrapping a lambda expression around the call, as in <code>x =&gt; p.F&lt;int&gt;@L(x)</code>.
The following example illustrates using such an eta-expansion:</p>
<pre><code class="language-dafny">class P {
  twostate function F&lt;X&gt;(x: X): X
}

method EtaExample(p: P) returns (ghost f: int -&gt; int) {
  label L:
  f := x =&gt; p.F&lt;int&gt;@L(x);
}

</code></pre>

<p>TO BE WRITTEN - unchanged predicate</p>

<h3 id="sec-function-declarations">13.4. Function Declarations</h3>

<pre><code class="language-grammar">FunctionDecl(isWithinAbstractModule) =
  ( [ "twostate" ] "function" [ "method" ] { Attribute }
    MethodFunctionName
    FunctionSignatureOrEllipsis_(allowGhostKeyword:
                                           ("method" present),
                                 allowNewKeyword:
                                           "twostate" present)
  | "predicate" [ "method" ] { Attribute }
    MethodFunctionName
    PredicateSignatureOrEllipsis_(allowGhostKeyword:
                                           ("method" present),
                                  allowNewKeyword:
                                           "twostate" present,
                                  allowOlderKeyword: true)
  | ( "least" | "greatest" ) "predicate" { Attribute }
    MethodFunctionName
    PredicateSignatureOrEllipsis_(allowGhostKeyword: false,
                         allowNewKeyword: "twostate" present,
                         allowOlderKeyword: false))
  )
  FunctionSpec
  [ FunctionBody ]

FunctionSignatureOrEllipsis_(allowGhostKeyword) =
  FunctionSignature_(allowGhostKeyword) | ellipsis

FunctionSignature_(allowGhostKeyword, allowNewKeyword) =
  [ GenericParameters ]
  Formals(allowGhostKeyword, allowNewKeyword, allowOlderKeyword: true, allowDefault: true)
  ":"
  ( Type
  | "(" GIdentType(allowGhostKeyword: false,
                   allowNewKeyword: false,
                   allowOlderKeyword: false,
                   allowNameOnlyKeyword: false,
                   allowDefault: false)
    ")"
  )

PredicateSignatureOrEllipsis_(allowGhostKeyword, allowNewKeyword, allowOlderKeyword) =
  PredicateSignature_(allowGhostKeyword, allowNewKeyword, allowOlderKeyword) | ellipsis

PredicateSignature_(allowGhostKeyword, allowNewKeyword, allowOlderKeyword) =
  [ GenericParameters ]
  [ KType ]
  Formals(allowGhostKeyword, allowNewKeyword, allowOlderKeyword, allowDefault: true)

FunctionBody = "{" Expression(allowLemma: true, allowLambda: true)
               "}" [ "by" "method" BlockStmt ]
</code></pre>

<p>A function with a <code>by method</code> clause declares a <em>function-by-method</em>.
A function-by-method gives a way to implement a
(deterministic, side-effect free) function by a method (whose body may be
nondeterministic and may allocate objects that it modifies). This can
be useful if the best implementation uses nondeterminism (for example,
because it uses <code>:|</code> in a nondeterministic way) in a way that does not
affect the result, or if the implementation temporarily makes use of some
mutable data structures, or if the implementation is done with a loop.
For example, here is the standard definition of the Fibonacci function
but with an efficient implementation that uses a loop:</p>

<pre><code class="language-dafny">function Fib(n: nat): nat {
  if n &lt; 2 then n else Fib(n - 2) + Fib(n - 1)
} by method {
  var x, y := 0, 1;
  for i := 0 to n
    invariant x == Fib(i) &amp;&amp; y == Fib(i + 1)
  {
    x, y := y, x + y;
  }
  return x;
}
</code></pre>

<p>The <code>by method</code> clause is allowed only for the <code>function</code> or <code>predicate</code>
declarations (without <code>method</code>, <code>twostate</code>, <code>least</code>, and <code>greatest</code>, but
possibly with <code>static</code>). The method
inherits the in-parameters, attributes, and <code>requires</code> and <code>decreases</code>
clauses of the function. The method also gets one out-parameter, corresponding
to the functions result value (and the name of it, if present). Finally,
the method gets an empty <code>modifies</code> clause and a postcondition
<code>ensures r == F(args)</code>, where <code>r</code> is the name of the out-parameter and
<code>F(args)</code> is the function with its arguments. In other words, the method
body must compute and return exactly what the function says, and must
do so without modifying any previously existing heap state.</p>

<p>The function body of a function-by-method is allowed to be ghost, but the
method body must be compilable. In non-ghost contexts, the compiler turns a
call of the function-by-method into a call that leads to the method body.</p>

<p>Note, the method body of a function-by-method may contain <code>print</code> statements.
This means that the run-time evaluation of an expression may have print effects.
Dafny does not track print effects, but this is the only situation that an
expression can have a print effect.</p>

<h4 id="1341-functions">13.4.1. Functions</h4>

<p>In the above productions, <code>allowGhostKeyword</code> is true if the optional
<code>method</code> keyword was specified. This allows some of the
formal parameters of a function method to be specified as <code>ghost</code>.</p>

<p>See <a href="#sec-function-specification">Section 5.3</a> for a description of <code>FunctionSpec</code>.</p>

<p>A Dafny function is a pure mathematical function. It is allowed to
read memory that was specified in its <code>reads</code> expression but is not
allowed to have any side effects.</p>

<p>Here is an example function declaration:</p>
<pre><code class="language-dafny">function {:att1}{:att2} F&lt;T1, T2&gt;(a: A, b: B, c: C): T
  requires Pre
  reads Frame
  ensures Post
  decreases Rank
{
  Body
}
</code></pre>

<p>where <code>:att1</code> and <code>:att2</code> are attributes of the function, if any, <code>T1</code>
and <code>T2</code> are type parameters of the function (if generic), <code>a, b, c</code> are
the functions parameters, <code>T</code> is the type of the functions result,
<code>Pre</code> is a boolean expression denoting the functions precondition,
<code>Frame</code> denotes a set of objects whose fields the function body may
depend on, <code>Post</code> is a boolean expression denoting the functions
postcondition, <code>Rank</code> is the functions variant function, and <code>Body</code> is
an expression that defines the functions return value. The precondition
allows a function to be partial, that is, the precondition says when the
function is defined (and Dafny will verify that every use of the function
meets the precondition).</p>

<p>The postcondition is usually not needed, since
the body of the function gives the full definition. However, the
postcondition can be a convenient place to declare properties of the
function that may require an inductive proof to establish, such as when
the function is recursive. For example:</p>

<pre><code class="language-dafny">function Factorial(n: int): int
  requires 0 &lt;= n
  ensures 1 &lt;= Factorial(n)
{
  if n == 0 then 1 else Factorial(n-1) * n
}
</code></pre>

<p>says that the result of Factorial is always positive, which Dafny
verifies inductively from the function body.</p>

<p>Within a postcondition, the result of the function is designated by
a call of the function, such as <code>Factorial(n)</code> in the example above.
Alternatively, a name for the function result can be given in the signature,
as in the following rewrite of the example above.</p>

<pre><code class="language-dafny">function Factorial(n: int): (f: int)
  requires 0 &lt;= n
  ensures 1 &lt;= f
{
  if n == 0 then 1 else Factorial(n-1) * n
}
</code></pre>

<p>By default, a function is <code>ghost</code>, and cannot be called from non-ghost
code. To make it non-ghost, replace the keyword <code>function</code> with the two
keywords <code>function method</code>.</p>

<p>Like methods, functions can be either <em>instance</em> (which they are be default) or
<em>static</em> (when the function declaration contains the keyword <code>static</code>).
An instance function, but not a static function, has an implicit receiver parameter, <code>this</code>.  A static function <code>F</code> in a class <code>C</code> can be invoked
by <code>C.F()</code>. This provides a convenient way to declare a number of helper
functions in a separate class.</p>

<p>As for methods, a <code>...</code> is used when declaring
a function in a module refinement (cf. <a href="#sec-module-refinement">Section 21</a>).
 For example, if module <code>M0</code> declares
function <code>F</code>, a module <code>M1</code> can be declared to refine <code>M0</code> and
<code>M1</code> can then refine <code>F</code>. The refinement function, <code>M1.F</code> can have
a <code>...</code> which means to copy the signature from
<code>M0.F</code>. A refinement function can furnish a body for a function
(if <code>M0.F</code> does not provide one). It can also add <code>ensures</code>
clauses.</p>

<h4 id="1342-predicates">13.4.2. Predicates</h4>
<p>A function that returns a <code>bool</code> result is called a <em>predicate</em>. As an
alternative syntax, a predicate can be declared by replacing the <code>function</code>
keyword with the <code>predicate</code> keyword and omitting a declaration of the
return type.</p>

<h4 id="1343-function-transparency">13.4.3. Function Transparency</h4>
<p>A function is said to be <em>transparent</em> in a location if the
body of the function is visible at that point.
A function is said to be <em>opaque</em> at a location if it is not
transparent. However the <code>FunctionSpec</code> of a function
is always available.</p>

<p>A function is usually transparent up to some unrolling level (up to
1, or maybe 2 or 3). If its arguments are all literals it is
transparent all the way.</p>

<p>But the transparency of a function is affected by
whether the function was given the <code>{:opaque}</code> attribute (as explained
in <a href="#sec-opaque">Section 22.2.9</a>).</p>

<p>The following table summarizes where the function is transparent.
The module referenced in the table is the module in which the
function is defined.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: center"><code>{:opaque}</code>?</th>
      <th style="text-align: center">Transparent Inside Module</th>
      <th style="text-align: center">Transparent Outside Module</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">N</td>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">Y</td>
    </tr>
    <tr>
      <td style="text-align: center">Y</td>
      <td style="text-align: center">N</td>
      <td style="text-align: center">N</td>
    </tr>
  </tbody>
</table>

<p>When <code>{:opaque}</code> is specified for function <code>g</code>, <code>g</code> is opaque,
however the statement <code>reveal g();</code> is available to give the semantics
of <code>g</code> whether in the defining module or outside.</p>

<h4 id="1344-extreme-least-or-greatest-predicates-and-lemmas">13.4.4. Extreme (Least or Greatest) Predicates and Lemmas</h4>
<p>See <a href="#sec-friendliness">Section 23.5.3</a> for descriptions
of extreme predicates and lemmas.</p>

<h4 id="1345-older-parameters-in-predicates">13.4.5. <code>older</code> parameters in predicates</h4>

<p>A parameter of any predicate (more precisely, of any
boolean-returning, non-extreme function) can be marked as
<code>older</code>. This specifies that the truth of the predicate implies that
the allocatedness of the parameter follows from the allocatedness of
the non-<code>older</code> parameters.</p>

<p>To understand what this means and why this attribute is useful,
consider the following example, which specifies reachability between
nodes in a directed graph. A <code>Node</code> is declared to have any number of
children:</p>

<pre><code>class Node {
  var children: seq&lt;Node&gt;
}
</code></pre>

<p>There are several ways one could specify reachability between
nodes. One way (which is used in <code>Test/dafny1/SchorrWaite.dfy</code> in the
Dafny test suite) is to define a type <code>Path</code>, representing lists of
<code>Node</code>s, and to define a predicate that checks if a given list of
<code>Node</code>s is indeed a path between two given nodes:</p>

<pre><code>datatype Path = Empty | Extend(Path, Node)

predicate ReachableVia(source: Node, p: Path, sink: Node, S: set&lt;Node&gt;)
  reads S
  decreases p
{
  match p
  case Empty =&gt;
    source == sink
  case Extend(prefix, n) =&gt;
    n in S &amp;&amp; sink in n.children &amp;&amp; ReachableVia(source, prefix, n, S)
}
</code></pre>

<p>In a nutshell, the definition of <code>ReachableVia</code> says</p>

<ul>
  <li>An empty path lets <code>source</code> reach <code>sink</code> just when
<code>source</code> and <code>sink</code> are the same node.</li>
  <li>A path <code>Extend(prefix, n)</code> lets <code>source</code> reach <code>sink</code> just when
the path <code>prefix</code> lets <code>source</code> reach <code>n</code> and <code>sink</code> is one of
the children nodes of <code>n</code>.</li>
</ul>

<p>To be admissible by Dafny, the recursive predicate must be shown to
terminate. Termination is assured by the specification <code>decreases p</code>,
since every such datatype value has a finite structure and every
recursive call passes in a path that is structurally included in the
previous. Predicate <code>ReachableVia</code> must also declare (an upper bound
on) which heap objects that it depends on. For this purpose, the
predicate takes an additional parameter <code>S</code>, which is used to limit
the set of intermediate nodes in the path. More precisely, predicate
<code>ReachableVia(source, p, sink, S)</code> returns <code>true</code> if and only if <code>p</code>
is a list of nodes in <code>S</code> and <code>source</code> can reach <code>sink</code> via <code>p</code>.</p>

<p>Using predicate <code>ReachableVia</code>, we can now define reachability in <code>S</code>:</p>

<pre><code>predicate Reachable(source: Node, sink: Node, S: set&lt;Node&gt;)
  reads S
{
  exists p :: ReachableVia(source, p, sink, S)
}
</code></pre>

<p>This looks like a good definition of reachability, but Dafny wont
admit it. The reason is twofold:</p>

<ul>
  <li>
    <p>Quantifiers and comprehensions are allowed to range only over
allocated state. Ater all, Dafny is a type-safe language where every
object reference is <em>valid</em> (that is, a pointer to allocated storage
of the right type)it should not be possible, not even through a
bound variable in a quantifier or comprehension, for a program to
obtain an object reference that isnt valid.</p>
  </li>
  <li>
    <p>This property is ensured by disallowing <em>open-ended</em> quantifiers.
More precisely, the object references that a quantifier may range
over must be shown to be confined to object references that were
allocated before some of the non-<code>older</code> parameters passed to the
predicate. Quantifiers that are not open-ended are called
<em>close-ended</em>. Note that close-ended refers only to the object
references that the quantification or comprehension ranges overit
does not say anything about values of other types, like integers.</p>
  </li>
</ul>

<p>Often, it is easy to show that a quantifier is close-ended. In fact,
if the type of a bound variable does not contain any object
references, then the quantifier is trivially close-ended. For example,</p>

<pre><code>forall x: int :: x &lt;= Square(x)
</code></pre>

<p>is trivially close-ended.</p>

<p>Another innocent-looking quantifier occurs in the following example:</p>

<pre><code>predicate IsCommutative&lt;X&gt;(r: (X, X) -&gt; bool)
{
  forall x, y :: r(x, y) == r(y, x) // error: open-ended quantifier
}
</code></pre>

<p>Since nothing is known about type <code>X</code>, this quantifier might be
open-ended.  For example, if <code>X</code> were passed in as a class type, then
the quantifier would be open-ended. One way to fix this predicate is
to restrict it to non-heap based types, which is indicated with the
<code>(!new)</code> type characteristic (see <a href="#sec-non-heap-based">Section 8.1.4</a>):</p>

<pre><code>predicate IsCommutative&lt;X(!new)&gt;(r: (X, X) -&gt; bool) // X is restricted to non-heap types
{
  forall x, y :: r(x, y) == r(y, x) // allowed
}
</code></pre>

<p>Another way to make <code>IsCommutative</code> close-ended is to constrain the values
of the bound variables <code>x</code> and <code>y</code>. This can be done by adding a parameter
to the predicate and limiting the quantified values to ones in the given set:</p>

<pre><code>predicate IsCommutativeInS&lt;X&gt;(r: (X, X) -&gt; bool, S: set&lt;X&gt;)
{
  forall x, y :: x in S &amp;&amp; y in S ==&gt; r(x, y) == r(y, x) // close-ended
}
</code></pre>

<p>Through a simple syntactic analysis, Dafny detects the antecedents
<code>x in S</code> and <code>y in S</code>, and since <code>S</code> is a parameter and thus can only be
passed in as something that the caller has already allocated, the
quantifier in <code>IsCommutativeInS</code> is determined to be close-ended.</p>

<p>Note, the <code>x in S</code> trick does not work for the motivating example,
<code>Reachable</code>. If you try to write</p>

<pre><code>predicate Reachable(source: Node, sink: Node, S: set&lt;Node&gt;)
  reads S
{
  exists p :: p in S &amp;&amp; ReachableVia(source, p, sink, S) // type error: p
}
</code></pre>

<p>you will get a type error, because <code>p in S</code> does not make sense if <code>p</code>
has type <code>Path</code>. We need some other way to justify that the
quantification in <code>Reachable</code> is close-ended.</p>

<p>Dafny offers a way to extend the <code>x in S</code> trick to more situations.
This is where the <code>older</code> modifier comes in. Before we apply <code>older</code>
in the <code>Reachable</code> example, lets first look at what <code>older</code> does in a
less cluttered example.</p>

<p>Suppose we rewrite <code>IsCommutativeInS</code> using a programmer-defined predicate <code>In</code>:</p>

<pre><code>predicate In&lt;X&gt;(x: X, S: set&lt;X&gt;) {
  x in S
}

predicate IsCommutativeInS&lt;X&gt;(r: (X, X) -&gt; bool, S: set&lt;X&gt;)
{
  forall x, y :: In(x, S) &amp;&amp; In(y, S) ==&gt; r(x, y) == r(y, x) // error: open-ended?
}
</code></pre>

<p>The simple syntactic analysis that looks for <code>x in S</code> finds nothing
here, because the <code>in</code> operator is relegated to the body of predicate
<code>In</code>. To inform the analysis that <code>In</code> is a predicate that, in effect,
is like <code>in</code>, you can mark parameter <code>x</code> with <code>older</code>:</p>

<pre><code>predicate In&lt;X&gt;(older x: X, S: set&lt;X&gt;) {
  x in S
}
</code></pre>

<p>This causes the simple syntactic analysis to accept the quantifier in
<code>IsCommutativeInS</code>. Adding <code>older</code> also imposes a semantic check on
the body of predicate <code>In</code>, enforced by the verifier. The semantic
check is that all the object references in the value <code>x</code> are older (or
equally old as) the object references that are part of the other
parameters, <em>in the event that the predicate returns true</em>. That is,
<code>older</code> is designed to help the caller only if the predicate returns
<code>true</code>, and the semantic check amounts to nothing if the predicate
returns <code>false</code>.</p>

<p>Finally, lets get back to the motivating example. To allow the quantifier
in <code>Reachable</code>, mark parameter <code>p</code> of <code>ReachableVia</code> with <code>older</code>:</p>

<pre><code>predicate Reachable(source: Node, sink: Node, S: set&lt;Node&gt;)
  reads S
{
  exists p :: ReachableVia(source, p, sink, S) // allowed because of 'older p' on ReachableVia
}

predicate ReachableVia(source: Node, older p: Path&lt;Node&gt;, sink: Node, S: set&lt;Node&gt;)
  reads S
  decreases p
{
  match p
  case Empty =&gt;
    source == sink
  case Extend(prefix, n) =&gt;
    n in S &amp;&amp; sink in n.children &amp;&amp; ReachableVia(source, prefix, n, S)
}
</code></pre>

<p>This example is more involved than the simpler <code>In</code> example
above. Because of the <code>older</code> modifier on the parameter, the quantifier in
<code>Reachable</code> is allowed. For intuition, you can think of the effect of
<code>older p</code> as adding an antecedent <code>p in {source} + {sink} + S</code>
(but, as we have seen, this is not type correct). The semantic check
imposed on the body of <code>ReachableVia</code> makes sure that, if the
predicate returns <code>true</code>, then every object reference in <code>p</code> is as old
as some object reference in another parameter to the predicate.</p>

<!--PDF NEWPAGE-->
<h2 id="sec-trait-types">14. Trait Types</h2>
<pre><code class="language-grammar">TraitDecl =
  "trait" { Attribute } ClassName [ GenericParameters ]
  [ "extends" Type { "," Type } | ellipsis ]
  "{"
   { { DeclModifier } ClassMemberDecl(allowConstructors: true,
                                      isValueType: false,
                                      moduleLevelDecl: false,
                                      isWithinAbstractModule: false) }
  "}"
</code></pre>

<p>A <em>trait</em> is an abstract superclass, similar to an interface or
mixin. A trait can be <em>extended</em> only by another trait or
by a class (and in the latter case we say that the class <em>implements</em>
the trait). More specifically, algebraic datatypes cannot extend traits.<sup id="fnref:fn-traits" role="doc-noteref"><a href="#fn:fn-traits" class="footnote" rel="footnote">4</a></sup></p>

<p>The declaration of a trait is much like that of a class:</p>
<pre><code class="language-dafny">trait J
{
  _members_
}
</code></pre>
<p>where <em>members</em> can include fields, functions, methods and declarations of nested traits, but
no constructor methods.  The functions and methods are allowed to be
declared <code>static</code>.</p>

<p>A reference type <code>C</code> that extends a trait <code>J</code> is assignable to a variable of
type <code>J</code>;
a value of type <code>J</code> is assignable to a variable of a reference type <code>C</code> that
extends <code>J</code> only if the verifier can prove that the reference does
indeed refer to an object of allocated type <code>C</code>.
The members of <code>J</code> are available as members
of <code>C</code>.  A member in <code>J</code> is not allowed to be redeclared in <code>C</code>,
except if the member is a non-<code>static</code> function or method without a
body in <code>J</code>.  By doing so, type <code>C</code> can supply a stronger
specification and a body for the member. There is further discussion on
this point in <a href="#sec-inheritance">Section 14.2</a>.</p>

<p><code>new</code> is not allowed to be used with traits.  Therefore, there is no
object whose allocated type is a trait.  But there can of course be
objects of a class <code>C</code> that implement a trait <code>J</code>, and a reference to
such a <code>C</code> object can be used as a value of type <code>J</code>.</p>

<h3 id="141-type-object">14.1. Type <code>object</code></h3>
<pre><code class="language-grammar">ObjectType_ = "object" | "object?"
</code></pre>

<p>There is a built-in trait <code>object</code> that is implicitly extended by all classes and traits.
It produces two types: the type <code>object?</code> that is a supertype of all
reference types and a subset type <code>object</code> that is a supertype of all non-null reference types.
This includes reference types like arrays and iterators that do not permit
explicit extending of traits. The purpose of type <code>object</code>
is to enable a uniform treatment of <em>dynamic frames</em>. In particular, it
is useful to keep a ghost field (typically named <code>Repr</code> for
representation) of type <code>set&lt;object&gt;</code>.</p>

<p>It serves no purpose (but does no harm) to explicitly list the trait <code>object</code> as
an extendee in a class or trait declaration.</p>

<p>Traits <code>object?</code> and  <code>object</code> contain no members.</p>

<p>The dynamic allocation of objects is done using <code>new C</code>,
 where <code>C</code> is the name of a class.
 The name <code>C</code> is not allowed to be a trait,
 except that it is allowed to be <code>object</code>.
 The construction <code>new object</code> allocates a new object (of an unspecified class type).
 The construction can be used to create unique references, where no other properties of those references are needed.
(<code>new object?</code> makes no sense; always use <code>new object</code> instead because the result of
<code>new</code> is always non-null.)</p>

<h3 id="sec-inheritance">14.2. Inheritance</h3>

<p>The purpose of traits is to be able to express abstraction: a trait
encapsulates a set of behaviors; classes and traits that extend it
<em>inherit</em> those behaviors, perhaps specializing them.</p>

<p>A trait or class may extend multiple other traits.
The traits syntactically listed in a trait or classs <code>extends</code> clause
are called its <em>direct parents</em>; the <em>transitive parents</em> of a trait or class
are its direct parents, the transitive parents of its direct parents, and
the <code>object</code> trait (if it is not itself <code>object</code>).
These are sets of traits, in that it does not matter if
there are repetitions of a given trait in a class or traits direct or
transitive parents. However, if a trait with type parameters is repeated,
it must have the same actual type parameters in each instance.
Furthermore, a trait may not be in its own set of transitive parents; that is,
the graph of traits connected by the directed <em>extends</em> relationship may not
have any cycles.</p>

<p>A class or trait inherits (as if they are copied) all the instance members
of its transitive parents. However, since names may not be overloaded in
Dafny, different members (that is, members with different type signatures)
within the set of transitive parents and the class or trait itself must have different names.<sup id="fnref:overload" role="doc-noteref"><a href="#fn:overload" class="footnote" rel="footnote">5</a></sup>
This restriction does mean that traits from different sources that
coincidentally use the same name for different purposes cannot be combined
by being part of the set of transitive parents for some new trait or class.</p>

<p>A declaration of  member <code>C.M</code> in a class or trait <em>overrides</em> any other declarations
of the same name (and signature) in a transitive parent. <code>C.M</code> is then called an
override; a declaration that
does not override anything is called an <em>original declaration</em>.</p>

<p>Static members of a trait may not be redeclared;
thus, if there is a body it must be declared in the trait;
the compiler will require a body, though the verifier will not.</p>

<p>conflicting names, but this would add complexity to the language that does not
appear to be needed, at least as yet.</p>

<p>Where traits within an extension hierarchy do declare instance members with the same
name (and thus the same signature), some rules apply. Recall that, for methods,
every declaration includes a specification; if no specification is given
explicitly, a default specification applies. Instance method declarations in traits,
however, need not have a body, as a body can be declared in an override.</p>

<p>For a given non-static method M,</p>

<ul>
  <li>A trait or class may not redeclare M if it has a transitive parent that declares M and provides a body.</li>
  <li>A trait may but need not provide a body if all its transitive parents that declare M do not declare a body.</li>
  <li>A trait or class may not have more than one transitive parent that declares M with a body.</li>
  <li>A class that has one or more transitive parents that declare M without a body
and no transitive parent that declares M with a body must itself redeclare M
with a body if it is compiled. (The verifier alone does not require a body.)</li>
  <li>Currently (and under debate), the following restriction applies:
if <code>M</code> overrides two (or more) declarations, <code>P.M</code> and <code>Q.M</code>, then either
<code>P.M</code> must override <code>Q.M</code> or <code>Q.M</code> must override <code>P.M</code>.</li>
</ul>

<p>The last restriction above is the current implementation. It effectively limits
inheritance of a method M to a single chain of declarations and does not
permit mixins.</p>

<p>Each of any method declarations explicitly or implicitly
includes a specification. In simple cases, those syntactically separate
specifications will be copies of each other (up to renaming to take account
of differing formal parameter names). However they need not be. The rule is
that the specifications of M in a given class or trait must be <em>as strong as</em>
Ms specifications in a transitive parent.
Here <em>as strong as</em>  means that it
must be permitted to call the subtypes M in the context of the supertypes M.
Stated differently, where P and C are a parent trait and a child class or trait,
respectively, then, under the precondition of <code>P.M</code>,</p>

<ul>
  <li>C.Ms <code>requires</code> clause must be implied by P.Ms <code>requires</code> clause</li>
  <li>C.Ms <code>ensures</code> clause must imply P.Ms <code>ensures</code> clause</li>
  <li>C.Ms <code>reads</code> set must be a subset of P.Ms <code>reads</code> set</li>
  <li>C.Ms <code>modifies</code> set must be a subset of P.Ms <code>modifies</code> set</li>
  <li>C.Ms <code>decreases</code> expression must be smaller than or equal to P.Ms <code>decreases</code> expression</li>
</ul>

<p>Non-static const and field declarations are also inherited from parent traits.
These may not be redeclared in extending traits and classes.
However, a trait need not initialize a const field with a value.
The class that extends a trait that declares such a const field without an
initializer can initialize the field in a constructor.
If the declaring trait does give
an initial value in the declaration, the extending class or trait may not either
redeclare the field or give it a value in a constructor.</p>

<p>When names are inherited from multiple traits, they must be different.
If two traits declare a common name (even with the same signature),
they cannot both be extendees of the same class or trait.</p>

<h3 id="143-example-of-traits">14.3. Example of traits</h3>
<p>As an example, the following trait represents movable geometric shapes:</p>
<pre><code class="language-dafny">trait Shape
{
  function method Width(): real
    reads this
  method Move(dx: real, dy: real)
    modifies this
  method MoveH(dx: real)
    modifies this
  {
    Move(dx, 0.0);
  }
}
</code></pre>
<p>Members <code>Width</code> and <code>Move</code> are <em>abstract</em> (that is, body-less) and can
be implemented differently by different classes that extend the trait.
The implementation of method <code>MoveH</code> is given in the trait and thus
is used by all classes that extend <code>Shape</code>.  Here are two classes
that each extend <code>Shape</code>:</p>
<pre><code class="language-dafny">class UnitSquare extends Shape
{
  var x: real, y: real
  function method Width(): real {  // note the empty reads clause
    1.0
  }
  method Move(dx: real, dy: real)
    modifies this
  {
    x, y := x + dx, y + dy;
  }
}

class LowerRightTriangle extends Shape
{
  var xNW: real, yNW: real, xSE: real, ySE: real
  function method Width(): real
    reads this
  {
    xSE - xNW
  }
  method Move(dx: real, dy: real)
    modifies this
  {
    xNW, yNW, xSE, ySE := xNW + dx, yNW + dy, xSE + dx, ySE + dy;
  }
}
</code></pre>
<p>Note that the classes can declare additional members, that they supply
implementations for the abstract members of the trait,
that they repeat the member signatures, and that they are responsible
for providing their own member specifications that both strengthen the
corresponding specification in the trait and are satisfied by the
provided body.
Finally, here is some code that creates two class instances and uses
them together as shapes:</p>
<pre><code class="language-dafny">var myShapes: seq&lt;Shape&gt;;
var A := new UnitSquare;
myShapes := [A];
var tri := new LowerRightTriangle;
// myShapes contains two Shape values, of different classes
myShapes := myShapes + [tri];
// move shape 1 to the right by the width of shape 0
myShapes[1].MoveH(myShapes[0].Width());
</code></pre>

<!--PDF NEWPAGE-->
<h2 id="sec-array-types">15. Array Types</h2>
<pre><code class="language-grammar">ArrayType_ = arrayToken [ GenericInstantiation ]
</code></pre>

<p>Dafny supports mutable fixed-length <em>array types</em> of any positive
dimension.  Array types are (heap-based) reference types.</p>

<h3 id="151-one-dimensional-arrays">15.1. One-dimensional arrays</h3>

<p>A one-dimensional array of <code>n</code> <code>T</code> elements is created as follows:</p>
<pre><code class="language-dafny">a := new T[n];
</code></pre>
<p>The initial values of the array elements are arbitrary values of type
<code>T</code>. They can be initialized using an ordered list of expressions enclosed in square brackets, as follows:</p>
<pre><code>a := new T[] [t1, t2, t3, t4];
</code></pre>
<p>The length of an array is retrieved using the immutable <code>Length</code>
member.  For example, the array allocated above satisfies:</p>
<pre><code class="language-dafny">a.Length == n
</code></pre>
<p>Once an array is allocated, its length cannot be changed.</p>

<p>For any integer-based numeric <code>i</code> in the range <code>0 &lt;= i &lt; a.Length</code>,
the <em>array selection</em> expression <code>a[i]</code> retrieves element <code>i</code> (that
is, the element preceded by <code>i</code> elements in the array).  The
element stored at <code>i</code> can be changed to a value <code>t</code> using the array
update statement:</p>
<pre><code class="language-dafny">a[i] := t;
</code></pre>

<p>Caveat: The type of the array created by <code>new T[n]</code> is
<code>array&lt;T&gt;</code>.  A mistake that is simple to make and that can lead to
befuddlement is to write <code>array&lt;T&gt;</code> instead of <code>T</code> after <code>new</code>.
For example, consider the following:</p>
<pre><code class="language-dafny">var a := new array&lt;T&gt;;
var b := new array&lt;T&gt;[n];
var c := new array&lt;T&gt;(n);  // resolution error
var d := new array(n);  // resolution error
</code></pre>
<p>The first statement allocates an array of type <code>array&lt;T&gt;</code>, but of
unknown length.  The second allocates an array of type
<code>array&lt;array&lt;T&gt;&gt;</code> of length <code>n</code>, that is, an array that holds <code>n</code>
values of type <code>array&lt;T&gt;</code>.  The third statement allocates an
array of type <code>array&lt;T&gt;</code> and then attempts to invoke an anonymous
constructor on this array, passing argument <code>n</code>.  Since <code>array</code> has no
constructors, let alone an anonymous constructor, this statement
gives rise to an error.  If the type-parameter list is omitted for a
type that expects type parameters, Dafny will attempt to fill these
in, so as long as the <code>array</code> type parameter can be inferred, it is
okay to leave off the <code>&lt;T&gt;</code> in the fourth statement above.  However,
as with the third statement, <code>array</code> has no anonymous constructor, so
an error message is generated.</p>

<p>One-dimensional arrays support operations that convert a stretch of
consecutive elements into a sequence.  For any array <code>a</code> of type
<code>array&lt;T&gt;</code>, integer-based numerics <code>lo</code> and <code>hi</code> satisfying
<code>0 &lt;= lo &lt;= hi &lt;= a.Length</code>, the following operations each yields a
<code>seq&lt;T&gt;</code>:</p>

<table>
  <thead>
    <tr>
      <th>expression</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>a[lo..hi]</code></td>
      <td>subarray conversion to sequence</td>
    </tr>
    <tr>
      <td><code>a[lo..]</code></td>
      <td>drop</td>
    </tr>
    <tr>
      <td><code>a[..hi]</code></td>
      <td>take</td>
    </tr>
    <tr>
      <td><code>a[..]</code></td>
      <td>array conversion to sequence</td>
    </tr>
  </tbody>
</table>

<p>The expression <code>a[lo..hi]</code> takes the first <code>hi</code> elements of the array,
then drops the first <code>lo</code> elements thereof and returns what remains as
a sequence, with length <code>hi - lo</code>.
The other operations are special instances of the first.  If <code>lo</code> is
omitted, it defaults to <code>0</code> and if <code>hi</code> is omitted, it defaults to
<code>a.Length</code>.
In the last operation, both <code>lo</code> and <code>hi</code> have been omitted, thus
<code>a[..]</code> returns the sequence consisting of all the array elements of
<code>a</code>.</p>

<p>The subarray operations are especially useful in specifications.  For
example, the loop invariant of a binary search algorithm that uses
variables <code>lo</code> and <code>hi</code> to delimit the subarray where the search <code>key</code>
may be still found can be expressed as follows:</p>
<pre><code class="language-dafny">key !in a[..lo] &amp;&amp; key !in a[hi..]
</code></pre>
<p>Another use is to say that a certain range of array elements have not
been changed since the beginning of a method:</p>
<pre><code class="language-dafny">a[lo..hi] == old(a[lo..hi])
</code></pre>
<p>or since the beginning of a loop:</p>
<pre><code class="language-dafny">ghost var prevElements := a[..];
while // ...
  invariant a[lo..hi] == prevElements[lo..hi]
{
  // ...
}
</code></pre>
<p>Note that the type of <code>prevElements</code> in this example is <code>seq&lt;T&gt;</code>, if
<code>a</code> has type <code>array&lt;T&gt;</code>.</p>

<p>A final example of the subarray operation lies in expressing that an
arrays elements are a permutation of the arrays elements at the
beginning of a method, as would be done in most sorting algorithms.
Here, the subarray operation is combined with the sequence-to-multiset
conversion:</p>
<pre><code class="language-dafny">multiset(a[..]) == multiset(old(a[..]))
</code></pre>

<h3 id="152-multi-dimensional-arrays">15.2. Multi-dimensional arrays</h3>

<p>An array of 2 or more dimensions is mostly like a one-dimensional
array, except that <code>new</code> takes more length arguments (one for each
dimension), and the array selection expression and the array update
statement take more indices.  For example:</p>
<pre><code class="language-dafny">matrix := new T[m, n];
matrix[i, j], matrix[x, y] := matrix[x, y], matrix[i, j];
</code></pre>
<p>create a 2-dimensional array whose dimensions have lengths <code>m</code> and
<code>n</code>, respectively, and then swaps the elements at <code>i,j</code> and <code>x,y</code>.
The type of <code>matrix</code> is <code>array2&lt;T&gt;</code>, and similarly for
higher-dimensional arrays (<code>array3&lt;T&gt;</code>, <code>array4&lt;T&gt;</code>, etc.).  Note,
however, that there is no type <code>array0&lt;T&gt;</code>, and what could have been
<code>array1&lt;T&gt;</code> is actually named just <code>array&lt;T&gt;</code>. (Accordingly, <code>array0</code> and <code>array1</code> are just
normal identifiers, not type names.)</p>

<p>The <code>new</code> operation above requires <code>m</code> and <code>n</code> to be non-negative
integer-based numerics.  These lengths can be retrieved using the
immutable fields <code>Length0</code> and <code>Length1</code>.  For example, the following
holds for the array created above:</p>
<pre><code class="language-dafny">matrix.Length0 == m &amp;&amp; matrix.Length1 == n
</code></pre>
<p>Higher-dimensional arrays are similar (<code>Length0</code>, <code>Length1</code>,
<code>Length2</code>, ).  The array selection expression and array update
statement require that the indices are in bounds.  For example, the
swap statement above is well-formed only if:</p>
<pre><code class="language-dafny">0 &lt;= i &lt; matrix.Length0 &amp;&amp; 0 &lt;= j &lt; matrix.Length1 &amp;&amp;
0 &lt;= x &lt; matrix.Length0 &amp;&amp; 0 &lt;= y &lt; matrix.Length1
</code></pre>

<p>In contrast to one-dimensional arrays, there is no operation to
convert stretches of elements from a multi-dimensional array to a
sequence.</p>

<h3 id="sec-array-to-seq">15.3. Converting arrays to sequences</h3>

<p>To convert an array <code>x</code> to a sequence, use the <code>[..]</code> operator:</p>
<pre><code class="language-dafny">  var intArr: array&lt;int&gt; := new int[] [1, 2, 3];
  var intSeq: seq&lt;int&gt; := intArr[..];
  assert intSeq == [1, 2, 3];
</code></pre>

<!--PDF NEWPAGE-->
<h2 id="sec-iterator-types">16. Iterator types</h2>
<pre><code class="language-grammar">IteratorDecl = "iterator" { Attribute } IteratorName
  ( [ GenericParameters ]
    Formals(allowGhostKeyword: true, allowNewKeyword: false, allowOlderKeyword: false)
    [ "yields" Formals(allowGhostKeyword: true, allowNewKeyword: false, allowOlderKeyword: false) ]
  | ellipsis
  )
  IteratorSpec
  [ BlockStmt ]
</code></pre>

<p>See <a href="#sec-iterator-specification">Section 5.5</a> for a description of <code>IteratorSpec</code>.</p>

<p>An <em>iterator</em> provides a programming abstraction for writing code that
iteratively returns elements.  These CLU-style iterators are
<em>co-routines</em> in the sense that they keep track of their own program
counter and control can be transferred into and out of the iterator
body.</p>

<p>An iterator is declared as follows:</p>
<pre><code class="language-dafny">iterator Iter&lt;T&gt;(_in-params_) yields (_yield-params_)
  _specification_
{
  _body_
}
</code></pre>
<p>where <code>T</code> is a list of type parameters (as usual, if there are no type
parameters, <code>&lt;T&gt;</code> is omitted). This declaration gives rise to a
reference type with the same name, <code>Iter&lt;T&gt;</code>. In the signature,
in-parameters and yield-parameters are the iterators analog of a
methods in-parameters and out-parameters. The difference is that the
out-parameters of a method are returned to a caller just once, whereas
the yield-parameters of an iterator are returned each time the iterator
body performs a <code>yield</code>. The body consists of statements, like in a
method body, but with the availability also of <code>yield</code> statements.</p>

<p>From the perspective of an iterator client, the <code>iterator</code> declaration
can be understood as generating a class <code>Iter&lt;T&gt;</code> with various
members, a simplified version of which is described next.</p>

<p>The <code>Iter&lt;T&gt;</code> class contains an anonymous constructor whose parameters
are the iterators in-parameters:</p>
<pre><code class="language-dafny">predicate Valid()
constructor (_in-params_)
  modifies this
  ensures Valid()
</code></pre>
<p>An iterator is created using <code>new</code> and this anonymous constructor.
For example, an iterator willing to return ten consecutive integers
from <code>start</code> can be declared as follows:</p>
<pre><code class="language-dafny">iterator Gen(start: int) yields (x: int)
{
  var i := 0;
  while i &lt; 10 {
    x := start + i;
    yield;
    i := i + 1;
  }
}
</code></pre>
<p>An instance of this iterator is created using</p>
<pre><code class="language-dafny">iter := new Gen(30);
</code></pre>
<p>TODO: Add example of using the iterator</p>

<p>The predicate <code>Valid()</code> says when the iterator is in a state where one
can attempt to compute more elements.  It is a postcondition of the
constructor and occurs in the specification of the <code>MoveNext</code> member:</p>
<pre><code class="language-dafny">method MoveNext() returns (more: bool)
  requires Valid()
  modifies this
  ensures more ==&gt; Valid()
</code></pre>
<p>Note that the iterator remains valid as long as <code>MoveNext</code> returns
<code>true</code>.  Once <code>MoveNext</code> returns <code>false</code>, the <code>MoveNext</code> method can no
longer be called.  Note, the client is under no obligation to keep
calling <code>MoveNext</code> until it returns <code>false</code>, and the body of the
iterator is allowed to keep returning elements forever.</p>

<p>The in-parameters of the iterator are stored in immutable fields of
the iterator class.  To illustrate in terms of the example above, the
iterator class <code>Gen</code> contains the following field:</p>
<pre><code class="language-dafny">var start: int
</code></pre>
<p>The yield-parameters also result in members of the iterator class:</p>
<pre><code class="language-dafny">var x: int
</code></pre>
<p>These fields are set by the <code>MoveNext</code> method.  If <code>MoveNext</code> returns
<code>true</code>, the latest yield values are available in these fields and the
client can read them from there.</p>

<p>To aid in writing specifications, the iterator class also contains
ghost members that keep the history of values returned by
<code>MoveNext</code>.  The names of these ghost fields follow the names of the
yield-parameters with an <code>s</code> appended to the name (to suggest
plural).  Name checking rules make sure these names do not give rise
to ambiguities.  The iterator class for <code>Gen</code> above thus contains:</p>
<pre><code class="language-dafny">ghost var xs: seq&lt;int&gt;
</code></pre>
<p>These history fields are changed automatically by <code>MoveNext</code>, but are
not assignable by user code.</p>

<p>Finally, the iterator class contains some special fields for use in
specifications.  In particular, the iterator specification is
recorded in the following immutable fields:</p>
<pre><code class="language-dafny">ghost var _reads: set&lt;object&gt;
ghost var _modifies: set&lt;object&gt;
ghost var _decreases0: T0
ghost var _decreases1: T1
// ...
</code></pre>
<p>where there is a <code>_decreases(</code><em>i</em><code>): T(</code><em>i</em><code>)</code> field for each
component of the iterators <code>decreases</code>
clause.<sup id="fnref:fn-iterator-field-names" role="doc-noteref"><a href="#fn:fn-iterator-field-names" class="footnote" rel="footnote">6</a></sup>
In addition, there is a field:</p>
<pre><code class="language-dafny">ghost var _new: set&lt;object&gt;;
</code></pre>
<p>to which any objects allocated on behalf of the iterator body are
added.  The iterator body is allowed to remove elements from the
<code>_new</code> set, but cannot by assignment to <code>_new</code> add any elements.</p>

<p>Note, in the precondition of the iterator, which is to hold upon
construction of the iterator, the in-parameters are indeed
in-parameters, not fields of <code>this</code>.</p>

<p>It is regrettably tricky to use iterators. The language really
ought to have a <code>foreach</code> statement to make this easier.
Here is an example showing a definition and use of an iterator.</p>

<pre><code class="language-dafny">iterator Iter&lt;T&gt;(s: set&lt;T&gt;) yields (x: T)
  yield ensures x in s &amp;&amp; x !in xs[..|xs|-1];
  ensures s == set z | z in xs;
{
  var r := s;
  while (r != {})
    invariant forall z :: z in xs ==&gt; x !in r;
                                 // r and xs are disjoint
    invariant s == r + set z | z in xs;
  {
    var y :| y in r;
    r, x := r - {y}, y;
    yield;
    assert y == xs[|xs|-1]; // a lemma to help prove loop invariant
  }
}

method UseIterToCopy&lt;T&gt;(s: set&lt;T&gt;) returns (t: set&lt;T&gt;)
  ensures s == t;
{
  t := {};
  var m := new Iter(s);
  while (true)
    invariant m.Valid() &amp;&amp; fresh(m._new);
    invariant t == set z | z in m.xs;
    decreases s - t;
  {
    var more := m.MoveNext();
    if (!more) { break; }
    t := t + {m.x};
  }
}
</code></pre>

<p>TODO: The section above can use some rewriting, a summary of the
defined members of an iterator, and more examples. Probably also a redesign.</p>

<!--
Make this a heading if it is uncommented
 16. Async-task types

Another experimental feature in Dafny that is likely to undergo some
evolution is _asynchronous methods_.  When an asynchronous method is
called, it does not return values for the out-parameters, but instead
returns an instance of an _async-task type_.  An asynchronous method
declared in a class `C` with the following signature:
```dafny
async method AM<T>(\(_in-params_\)) returns (\(_out-params_\))
```
also gives rise to an async-task type `AM<T>` (outside the enclosing
class, the name of the type needs the qualification `C.AM<T>`).  The
async-task type is a reference type and can be understood as a class
with various members, a simplified version of which is described next.

Each in-parameter `x` of type `X` of the asynchronous method gives
rise to a immutable ghost field of the async-task type:
```dafny
ghost var x: X;
```
Each out-parameter `y` of type `Y` gives rise to a field
```dafny
var y: Y;
```
These fields are changed automatically by the time the asynchronous
method is successfully awaited, but are not assignable by user code.

The async-task type also gets a number of special fields that are used
to keep track of dependencies, outstanding tasks, newly allocated
objects, etc.  These fields will be described in more detail as the
design of asynchronous methods evolves.

-->

<!--PDF NEWPAGE-->
<h2 id="sec-arrow-types">17. Arrow types</h2>

<pre><code class="language-grammar">ArrowType_ = ( DomainType_ "~&gt;" Type
             | DomainType_ "--&gt;" Type
             | DomainType_ "-&gt;" Type
             )
</code></pre>

<p>Functions are first-class values in Dafny. The types of function values
are called <em>arrow types</em> (aka, <em>function types</em>).
Arrow types have the form <code>(TT) ~&gt; U</code> where <code>TT</code> is a (possibly empty)
comma-delimited list of types and <code>U</code> is a type.
<code>TT</code> is called the functions <em>domain type(s)</em> and <code>U</code> is its
<em>range type</em>.  For example, the type of a function</p>
<pre><code class="language-dafny">function F(x: int, arr: array&lt;bool&gt;): real
  requires x &lt; 1000
  reads arr
</code></pre>
<p>is <code>(int, array&lt;bool&gt;) ~&gt; real</code>.</p>

<p>As seen in the example above, the functions that are values of a type
<code>(TT) ~&gt; U</code> can have a precondition (as indicated by the <code>requires</code> clause)
and can read values in the heap (as indicated by the <code>reads</code> clause).
As described in <a href="#sec-arrow-subset-types">Section 11.3.3</a>,
the subset type <code>(TT) --&gt; U</code> denotes partial (but heap-independent) functions
and the subset type <code>(TT) -&gt; U</code> denotes total functions.</p>

<p>A function declared without a <code>reads</code> clause is known by the type
checker to be a partial function. For example, the type of</p>
<pre><code class="language-dafny">function F(x: int, b: bool): real
  requires x &lt; 1000
</code></pre>
<p>is <code>(int, bool) --&gt; real</code>.
Similarly, a function declared with neither a <code>reads</code> clause nor a
<code>requires</code> clause is known by the type checker to be a total function.
For example, the type of</p>
<pre><code class="language-dafny">function F(x: int, b: bool): real
</code></pre>
<p>is <code>(int, bool) -&gt; real</code>.
In addition to functions declared by name, Dafny also supports anonymous
functions by means of <em>lambda expressions</em> (see <a href="#sec-lambda-expressions">Section 20.13</a>).</p>

<p>To simplify the appearance of the basic case where a functions
domain consists of a list of exactly one non-function, non-tuple type, the parentheses around
the domain type can be dropped in this case. For example, you may
write just <code>T -&gt; U</code> for a total arrow type.
This innocent simplification requires additional explanation in the
case where that one type is a tuple type, since tuple types are also
written with enclosing parentheses.
If the function takes a single argument that is a tuple, an additional
set of parentheses is needed.  For example, the function</p>
<pre><code class="language-dafny">function G(pair: (int, bool)): real
</code></pre>
<p>has type <code>((int, bool)) -&gt; real</code>.  Note the necessary double
parentheses.  Similarly, a function that takes no arguments is
different from one that takes a 0-tuple as an argument.  For instance,
the functions</p>
<pre><code class="language-dafny">function NoArgs(): real
function Z(unit: ()): real
</code></pre>
<p>have types <code>() -&gt; real</code> and <code>(()) -&gt; real</code>, respectively.</p>

<p>The function arrows are right associative.
For example, <code>A -&gt; B -&gt; C</code> means <code>A -&gt; (B -&gt; C)</code>, whereas
the other association requires explicit parentheses: <code>(A -&gt; B) -&gt; C</code>.
As another example, <code>A -&gt; B --&gt; C ~&gt; D</code> means
<code>A -&gt; (B --&gt; (C ~&gt; D))</code>.</p>

<p>Note that the receiver parameter of a named function is not part of
the type.  Rather, it is used when looking up the function and can
then be thought of as being captured into the function definition.
For example, suppose function <code>F</code> above is declared in a class <code>C</code> and
that <code>c</code> references an object of type <code>C</code>; then, the following is type
correct:</p>
<pre><code class="language-dafny">var f: (int, bool) -&gt; real := c.F;
</code></pre>
<p>whereas it would have been incorrect to have written something like:</p>
<pre><code class="language-dafny">var f': (C, int, bool) -&gt; real := F;  // not correct
</code></pre>

<p>The arrow types themselves do not divide its parameters into ghost
versus non-ghost. Instead, a function used as a first-class value is
considered to be ghost if either the function or any of its arguments
is ghost. The following example program illustrates:</p>
<pre><code class="language-dafny">function method F(x: int, ghost y: int): int
{
  x
}

method Example() {
  ghost var f: (int, int) -&gt; int;
  var g: (int, int) -&gt; int;
  var h: (int) -&gt; int;
  var x: int;
  f := F;
  x := F(20, 30);
  g := F; // error: tries to assign ghost to non-ghost
  h := F; // error: wrong arity (and also tries to assign ghost to non-ghost)
}
</code></pre>

<p>In addition to its type signature, each function value has three properties,
described next.</p>

<p>Every function implicitly takes the heap as an argument.  No function
ever depends on the <em>entire</em> heap, however.  A property of the
function is its declared upper bound on the set of heap locations it
depends on for a given input.  This lets the verifier figure out that
certain heap modifications have no effect on the value returned by a
certain function.  For a function <code>f: T ~&gt; U</code> and a value <code>t</code> of type
<code>T</code>, the dependency set is denoted <code>f.reads(t)</code> and has type
<code>set&lt;object&gt;</code>.</p>

<p>The second property of functions stems from the fact that every function
is potentially <em>partial</em>. In other words, a property of a function is its
<em>precondition</em>. For a function <code>f: T ~&gt; U</code>, the precondition of <code>f</code> for a
parameter value <code>t</code> of type <code>T</code> is denoted <code>f.requires(t)</code> and has type
<code>bool</code>.</p>

<p>The third property of a function is more obviousthe functions
body.  For a function <code>f: T ~&gt; U</code>, the value that the function yields
for an input <code>t</code> of type <code>T</code> is denoted <code>f(t)</code> and has type <code>U</code>.</p>

<p>Note that <code>f.reads</code> and <code>f.requires</code> are themselves functions.
Suppose <code>f</code> has type <code>T ~&gt; U</code> and <code>t</code> has type <code>T</code>.  Then, <code>f.reads</code>
is a function of type <code>T ~&gt; set&lt;object?&gt;</code> whose <code>reads</code> and <code>requires</code>
properties are:</p>
<pre><code class="language-dafny">f.reads.reads(t) == f.reads(t)
f.reads.requires(t) == true
</code></pre>
<p><code>f.requires</code> is a function of type <code>T ~&gt; bool</code> whose <code>reads</code> and
<code>requires</code> properties are:</p>
<pre><code class="language-dafny">f.requires.reads(t) == f.reads(t)
f.requires.requires(t) == true
</code></pre>
<p>In these examples, if <code>f</code> instead had type <code>T --&gt; U</code> or <code>T -&gt; U</code>,
then the type of <code>f.reads</code> is <code>T -&gt; set&lt;object?&gt;</code> and the type
of <code>f.requires</code> is <code>T -&gt; bool</code>.</p>

<p>Dafny also supports anonymous functions by means of
<em>lambda expressions</em>. See <a href="#sec-lambda-expressions">Section 20.13</a>.</p>

<!--PDF NEWPAGE-->
<h3 id="sec-tuple-types">17.1.  Tuple types</h3>
<pre><code class="language-grammar">TupleType = "(" [ [ "ghost" ] Type { "," [ "ghost" ] Type } ] ")"
</code></pre>

<p>Dafny builds in record types that correspond to tuples and gives these
a convenient special syntax, namely parentheses.  For example, for what
might have been declared as</p>
<pre><code class="language-dafny">datatype Pair&lt;T,U&gt; = Pair(0: T, 1: U)
</code></pre>
<p>Dafny provides the type <code>(T, U)</code> and the constructor <code>(t, u)</code>, as
if the datatypes name were  (i.e., an empty string)
and its type arguments are given in
round parentheses, and as if the constructor name were the empty string.
Note that
the destructor names are <code>0</code> and <code>1</code>, which are legal identifier names
for members.  For example, showing the use of a tuple destructor, here
is a property that holds of 2-tuples (that is, <em>pairs</em>):</p>
<pre><code class="language-dafny">(5, true).1 == true
</code></pre>

<p>Dafny declares <em>n</em>-tuples where <em>n</em> is 0 or 2 or more.  There are no
1-tuples, since parentheses around a single type or a single value have
no semantic meaning.  The 0-tuple type, <code>()</code>, is often known as the
<em>unit type</em> and its single value, also written <code>()</code>, is known as <em>unit</em>.</p>

<p>The <code>ghost</code> modifier can be used to mark tuple components as being used for specification only:</p>
<pre><code class="language-dafny">var pair: (int, ghost int) := (1, ghost 2);
</code></pre>

<!--PDF NEWPAGE-->
<h2 id="sec-algebraic-datatype">18. Algebraic Datatypes</h2>

<pre><code class="language-grammar">DatatypeDecl =
  ( "datatype" | "codatatype" )
  { Attribute }
  DatatypeName [ GenericParameters ]
  "=" [ ellipsis ]
      [ "|" ] DatatypeMemberDecl
      { "|" DatatypeMemberDecl }
      [ TypeMembers ]

DatatypeMemberDecl =
  { Attribute } DatatypeMemberName [ FormalsOptionalIds ]
</code></pre>

<p>Dafny offers two kinds of algebraic datatypes, those defined
inductively (with <code>datatype</code>)  and those defined co-inductively (with <code>codatatype</code>).
The salient property of
every datatype is that each value of the type uniquely identifies one
of the datatypes constructors and each constructor is injective in
its parameters.</p>

<h3 id="181-inductive-datatypes">18.1. Inductive datatypes</h3>

<p>The values of inductive datatypes can be seen as finite trees where
the leaves are values of basic types, numeric types, reference types,
co-inductive datatypes, or arrow types.  Indeed, values of
inductive datatypes can be compared using Dafnys well-founded
<code>&lt;</code> ordering.</p>

<p>An inductive datatype is declared as follows:</p>
<pre><code class="language-dafny">datatype D&lt;T&gt; = _Ctors_
</code></pre>
<p>where <em>Ctors</em> is a nonempty <code>|</code>-separated list of
<em>(datatype) constructors</em> for the datatype.  Each constructor has the
form:</p>
<pre><code class="language-dafny">C(_params_)
</code></pre>
<p>where <em>params</em> is a comma-delimited list of types, optionally
preceded by a name for the parameter and a colon, and optionally
preceded by the keyword <code>ghost</code>.  If a constructor has no parameters,
the parentheses after the constructor name may be omitted.  If no
constructor takes a parameter, the type is usually called an
<em>enumeration</em>; for example:</p>
<pre><code class="language-dafny">datatype Friends = Agnes | Agatha | Jermaine | Jack
</code></pre>

<p>For every constructor <code>C</code>, Dafny defines a <em>discriminator</em> <code>C?</code>, which
is a member that returns <code>true</code> if and only if the datatype value has
been constructed using <code>C</code>.  For every named parameter <code>p</code> of a
constructor <code>C</code>, Dafny defines a <em>destructor</em> <code>p</code>, which is a member
that returns the <code>p</code> parameter from the <code>C</code> call used to construct the
datatype value; its use requires that <code>C?</code> holds.  For example, for
the standard <code>List</code> type</p>
<pre><code class="language-dafny">datatype List&lt;T&gt; = Nil | Cons(head: T, tail: List&lt;T&gt;)
</code></pre>
<p>the following holds:</p>
<pre><code class="language-dafny">Cons(5, Nil).Cons? &amp;&amp; Cons(5, Nil).head == 5
</code></pre>
<p>Note that the expression</p>
<pre><code class="language-dafny">Cons(5, Nil).tail.head
</code></pre>
<p>is not well-formed, since <code>Cons(5, Nil).tail</code> does not satisfy
<code>Cons?</code>.</p>

<p>A constructor can have the same name as
the enclosing datatype; this is especially useful for
single-constructor datatypes, which are often called
<em>record types</em>.  For example, a record type for black-and-white pixels
might be represented as follows:</p>
<pre><code class="language-dafny">datatype Pixel = Pixel(x: int, y: int, on: bool)
</code></pre>

<p>To call a constructor, it is usually necessary only to mention the
name of the constructor, but if this is ambiguous, it is always
possible to qualify the name of constructor by the name of the
datatype.  For example, <code>Cons(5, Nil)</code> above can be written</p>
<pre><code class="language-dafny">List.Cons(5, List.Nil)
</code></pre>

<p>As an alternative to calling a datatype constructor explicitly, a
datatype value can be constructed as a change in one parameter from a
given datatype value using the <em>datatype update</em> expression.  For any
<code>d</code> whose type is a datatype that includes a constructor <code>C</code> that has
a parameter (destructor) named <code>f</code> of type <code>T</code>, and any expression <code>t</code>
of type <code>T</code>,</p>
<pre><code class="language-dafny">d.(f := t)
</code></pre>
<p>constructs a value like <code>d</code> but whose <code>f</code> parameter is <code>t</code>.  The
operation requires that <code>d</code> satisfies <code>C?</code>.  For example, the
following equality holds:</p>
<pre><code class="language-dafny">Cons(4, Nil).(tail := Cons(3, Nil)) == Cons(4, Cons(3, Nil))
</code></pre>

<p>The datatype update expression also accepts multiple field
names, provided these are distinct. For example, a node of some
inductive datatype for trees may be updated as follows:</p>

<pre><code class="language-dafny">node.(left := L, right := R)
</code></pre>

<h3 id="182-co-inductive-datatypes">18.2. Co-inductive datatypes</h3>

<p>TODO: This section and particularly the subsections need rewriting using
the least and greatest terminology, and to make the text fit better into
the overall reference manual.</p>

<p>Whereas Dafny insists that there is a way to construct every inductive
datatype value from the ground up, Dafny also supports
<em>co-inductive datatypes</em>, whose constructors are evaluated lazily, and
hence the language allows infinite structures.
A co-inductive datatype is declared
using the keyword <code>codatatype</code>; other than that, it is declared and
used like an inductive datatype.</p>

<p>For example,</p>
<pre><code class="language-dafny">codatatype IList&lt;T&gt; = Nil | Cons(head: T, tail: IList&lt;T&gt;)
codatatype Stream&lt;T&gt; = More(head: T, tail: Stream&lt;T&gt;)
codatatype Tree&lt;T&gt; = Node(left: Tree&lt;T&gt;, value: T, right: Tree&lt;T&gt;)
</code></pre>
<p>declare possibly infinite lists (that is, lists that can be either
finite or infinite), infinite streams (that is, lists that are always
infinite), and infinite binary trees (that is, trees where every
branch goes on forever), respectively.</p>

<p>The paper [Co-induction Simply], by Leino and
Moskal[@LEINO:Dafny:Coinduction], explains Dafnys implementation and
verification of co-inductive types. We capture the key features from that
paper in this section but the reader is referred to that paper for more
complete details and to supply bibliographic references that are
omitted here.</p>

<h3 id="sec-coinduction">18.3. Co-induction</h3>

<p>Mathematical induction is a cornerstone of programming and program
verification. It arises in data definitions (e.g., some algebraic data
structures can be described using induction), it underlies program
semantics (e.g., it explains how to reason about finite iteration and
recursion), and it is used in proofs (e.g., supporting lemmas about
data structures use inductive proofs). Whereas induction deals with
finite things (data, behavior, etc.), its dual, co-induction, deals with
possibly infinite things. Co-induction, too, is important in programming
and program verification: it arises in data definitions (e.g., lazy
data structures), semantics (e.g., concurrency), and proofs (e.g.,
showing refinement in a co-inductive big-step semantics). It is thus
desirable to have good support for both induction and co-induction in a
system for constructing and reasoning about programs.</p>

<p>Co-datatypes and co-recursive functions make it possible to use lazily
evaluated data structures (like in Haskell or Agda). Co-predicates,
defined by greatest fix-points, let programs state properties of such
data structures (as can also be done in, for example, Coq). For the
purpose of writing co-inductive proofs in the language, we introduce
co-lemmas. Ostensibly, a co-lemma invokes the co-induction hypothesis
much like an inductive proof invokes the induction hypothesis. Underneath
the hood, our co-inductive proofs are actually approached via induction:
co-lemmas provide a syntactic veneer around this approach.</p>

<p>The following example gives a taste of how the co-inductive features in
Dafny come together to give straightforward definitions of infinite
matters.</p>
<pre><code class="language-dafny">// infinite streams
codatatype IStream&lt;T&gt; = ICons(head: T, tail: IStream&lt;T&gt;)

// pointwise product of streams
function Mult(a: IStream&lt;int&gt;, b: IStream&lt;int&gt;): IStream&lt;int&gt;
{ ICons(a.head * b.head, Mult(a.tail, b.tail)) }

// lexicographic order on streams
greatest predicate Below(a: IStream&lt;int&gt;, b: IStream&lt;int&gt;)
{ a.head &lt;= b.head &amp;&amp;
  ((a.head == b.head) ==&gt; Below(a.tail, b.tail))
}

// a stream is Below its Square
greatest lemma Theorem_BelowSquare(a: IStream&lt;int&gt;)
  ensures Below(a, Mult(a, a))
{ assert a.head &lt;= Mult(a, a).head;
  if a.head == Mult(a, a).head {
    Theorem_BelowSquare(a.tail);
  }
}

// an incorrect property and a bogus proof attempt
greatest lemma NotATheorem_SquareBelow(a: IStream&lt;int&gt;)
  ensures Below(Mult(a, a), a); // ERROR
{
  NotATheorem_SquareBelow(a);
}
</code></pre>

<p>The example defines a type <code>IStream</code> of infinite streams, with constructor <code>ICons</code> and
destructors <code>head</code> and <code>tail</code>. Function <code>Mult</code> performs pointwise
multiplication on infinite streams of integers, defined using a
co-recursive call (which is evaluated lazily). Co-predicate <code>Below</code> is
defined as a greatest fix-point, which intuitively means that the
co-predicate will take on the value true if the recursion goes on forever
without determining a different value. The co-lemma states the theorem
<code>Below(a, Mult(a, a))</code>. Its body gives the proof, where the recursive
invocation of the co-lemma corresponds to an invocation of the
co-induction hypothesis.</p>

<p>The proof of the theorem stated by the first co-lemma lends
itself to the following intuitive reading: To prove that <code>a</code> is below
<code>Mult(a, a)</code>, check that their heads are ordered and, if the heads are
equal, also prove that the tails are ordered. The second co-lemma states
a property that does not always hold; the verifier is not fooled by the
bogus proof attempt and instead reports the property as unproved.</p>

<p>We argue that these definitions in Dafny are simple enough to level the
playing field between induction (which is familiar) and co-induction
(which, despite being the dual of induction, is often perceived as eerily
mysterious). Moreover, the automation provided by our SMT-based verifier
reduces the tedium in writing co-inductive proofs. For example, it
verifies <code>Theorem_BelowSquare</code> from the program text given above no
additional lemmas or tactics are needed. In fact, as a consequence of the
automatic-induction heuristic in Dafny, the verifier will
automatically verify <code>Theorem_BelowSquare</code> even given an empty body.</p>

<p>Just like there are restrictions on when an <em>inductive hypothesis</em> can be
invoked, there are restrictions on how a <em>co-inductive</em> hypothesis can be
<em>used</em>. These are, of course, taken into consideration by Dafnys verifier.
For example, as illustrated by the second co-lemma above, invoking the
co-inductive hypothesis in an attempt to obtain the entire proof goal is
futile. (We explain how this works in <a href="#sec-colemmas">Section 18.3.5.2</a>) Our initial experience
with co-induction in Dafny shows it to provide an intuitive, low-overhead
user experience that compares favorably to even the best of todays
interactive proof assistants for co-induction. In addition, the
co-inductive features and verification support in Dafny have other
potential benefits. The features are a stepping stone for verifying
functional lazy programs with Dafny. Co-inductive features have also
shown to be useful in defining language semantics, as needed to verify
the correctness of a compiler, so this opens the possibility that
such verifications can benefit from SMT automation.</p>

<h4 id="1831-well-founded-functionmethod-definitions">18.3.1. Well-Founded Function/Method Definitions</h4>
<p>The Dafny programming language supports functions and methods. A <em>function</em>
in Dafny is a mathematical function (i.e., it is well-defined,
deterministic, and pure), whereas a <em>method</em> is a body of statements that
can mutate the state of the program. A function is defined by its given
body, which is an expression. To ensure that function definitions
are mathematically consistent, Dafny insists that recursive calls be well-founded,
enforced as follows: Dafny computes the call graph of functions. The strongly connected
components within it are <em>clusters</em> of mutually recursive definitions; the clusters are arranged in
a DAG. This stratifies the functions so that a call from one cluster in the DAG to a
lower cluster is allowed arbitrarily. For an intra-cluster call, Dafny prescribes a proof
obligation that is taken through the program verifiers reasoning engine. Semantically,
each function activation is labeled by a <em>rank</em>a lexicographic tuple determined
by evaluating the functions <code>decreases</code> clause upon invocation of the function. The
proof obligation for an intra-cluster call is thus that the rank of the callee is strictly less
(in a language-defined well-founded relation) than the rank of the caller. Because
these well-founded checks correspond to proving termination of executable code, we
will often refer to them as termination checks. The same process applies to methods.</p>

<p>Lemmas in Dafny are commonly introduced by declaring a method, stating
the property of the lemma in the <em>postcondition</em> (keyword <code>ensures</code>) of
the method, perhaps restricting the domain of the lemma by also giving a
<em>precondition</em> (keyword <code>requires</code>), and using the lemma by invoking
the method. Lemmas are stated, used, and proved as methods, but
since they have no use at run time, such lemma methods are typically
declared as <em>ghost</em>, meaning that they are not compiled into code. The
keyword <code>lemma</code> introduces such a method. Control flow statements
correspond to proof techniquescase splits are introduced with if
statements, recursion and loops are used for induction, and method calls
for structuring the proof. Additionally, the statement:</p>
<pre><code class="language-dafny">forall x | P(x) { Lemma(x); }
</code></pre>
<p>is used to invoke <code>Lemma(x)</code> on all <code>x</code> for which <code>P(x)</code> holds. If
<code>Lemma(x)</code> ensures <code>Q(x)</code>, then the forall statement establishes</p>
<pre><code class="language-dafny">forall x :: P(x) ==&gt; Q(x).
</code></pre>

<h4 id="1832-defining-co-inductive-datatypes">18.3.2. Defining Co-inductive Datatypes</h4>
<p>Each value of an inductive datatype is finite, in the sense that it can
be constructed by a finite number of calls to datatype constructors. In
contrast, values of a co-inductive datatype, or co-datatype for short,
can be infinite. For example, a co-datatype can be used to represent
infinite trees.</p>

<p>Syntactically, the declaration of a co-datatype in Dafny looks like that
of a datatype, giving prominence to the constructors (following Coq). The
following example defines a co-datatype Stream of possibly
infinite lists.</p>

<pre><code class="language-dafny">codatatype Stream&lt;T&gt; = SNil | SCons(head: T, tail: Stream)
function Up(n: int): Stream&lt;int&gt; { SCons(n, Up(n+1)) }
function FivesUp(n: int): Stream&lt;int&gt;
  decreases 4 - (n - 1) % 5
{
  if (n % 5 == 0) then
    SCons(n, FivesUp(n+1))
  else
    FivesUp(n+1)
}
</code></pre>

<p><code>Stream</code> is a co-inductive datatype whose values are possibly infinite
lists. Function <code>Up</code> returns a stream consisting of all integers upwards
of <code>n</code> and <code>FivesUp</code> returns a stream consisting of all multiples of 5
upwards of <code>n</code> . The self-call in <code>Up</code> and the first self-call in <code>FivesUp</code>
sit in productive positions and are therefore classified as co-recursive
calls, exempt from termination checks. The second self-call in <code>FivesUp</code> is
not in a productive position and is therefore subject to termination
checking; in particular, each recursive call must decrease the rank
defined by the <code>decreases</code> clause.</p>

<p>Analogous to the common finite list datatype, Stream declares two
constructors, <code>SNil</code> and <code>SCons</code>. Values can be destructed using match
expressions and statements. In addition, like for inductive datatypes,
each constructor <code>C</code> automatically gives rise to a discriminator <code>C?</code> and
each parameter of a constructor can be named in order to introduce a
corresponding destructor. For example, if <code>xs</code> is the stream
<code>SCons(x, ys)</code>, then <code>xs.SCons?</code> and <code>xs.head == x</code> hold. In contrast
to datatype declarations, there is no grounding check for
co-datatypessince a codatatype admits infinite values, the type is
nevertheless inhabited.</p>

<h4 id="1833-creating-values-of-co-datatypes">18.3.3. Creating Values of Co-datatypes</h4>
<p>To define values of co-datatypes, one could imagine a co-function
language feature: the body of a co-function could include possibly
never-ending self-calls that are interpreted by a greatest fix-point
semantics (akin to a <strong>CoFixpoint</strong> in Coq). Dafny uses a different design:
it offers only functions (not co-functions), but it classifies each
intra-cluster call as either <em>recursive</em> or <em>co-recursive</em>. Recursive calls
are subject to termination checks. Co-recursive calls may be
never-ending, which is what is needed to define infinite values of a
co-datatype. For example, function <code>Up(n)</code> in the preceding example is defined as the
stream of numbers from <code>n</code> upward: it returns a stream that starts with <code>n</code>
and continues as the co-recursive call <code>Up(n + 1)</code>.</p>

<p>To ensure that co-recursive calls give rise to mathematically consistent definitions,
they must occur only in productive positions. This says that it must be possible to determine
each successive piece of a co-datatype value after a finite amount of work. This
condition is satisfied if every co-recursive call is syntactically guarded by a constructor
of a co-datatype, which is the criterion Dafny uses to classify intra-cluster calls as being
either co-recursive or recursive. Calls that are classified as co-recursive are exempt from
termination checks.</p>

<p>A consequence of the productivity checks and termination checks is that, even in the
absence of talking about least or greatest fix-points of self-calling functions, all functions
in Dafny are deterministic. Since there cannot be multiple fix-points,
the language allows one function to be involved in both recursive and co-recursive calls,
as we illustrate by the function <code>FivesUp</code>.</p>

<h4 id="sec-copredicates">18.3.4. Greatest predicates</h4>
<p>Determining properties of co-datatype values may require an infinite
number of observations. To that end, Dafny provides <em>greatest predicates</em>
which are function declarations that use the <code>greatest predicate</code> keyword phrase.
Self-calls to a greatest predicate need not terminate. Instead, the value
defined is the greatest fix-point of the given recurrence equations.
Continuing the preceding example, the following code defines a
greatest predicate that holds for exactly those streams whose payload consists
solely of positive integers. The greatest predicate definition implicitly also
gives rise to a corresponding prefix predicate, <code>Pos#</code>. The syntax for
calling a prefix predicate sets apart the argument that specifies the
prefix length, as shown in the last line; for this figure, we took the
liberty of making up a coordinating syntax for the signature of the
automatically generated prefix predicate (which is not part of
Dafny syntax).</p>

<pre><code class="language-dafny">greatest predicate Pos(s: Stream&lt;int&gt;)
{
  match s
  case SNil =&gt; true
  case SCons(x, rest) =&gt; x &gt; 0 &amp;&amp; Pos(rest)
}
// Automatically generated by the Dafny compiler:
predicate Pos#[_k: nat](s: Stream&lt;int&gt;)
  decreases _k
{ if _k = 0 then true else
  match s
  case SNil =&gt; true
  case SCons(x, rest) =&gt; x &gt; 0 &amp;&amp; Pos#[_k-1](rest)
}
</code></pre>

<p>Some restrictions apply. To guarantee that the greatest fix-point always
exists, the (implicit functor defining the) co-predicate must be
monotonic. This is enforced by a syntactic restriction on the form of the
body of co-predicates: after conversion to negation normal form (i.e.,
pushing negations down to the atoms), intra-cluster calls of
co-predicates must appear only in <em>positive</em> positionsthat is, they must
appear as atoms and must not be negated. Additionally, to guarantee
soundness later on, we require that they appear in <em>co-friendly</em>
positionsthat is, in negation normal form, when they appear under
existential quantification, the quantification needs to be limited to a
finite range<sup id="fnref:fn-copredicate-restriction" role="doc-noteref"><a href="#fn:fn-copredicate-restriction" class="footnote" rel="footnote">7</a></sup>. Since the evaluation of a co-predicate might not
terminate, co-predicates are always ghost. There is also a restriction on
the call graph that a cluster containing a co-predicate must contain only
co-predicates, no other kinds of functions.</p>

<p>A <strong>greatest predicate</strong> declaration of <code>P</code> defines not just a greatest predicate, but
also a corresponding <em>prefix predicate</em> <code>P#</code>. A prefix predicate is a
finite unrolling of a co-predicate. The prefix predicate is constructed
from the co-predicate by</p>

<ul>
  <li>
    <p>adding a parameter <code>_k</code> of type <code>nat</code> to denote the prefix length,</p>
  </li>
  <li>
    <p>adding the clause <code>decreases _k;</code> to the prefix predicate (the
co-predicate itself is not allowed to have a decreases clause),</p>
  </li>
  <li>
    <p>replacing in the body of the co-predicate every intra-cluster
call <code>Q(args)</code> to a greatest predicate by a call <code>Q#[_k - 1](args)</code>
to the corresponding prefix predicate, and then</p>
  </li>
  <li>
    <p>prepending the body with <code>if _k = 0 then true else</code>.</p>
  </li>
</ul>

<p>For example, for co-predicate <code>Pos</code>, the definition of the prefix
predicate <code>Pos#</code> is as suggested above. Syntactically, the prefix-length
argument passed to a prefix predicate to indicate how many times to
unroll the definition is written in square brackets, as in <code>Pos#[k](s)</code>.
In the Dafny grammar this is called a <code>HashCall</code>. The definition of
<code>Pos#</code> is available only at clusters strictly higher than that of <code>Pos</code>;
that is, <code>Pos</code> and <code>Pos#</code> must not be in the same cluster. In other
words, the definition of <code>Pos</code> cannot depend on <code>Pos#</code>.</p>

<h5 id="18341-co-equality">18.3.4.1. Co-Equality</h5>
<p>Equality between two values of a co-datatype is a built-in co-predicate.
It has the usual equality syntax <code>s == t</code>, and the corresponding prefix
equality is written <code>s ==#[k] t</code>. And similarly for <code>s != t</code>
and <code>s !=#[k] t</code>.</p>

<h4 id="1835-co-inductive-proofs">18.3.5. Co-inductive Proofs</h4>
<p>From what we have said so far, a program can make use of properties of
co-datatypes. For example, a method that declares <code>Pos(s)</code> as a
precondition can rely on the stream <code>s</code> containing only positive integers.
In this section, we consider how such properties are established in the
first place.</p>

<h5 id="18351-properties-about-prefix-predicates">18.3.5.1. Properties About Prefix Predicates</h5>
<p>Among other possible strategies for establishing co-inductive properties
we take the time-honored approach of reducing co-induction to
induction. More precisely, Dafny passes to the SMT solver an
assumption <code>D(P)</code> for every co-predicate <code>P</code>, where:</p>

<pre><code class="language-dafny">D(P) = ? x  P(x) &lt;==&gt; ? k  P#[k](x)
</code></pre>

<p>In other words, a co-predicate is true iff its corresponding prefix
predicate is true for all finite unrollings.</p>

<p>In Sec. 4 of the paper [Co-induction Simply] a soundness theorem of such
assumptions is given, provided the co-predicates meet the co-friendly
restrictions. An example proof of <code>Pos(Up(n))</code> for every <code>n &gt; 0</code> is
here shown:</p>

<pre><code class="language-dafny">lemma UpPosLemma(n: int)
  requires n &gt; 0
  ensures Pos(Up(n))
{
  forall k | 0 &lt;= k { UpPosLemmaK(k, n); }
}

lemma UpPosLemmaK(k: nat, n: int)
  requires n &gt; 0
  ensures Pos#[k](Up(n))
  decreases k
{
  if k != 0 {
    // this establishes Pos#[k-1](Up(n).tail)
    UpPosLemmaK(k-1, n+1);
  }
}
</code></pre>

<p>The lemma <code>UpPosLemma</code> proves <code>Pos(Up(n))</code> for every <code>n &gt; 0</code>. We first
show <code>Pos#[k](Up(n ))</code>, for <code>n &gt; 0</code> and an arbitrary <code>k</code>, and then use
the forall statement to show <code>? k  Pos#[k](Up(n))</code>. Finally, the axiom
<code>D(Pos)</code> is used (automatically) to establish the co-predicate.</p>

<h5 id="sec-colemmas">18.3.5.2. Greatest lemmas</h5>
<p>As we just showed, with help of the <code>D</code> axiom we can now prove a
greatest predicate by inductively proving that the corresponding prefix
predicate holds for all prefix lengths <code>k</code>. In this section, we introduce
<em>greatest lemma</em> declarations, which bring about two benefits. The first benefit
is that greatest lemmas are syntactic sugar and reduce the tedium of having to
write explicit quantifications over <code>k</code>. The second benefit is that, in
simple cases, the bodies of co-lemmas can be understood as co-inductive
proofs directly. As an example consider the following greatest lemma.</p>

<pre><code class="language-dafny">greatest lemma UpPosLemma(n: int)
  requires n &gt; 0
  ensures Pos(Up(n))
{
  UpPosLemma(n+1);
}
</code></pre>
<p>This co-lemma can be understood as follows: <code>UpPosLemma</code> invokes itself
co-recursively to obtain the proof for <code>Pos(Up(n).tail)</code> (since <code>Up(n).tail</code>
equals <code>Up(n+1)</code>). The proof glue needed to then conclude <code>Pos(Up(n))</code> is
provided automatically, thanks to the power of the SMT-based verifier.</p>

<h5 id="sec-prefix-lemmas">18.3.5.3. Prefix Lemmas</h5>
<p>To understand why the above <code>UpPosLemma</code> greatest lemma code is a sound proof,
let us now describe the details of the desugaring of greatest lemmas. In
analogy to how a <strong>greatest predicate</strong> declaration defines both a greatest predicate and
a prefix predicate, a <strong>greatest lemma</strong> declaration defines both a greatest lemma and
<em>prefix lemma</em>. In the call graph, the cluster containing a greatest lemma must
contain only greatest lemmas and prefix lemmas, no other methods or function.
By decree, a greatest lemma and its corresponding prefix lemma are always
placed in the same cluster. Both greatest lemmas and prefix lemmas are always
ghosts.</p>

<p>The prefix lemma is constructed from the co-lemma by</p>

<ul>
  <li>
    <p>adding a parameter <code>_k</code> of type <code>nat</code> to denote the prefix length,</p>
  </li>
  <li>
    <p>replacing in the co-lemmas postcondition the positive co-friendly
occurrences of co-predicates by corresponding prefix predicates,
passing in <code>_k</code> as the prefix-length argument,</p>
  </li>
  <li>
    <p>prepending <code>_k</code> to the (typically implicit) <strong>decreases</strong> clause of the co-lemma,</p>
  </li>
  <li>
    <p>replacing in the body of the co-lemma every intra-cluster call
<code>M(args)</code> to a greatest lemma by a call <code>M#[_k - 1](args)</code> to the
corresponding prefix lemma, and then</p>
  </li>
  <li>
    <p>making the bodys execution conditional on <code>_k != 0</code>.</p>
  </li>
</ul>

<p>Note that this rewriting removes all co-recursive calls of co-lemmas,
replacing them with recursive calls to prefix lemmas. These recursive
call are, as usual, checked to be terminating. We allow the pre-declared
identifier <code>_k</code> to appear in the original body of the
co-lemma.<sup id="fnref:fn-co-predicate-co-lemma-diffs" role="doc-noteref"><a href="#fn:fn-co-predicate-co-lemma-diffs" class="footnote" rel="footnote">8</a></sup></p>

<p>We can now think of the body of the co-lemma as being replaced by a
<strong>forall</strong> call, for every <em>k</em> , to the prefix lemma. By construction,
this new body will establish the greatest lemmas declared postcondition (on
account of the <code>D</code> axiom, and remembering that only the positive
co-friendly occurrences of co-predicates in the co-lemmas postcondition
are rewritten), so there is no reason for the program verifier to check
it.</p>

<p>The actual desugaring of our co-lemma <code>UpPosLemma</code> is in fact the
previous code for the <code>UpPosLemma</code> lemma except that <code>UpPosLemmaK</code> is
named <code>UpPosLemma#</code> and modulo a minor syntactic difference in how the
<code>k</code> argument is passed.</p>

<p>In the recursive call of the prefix lemma, there is a proof obligation
that the prefixlength argument <code>_k - 1</code> is a natural number.
Conveniently, this follows from the fact that the body has been wrapped
in an <code>if _k != 0</code> statement. This also means that the postcondition must
hold trivially when <code>_k = 0</code>, or else a postcondition violation will be
reported. This is an appropriate design for our desugaring, because
co-lemmas are expected to be used to establish co-predicates, whose
corresponding prefix predicates hold trivially when <code>_k = 0</code>. (To prove
other predicates, use an ordinary lemma, not a co-lemma.)</p>

<p>It is interesting to compare the intuitive understanding of the
co-inductive proof in using a co-lemma with the inductive proof in using
the lemma. Whereas the inductive proof is performing proofs for deeper
and deeper equalities, the co-lemma can be understood as producing the
infinite proof on demand.</p>

<!--PDF NEWPAGE-->
<h2 id="19-statements">19. Statements</h2>
<pre><code class="language-grammar">Stmt = { "label" LabelName ":" } NonLabeledStmt
NonLabeledStmt =
  ( AssertStmt | AssumeStmt | BlockStmt | BreakStmt
  | CalcStmt | ExpectStmt | ForallStmt | IfStmt
  | MatchStmt | ModifyStmt
  | PrintStmt | ReturnStmt | RevealStmt | SkeletonStmt
  | UpdateStmt | UpdateFailureStmt
  | VarDeclStatement | WhileStmt | ForLoopStmt | YieldStmt
  )
</code></pre>
<!--
TODO: RevealStmt, SkeletonStmt
-->

<p>Many of Dafnys statements are similar to those in traditional
programming languages, but a number of them are significantly different.
This grammar production shows the different kinds of Dafny statements.
They are described in subsequent sections.</p>

<h3 id="sec-labeled-stmt">19.1. Labeled Statement</h3>
<pre><code class="language-grammar">Stmt = { "label" LabelName ":" } NonLabeledStmt
</code></pre>
<p>A labeled statement is just the keyword <code>label</code> followed by an identifier
which is the label, followed by a colon and a statement. The label may be
referenced in a <code>break</code> or <code>continue</code> statement within the labeled statement
(see <a href="#sec-break-continue">Section 19.2</a>). That is, the break or continue that
mentions the label must be <em>enclosed</em> in the labeled statement.
The label may also be used in an <code>old</code> expression (<a href="#sec-old-expression">Section 20.24</a>). In this case, the label
must have been encountered during the control flow en route to the <code>old</code>
expression. We say in this case that the (program point of the) label <em>dominates</em>
the (program point of the) use of the label.</p>

<p>A statement can be given several labels. It makes no difference which of these
labels is used to reference the statementthey are synonyms of each other.
The labels must be distinct from each other, and are not allowed to be the
same as any previous enclosing or dominating label.</p>

<h3 id="sec-break-continue">19.2. Break and Continue Statements</h3>
<pre><code class="language-grammar">BreakStmt =
  ( "break" LabelName ";"
  | "continue" LabelName ";"
  | { "break" } "break" ";"
  | { "break" } "continue" ";"
  )
</code></pre>
<p>Break and continue statements provide a means to transfer control
in a way different than the usual nested control structures.
There are two forms of each of these statements: with and without a label.</p>

<p>If a label is used, the break or continue statement must be enclosed in a statement
with that label. The enclosing statement is called the <em>target</em> of the break
or continue.</p>

<p>A <code>break</code> statement transfers control to the point immediately
following the target statement. For example, such a break statement can be
used to exit a sequence of statements in a block statement before
reaching the end of the block.</p>

<p>For example,</p>
<pre><code class="language-dafny">label L: {
  var n := ReadNext();
  if n &lt; 0 {
    break L;
  }
  DoSomething(n);
}
</code></pre>
<p>is equivalent to</p>
<pre><code class="language-dafny">{
  var n := ReadNext();
  if 0 &lt;= n {
    DoSomething(n);
  }
}
</code></pre>

<p>If no label is specified and the statement lists <code>n</code>
occurrences of <code>break</code>, then the statement must be enclosed in
at least <code>n</code> levels of loop statements. Control continues after exiting <code>n</code>
enclosing loops. For example,</p>

<pre><code class="language-dafny">for i := 0 to 10 {
  for j := 0 to 10 {
    label X: {
      for k := 0 to 10 {
        if j + k == 15 {
          break break;
        }
      }
    }
  }
  // control continues here after the "break break", exiting two loops
}
</code></pre>

<p>Note that a non-labeled <code>break</code> pays attention only to loop, not to labeled
statements. For example, the labeled block <code>X</code> in the previous example
does not play a role in determining the target statement of the <code>break break;</code>.</p>

<p>For a <code>continue</code> statement, the target statement must be a loop statement.
The continue statement transfers control to the point immediately
before the closing curly-brace of the loop body.</p>

<p>For example,</p>
<pre><code class="language-dafny">for i := 0 to 100 {
  if i == 17 {
    continue;
  }
  DoSomething(i);
}
</code></pre>
<p>is equivalent to</p>
<pre><code class="language-dafny">for i := 0 to 100 {
  if i != 17 {
    DoSomething(i);
  }
}
</code></pre>
<p>The same effect can also be obtained by wrapping the loop body in a labeled
block statement and then using <code>break</code> with a label, but that usually makes
for a more cluttered program:</p>
<pre><code class="language-dafny">for i := 0 to 100 {
  label LoopBody: {
    if i == 17 {
      break LoopBody;
    }
    DoSomething(i);
  }
}
</code></pre>

<p>Stated differently, <code>continue</code> has the effect of ending the current loop iteration,
after which control continues with any remaining iterations. This is most natural
for <code>for</code> loops. For a <code>while</code> loop, be careful to make progress toward termination
before a <code>continue</code> statement. For example, the following program snippet shows
an easy mistake to make (the verifier will complain that the loop may not terminate):</p>

<pre><code class="language-dafny">var i := 0;
while i &lt; 100 {
  if i == 17 {
    continue; // error: this would cause an infinite loop
  }
  DoSomething(i);
  i := i + 1;
}
</code></pre>

<p>The <code>continue</code> statement can give a label, provided the label is a label of a loop.
For example,</p>

<pre><code class="language-dafny">label Outer:
for i := 0 to 100 {
  for j := 0 to 100 {
    if i + j == 19 {
      continue Outer;
    }
    WorkIt(i, j);
  }
  PostProcess(i);
  // the "continue Outer" statement above transfers control to here
}
</code></pre>

<p>If a non-labeled continue statement lists <code>n</code> occurrences of <code>break</code> before the
<code>continue</code> keyword, then the statement must be enclosed in at least <code>n + 1</code> levels
of loop statements. The effect is to <code>break</code> out of the <code>n</code> most closely enclosing
loops and then <code>continue</code> the iterations of the next loop. That is, <code>n</code> occurrences
of <code>break</code> followed by one more <code>break;</code> will break out of <code>n</code> levels of loops
and then do a <code>break</code>, whereas <code>n</code> occurrences of <code>break</code> followed by <code>continue;</code>
will break out of <code>n</code> levels of loops and then do a <code>continue</code>.</p>

<p>For example, the <code>WorkIt</code> example above can equivalently be written without labels
as</p>
<pre><code class="language-dafny">for i := 0 to 100 {
  for j := 0 to 100 {
    if i + j == 19 {
      break continue;
    }
    WorkIt(i, j);
  }
  PostProcess(i);
  // the "break continue" statement above transfers control to here
}
</code></pre>

<p>Note that a loop invariant is checked on entry to a loop and at the closing curly-brace
of the loop body. It is not checked at break statements. It also isnt checked at continue
statements per se, but the loop invariant is checked as usual at the closing curly-brace
that the continue statement jumps to.
This checking ensures that the loop invariant holds at the very top of
every iteration. Commonly, the only exit out of a loop happens when the loop guard evaluates
to <code>false</code>. Since no state is changed between the top of an iteration (where the loop
invariant is known to hold) and the evaluation of the loop guard, one can also rely on
the loop invariant to hold immediately following the loop. But the loop invariant may
not hold immediately following a loop if a loop iteration changes the program state and
then exits the loop with a break statement.</p>

<p>For example, the following program verifies:</p>
<pre><code class="language-dafny">var i := 0;
while i &lt; 10
  invariant 0 &lt;= i &lt;= 10
{
  if P(i) {
    i := i + 200;
    break;
  }
  i := i + 1;
}
assert i == 10 || 200 &lt;= i &lt; 210;
</code></pre>
<p>To explain the example, the loop invariant <code>0 &lt;= i &lt;= 10</code> is known to hold at the very top
of each iteration,
that is, just before the loop guard <code>i &lt; 10</code> is evaluated. If the loop guard evaluates
to <code>false</code>, then the negated guard condition (<code>10 &lt;= i</code>) and the invariant hold, so
<code>i == 10</code> will hold immediately after the loop. If the loop guard evaluates to <code>true</code>
(that is, <code>i &lt; 10</code> holds), then the loop body is entered. If the test <code>P(i)</code> then evaluates
to <code>true</code>, the loop adds <code>200</code> to <code>i</code> and breaks out of the loop, so on such a
path, <code>200 &lt;= i &lt; 210</code> is known to hold immediately after the loop. This is summarized
in the assert statement in the example.
So, remember, a loop invariant holds at the very top of every iteration, not necessarily
immediately after the loop.</p>

<h3 id="193-block-statement">19.3. Block Statement</h3>
<pre><code class="language-grammar">BlockStmt = "{" { Stmt } "}"
</code></pre>
<p>A block statement is just a sequence of statements enclosed by curly braces.
Local variables declared in the block end their scope at the end of the block.</p>

<h3 id="sec-return-statement">19.4. Return Statement</h3>
<pre><code class="language-grammar">ReturnStmt = "return" [ Rhs { "," Rhs } ] ";"
</code></pre>
<p>A return statement can only be used in a method. It is used
to terminate the execution of the method.</p>

<p>To return a value from a method, the value is assigned to one
of the named out-parameters sometime before a return statement.
In fact, the out-parameters act very much like local variables,
and can be assigned to more than once. Return statements are
used when one wants to return before reaching the end of the
body block of the method.</p>

<p>Return statements can be just the <code>return</code> keyword (where the current values
of the out-parameters are used), or they can take a list of expressions to
return. If a list is given, the number of expressions given must be the same
as the number of named out-parameters. These expressions are
evaluated, then they are assigned to the out-parameters, and then the
method terminates.</p>

<h3 id="sec-yield-statement">19.5. Yield Statement</h3>
<pre><code class="language-grammar">YieldStmt = "yield" [ Rhs { "," Rhs } ] ";"
</code></pre>

<p>A yield statement can only be used in an iterator.
See <a href="#sec-iterator-types">Section 16</a> for more details
about iterators.</p>

<p>The body of an iterator is a <em>co-routine</em>. It is used
to yield control to its caller, signaling that a new
set of values for the iterators yield (out-)parameters (if any)
are available. Values are assigned to the yield parameters
at or before a yield statement.
In fact, the yield parameters act very much like local variables,
and can be assigned to more than once. Yield statements are
used when one wants to return new yield parameter values
to the caller. Yield statements can be just the
<code>yield</code> keyword (where the current values of the yield parameters
are used), or they can take a list of expressions to yield.
If a list is given, the number of expressions given must be the
same as the number of named iterator out-parameters.
These expressions are then evaluated, then they are
assigned to the yield parameters, and then the iterator
yields.</p>

<h3 id="sec-update-and-call-statement">19.6. Update and Call Statements</h3>
<pre><code class="language-grammar">UpdateStmt =
    Lhs
    ( {Attribute} ";"
    |
     { "," Lhs }
     ( ":=" Rhs { "," Rhs }
     | ":|" [ "assume" ]
               Expression(allowLemma: false, allowLambda: true)
     )
     ";"
    )
</code></pre>
<p>If more than one
left-hand side is used, these must denote different l-values, unless the
corresponding right-hand sides also denote the same value.</p>

<p>The update statement serves several logical purposes.</p>

<p>1) The form</p>

<pre><code>Lhs {Attribute} ";"
</code></pre>
<p>is assumed to be a call to a method with no out-parameters.</p>

<p>2) The form</p>

<pre><code>    Lhs { , Lhs } ":=" Rhs ";"
</code></pre>
<p>can occur in the <code>UpdateStmt</code> grammar when there is a single Rhs that
takes the special form of a <code>Lhs</code> that is a call.
This is the only case
where the number of left-hand sides can be different than the number of
right-hand sides in the <code>UpdateStmt</code>. In that case the number of
left-hand sides must match the number of out-parameters of the
method that is called or there must be just one <code>Lhs</code> to the left of
the <code>:=</code>, which then is assigned a tuple of the out-parameters.
Note that the result of a method call is not allowed to be used as an argument of
another method call, as if it were an expression.</p>

<p>3) This is the typical parallel-assignment form, in which no call is involved:</p>
<pre><code>    Lhs { , Lhs } ":=" Rhs { "," Rhs } ";"
</code></pre>
<p>This <code>UpdateStmt</code> is a parallel
assignment of right-hand-side values to the left-hand sides. For example,
<code>x,y := y,x</code> swaps the values of <code>x</code> and <code>y</code>. If more than one
left-hand side is used, these must denote different l-values, unless the
corresponding right-hand sides also denote the same value. There must
be an equal number of left-hand sides and right-hand sides in this case.
Of course, the most common case will have only one
<code>Rhs</code> and one <code>Lhs</code>.</p>

<p>4) The form</p>
<pre><code>  Lhs { "," Lhs } :| [ "assume" ] Expression&lt;false,false&gt;
</code></pre>
<p>using <code>:|</code> assigns some values to the left-hand side
variables such that the boolean expression on the right hand side
is satisfied. This can be used to make a choice as in the
following example where we choose an element in a set.
The given boolean expression need not constrain the LHS values uniquely.</p>

<pre><code class="language-dafny">method Sum(X: set&lt;int&gt;) returns (s: int)
{
  s := 0; var Y := X;
  while Y != {}
    decreases Y
  {
    var y: int;
    y :| y in Y;
    s, Y := s + y, Y - {y};
  }
}
</code></pre>

<p>Dafny will report an error if it cannot prove that values
exist that satisfy the condition.</p>

<p>In addition, as the choice is arbitrary,
assignment statements using <code>:|</code> may be non-deterministic
when executed.</p>

<p>Note that the form</p>

<pre><code class="language-grammar">    Lhs ":"
</code></pre>

<p>is diagnosed as a label in which the user forgot the <code>label</code> keyword.</p>

<h3 id="sec-update-failure">19.7. Update with Failure Statement (<code>:-</code>)</h3>
<pre><code class="language-grammar">UpdateFailureStmt  =
    [ Lhs { "," Lhs } ]
    ":-"
    [ "expect"  | "assert" | "assume" ]
    Expression(allowLemma: false, allowLambda: false)
    { "," Rhs }
    ";"
</code></pre>

<p>A <code>:-</code> statement is an alternate form of the <code>:=</code> statement that allows for abrupt return if a failure is detected.
This is a language feature somewhat analogous to exceptions in other languages.</p>

<p>An update-with-failure statement uses <em>failure-compatible</em> types.
A failure-compatible type is a type that has the following members (each with no in-parameters and one out-parameter):</p>

<ul>
  <li>a function method <code>IsFailure()</code> that returns a <code>bool</code></li>
  <li>an optional function method <code>PropagateFailure()</code> that returns a value assignable to the first out-parameter of the caller</li>
  <li>an optional method or function <code>Extract()</code></li>
</ul>

<p>A failure-compatible type with an <code>Extract</code> member is called <em>value-carrying</em>.</p>

<p>To use this form of update,</p>

<ul>
  <li>if the RHS of the update-with-failure statement is a method call, 
the first out-parameter of the callee must be failure-compatible</li>
  <li>if instead the RHS of the update-with-failure statement is one or 
more expressions, the first of these expressions must be a value with a 
failure-compatible type</li>
  <li>the caller must have a first out-parameter whose type matches the output of <code>PropagateFailure</code> applied to the first output of the callee, unless an
<code>expect</code>, <code>assume</code>, or <code>assert</code> keyword is used after <code>:-</code> (cf. <a href="#sec-failure-return-keyword">Section 19.7.7</a>).</li>
  <li>if the failure-compatible type of the RHS does not have an <code>Extract</code> member,
then the LHS of the <code>:-</code> statement has one less expression than the RHS
(or than the number of out-parameters from the method call)</li>
  <li>if the failure-compatible type of the RHS does have an <code>Extract</code> member,
then the LHS of the <code>:-</code> statement has the same number of expressions as the RHS
(or as the number of out-parameters from the method call)
and the type of the first LHS expression must be assignable from the return type of the <code>Extract</code> member</li>
  <li>the <code>IsFailure</code> and <code>PropagateFailure</code> methods may not be ghost</li>
  <li>the LHS expression assigned the output of the <code>Extract</code> member is ghost precisely if <code>Extract</code> is ghost</li>
</ul>

<p>The following subsections show various uses and alternatives.</p>

<h4 id="1971-failure-compatible-types">19.7.1. Failure compatible types</h4>

<p>A simple failure-compatible type is the following:</p>
<pre><code class="language-dafny">datatype Status =
| Success
| Failure(error: string)
{
  predicate method IsFailure() { this.Failure?  }
  function method PropagateFailure(): Status
    requires IsFailure()
  {
    Failure(this.error)
  }
}


</code></pre>

<p>A commonly used alternative that carries some value information is something like this generic type:</p>
<pre><code class="language-dafny">datatype Outcome&lt;T&gt; =
| Success(value: T)
| Failure(error: string)
{
  predicate method IsFailure() {
    this.Failure?
  }
  function method PropagateFailure&lt;U&gt;(): Outcome&lt;U&gt;
    requires IsFailure()
  {
    Failure(this.error) // this is Outcome&lt;U&gt;.Failure(...)
  }
  function method Extract(): T
    requires !IsFailure()
  {
    this.value
  }
}


</code></pre>

<h4 id="1972-simple-status-return-with-no-other-outputs">19.7.2. Simple status return with no other outputs</h4>

<p>The simplest use of this failure-return style of programming is to have a method call that just returns a non-value-carrying <code>Status</code> value:</p>
<pre><code class="language-dafny">method Callee(i: int) returns (r: Status)
{
  if i &lt; 0 { return Failure("negative"); }
  return Success;
}

method Caller(i: int) returns (rr: Status)
{
  :- Callee(i);
  ...
}
</code></pre>

<p>Note that there is no LHS to the <code>:-</code> statement.
If <code>Callee</code> returns <code>Failure</code>, then the caller immediately returns,
not executing any statements following the call of <code>Callee</code>.
The value returned by <code>Caller</code> (the value of <code>rr</code> in the code above) is the result of <code>PropagateFailure</code> applied to the value returned by <code>Callee</code>, which is often just the same value.
If <code>Callee</code> does not return <code>Failure</code> (that is, returns a value for which <code>IsFailure()</code> is <code>false</code>)
then that return value is forgotten and execution proceeds normally with the statements following the call of <code>Callee</code> in the body of <code>Caller</code>.</p>

<p>The desugaring of the <code>:- Callee(i);</code> statement is</p>
<pre><code class="language-dafny">var tmp;
tmp := Callee(i);
if tmp.IsFailure() {
  rr := tmp.PropagateFailure();
  return;
}
</code></pre>
<p>In this and subsequent examples of desugaring, the <code>tmp</code> variable is a new, unique variable, unused elsewhere in the calling member.</p>

<h4 id="1973-status-return-with-additional-outputs">19.7.3. Status return with additional outputs</h4>

<p>The example in the previous subsection affects the program only through side effects or the status return itself.
It may well be convenient to have additional out-parameters, as is allowed for <code>:=</code> updates;
these out-parameters behave just as for <code>:=</code>.
Here is an example:</p>

<pre><code class="language-dafny">method Callee(i: int) returns (r: Status, v: int, w: int)
{
  if i &lt; 0 { return Failure("negative"), 0, 0; }
  return Success, i+i, i*i;
}

method Caller(i: int) returns (rr: Status, k: int)
{
  var j: int;
  j, k :- Callee(i);
  k := k + k;
  ...
}
</code></pre>

<p>Here <code>Callee</code> has two outputs in addition to the <code>Status</code> output.
The LHS of the <code>:-</code> statement accordingly has two l-values to receive those outputs.
The recipients of those outputs may be any sort of l-values;
here they are a local variable and an out-parameter of the caller.
Those outputs are assigned in the <code>:-</code> call regardless of the <code>Status</code> value:</p>

<ul>
  <li>If <code>Callee</code> returns a failure value as its first output, then the other outputs are assigned, the <em>callers</em> first out-parameter (here <code>rr</code>) is assigned the value of <code>PropagateFailure</code>, and the caller returns.</li>
  <li>If <code>Callee</code> returns a non-failure value as its first output, then the other outputs are assigned and the
caller continues execution as normal.</li>
</ul>

<p>The desugaring of the <code>j, k :- Callee(i);</code> statement is</p>
<pre><code class="language-dafny">var tmp;
tmp, j, k := Callee(i);
if tmp.IsFailure() {
  rr := tmp.PropagateFailure();
  return;
}
</code></pre>

<h4 id="1974-failure-returns-with-additional-data">19.7.4. Failure-returns with additional data</h4>

<p>The failure-compatible return value can carry additional data as shown in the <code>Outcome&lt;T&gt;</code> example above.
In this case there is a (first) LHS l-value to receive this additional data.</p>

<pre><code class="language-dafny">method Callee(i: int) returns (r: Outcome&lt;nat&gt;, v: int)
{
  if i &lt; 0 { return Failure("negative"), i+i; }
  return Success(i), i+i;
}

method Caller(i: int) returns (rr: Outcome&lt;int&gt;, k: int)
{
  var j: int;
  j, k :- Callee(i);
  k := k + k;
  ...
}
</code></pre>

<p>Suppose <code>Caller</code> is called with an argument of <code>10</code>.
Then <code>Callee</code> is called with argument <code>10</code>
and returns <code>r</code> and <code>v</code> of <code>Outcome&lt;nat&gt;.Success(10)</code> and <code>20</code>.
Here <code>r.IsFailure()</code> is <code>false</code>, so control proceeds normally.
The <code>j</code> is assigned the result of <code>r.Extract()</code>, which will be <code>10</code>,
and <code>k</code> is assigned <code>20</code>.
Control flow proceeds to the next line, where <code>k</code> now gets the value <code>40</code>.</p>

<p>Suppose instead that <code>Caller</code> is called with an argument of <code>-1</code>.
Then <code>Callee</code> is called with the value <code>-1</code>
 and returns <code>r</code> and <code>v</code> with values <code>Outcome&lt;nat&gt;.Failure("negative")</code> and <code>-2</code>.
<code>k</code> is assigned the value of <code>v</code> (-2).
But <code>r.IsFailure()</code> is <code>true</code>, so control proceeds directly to return from <code>Caller</code>.
The first out-parameter of <code>Caller</code> (<code>rr</code>) gets the value of <code>r.PropagateFailure()</code>,
which is <code>Outcome&lt;int&gt;.Failure("negative")</code>; <code>k</code> already has the value <code>-2</code>.
The rest of the body of <code>Caller</code> is skipped.
In this example, the first out-parameter of <code>Caller</code> has a failure-compatible type
so the exceptional return will propagate up the call stack.
It will keep propagating up the call stack
as long as there are callers with this first special output type
and calls that use <code>:-</code>
and the return value keeps having <code>IsFailure()</code> true.</p>

<p>The desugaring of the <code>j, k :- Callee(i);</code> statement in this example is</p>
<pre><code class="language-dafny">var tmp;
tmp, k := Callee(i);
if tmp.IsFailure() {
  rr := tmp.PropagateFailure();
  return;
}
j := tmp.Extract();
</code></pre>

<h4 id="1975-rhs-with-expression-list">19.7.5. RHS with expression list</h4>

<p>Instead of a failure-returning method call on the RHS of the statement,
the RHS can instead be a list of expressions.
As for a <code>:=</code> statement, in this form, the expressions on the left and right sides of <code>:-</code> must correspond,
just omitting a LHS l-value for the first RHS expression if its type is not value-carrying.
The semantics is very similar to that in the previous subsection.</p>

<ul>
  <li>The first RHS expression must have a failure-compatible type.</li>
  <li>All the assignments of RHS expressions to LHS values except for the first RHS value are made.</li>
  <li>If the first RHS value (say <code>r</code>) responds <code>true</code> to <code>r.IsFailure()</code>,
then <code>r.PropagateFailure()</code> is assigned to the first out-parameter of the <em>caller</em>
and the execution of the callers body is ended.</li>
  <li>If the first RHS value (say <code>r</code>) responds <code>false</code> to <code>r.IsFailure()</code>, then
    <ul>
      <li>if the type of <code>r</code> is value-carrying, then <code>r.Extract()</code> is assigned to the first LHS value of the <code>:-</code> statement
(if <code>r</code> is not value-carrying, then the corresponding LHS l-value is omitted)</li>
      <li>execution of the callers body continues with the statement following the <code>:-</code> statement.</li>
    </ul>
  </li>
</ul>

<p>A RHS with a method call cannot be mixed with a RHS containing multiple expressions.</p>

<p>For example, the desugaring of</p>
<pre><code class="language-dafny">method m(Status r) returns (rr: Status) {
  var k;
  k :- r, 7;
  ...
}
</code></pre>
<p>is</p>
<pre><code class="language-dafny">var k;
var tmp;
tmp, k := r, 7;
if tmp.IsFailure() {
  rr := tmp.PropagateFailure();
  return;
}
</code></pre>
<h4 id="1976-failure-with-initialized-declaration">19.7.6. Failure with initialized declaration.</h4>

<p>The <code>:-</code> syntax can also be used in initialization, as in</p>
<pre><code class="language-dafny">var s :- M();
</code></pre>
<p>This is equivalent to</p>
<pre><code class="language-dafny">var s;
s :- M();
</code></pre>
<p>with the semantics as described above.</p>

<h4 id="sec-failure-return-keyword">19.7.7. Keyword alternative</h4>

<p>In any of the above described uses of <code>:-</code>, the <code>:-</code> token may be followed immediately by the keyword <code>expect</code>, <code>assert</code> or <code>assume</code>.</p>

<ul>
  <li><code>assert</code> means that the RHS evaluation is expected to be successful, but that
the verifier should prove that this is so; that is, the verifier should prove
<code>assert !r.IsFailure()</code> (where <code>r</code> is the status return from the callee)
(cf. <a href="#sec-assert-statement">Section 19.16</a>)</li>
  <li><code>assume</code> means that the RHS evaluation should be assumed to be successful,
as if the statement <code>assume !r.IsFailure()</code> followed the evaluation of the RHS
(cf. <a href="#sec-assume-statement">Section 19.17</a>)</li>
  <li><code>expect</code> means that the RHS evaluation should be assumed to be successful
(like using <code>assume</code> above), but that the compiler should include a
run-time check for success. This is equivalent to including
<code>expect !r.IsFailure()</code> after the RHS evaluation; that is, if the status
return is a failure, the program halts.
(cf. <a href="#sec-expect-statement">Section 19.18</a>)</li>
</ul>

<p>In each of these cases, there is no abrupt return from the caller. Thus
there is no evaluation of <code>PropagateFailure</code>. Consequently the first
out-parameter of the caller need not match the return type of
<code>PropagateFailure</code>; indeed, the failure-compatible type returned by the
callee need not have a <code>PropagateFailure</code> member.</p>

<p>The equivalent desugaring replaces</p>
<pre><code class="language-dafny">if tmp.IsFailure() {
  rr := tmp.PropagateFailure();
  return;
}
</code></pre>
<p>with</p>
<pre><code class="language-dafny">expect !tmp.IsFailure(), tmp;
</code></pre>
<p>or</p>
<pre><code class="language-dafny">assert !tmp.IsFailure();
</code></pre>
<p>or</p>
<pre><code class="language-dafny">assume !tmp.IsFailure();
</code></pre>

<p>There is a grammatical nuance that the user should be aware of.
The keywords <code>assert</code>, <code>assume</code>, and <code>expect</code> can start an expression.
For example, <code>assert P; E</code> can be an expression. However, in
<code>e :- assert P; E;</code> the <code>assert</code> is parsed as the keyword associated with
<code>:-</code>. To have the <code>assert</code> considered part of the expression use parentheses:
<code>e :- (assert P; E);</code>.</p>

<h4 id="1978-key-points">19.7.8. Key points</h4>

<p>There are several points to note.</p>

<ul>
  <li>The first out-parameter of the callee is special.
It has a special type and that type indicates that the value is inspected to see if an abrupt return
from the caller is warranted.
This type is often a datatype, as shown in the examples above, but it may be any type with the appropriate members.</li>
  <li>The restriction on the type of callers first out-parameter is
just that it must be possible (perhaps through generic instantiation and type inference, as in these examples) for <code>PropagateFailure</code> applied to the failure-compatible output from the callee to produce a value of the callers first out-parameter type.
If the callers first out-parameter type is failure-compatible (which it need not be),
 then failures can be propagated up the call chain.
If the keyword form of the statement is used, then no <code>PropagateFailure</code> member
is needed and there is no restriction on the callers first out-parameter.</li>
  <li>In the statement <code>j, k :- Callee(i);</code>,
 when the callees return value has an <code>Extract</code> member,
the type of <code>j</code> is not the type of the first out-parameter of <code>Callee</code>.
Rather it is a type assignable from the output type of <code>Extract</code> applied to the first out-value of <code>Callee</code>.</li>
  <li>A method like <code>Callee</code> with a special first out-parameter type can still be used in the normal way:
<code>r, k := Callee(i)</code>.
Now <code>r</code> gets the first output value from <code>Callee</code>, of type <code>Status</code> or <code>Outcome&lt;nat&gt;</code> in the examples above.
No special semantics or exceptional control paths apply.
Subsequent code can do its own testing of the value of <code>r</code>
and whatever other computations or control flow are desired.</li>
  <li>The caller and callee can have any (positive) number of output arguments,
as long as the callees first out-parameter has a failure-compatible type
and the callers first out-parameter type matches <code>PropagateFailure</code>.</li>
  <li>If there is more than one LHS, the LHSs must denote different 
l-values, unless the RHS is a list of expressions and the corresponding 
RHS values are equal.</li>
  <li>The LHS l-values are evaluated before the RHS method call,
in case the method call has side-effects or return values that modify the l-values prior to assignments being made.</li>
</ul>

<p>It is important to note the connection between the failure-compatible types used in the caller and callee,
if they both use them.
They do not have to be the same type, but they must be closely related,
as it must be possible for the callees <code>PropagateFailure</code> to
 return a value of the callers failure-compatible type.
In practice this means that one such failure-compatible type should be 
used for an entire program.
If a Dafny program uses a library shared by multiple programs, the 
library should supply such a type and it should be used by all the 
client programs (and, effectively, all Dafny libraries).
It is also the case that it is inconvenient to mix types such as <code>Outcome</code> and <code>Status</code> above within the same program.
If there is a mix of failure-compatible types, then the program will need to use <code>:=</code> statements and code for
explicit handling of failure values.</p>

<h4 id="1979-failure-returns-and-exceptions">19.7.9. Failure returns and exceptions</h4>

<p>The <code>:-</code> mechanism is like the exceptions used in other programming languages, with some similarities and differences.</p>

<ul>
  <li>There is essentially just one kind of exception in Dafny,
the variations of the failure-compatible data type.</li>
  <li>Exceptions are passed up the call stack whether or not intervening
 methods are aware of the possibility of an exception,
that is, whether or not the intervening methods have declared that they 
throw exceptions.
Not so in Dafny: a failure is passed up the call stack only if each 
caller has a failure-compatible first out-parameter, is itself called in
 a <code>:-</code> statement, and returns a value that responds true to <code>IsFailure()</code>.</li>
  <li>All methods that contain failure-return callees must explicitly handle those failures
using either <code>:-</code> statements or using <code>:=</code> statements with a LHS to receive the failure value.</li>
</ul>

<h3 id="sec-var-decl-statement">19.8. Variable Declaration Statement</h3>
<pre><code class="language-grammar">VarDeclStatement =
  [ "ghost" ] "var" { Attribute }
  (
    LocalIdentTypeOptional
    { "," { Attribute } LocalIdentTypeOptional }
    [ ":="
      Rhs { "," Rhs }
    | ":-"
      [ "expect" | "assert" | "assume" ]
      Expression(allowLemma: false, allowLambda: false)
      { "," Rhs }
    | { Attribute }
      ":|"
      [ "assume" ] Expression(allowLemma: false, allowLambda: true)
    ]
  |
    CasePatternLocal
    ( ":=" | { Attribute } ":|" )
    Expression(allowLemma: false, allowLambda: true)
  )
  ";"

CasePatternLocal = ( [ Ident ] "(" CasePatternLocsl { "," CasePatternLocal } ")"
                   | LocalIdentTypeOptional
                   )
</code></pre>

<p>A <code>VarDeclStatement</code> is used to declare one or more local variables in
a method or function. The type of each local variable must be given
unless its type can be inferred, either from a given initial value, or
from other uses of the variable. If initial values are given, the number
of values must match the number of variables declared.</p>

<p>Note that the type of each variable must be given individually. The following code</p>

<pre><code class="language-dafny">var x, y : int;
</code></pre>
<p>does not declare both <code>x</code> and <code>y</code> to be of type <code>int</code>. Rather it will give an
error explaining that the type of <code>x</code> is underspecified if it cannot be
inferred from uses of x.</p>

<p>What follows the <code>LocalIdentTypeOptional</code> optionally combines the variable
declarations with an update statement (cf. <a href="#sec-update-and-call-statement">Section 19.6</a>).
If the RHS is a call, then any variable receiving the value of a
formal ghost out-parameter will automatically be declared as ghost, even
if the <code>ghost</code> keyword is not part of the variable declaration statement.</p>

<p>The left-hand side can also contain a tuple of patterns that will be
matched against the right-hand-side. For example:</p>

<pre><code class="language-dafny">function returnsTuple() : (int, int)
{
    (5, 10)
}

function usesTuple() : int
{
    var (x, y) := returnsTuple();
    x + y
}
</code></pre>

<p>The assignment with failure operator <code>:-</code> returns from the method if the value evaluates to a failure value of a failure-compatible type, see <a href="https://dafny-lang.github.io/dafny/DafnyRef/sec-update-failure">Section 19.7</a>.</p>

<h3 id="199-guards">19.9. Guards</h3>
<pre><code class="language-grammar">Guard = ( "*"
        | "(" "*" ")"
        | Expression(allowLemma: true, allowLambda: true)
        )
</code></pre>
<p>Guards are used in <code>if</code> and <code>while</code> statements as boolean expressions. Guards
take two forms.</p>

<p>The first and most common form is just a boolean expression.</p>

<p>The second form is either <code>*</code> or <code>(*)</code>. These have the same meaning. An
unspecified boolean value is returned. The value returned
may be different each time it is executed.</p>

<h3 id="1910-binding-guards">19.10. Binding Guards</h3>
<pre><code class="language-grammar">BindingGuard(allowLambda) =
  IdentTypeOptional { "," IdentTypeOptional }
  { Attribute }
  ":|"
  Expression(allowLemma: true, allowLambda)
</code></pre>

<p><code>IfStmt</code>s can also take a <code>BindingGuard</code>.
It checks if there exist values for the given variables that satisfy the given expression.
If so, it binds some satisfying values to the variables and proceeds
into the then branch; otherwise it proceeds with the else branch,
where the bound variables are not in scope.</p>

<p>In other words, the statement</p>

<pre><code class="language-dafny">if x :| P { S } else { T }
</code></pre>

<p>has the same meaning as</p>

<pre><code class="language-dafny">if exists x :| P { var x :| P; S } else { T }
</code></pre>

<p>The identifiers bound by <code>BindingGuard</code> are ghost variables
and cannot be assigned to non-ghost variables. They are only
used in specification contexts.</p>

<p>Here is an example:</p>

<pre><code class="language-dafny">predicate P(n: int)
{
  n % 2 == 0
}

method M1() returns (ghost y: int)
    requires exists x :: P(x)
    ensures P(y)
{
  if x : int :| P(x) {
      y := x;
  }
}
</code></pre>

<h3 id="sec-if-statement">19.11. If Statement</h3>
<pre><code class="language-grammar">IfStmt = "if"
  ( AlternativeBlock(allowBindingGuards: true)
  |
    ( BindingGuard(allowLambda: true)
    | Guard
    | ellipsis
    )
    BlockStmt [ "else" ( IfStmt | BlockStmt ) ]
  )

AlternativeBlock(allowBindingGuards) =
  ( { AlternativeBlockCase(allowBindingGuards) }
  | "{" { AlternativeBlockCase(allowBindingGuards) } "}"
  )

AlternativeBlockCase(allowBindingGuards) =
      { "case"
      (
        BindingGuard(allowLambda: false) // permitted iff allowBindingGuards == true
      | Expression(allowLemma: true, allowLambda: false)
      ) "=&gt;" { Stmt } } .
</code></pre>

<p>The simplest form of an <code>if</code> statement uses a guard that is a boolean
expression. For example,</p>

<pre><code class="language-dafny">  if x &lt; 0 {
    x := -x;
  }
</code></pre>

<p>Unlike <code>match</code> statements, <code>if</code> statements do not have to be exhaustive:
omitting the <code>else</code> block is the same as including an empty <code>else</code>
block.  To ensure that an <code>if</code> statement is exhaustive, use the
<code>if-case</code> statement documented below.</p>

<p>If the guard is an asterisk then a non-deterministic choice is made:</p>

<pre><code class="language-dafny">  if * {
    print "True";
  } else {
    print "False";
  }
</code></pre>

<p>The <code>if-case</code> statement using the <code>AlternativeBlock</code> form is similar to the
<code>if ... fi</code> construct used in the book A Discipline of Programming by
Edsger W. Dijkstra. It is used for a multi-branch <code>if</code>.</p>

<p>For example:</p>
<pre><code class="language-dafny">  if {
    case x &lt;= y =&gt; max := y;
    case y &lt;= x =&gt; max := x;
  }
</code></pre>

<p>In this form, the expressions following the <code>case</code> keyword are called
<em>guards</em>. The statement is evaluated by evaluating the guards in an
undetermined order until one is found that is <code>true</code> and the statements
to the right of <code>=&gt;</code> for that guard are executed. The statement requires
at least one of the guards to evaluate to <code>true</code> (that is, <code>if-case</code>
statements must be exhaustive: the guards must cover all cases).</p>

<p>TODO: Describe the  refinement</p>

<h3 id="1912-while-statement">19.12. While Statement</h3>
<pre><code class="language-grammar">WhileStmt =
  "while"
  ( LoopSpec
    AlternativeBlock(allowBindingGuards: false)
  | ( Guard | ellipsis )
    LoopSpec
    ( BlockStmt
    | ellipsis
    | /* go body-less */
    )
  )
</code></pre>

<p>Loops need <em>loop specifications</em> (<code>LoopSpec</code> in the grammar) in order for Dafny to prove that
they obey expected behavior. In some cases Dafny can infer the loop specifications by analyzing the code,
so the loop specifications need not always be explicit.
These specifications are described in <a href="#sec-loop-specification">Section 19.14</a>.</p>

<p>The general loop statement in Dafny is the familiar <code>while</code> statement.
It has two general forms.</p>

<p>The first form is similar to a while loop in a C-like language. For
example:</p>

<pre><code class="language-dafny">  var i := 0;
  while i &lt; 5 {
    i := i + 1;
  }
</code></pre>

<p>In this form, the condition following the <code>while</code> is one of these:</p>

<ul>
  <li>A boolean expression. If true it means execute one more
iteration of the loop. If false then terminate the loop.</li>
  <li>An asterisk (<code>*</code>), meaning non-deterministically yield either
<code>true</code> or <code>false</code> as the value of the condition</li>
</ul>

<!--
Keep the following commented out until we decide a better
place to put it.

* An ellipsis (`...`), which makes the while statement a _skeleton_
`while` statement. TODO: What does that mean?

The _body_ of the loop is usually a block statement, but it can also
be a _skeleton_, denoted by ellipsis, or missing altogether.
TODO: Wouldn't a missing body cause problems? Isn't it clearer to have
a block statement with no statements inside?
-->

<p>The second form uses the <code>AlternativeBlock</code>. It is similar to the
<code>do ... od</code> construct used in the book A Discipline of Programming by
Edsger W. Dijkstra. For example:</p>

<pre><code class="language-dafny">  while
    decreases if 0 &lt;= r then r else -r;
  {
    case r &lt; 0 =&gt;
      r := r + 1;
    case 0 &lt; r =&gt;
      r := r - 1;
  }
</code></pre>
<p>For this form, the guards are evaluated in some undetermined order
until one is found that is true, in which case the corresponding statements
are executed and the while statement is repeated.
If none of the guards evaluates to true, then the
loop execution is terminated.</p>

<p>TODO: Describe  refinement</p>

<h3 id="1913-for-loops">19.13. For Loops</h3>
<pre><code class="language-grammar">ForLoopStmt =
  "for" IdentTypeOptional ":="
    Expression(allowLemma: false, allowLambda: false)
    ( "to" | "downto" )
    ( Expression(allowLemma: false, allowLambda: false)
    | "*"
    )
    LoopSpec
    ( BlockStmt
    | /* go body-less */
    )
  )
</code></pre>

<p>The <code>for</code> statement provides a convenient way to write some common loops.</p>

<p>The statement introduces a local variable <code>IdentTypeOptional</code>, which is called
the <em>loop index</em>. The loop index is in scope in the <code>LoopSpec</code> and <code>BlockStmt</code>,
but not after the <code>for</code> loop. Assignments to the loop index are not allowed.
The type of the loop index can typically be inferred, so it need not be given
explicitly. If the identifier is not used, it can be written as <code>_</code>, as illustrated
in this repeat-20-times loop:</p>
<pre><code class="language-dafny">for _ := 0 to 20 {
  Body
}
</code></pre>

<p>There are four basic variations of the <code>for</code> loop:</p>
<pre><code class="language-dafny">for i: T := lo to hi
  LoopSpec
{ Body }

for i: T := hi downto lo
  LoopSpec
{ Body }

for i: T := lo to *
  LoopSpec
{ Body }

for i: T := hi downto *
  LoopSpec
{ Body }
</code></pre>
<p>Semantically, they are defined as the following respective <code>while</code> loops:</p>
<pre><code class="language-dafny">{
  var _lo, _hi := lo, hi;
  assert _lo &lt;= _hi &amp;&amp; forall _i: int :: _lo &lt;= _i &lt;= _hi ==&gt; _i is T;
  var i := _lo;
  while i != _hi
    invariant _lo &lt;= i &lt;= _hi
    LoopSpec
    decreases _hi - i
  {
    Body
    i := i + 1;
  }
}

{
  var _lo, _hi := lo, hi;
  assert _lo &lt;= _hi &amp;&amp; forall _i: int :: _lo &lt;= _i &lt;= _hi ==&gt; _i is T;
  var i := _hi;
  while i != lo
    invariant _lo &lt;= i &lt;= _hi
    LoopSpec
    decreases i - _lo
  {
    i := i - 1;
    Body
  }
}

{
  var _lo := lo;
  assert forall _i: int :: _lo &lt;= _i ==&gt; _i is T;
  var i := _lo;
  while true
    invariant _lo &lt;= i
    LoopSpec
  {
    Body
    i := i + 1;
  }
}

{
  var _hi := hi;
  assert forall _i: int :: _i &lt;= _hi ==&gt; _i is T;
  var i := _hi;
  while true
    invariant i &lt;= _hi
    LoopSpec
  {
    i := i - 1;
    Body
  }
}
</code></pre>

<p>Note that expressions <code>lo</code> and <code>hi</code> are evaluated just once, before the loop
iterations start.</p>

<p>Also, note in all variations that the values of <code>i</code> in the body are the values
from <code>lo</code> to, <em>but not including</em>, <code>hi</code>. This makes it convenient to
write common loops, including these:</p>

<pre><code class="language-dafny">for i := 0 to a.Length {
  Process(a[i]);
}
for i := a.Length downto 0 {
  Process(a[i]);
}
</code></pre>
<p>Nevertheless, <code>hi</code> must be a legal value for the type of the index variable,
since that is how the index variable is used in the invariant.</p>

<p>If the end-expression is not <code>*</code>, then no explicit <code>decreases</code> is
allowed, since such a loop is already known to terminate.
If the end-expression is <code>*</code>, then the absence of an explicit <code>decreases</code>
clause makes it default to <code>decreases *</code>. So, if the end-expression is <code>*</code> and no
explicit <code>decreases</code> clause is given, the loop is allowed only in methods
that are declared with <code>decreases *</code>.</p>

<p>The directions <code>to</code> or <code>downto</code> are contextual keywords. That is, these two
words are part of the syntax of the <code>for</code> loop, but they are not reserved
keywords elsewhere.</p>

<h3 id="sec-loop-specification">19.14. Loop Specifications</h3>
<p>For some simple loops, such as those mentioned previously, Dafny can figure
out what the loop is doing without more help. However, in general the user
must provide more information in order to help Dafny prove the effect of
the loop. This information is provided by a <code>LoopSpec</code>. A
<code>LoopSpec</code> provides information about invariants, termination, and
what the loop modifies.
For additional tutorial information see [@KoenigLeino:MOD2011] or the
<a href="https://dafny-lang.github.io/dafny/OnlineTutorial/guide">online Dafny tutorial</a>.</p>

<h4 id="19141-loop-invariants">19.14.1. Loop invariants</h4>

<p>Loops present a problem for specification-based reasoning. There is no way to
know in advance how many times the code will go around the loop and
a tool cannot reason about every one of a possibly unbounded sequence of unrollings.
In order to consider all paths through a program, specification-based
program verification tools require loop invariants, which are another kind of
annotation.</p>

<p>A loop invariant is an expression that holds just prior to the loop test,
that is, upon entering a loop and
after every execution of the loop body. It captures something that is
invariant, i.e. does not change, about every step of the loop. Now,
obviously we are going to want to change variables, etc. each time around
the loop, or we wouldnt need the loop. Like pre- and postconditions, an
invariant is a property that is preserved for each execution of the loop,
expressed using the same boolean expressions we have seen. For example,</p>

<pre><code class="language-dafny">var i := 0;
while i &lt; n
  invariant 0 &lt;= i
{
  i := i + 1;
}
</code></pre>

<p>When you specify an invariant, Dafny proves two things: the invariant
holds upon entering the loop, and it is preserved by the loop. By
preserved, we mean that assuming that the invariant holds at the
beginning of the loop (just prior to the loop test), we must show that executing the loop body once
makes the invariant hold again. Dafny can only know upon analyzing the
loop body what the invariants say, in addition to the loop guard (the
loop condition). Just as Dafny will not discover properties of a method
on its own, it will not know that any but the most basic properties of a loop
are preserved unless it is told via an invariant.</p>

<h4 id="sec-loop-termination">19.14.2. Loop termination</h4>

<p>Dafny proves that code terminates, i.e. does not loop forever, by using
<code>decreases</code> annotations. For many things, Dafny is able to guess the right
annotations, but sometimes it needs to be made explicit.
There are two places Dafny proves termination: loops and recursion.
Both of these situations require either an explicit annotation or a
correct guess by Dafny.</p>

<p>A <code>decreases</code> annotation, as its name suggests, gives Dafny an expression
that decreases with every loop iteration or recursive call. There are two
conditions that Dafny needs to verify when using a <code>decreases</code> expression:</p>

<ul>
  <li>that the expression actually gets smaller, and</li>
  <li>that it is bounded.</li>
</ul>

<p>That is, the expression must strictly decrease in a well-founded ordering
(cf. <a href="#sec-well-founded-orders">Section 23.7</a>).</p>

<p>Many times, an integral value (natural or plain integer) is the quantity
that decreases, but other values can be used as well. In the case of
integers, the bound is assumed to be zero.
For each loop iteration the <code>decreases</code> expression at the end of the loop
body must be strictly smaller than the value at the beginning of the loop
body (after the loop test). For integers, the well-founded relation between
<code>x</code> and <code>X</code> is <code>x &lt; X &amp;&amp; 0 &lt;= X</code>.
Thus if the <code>decreases</code> value (<code>X</code>) is negative at the
loop test, it must exit the loop, since there is no permitted value for
<code>x</code> to have at the end of the loop body.</p>

<p>For example, the following is
a proper use of <code>decreases</code> on a loop:</p>

<pre><code class="language-dafny">  while 0 &lt; i
    invariant 0 &lt;= i
    decreases i
  {
    i := i - 1;
  }
</code></pre>

<p>Here Dafny has all the ingredients it needs to prove termination. The
variable <code>i</code> becomes smaller each loop iteration, and is bounded below by
zero. When <code>i</code> becomes 0, the lower bound of the well-founded order, control
flow exits the loop.</p>

<p>This is fine, except the loop is backwards from most loops, which
tend to count up instead of down. In this case, what decreases is not the
counter itself, but rather the distance between the counter and the upper
bound. A simple trick for dealing with this situation is given below:</p>

<pre><code class="language-dafny">  while i &lt; n
    invariant 0 &lt;= i &lt;= n
    decreases n - i
  {
    i := i + 1;
  }
</code></pre>

<p>This is actually Dafnys guess for this situation, as it sees <code>i &lt; n</code> and
assumes that <code>n - i</code> is the quantity that decreases. The upper bound of the
loop invariant implies that <code>0 &lt;= n  i</code>, and gives Dafny a lower bound on
the quantity. This also works when the bound <code>n</code> is not constant, such as
in the binary search algorithm, where two quantities approach each other,
and neither is fixed.</p>

<p>If the <code>decreases</code> clause of a loop specifies <code>*</code>, then no
termination check will be performed. Use of this feature is sound only with
respect to partial correctness.</p>

<h4 id="sec-loop-framing">19.14.3. Loop framing</h4>

<p>The specification of a loop also includes <em>framing</em>, which says what the
loop modifies. The loop frame includes both local variables and locations
in the heap.</p>

<p>For local variables, the Dafny verifier performs a syntactic
scan of the loop body to find every local variable or out-parameter that occurs as a left-hand
side of an assignment. These variables are called
<em>syntactic assignment targets of the loop</em>, or <em>syntactic loop targets</em> for short.
Any local variable or out-parameter that is not a syntactic assignment target is known by the
verifier to remain unchanged by the loop.</p>

<p>The heap may or may not be a syntactic loop target. It is when the loop body
syntactically contains a statement that can modify a heap location. This
includes calls to compiled methods, even if such a method has an empty
<code>modifies</code> clause, since a compiled method is always allowed to allocate
new objects and change their values in the heap.</p>

<p>If the heap is not a syntactic loop target, then the verifier knows the heap
remains unchanged by the loop. If the heap <em>is</em> a syntactic loop target,
then the loops effective <code>modifies</code> clause determines what is allowed to be
modified by iterations of the loop body.</p>

<p>A loop can use <code>modifies</code> clauses to declare the effective <code>modifies</code> clause
of the loop. If a loop does not explicitly declare any <code>modifies</code> clause, then
the effective <code>modifies</code> clause of the loop is the effective <code>modifies</code> clause
of the most tightly enclosing loop or, if there is no enclosing loop, the
<code>modifies</code> clause of the enclosing method.</p>

<p>In most cases, there is no need to give an explicit <code>modifies</code> clause for a
loop. The one case where it is sometimes needed is if a loop modifies less
than is allowed by the enclosing method. Here are two simple methods that
illustrate this case:</p>

<pre><code>class Cell {
  var data: int
}

method M0(c: Cell, d: Cell)
  requires c != d
  modifies c, d
  ensures c.data == d.data == 100
{
  c.data, d.data := 100, 0;
  var i := 0;
  while i &lt; 100
    invariant d.data == i
    // Needs "invariant c.data == 100" or "modifies d" to verify
  {
    d.data := d.data + 1;
    i := i + 1;
  }
}

method M1(c: Cell)
  modifies c
  ensures c.data == 100
{
  c.data := 100;
  var i := 0;
  while i &lt; 100
    // Needs "invariant c.data == 100" or "modifies {}" to verify
  {
    var tmp := new Cell;
    tmp.data := i;
    i := i + 1;
  }
}
</code></pre>

<p>In <code>M0</code>, the effective <code>modifies</code> clause of the loop is <code>modifies c, d</code>. Therefore,
the methods postcondition <code>c.data == 100</code> is not provable. To remedy the situation,
the loop needs to be declared either with <code>invariant c.data == 100</code> or with
<code>modifies d</code>.</p>

<p>Similarly, the effective <code>modifies</code> clause of the loop in <code>M1</code> is <code>modifies c</code>. Therefore,
the methods postcondition <code>c.data == 100</code> is not provable. To remedy the situation,
the loop needs to be declared either with <code>invariant c.data == 100</code> or with
<code>modifies {}</code>.</p>

<p>When a loop has an explicit <code>modifies</code> clause, there is, at the top of
every iteration, a proof obligation that</p>

<ul>
  <li>the expressions given in the <code>modifies</code> clause are well-formed, and</li>
  <li>everything indicated in the loop <code>modifies</code> clause is allowed to be modified by the
(effective <code>modifies</code> clause of the) enclosing loop or method.</li>
</ul>

<h4 id="19144-body-less-methods-functions-loops-and-aggregate-statements">19.14.4. Body-less methods, functions, loops, and aggregate statements</h4>

<p>Methods (including lemmas), functions, loops, and <code>forall</code> statements are ordinarily
declared with a body, that is, a curly-braces pair that contains (for methods, loops, and <code>forall</code>)
a list of statements or (for a function) an expression. In each case, Dafny syntactically
allows these constructs to be given without a body. This is to allow programmers to
temporarily postpone the development of the implementation of the method, function, loop, or
aggregate statement.</p>

<p>If a method has no body, there is no difference for callers of the method. Callers still reason
about the call in terms of the methods specification. But without a body, the verifier has
no method implementation to check against the specification, so the verifier is silently happy.
The compiler, on the other hand, will complain if it encounters a body-less method, because the
compiler is supposed to generate code for the method, but it isnt clever enough to do that by
itself without a given method body. If the method implementation is provided by code written
outside of Dafny, the method can be marked with an <code>{:extern}</code> annotation, in which case the
compiler will no longer complain about the absence of a method body.</p>

<p>A lemma is a special kind of method. Callers are therefore unaffected by the absence of a body,
and the verifier is silently happy with not having a proof to check against the lemma specification.
Despite a lemma being ghost, it is still the compiler that checks for, and complains about,
body-less lemmas. A body-less lemma is an unproven lemma, which is often known as an <em>axiom</em>.
If you intend to use a lemma as an axiom, omit its body and add the attribute <code>{:axiom}</code>, which
causes the compiler to suppress its complaint about the lack of a body.</p>

<p>Similarly, calls to a body-less function use only the specification of the function. The
verifier is silently happy, but the compiler complains (whether or not the function is ghost).
As for methods and lemmas, the <code>{:extern}</code> and <code>{:axiom}</code> attributes can be used to suppress the
compilers complaint.</p>

<p>By supplying a body for a method or function, the verifier will in effect show the feasibility of
the specification of the method or function. By supplying an <code>{:extern}</code> or <code>{:axiom}</code> attribute,
you are taking that responsibility into your own hands. Common mistakes include forgetting to
provide an appropriate <code>modifies</code> or <code>reads</code> clause in the specification, or forgetting that
the results of functions in Dafny (unlike in most other languages) must be deterministic.</p>

<p>Just like methods and functions have two sides, callers and implementations, loops also have
two sides. One side (analogous to callers) is the context that uses the loop. That context treats
the loop in the same way regardless of whether or not the loop has a body. The other side
is the loop body, that is, the implementation of each loop iteration. The verifier checks
that the loop body maintains the loop invariant and that the iterations will eventually terminate,
but if there is no loop body, the verifier is silently happy. This allows you to temporarily
postpone the authoring of the loop body until after youve made sure that the loop specification
is what you need in the context of the loop.</p>

<p>There is one thing that works differently for body-less loops than for loops with bodies.
It is the computation of syntactic loop targets, which become part of the loop frame
(see <a href="#sec-loop-framing">Section 19.14.3</a>). For a body-less loop, the local variables
computed as part of the loop frame are the mutable variables that occur free in the
loop specification. The heap is considered a part of the loop frame if it is used
for mutable fields in the loop specification or if the loop has an explicit <code>modifies</code> clause.
The IDE will display the computed loop frame in hover text.</p>

<p>For example, consider</p>

<pre><code class="language-dafny">class Cell {
  var data: int
  const K: int
}

method BodylessLoop(n: nat, c: Cell)
  requires c.K == 8
  modifies c
{
  c.data := 5;
  var a, b := n, n;
  for i := 0 to n
    invariant c.K &lt; 10
    invariant a &lt;= n
    invariant c.data &lt; 10
  assert a == n;
  assert b == n;
  assert c.data == 5;
}
</code></pre>

<p>The loop specification mentions local variable <code>a</code>, and thus <code>a</code> is considered part of
the loop frame. Since what the loop invariant says about <code>a</code> is not strong enough to
prove the assertion <code>a == n</code> that follows the loop, the verifier complains about that
assertion.</p>

<p>Local variable <code>b</code> is not mentioned in the loop specification, and thus <code>b</code> is not
included in the loop frame. Since in-parameter <code>n</code> is immutable, it is not included
in the loop frame, either, despite being mentioned in the loop specification. For
these reasons, the assertion <code>b == n</code> is provable after the loop.</p>

<p>Because the loop specification mentions the mutable field <code>data</code>, the heap becomes
part of the loop frame. Since the loop invariant is not strong enough to prove the
assertion <code>c.data == 5</code> that follows the loop, the verifier complains about that
assertion. On the other hand, had <code>c.data &lt; 10</code> not been mentioned in the loop
specification, the assertion would be verified, since field <code>K</code> is then the only
field mentioned in the loop specification and <code>K</code> is immutable.</p>

<p>Finally, the aggregate statement (<code>forall</code>) can also be given without a body. Such
a statement claims that the given <code>ensures</code> clause holds true for all values of
the bound variables that satisfy the given range constraint. If the statement has
no body, the program is in effect omitting the proof, much like a body-less lemma
is omitting the proof of the claim made by the lemma specification. As with the
other body-less constructs above, the verifier is silently happy with a body-less
<code>forall</code> statement, but the compiler will complain.</p>

<h3 id="sec-match-statement">19.15. Match Statement</h3>
<pre><code class="language-grammar">MatchStmt =
  "match"
  Expression(allowLemma: true, allowLambda: true)
  ( "{" { CaseStmt } "}"
  | { CaseStmt }
  )

CaseStmt = "case" ExtendedPattern "=&gt;" { Stmt }
</code></pre>

<p>[ <code>ExtendedPattern</code> is defined in <a href="#sec-case-pattern">Section 20.32</a>.]</p>

<p>The <code>match</code> statement is used to do case analysis on a 
value of an inductive or co-inductive datatype (which includes the 
built-in tuple types), a base type, or newtype. The expression after the
 <code>match</code> keyword is called the <em>selector</em>. The expression is evaluated and then matched against
each clause in order until a matching clause is found.</p>

<p>The process of matching the selector expression against the <code>CaseBinding_</code>s is
the same as for match expressions and is described in
<a href="#sec-case-pattern">Section 20.32</a>.</p>

<p>The code below shows an example of a match statement.</p>

<pre><code class="language-dafny">datatype Tree = Empty | Node(left: Tree, data: int, right: Tree)

// Return the sum of the data in a tree.
method Sum(x: Tree) returns (r: int)
{
  match x {
    case Empty =&gt; r := 0;
    case Node(t1, d, t2) =&gt;
      var v1 := Sum(t1);
      var v2 := Sum(t2);
      r := v1 + d + v2;
  }
}
</code></pre>

<p>Note that the <code>Sum</code> method is recursive yet has no <code>decreases</code> annotation.
In this case it is not needed because Dafny is able to deduce that
<code>t1</code> and <code>t2</code> are <em>smaller</em> (structurally) than <code>x</code>. If <code>Tree</code> had been
coinductive this would not have been possible since <code>x</code> might have been
infinite.</p>

<h3 id="sec-assert-statement">19.16. Assert Statement</h3>
<pre><code class="language-grammar">AssertStmt =
    "assert"
    { Attribute }
    ( [ LabelName ":" ]
      Expression(allowLemma: false, allowLambda: true)
      ( ";"
      | "by" BlockStmt
      )
    | ellipsis
      ";"
</code></pre>

<p><code>Assert</code> statements are used to express logical proposition that are
expected to be true. Dafny will attempt to prove that the assertion
is true and give an error if the assertion cannot be proven.
Once the assertion is proved,
its truth may aid in proving subsequent deductions.
Thus if Dafny is having a difficult time verifying a method,
the user may help by inserting assertions that Dafny can prove,
and whose truth may aid in the larger verification effort,
much as lemmas might be used in mathematical proofs.</p>

<p><code>Assert</code> statements are ignored by the compiler.</p>

<p>Using <code>...</code> as the argument of the statement is part of module refinement, as described in <a href="#sec-module-refinement">Section 21</a>.</p>

<p>TO BE WRITTEN - assert by statements</p>

<h3 id="sec-assume-statement">19.17. Assume Statement</h3>
<pre><code class="language-grammar">AssumeStmt =
    "assume"
    { Attribute }
    ( Expression(allowLemma: false, allowLambda: true)
    | ellipsis
    )
    ";"
</code></pre>

<p>The <code>assume</code> statement lets the user specify a logical proposition
that Dafny may assume to be true without proof. If in fact the
proposition is not true this may lead to invalid conclusions.</p>

<p>An <code>assume</code> statement would ordinarily be used as part of a larger
verification effort where verification of some other part of
the program required the proposition. By using the <code>assume</code> statement
the other verification can proceed. Then when that is completed the
user would come back and replace the <code>assume</code> with <code>assert</code>.</p>

<p>An <code>assume</code> statement cannot be compiled. In fact, the compiler
will complain if it finds an <code>assume</code> anywhere where it has not
been replaced through a refinement step.</p>

<p>Using <code>...</code> as the argument of the statement is part of module refinement, as described in <a href="#sec-module-refinement">Section 21</a>.</p>

<h3 id="sec-expect-statement">19.18. Expect Statement</h3>

<pre><code class="language-grammar">ExpectStmt =
    "expect"
    { Attribute }
    ( Expression(allowLemma: false, allowLambda: true)
    | ellipsis
    )
    [ "," Expression(allowLemma: false, allowLambda: true) ]
    ";"
</code></pre>

<p>The <code>expect</code> statement states a boolean expression that is
(a) assumed to be true by the verifier
and (b) checked to be true
at run-time. That is, the compiler inserts into the run-time executable a
check that the given expression is true; if the expression is false, then
the execution of the program halts immediately. If a second argument is
given, it may be a value of any type.
That value is converted to a string (just like the <code>print</code> statement)
and  the string is included
in the message emitted by the program
when it halts; otherwise a default message is emitted.</p>

<p>Because the expect expression and optional second argument are compiled, they cannot be ghost expressions.</p>

<p><code>assume</code> statements are ignored at run-time. The <code>expect</code> statement behaves like
<code>assume</code> for the verifier, but also inserts a run-time check that the
assumption is indeed correct (for the test cases used at run-time).</p>

<p>Here are a few use-cases for the <code>expect</code> statement.</p>

<p>A) To check the specifications of external methods.</p>

<p>Consider an external method <code>Random</code> that takes a <code>nat</code> as input
and returns a <code>nat</code> value that is less than the input.
Such a method could be specified as</p>
<pre><code class="language-dafny">method {:extern} Random(n: nat) returns (r: nat)
  ensures r &lt; n
</code></pre>
<p>But because there is no body for <code>Random</code> (only the external non-dafny implementation),
it cannot be verified that <code>Random</code> actually satisfies this specification.</p>

<p>To mitigate this situation somewhat, we can define a wrapper function, <code>Random'</code>,
that calls <code>Random</code> but in which we can put some run-time checks:</p>
<pre><code class="language-dafny">method {:extern} Random(n: nat) returns (r: nat)

method Random'(n: nat) returns (r: nat)
  ensures r &lt; n
{
  r := Random(n);
  expect r &lt; n;
}
</code></pre>
<p>Here we can verify that <code>Random'</code> satisfies its own specification,
relying on the unverified specification of <code>Random</code>.
But we are also checking at run-time that any input-output pairs for <code>Random</code>
encountered during execution
do satisfy the specification,
as they are checked by the <code>expect</code> statement.</p>

<p>Note, in this example, two problems still remain.
One problem is that the out-parameter of the extern <code>Random</code> has type <code>nat</code>,
but there is no check that the value returned really is non-negative.
It would be better to declare the out-parameter of <code>Random</code> to be <code>int</code> and
to include <code>0 &lt;= r</code> in the condition checked by the <code>expect</code> statement in <code>Random'</code>.
The other problem is that <code>Random</code> surely will need <code>n</code> to be strictly positive.
This can be fixed by adding <code>requires n != 0</code> to <code>Random'</code> and <code>Random</code>.</p>

<p>B) Run-time testing</p>

<p>Verification and run-time testing are complementary
and both have their role in assuring that software does what is intended.
Dafny can produce executables
and these can be instrumented with unit tests.
Annotating a method with the <code>{:test}</code> attribute
indicates to the compiler
that it should produce target code
that is correspondingly annotated to mark the method
as a unit test (e.g., an XUnit test) in the target language.
Alternatively, the <code>/runAllTests</code> option will produce a main method
that invokes all methods with the <code>{:test}</code> attribute, and hence does not
depend on any testing framework in the target language.
Within such methods one might use <code>expect</code> statements (as well as <code>print</code> statements)
to insert checks that the target program is behaving as expected.</p>

<p>C) Compiler tests</p>

<p>If one wants to assure that compiled code is behaving at run-time consistently with the statically verified code,
one can use paired assert/expect statements with the same expression:</p>
<pre><code class="language-dafny">assert _P_;
expect _P_;
</code></pre>
<p>The verifier will check that <em>P</em> is always true at the given point in a program
(at the <code>assert</code> statement).</p>

<p>At run-time, the compiler will insert checks that the same predicate,
in the <code>expect</code> statement, is true.
Any difference identifies a compiler bug.
Note that the <code>expect</code> must be after the <code>assert</code>.
If the <code>expect</code> is first,
then the verifier will interpret the <code>expect</code> like an <code>assume</code>,
in which case the <code>assert</code> will be proved trivially
and potential unsoundness will be hidden.</p>

<p>Using <code>...</code> as the argument of the <code>expect</code> statement is part of module refinement, as described in <a href="#sec-module-refinement">Section 21</a>.</p>

<!--
Describe where refinement is described.

If the proposition is `...` then (TODO: what does this mean?).
-->

<h3 id="1919-print-statement">19.19. Print Statement</h3>
<pre><code class="language-grammar">PrintStmt =
    "print"
    Expression(allowLemma: false, allowLambda: true)
    { "," Expression(allowLemma: false, allowLambda: true) }
    ";"
</code></pre>

<p>The <code>print</code> statement is used to print the values of a comma-separated
list of expressions to the console. The generated code uses
target-language-specific idioms to perform this printing.
The expressions may of course include strings that are used
for captions. There is no implicit new line added, so to add a new
line you should include <code>"\n"</code> as part of one of the expressions.
Dafny automatically creates implementations of methods that convert values to strings
for all Dafny data types. For example,</p>

<pre><code class="language-dafny">datatype Tree = Empty | Node(left: Tree, data: int, right: Tree)
method Main()
{
  var x : Tree := Node(Node(Empty, 1, Empty), 2, Empty);
  print "x=", x, "\n";
}
</code></pre>

<p>produces this output:</p>

<pre><code>x=Tree.Node(Tree.Node(Tree.Empty, 1, Tree.Empty), 2, Tree.Empty)
</code></pre>

<p>Note that Dafny does not have method overriding and there is no mechanism to
override the built-in value-&gt;string conversion.  Nor is there a way to
explicitly invoke this conversion.</p>

<p>Dafny does not keep track of print effects. <code>print</code> statements are allowed
only in non-ghost contexts and not in expressions, with one exception.
The exception is that a function-by-method may contain <code>print</code> statements,
whose effect may be observed as part of the run-time evaluation of such functions.</p>

<h3 id="sec-reveal-statement">19.20. Reveal Statement</h3>
<pre><code class="language-grammar">RevealStmt =
    "reveal"
    Expression(allowLemma: false, allowLambda: true)
    { "," Expression(allowLemma: false, allowLambda: true) }
    ";"
</code></pre>

<p>TODO</p>

<h3 id="sec-forall-statement">19.21. Forall Statement</h3>
<pre><code class="language-grammar">ForallStmt =
  "forall"
  ( "(" [ QuantifierDomain ] ")"
  | [ QuantifierDomain ]
  )
  { EnsuresClause(allowLambda: true) }
  [ BlockStmt ]
</code></pre>

<p>The <code>forall</code> statement executes the body
simultaneously for all quantified values in the specified range.
There are several variant uses of the <code>forall</code>
statement and there are a number of restrictions.</p>

<p>In particular, a <code>forall</code> statement can be classified as one of the following:</p>

<ul>
  <li><em>Assign</em> - the <code>forall</code> statement is used for simultaneous assignment.
The target must be an array element or an object field.</li>
  <li><em>Call</em> - The body consists of a single call to a ghost method without side effects</li>
  <li><em>Proof</em> - The <code>forall</code> has <code>ensure</code> expressions which are effectively
quantified or proved by the body (if present).</li>
</ul>

<p>An <em>assign</em> <code>forall</code> statement performs simultaneous assignment.
The left-hand sides must denote different l-values, unless the
corresponding right-hand sides also coincide.</p>

<p>The following is an excerpt of an example given by Leino in
<a href="http://research.microsoft.com/en-us/um/people/leino/papers/krml233.pdf"><em>Developing Verified Programs with Dafny</em></a>.
When the buffer holding the queue needs to be resized,
the <code>forall</code> statement is used to simultaneously copy the old contents
into the new buffer.</p>

<pre><code class="language-dafny">class {:autocontracts} SimpleQueue&lt;Data&gt;
{
  ghost var Contents: seq&lt;Data&gt;;
  var a: array&lt;Data&gt;  // Buffer holding contents of queue.
  var m: int          // Index head of queue.
  var n: int          // Index just past end of queue
  ...
  method Enqueue(d: Data)
    ensures Contents == old(Contents) + [d]
  {
    if n == a.Length {
      var b := a;
      if m == 0 { b := new Data[2 * a.Length]; }
      forall i | 0 &lt;= i &lt; n - m {
      	b[i] := a[m + i];
      }
      a, m, n := b, 0, n - m;
    }
    a[n], n, Contents := d, n + 1, Contents + [d];
  }
}
</code></pre>

<p>Here is an example of a <em>call</em> <code>forall</code> statement and the
callee. This is contained in the <code>CloudMake-ConsistentBuilds.dfy</code>
test in the Dafny repository.</p>

<pre><code class="language-dafny">forall cmd', deps', e' |
       Hash(Loc(cmd', deps', e')) == Hash(Loc(cmd, deps, e)) {
  HashProperty(cmd', deps', e', cmd, deps, e);
}

lemma HashProperty(cmd: Expression, deps: Expression, ext: string,
    cmd': Expression, deps': Expression, ext': string)
  requires Hash(Loc(cmd, deps, ext)) == Hash(Loc(cmd', deps', ext'))
  ensures cmd == cmd' &amp;&amp; deps == deps' &amp;&amp; ext == ext'
</code></pre>

<p>The following example of a <em>proof</em> <code>forall</code> statement comes from the same file:</p>

<pre><code class="language-dafny">forall p | p in DomSt(stCombinedC.st) &amp;&amp; p in DomSt(stExecC.st)
  ensures GetSt(p, stCombinedC.st) == GetSt(p, stExecC.st)
{
  assert DomSt(stCombinedC.st) &lt;= DomSt(stExecC.st);
  assert stCombinedC.st == Restrict(DomSt(stCombinedC.st),
                                               stExecC.st);
}
</code></pre>

<p>More generally, the statement</p>
<pre><code class="language-dafny">forall x | P(x) { Lemma(x); }
</code></pre>
<p>is used to invoke <code>Lemma(x)</code> on all <code>x</code> for which <code>P(x)</code> holds. If
<code>Lemma(x)</code> ensures <code>Q(x)</code>, then the forall statement establishes</p>
<pre><code class="language-dafny">forall x :: P(x) ==&gt; Q(x).
</code></pre>

<p>The <code>forall</code> statement is also used extensively in the de-sugared forms of
co-predicates and co-lemmas. See section [#sec-co-inductive-datatypes].</p>

<h3 id="sec-modify-statement">19.22. Modify Statement</h3>
<pre><code class="language-grammar">ModifyStmt =
  "modify"
  { Attribute }
  ( FrameExpression(allowLemma: false, allowLambda: true)
    { "," FrameExpression(allowLemma: false, allowLambda: true) }
  | ellipsis
  )
  ( BlockStmt
  | ";"
  )
</code></pre>

<p>The <code>modify</code> statement has two forms which have two different
purposes.</p>

<p>When the <code>modify</code> statement ends with a semi-colon rather than
a block statement its effect is to say that some undetermined
modifications have been made to any or all of the memory
locations specified by the <a href="#sec-frame-expression">frame expressions</a>.
In the following example, a value is assigned to field <code>x</code>
followed by a <code>modify</code> statement that may modify any field
in the object. After that we can no longer prove that the field
<code>x</code> still has the value we assigned to it.</p>

<pre><code class="language-dafny">class MyClass {
  var x: int
  method N()
    modifies this
  {
    x := 18;
    modify this;
    assert x == 18;  // error: cannot conclude this here
  }
}
</code></pre>

<p>When the <code>modify</code> statement is followed by a block statement,
we are instead specifying what can be modified in that
block statement. Namely, only memory locations specified
by the frame expressions of the block <code>modify</code> statement
may be modified. Consider the following example.</p>

<pre><code class="language-dafny">class ModifyBody {
  var x: int
  var y: int
  method M0()
    modifies this
  {
    modify {} {
      x := 3;  // error: violates the modifies clause
               // on the line above
    }
  }

  method M1()
    modifies this
  {
    modify {} {
      var o := new ModifyBody;
      o.x := 3;  // fine
    }
  }

  method M2()
    modifies this
  {
    modify this {
      x := 3;
    }
  }

  method M3()
    modifies this
  {
    var k: int;
    modify {} { k := 4; } // fine. k is local
  }
}
</code></pre>

<p>The first <code>modify</code> statement in the example has an empty
frame expression so the statement guarded by the
modifies clause cannot modify any heap memory locations.
So an error is reported when it tries to modify field <code>x</code>.</p>

<p>The second <code>modify</code> statement also has an empty frame
expression. But it allocates a new object and modifies it.
Thus we see that the frame expressions on a block <code>modify</code>
statement only limit what may be modified in already allocated
memory. It does not limit what may be modified in
new memory that is allocated within the block.</p>

<p>The third <code>modify</code> statement has a frame expression that
allows it to modify any of the fields of the current object,
so the modification of field <code>x</code> is allowed.</p>

<p>Finally, the fourth example shows that the restrictions imposed by
the modify statement do not apply to local variables, only those
that are heap-based.</p>

<p>Using <code>...</code> as the argument of the statement is part of module refinement, as described in <a href="#sec-module-refinement">Section 21</a>.</p>

<h3 id="sec-calc-statement">19.23. Calc Statement</h3>
<pre><code class="language-grammar">CalcStmt = "calc" { Attribute } [ CalcOp ] "{" CalcBody_ "}"

CalcBody_ = { CalcLine_ [ CalcOp ] Hints_ }

CalcLine_ = Expression(allowLemma: false, allowLambda: true) ";"

Hints_ = { ( BlockStmt | CalcStmt ) }

CalcOp =
  ( "==" [ "#" "["
           Expression(allowLemma: true, allowLambda: true) "]" ]
  | "&lt;" | "&gt;"
  | "!=" | "&lt;=" | "&gt;="
  | "&lt;==&gt;" | "==&gt;" | "&lt;=="
  )
</code></pre>

<p>The <code>calc</code> statement supports <em>calculational proofs</em> using a language
feature called <em>program-oriented calculations</em> (poC). This feature was
introduced and explained in the [<em>Verified Calculations</em>] paper by Leino
and Polikarpova[@LEINO:Dafny:Calc]. Please see that paper for a more
complete explanation of the <code>calc</code> statement. We here mention only the
highlights.</p>

<p>Calculational proofs are proofs by stepwise formula manipulation
as is taught in elementary algebra. The typical example is to prove
an equality by starting with a left-hand-side and through a series of
transformations morph it into the desired right-hand-side.</p>

<p>Non-syntactic rules further restrict hints to only ghost and side-effect
free statements, as well as imposing a constraint that only
chain-compatible operators can be used together in a calculation. The
notion of chain-compatibility is quite intuitive for the operators
supported by poC; for example, it is clear that &lt; and &gt; cannot be used within
the same calculation, as there would be no relation to conclude between
the first and the last line. See the <a href="http://research.microsoft.com/en-us/um/people/leino/papers/krml231.pdf">paper</a> for
a more formal treatment of chain-compatibility.</p>

<p>Note that we allow a single occurrence of the intransitive operator != to
appear in a chain of equalities (that is, != is chain-compatible with
equality but not with any other operator, including itself). Calculations
with fewer than two lines are allowed, but have no effect. If a step
operator is omitted, it defaults to the calculation-wide operator,
defined after the <code>calc</code> keyword. If that operator is omitted, it defaults
to equality.</p>

<p>Here is an example using <code>calc</code> statements to prove an elementary
algebraic identity. As it turns out, Dafny is able to prove this without
the <code>calc</code> statements, but the example illustrates the syntax.</p>

<pre><code class="language-dafny">lemma docalc(x : int, y: int)
  ensures (x + y) * (x + y) == x * x + 2 * x * y + y * y
{
  calc {
    (x + y) * (x + y);
    ==
    // distributive law: (a + b) * c == a * c + b * c
    x * (x + y) + y * (x + y);
    ==
    // distributive law: a * (b + c) == a * b + a * c
    x * x + x * y + y * x + y * y;
    ==
    calc {
	    y * x;
      ==
	    x * y;
    }
    x * x + x * y + x * y + y * y;
    ==
    calc {
      x * y + x * y;
      ==
      // a = 1 * a
      1 * x * y + 1 * x * y;
      ==
      // Distributive law
      (1 + 1) * x * y;
      ==
      2 * x * y;
    }
    x * x + 2 * x * y + y * y;
  }
}
</code></pre>

<p>Here we started with <code>(x + y) * (x + y)</code> as the left-hand-side
expressions and gradually transformed it using distributive,
commutative and other laws into the desired right-hand-side.</p>

<p>The justification for the steps are given as comments or as
nested <code>calc</code> statements that prove equality of some sub-parts
of the expression.</p>

<p>The <code>==</code> operators show the relation between
the previous expression and the next. Because of the transitivity of
equality we can then conclude that the original left-hand-side is
equal to the final expression.</p>

<p>We can avoid having to supply the relational operator between
every pair of expressions by giving a default operator between
the <code>calc</code> keyword and the opening brace as shown in this abbreviated
version of the above calc statement:</p>

<pre><code class="language-dafny">calc == {
  (x + y) * (x + y);
  x * (x + y) + y * (x + y);
  x * x + x * y + y * x + y * y;
  x * x + x * y + x * y + y * y;
  x * x + 2 * x * y + y * y;
}
</code></pre>

<p>And since equality is the default operator, we could have omitted
it after the <code>calc</code> keyword.
The purpose of the block statements or the <code>calc</code> statements between
the expressions is to provide hints to aid Dafny in proving that
step. As shown in the example, comments can also be used to aid
the human reader in cases where Dafny can prove the step automatically.</p>

<h3 id="1924-skeleton-statement">19.24. Skeleton Statement</h3>
<pre><code class="language-grammar">SkeletonStmt =
  ellipsis
  ";"
</code></pre>
<p>TODO: Move to discussion of refinement?</p>

<!--PDF NEWPAGE-->
<h2 id="sec-expressions">20. Expressions</h2>
<p>The grammar of Dafny expressions follows a hierarchy that
reflects the precedence of Dafny operators. The following
table shows the Dafny operators and their precedence
in order of increasing binding power.</p>

<table>
  <thead>
    <tr>
      <th>operator</th>
      <th>description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>;</code></td>
      <td>That is <a href="#sec-top-level-expression">LemmaCall; Expression</a></td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>&lt;==&gt;</code></td>
      <td><a href="#sec-equivalence">equivalence (if and only if)</a></td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>==&gt;</code></td>
      <td><a href="#sec-implication">implication (implies)</a></td>
    </tr>
    <tr>
      <td><code>&lt;==</code></td>
      <td>reverse implication (follows from)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>&amp;&amp;</code>, <code>&amp;</code></td>
      <td>conjunction (and)</td>
    </tr>
    <tr>
      <td><code>||</code>, <code>|</code></td>
      <td>disjunction (or)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>==</code></td>
      <td>equality</td>
    </tr>
    <tr>
      <td><code>==#[k]</code></td>
      <td>prefix equality (co-inductive)</td>
    </tr>
    <tr>
      <td><code>!=</code></td>
      <td>disequality</td>
    </tr>
    <tr>
      <td><code>!=#[k]</code></td>
      <td>prefix disequality (co-inductive)</td>
    </tr>
    <tr>
      <td><code>&lt;</code></td>
      <td>less than</td>
    </tr>
    <tr>
      <td><code>&lt;=</code></td>
      <td>at most</td>
    </tr>
    <tr>
      <td><code>&gt;=</code></td>
      <td>at least</td>
    </tr>
    <tr>
      <td><code>&gt;</code></td>
      <td>greater than</td>
    </tr>
    <tr>
      <td><code>in</code></td>
      <td>collection membership</td>
    </tr>
    <tr>
      <td><code>!in</code></td>
      <td>collection non-membership</td>
    </tr>
    <tr>
      <td><code>!!</code></td>
      <td>disjointness</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>&lt;&lt;</code></td>
      <td>left-shift</td>
    </tr>
    <tr>
      <td><code>&gt;&gt;</code></td>
      <td>right-shift</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>+</code></td>
      <td>addition (plus)</td>
    </tr>
    <tr>
      <td><code>-</code></td>
      <td>subtraction (minus)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>*</code></td>
      <td>multiplication (times)</td>
    </tr>
    <tr>
      <td><code>/</code></td>
      <td>division (divided by)</td>
    </tr>
    <tr>
      <td><code>%</code></td>
      <td>modulus (mod)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>|</code></td>
      <td>bit-wise or</td>
    </tr>
    <tr>
      <td><code>&amp;</code></td>
      <td>bit-wise and</td>
    </tr>
    <tr>
      <td><code>^</code></td>
      <td>bit-wise exclusive-or (not equal)</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>as</code> operation</td>
      <td><a href="#sec-as-expression">type conversion</a></td>
    </tr>
    <tr>
      <td><code>is</code> operation</td>
      <td><a href="#sec-as-expression">type conversion</a></td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td><code>-</code></td>
      <td>arithmetic negation (unary minus)</td>
    </tr>
    <tr>
      <td><code>!</code></td>
      <td>logical negation, bit-wise complement</td>
    </tr>
  </tbody>
  <tbody>
    <tr>
      <td>Primary Expressions</td>
      <td>&nbsp;</td>
    </tr>
  </tbody>
</table>

<p>We are calling the <code>UnaryExpression</code>s that are neither
arithmetic nor logical negation the <em>primary expressions</em>.
They are the most tightly bound.</p>

<p>In the grammar entries below we explain the meaning when the
operator for that precedence level is present. If the
operator is not present then we just descend to the
next precedence level.</p>

<h3 id="sec-top-level-expression">20.1. Top-level expressions</h3>
<pre><code class="language-grammar">Expression(allowLemma, allowLambda) =
    EquivExpression(allowLemma, allowLambda)
    [ ";" Expression(allowLemma, allowLambda) ]
</code></pre>

<p>The allowLemma argument says whether or not the expression
to be parsed is allowed to have the form <code>S;E</code> where <code>S</code> is a call to a lemma.
allowLemma should be passed in as false whenever the expression to
be parsed sits in a context that itself is terminated by a semi-colon.</p>

<p>The allowLambda says whether or not the expression to be parsed is
allowed to be a lambda expression.  More precisely, an identifier or
parenthesized-enclosed comma-delimited list of identifiers is allowed to
continue as a lambda expression (that is, continue with a <code>reads</code>, <code>requires</code>,
or <code>=&gt;</code>) only if allowLambda is true.  This affects function/method/iterator
specifications, if/while statements with guarded alternatives, and expressions
in the specification of a lambda expression itself.</p>

<p>Sometimes an expression will fail unless some relevant fact is known.
In the following example the <code>F_Fails</code> function fails to verify
because the <code>Fact(n)</code> divisor may be zero. But preceding
the expression by a lemma that ensures that the denominator
is not zero allows function <code>F_Succeeds</code> to succeed.</p>
<pre><code class="language-dafny">function Fact(n: nat): nat
{
  if n == 0 then 1 else n * Fact(n-1)
}

lemma L(n: nat)
  ensures 1 &lt;= Fact(n)
{
}

function F_Fails(n: nat): int
{
  50 / Fact(n)  // error: possible division by zero
}

function F_Succeeds(n: nat): int
{
  L(n); // note, this is a lemma call in an expression
  50 / Fact(n)
}
</code></pre>

<h3 id="sec-equivalence">20.2. Equivalence Expressions</h3>
<pre><code class="language-grammar">EquivExpression(allowLemma, allowLambda) =
  ImpliesExpliesExpression(allowLemma, allowLambda)
  { "&lt;==&gt;" ImpliesExpliesExpression(allowLemma, allowLambda) }
</code></pre>
<p>An <code>EquivExpression</code> that contains one or more &lt;==&gt;s is
a boolean expression and all the contained <code>ImpliesExpliesExpression</code>
must also be boolean expressions. In that case each &lt;==&gt;
operator tests for logical equality which is the same as
ordinary equality.</p>

<p>See [Section 0](#sec-equivalence-operator] for an explanation of the
<code>&lt;==&gt;</code> operator as compared with the <code>==</code> operator.</p>

<h3 id="sec-implication">20.3. Implies or Explies Expressions</h3>
<pre><code class="language-grammar">ImpliesExpliesExpression(allowLemma, allowLambda) =
  LogicalExpression(allowLemma, allowLambda)
  [ (  "==&gt;" ImpliesExpression(allowLemma, allowLambda)
    | "&lt;==" LogicalExpression(allowLemma, allowLambda)
            { "&lt;==" LogicalExpression(allowLemma, allowLambda) }
    )
  ]

ImpliesExpression(allowLemma, allowLambda) =
  LogicalExpression(allowLemma, allowLambda)
  [  "==&gt;" ImpliesExpression(allowLemma, allowLambda) ]
</code></pre>

<p>See <a href="#sec-implication-and-reverse-implication">Section 7.1.3</a>] for an explanation
of the <code>==&gt;</code> and <code>&lt;==</code> operators.</p>

<h3 id="204-logical-expressions">20.4. Logical Expressions</h3>

<pre><code class="language-grammar">LogicalExpression(allowLemma, allowLambda) =
  RelationalExpression(allowLemma, allowLambda)
  [ ( "&amp;&amp;" RelationalExpression(allowLemma, allowLambda)
           { "&amp;&amp;" RelationalExpression(allowLemma, allowLambda) }
    | "||" RelationalExpression(allowLemma, allowLambda)
           { "||" RelationalExpression(allowLemma, allowLambda) }
    )
  ]
  | { "&amp;&amp;" RelationalExpression(allowLemma, allowLambda) }
  | { "||" RelationalExpression(allowLemma, allowLambda) }
</code></pre>

<p>Note that the Dafny grammar allows a conjunction or disjunction to be
<em>prefixed</em> with <code>&amp;&amp;</code> or <code>||</code> respectively. This form simply allows a
parallel structure to be written:</p>
<pre><code class="language-dafny">var b: bool :=
  &amp;&amp; x != null
  &amp;&amp; y != null
  &amp;&amp; z != null
  ;
</code></pre>
<p>This is purely a syntactic convenience allowing easy edits such as reordering
lines or commenting out lines without having to check that the infix
operators are always where they should be.</p>

<p>See <a href="#sec-conjunction-and-disjunction">Section 7.1.2</a> for an explanation
of the <code>&amp;&amp;</code> and <code>||</code> operators.</p>

<h3 id="205-relational-expressions">20.5. Relational Expressions</h3>
<pre><code class="language-grammar">RelationalExpression(allowLemma, allowLambda) =
  ShiftTerm(allowLemma, allowLambda)
  { RelOp ShiftTerm(allowLemma, allowLambda) }

RelOp =
  ( "=="
    [ "#" "[" Expression(allowLemma: true, allowLambda: true) "]" ]
  | "!="
    [ "#" "[" Expression(allowLemma: true, allowLambda: true) "]" ]
  | "&lt;" | "&gt;" | "&lt;=" | "&gt;="
  | "in"
  | "!in"
  | "!!"
  )

</code></pre>

<p>The relation expressions that have a <code>RelOp</code> compare two or more terms.
As explained in section [#sec-basic-types], <code>==</code>, <code>!=</code>, <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, and <code>&gt;=</code>
are <em>chaining</em>.</p>

<p>The <code>in</code> and <code>!in</code> operators apply to collection types as explained in
<a href="#sec-collection-types">Section 10</a> and represent membership or non-membership
respectively.</p>

<p>The <code>!!</code> represents disjointness for sets and multisets as explained in
<a href="#sec-sets">Section 10.1</a> and <a href="#sec-multisets">Section 10.2</a>.</p>

<p>Note that <code>x ==#[k] y</code> is the prefix equality operator that compares
co-inductive values for equality to a nesting level of k, as
explained in section [#sec-co-equality].</p>

<h3 id="206-bit-shifts">20.6. Bit Shifts</h3>
<pre><code class="language-grammar">ShiftTerm(allowLemma, allowLambda) =
  Term(allowLemma, allowLambda)
  { ShiftOp Term(allowLemma, allowLambda) }

ShiftOp = ( "&lt;&lt;" | "&gt;&gt;" )
</code></pre>

<p>These operators are the left and right shift operators for bit-vector values.
They take a bit-vector value and an <code>int</code>, shifting the bits by the given
amount; the result has the same bit-vector type as the LHS.
For the expression to be well-defined, the RHS value must be in the range 0 to the number of
bits in the bit-vector type, inclusive.</p>

<p>The operations are left-associative: <code>a &lt;&lt; i &gt;&gt; j</code> is <code>(a &lt;&lt; i) &gt;&gt; j</code>.</p>
<h3 id="207-terms">20.7. Terms</h3>
<pre><code class="language-grammar">Term(allowLemma, allowLambda) =
  Factor(allowLemma, allowLambda)
  { AddOp Factor(allowLemma, allowLambda) }

AddOp = ( "+" | "-" )
</code></pre>

<p><code>Terms</code> combine <code>Factors</code> by adding or subtracting.
Addition has these meanings for different types:</p>

<ul>
  <li>Arithmetic addition for numeric types (<a href="#sec-numeric-types">Section 7.2</a>]).</li>
  <li>Union for sets and multisets (<a href="#sec-sets">Section 10.1</a> and <a href="#sec-multisets">Section 10.2</a>)</li>
  <li>Concatenation for sequences (<a href="#sec-sequences">Section 10.3</a>)</li>
  <li>Map merging for maps (<a href="#sec-maps">Section 10.4</a>).</li>
</ul>

<p>Subtraction is arithmetic subtraction for numeric types, and set or multiset
subtraction for sets and multisets, and domain subtraction for maps.</p>

<h3 id="208-factors">20.8. Factors</h3>
<pre><code class="language-grammar">Factor(allowLemma, allowLambda) =
  BitvectorFactor(allowLemma, allowLambda)
  { MulOp BitvectorFactor(allowLemma, allowLambda) }

MulOp = ( "*" | "/" | "%" )
</code></pre>

<p>A <code>Factor</code> combines <code>UnaryExpression</code>s using multiplication,
division, or modulus. For numeric types these are explained in
<a href="#sec-numeric-types">Section 7.2</a>.
As explained there, <code>/</code> and <code>%</code> on <code>int</code> values represent <em>Euclidean</em>
integer division and modulus and not the typical C-like programming
language operations.</p>

<p>Only <code>*</code> has a non-numeric application. It represents set or multiset
intersection as explained in <a href="#sec-sets">Section 10.1</a> and <a href="#sec-multisets">Section 10.2</a>.</p>

<h3 id="209-bit-vector-operations">20.9. Bit-vector Operations</h3>
<pre><code class="language-grammar">BitvectorFactor(allowLemma, allowLambda) =
  AsExpression(allowLemma, allowLambda)
  { BVOp AsExpression(allowLemma, allowLambda) }

BVOp = ( "|" | "&amp;" | "^" )
</code></pre>

<p>These operations take two bit-vector values of the same type, returning
a value of the same type. The operations perform bit-wise <em>or</em> (<code>|</code>),
<em>and</em> (<code>&amp;</code>), and <em>exclusive-or</em> (<code>^</code>). To perform bit-wise equality, use
<code>^</code> and <code>!</code> (unary complement) together.</p>

<p>These operations associate to the left but do not associate with each other;
use parentheses: <code>a &amp; b | c</code> is illegal; use <code>(a &amp; b) | c</code> or <code>a &amp; (b | c)</code>
instead.</p>

<p>Bit-vector operations are not allowed in some contexts.
The <code>|</code> symbol is used both for bit-wise or and as the delimiter in a
<a href="#sec-cardinality-expression">cardinality</a> expression: an ambiguity arise if
the expression E in <code>| E |</code> contains a <code>|</code>. This situation is easily
remedied; just enclose E in parentheses, as in <code>|(E)|</code>.
The only type-correct way this can happen is if the expression is
a comprehension, as in <code>| set x: int :: x | 0x101 |</code>.</p>

<h3 id="sec-as-expression">20.10. As (Conversion) and Is (type test) Expressions</h3>
<pre><code class="language-grammar">AsExpression(allowLemma, allowLambda) =
  UnaryExpression(allowLemma, allowLambda)
  { ( "as" | "is" ) Type }
</code></pre>
<p>The <code>as</code> expression converts the given <code>UnaryExpression</code> to the stated
<code>Type</code>, with the result being of the given type. The following combinations
of conversions are permitted:</p>

<ul>
  <li>Any type to itself</li>
  <li>Any int or real based numeric type or bit-vector type to another int or real based numeric type or bit-vector type</li>
  <li>Any base type to a subset or newtype with that base</li>
  <li>Any subset or newtype or to its base type or a subset or newtype of the same base</li>
  <li>Any type to a subset of newtype that has the type as its base</li>
  <li>Any trait to a class or trait that extends that trait</li>
  <li>Any class or trait to a trait extended by that class or trait</li>
</ul>

<p>Some of the conversions above are already implicitly allowed, without the
<code>as</code> operation, such as from a subset type to its base. In any case, it
must be able to be proved that the value of the given expression is a
legal value of the given type. For example, <code>5 as MyType</code> is permitted (by the verifier) only if <code>5</code> is a legitimate value of<code>MyType</code> (which must be a numeric type).</p>

<p>The <code>as</code> operation is like a grammatical suffix or postfix operation.
However, note that the unary operations bind more tightly than does <code>as</code>.
That is <code>- 5 as nat</code> is <code>(- 5) as nat</code> (which fails), whereas <code>a * b as nat</code>
is <code>a * (b as nat)</code>. On the other hand, <code>- a[4]</code> is <code>- (a[4])</code>.</p>

<p>The <code>is</code> expression is grammatically similar to the <code>as</code> expression, with the
same binding power. The <code>is</code> expression is a run-time type test that
returns a <code>bool</code> value indicating whether the LHS expression is a legal
value of the RHS type. The expression can be used to check
whether a trait value is of a particular class type. That is, the expression
in effect checks the allocated type of a trait.</p>

<p>The RHS type of an <code>is</code> expression can always be a supertype of the type of the LHS
expression. Other than that, the RHS must be based on a reference type and the
LHS expression must be assignable to the RHS type. Furthermore, in order to be
compilable, the RHS type must not be a subset type other than a non-null reference
type, and the type parameters of the RHS must be uniquely determined from the
type parameters of the LHS type. The last restriction is designed to make it
possible to perform type tests without inspecting type parameters at run time.
For example, consider the following types:</p>

<pre><code class="language-dafny">trait A { }
trait B&lt;X&gt; { }
class C&lt;Y&gt; extends B&lt;Y&gt; { }
class D&lt;Y&gt; extends B&lt;set&lt;Y&gt;&gt; { }
class E extends B&lt;int&gt; { }
class F&lt;Z&gt; extends A { }
</code></pre>

<p>A LHS expression of type <code>B&lt;set&lt;int&gt;&gt;</code> can be used in a type test where the RHS is
<code>B&lt;set&lt;int&gt;&gt;</code>, <code>C&lt;set&lt;int&gt;&gt;</code>, or <code>D&lt;int&gt;</code>, and a LHS expression of type <code>B&lt;int&gt;</code>
can be used in a type test where the RHS is <code>B&lt;int&gt;</code>, <code>C&lt;int&gt;</code>, or <code>E</code>. Those
are always allowed in compiled (and ghost) contexts.
For an expression <code>a</code> of type <code>A</code>, the expression <code>a is F&lt;int&gt;</code> is a ghost expression;
it can be used in ghost contexts, but not in compiled contexts.</p>

<p>For an expression <code>e</code> and type <code>t</code>, <code>e is t</code> is the condition determining whether
<code>e as t</code> is well-defined (but, as noted above, is not always a legal expression).</p>

<p><em>The repertoire of types allowed in <code>is</code> tests may be expanded in the future.</em></p>

<h3 id="2011-unary-expressions">20.11. Unary Expressions</h3>

<pre><code class="language-grammar">UnaryExpression(allowLemma, allowLambda) =
  ( "-" UnaryExpression(allowLemma, allowLambda)
  | "!" UnaryExpression(allowLemma, allowLambda)
  | PrimaryExpression(allowLemma, allowLambda)
  )
</code></pre>

<p>A <code>UnaryExpression</code> applies either numeric (<a href="#sec-numeric-types">Section 7.2</a>)
or logical (<a href="#sec-booleans">Section 7.1</a>) negation to its operand.</p>

<h3 id="2012-primary-expressions">20.12. Primary Expressions</h3>
<pre><code class="language-grammar">PrimaryExpression(allowLemma, allowLambda) =
  ( NameSegment { Suffix }
  | LambdaExpression(allowLemma)
  | MapDisplayExpr { Suffix }
  | SeqDisplayExpr { Suffix }
  | SetDisplayExpr { Suffix }
  | EndlessExpression(allowLemma, allowLambda)
  | ConstAtomExpression { Suffix }
  )
</code></pre>

<p>After descending through all the binary and unary operators we arrive at
the primary expressions, which are explained in subsequent sections. As
can be seen, a number of these can be followed by 0 or more <code>Suffix</code>es
to select a component of the value.</p>

<p>If the <code>allowLambda</code> is false then <code>LambdaExpression</code>s are not
recognized in this context.</p>

<h3 id="sec-lambda-expressions">20.13. Lambda expressions</h3>
<pre><code class="language-grammar">LambdaExpression(allowLemma) =
  ( WildIdent
  | "(" [ IdentTypeOptional { "," IdentTypeOptional } ] ")"
  )
  LambdaSpec
  "=&gt;"
  Expression(allowLemma, allowLambda: true)
</code></pre>

<p>See <a href="#sec-lambda-specification">Section 5.4</a> for a description of <code>LambdaSpec</code>.</p>

<p>In addition to named functions, Dafny supports expressions that define
functions.  These are called <em>lambda (expression)s</em> (some languages
know them as <em>anonymous functions</em>).  A lambda expression has the
form:</p>
<pre><code class="language-dafny">( _params_ ) _specification_ =&gt; _body_
</code></pre>
<p>where <em>params</em> is a comma-delimited list of parameter
declarations, each of which has the form <code>x</code> or <code>x: T</code>.  The type <code>T</code>
of a parameter can be omitted when it can be inferred.  If the
identifier <code>x</code> is not needed, it can be replaced by <code>_</code>.  If
<em>params</em> consists of a single parameter <code>x</code> (or <code>_</code>) without an
explicit type, then the parentheses can be dropped; for example, the
function that returns the successor of a given integer can be written
as the following lambda expression:</p>
<pre><code class="language-dafny">x =&gt; x + 1
</code></pre>

<p>The <em>specification</em> is a list of clauses <code>requires E</code> or
<code>reads W</code>, where <code>E</code> is a boolean expression and <code>W</code> is a frame
expression.</p>

<p><em>body</em> is an expression that defines the functions return
value.  The body must be well-formed for all possible values of the
parameters that satisfy the precondition (just like the bodies of
named functions and methods).  In some cases, this means it is
necessary to write explicit <code>requires</code> and <code>reads</code> clauses.  For
example, the lambda expression</p>
<pre><code class="language-dafny">x requires x != 0 =&gt; 100 / x
</code></pre>
<p>would not be well-formed if the <code>requires</code> clause were omitted,
because of the possibility of division-by-zero.</p>

<p>In settings where functions cannot be partial and there are no
restrictions on reading the heap, the <em>eta expansion</em> of a function
<code>F: T -&gt; U</code> (that is, the wrapping of <code>F</code> inside a lambda expression
in such a way that the lambda expression is equivalent to <code>F</code>) would
be written <code>x =&gt; F(x)</code>.  In Dafny, eta expansion must also account for
the precondition and reads set of the function, so the eta expansion
of <code>F</code> looks like:</p>
<pre><code class="language-dafny">x requires F.requires(x) reads F.reads(x) =&gt; F(x)
</code></pre>

<h3 id="2014-left-hand-side-expressions">20.14. Left-Hand-Side Expressions</h3>
<pre><code class="language-grammar">Lhs =
  ( NameSegment { Suffix }
  | ConstAtomExpression
    Suffix { Suffix }
  )
</code></pre>

<p>A left-hand-side expression is only used on the left hand
side of an <a href="#sec-update-and-call-statement"><code>UpdateStmt</code></a>
or an <a href="#sec-update-failure">Update with Failure Statement</a>.</p>

<p>An example of the first (<code>NameSegment</code>) form is:</p>

<pre><code class="language-dafny">    LibraryModule.F().x
</code></pre>

<p>An example of the second (<code>ConstAtomExpression</code>) form is:</p>

<pre><code class="language-dafny">    old(o.f).x
</code></pre>

<h3 id="2015-right-hand-side-expressions">20.15. Right-Hand-Side Expressions</h3>
<pre><code class="language-grammar">Rhs =
  ( ArrayAllocation_
  | ObjectAllocation_
  | Expression(allowLemma: false, allowLambda: true)
  | HavocRhs_
  )
  { Attribute }
</code></pre>

<p>An <code>Rhs</code> is either array allocation, an object allocation,
an expression, or a havoc right-hand-side, optionally followed
by one or more <code>Attribute</code>s.</p>

<p>Right-hand-side expressions appear in the following constructs:
<a href="#sec-return-statement"><code>ReturnStmt</code></a>,
<a href="#sec-yield-statement"><code>YieldStmt</code></a>,
<a href="#sec-update-and-call-statement"><code>UpdateStmt</code></a>,
<a href="#sec-update-failure"><code>UpdateFailureStmt</code></a>, or
<a href="#sec-var-decl-statement"><code>VarDeclStatement</code></a>.
These are the only contexts in which arrays or objects may be
allocated, or in which havoc may be produced.</p>

<h3 id="2016-array-allocation">20.16. Array Allocation</h3>
<pre><code class="language-grammar">ArrayAllocation_ =
  "new" [ Type ] "[" [ Expressions ] "]"
  [ "(" Expression(allowLemma: true, allowLambda: true) ")"
  | "[" [ Expressions ] "]"
  ]
</code></pre>

<p>This allocates a new single or multi-dimensional array as explained in
section <a href="#sec-array-types">Section 15</a>.
The initialization portion is optional. One form is an
explicit list of values, in which case the dimension is optional:</p>
<pre><code class="language-dafny">var a := new int[5];
var b := new int[5][2,3,5,7,11];
var c := new int[][2,3,5,7,11];
var d := new int[3][4,5,6,7]; // error
</code></pre>
<p>The comprehension form requires a dimension and uses a function of
type <code>nat -&gt; T</code> where <code>T</code> is the array element type:</p>
<pre><code class="language-dafny">var a := new int[5](i =&gt; i*i);
</code></pre>

<p>To allocate a multi-dimensional array, simply give the sizes of
each dimension. For example,</p>
<pre><code class="language-dafny">var m := new real[640, 480];
</code></pre>
<p>allocates a 640-by-480 two-dimensional array of <code>real</code>s. The initialization
portion cannot give a display of elements like in the one-dimensional
case, but it can use an initialization function. A function used to initialize
a n-dimensional array requires a function from n <code>nat</code>s to a <code>T</code>, where <code>T</code>
is element type of the array. Here is an example:</p>
<pre><code class="language-dafny">var diag := new int[30, 30]((i, j) =&gt; if i == j then 1 else 0);
</code></pre>

<p>Array allocation is permitted in ghost contexts. If any expression
used to specify a dimension or initialization value is ghost, then the
<code>new</code> allocation can only be used in ghost contexts. Because the
elements of an array are non-ghost, an array allocated in a ghost
context in effect cannot be changed after initialization.</p>

<h3 id="2017-object-allocation">20.17. Object Allocation</h3>
<pre><code class="language-grammar">ObjectAllocation_ = "new" Type [ "." TypeNameOrCtorSuffix ]
                               [ "(" [ Bindings ] ")" ]
</code></pre>

<p>This allocated a new object of a class type as explained
in section <a href="#sec-class-types">Class Types</a>.</p>

<h3 id="2018-havoc-right-hand-side">20.18. Havoc Right-Hand-Side</h3>
<pre><code class="language-grammar">HavocRhs_ = "*"
</code></pre>
<p>A havoc right-hand-side produces an arbitrary value of its associated
type. To obtain a more constrained arbitrary value the assign-such-that
operator (<code>:|</code>) can be used. See <a href="#sec-update-and-call-statement">Section 19.6</a>.</p>

<h3 id="2019-constant-or-atomic-expressions">20.19. Constant Or Atomic Expressions</h3>
<pre><code class="language-grammar">ConstAtomExpression =
  ( LiteralExpression
  | "this"
  | FreshExpression_
  | AllocatedExpression_
  | UnchangedExpression_
  | OldExpression_
  | CardinalityExpression_
  | ParensExpression
  )
</code></pre>
<p>A <code>ConstAtomExpression</code> represents either a constant of some type, or an
atomic expression. A <code>ConstAtomExpression</code> is never an l-value.</p>

<h3 id="2020-literal-expressions">20.20. Literal Expressions</h3>
<pre><code class="language-grammar">LiteralExpression =
 ( "false" | "true" | "null" | Nat | Dec |
   charToken | stringToken )
</code></pre>
<p>A literal expression is a boolean literal, a null object reference,
an integer or real literal, a character or string literal,
or <code>this</code>, which denotes the current object in the context of
an instance method or function.</p>

<h3 id="sec-fresh-expression">20.21. Fresh Expressions</h3>
<pre><code class="language-grammar">FreshExpression_ =
  "fresh" [ "@" LabelName ]
  "(" Expression(allowLemma: true, allowLambda: true) ")"
</code></pre>

<p><code>fresh(e)</code> returns a boolean value that is true if
the objects denoted by expression <code>e</code> were all
freshly allocated since the time of entry to the enclosing method.</p>

<p>If the <code>LabelName</code> is present, it must denote a label that in the
enclosing methods control flow dominates the expression. In this
case, <code>fresh@L(e)</code> returns <code>true</code> if the objects denoted by <code>e</code> were all
freshly allocated since control flow reached label <code>L</code>.</p>

<p>The argument of <code>fresh</code> must be either an object reference
or a set or sequence of object references.</p>

<h3 id="sec-allocated-expression">20.22. Allocated Expressions</h3>
<pre><code class="language-grammar">AllocatedExpression_ =
  "allocated" "(" Expression(allowLemma: true, allowLambda: true) ")"
</code></pre>

<p>For any expression <code>e</code>, the expression <code>allocated(e)</code> evaluates to <code>true</code>
in a state if the value of <code>e</code> is available in that state, meaning that
it could in principle have been the value of a variable in that state.
This can be useful when, for example, <code>allocated(e)</code> is evaluated in an
<code>old</code> state. For instance, if <code>d</code> is a local variable holding a datatype value
<code>Cons(r, Nil)</code> where <code>r</code> is an object that was allocated in the enclosing
method, then <code>old(allocated(d))</code> is <code>false</code>.</p>

<p>If the expression <code>e</code> is of a reference type, then <code>!old(allocated(e))</code>
is the same as <code>fresh(e)</code>.</p>

<h3 id="sec-unchanged-expression">20.23. Unchanged Expressions</h3>

<pre><code class="language-grammar">UnchangedExpression_ =
  "unchanged" [ "@" LabelName ]
  "(" FrameExpression(allowLemma: true, allowLambda: true)
      { "," FrameExpression(allowLemma: true, allowLambda: true) }
  ")"
</code></pre>

<p>The <code>unchanged</code> expression returns <code>true</code> if and only if every reference
denoted by its arguments has the same value for all its fields in the
old and current state. For example, if <code>c</code> is an object with two
fields, <code>x</code> and <code>y</code>, then <code>unchanged(c)</code> is equivalent to</p>
<pre><code class="language-dafny">c.x == old(c.x) &amp;&amp; c.y == old(c.y)
</code></pre>

<p>Each argument to <code>unchanged</code> can be a reference, a set of references, or
a sequence of references. If it is a reference, it can be followed by
<code>`f</code>, where <code>f</code> is a field of the reference. This form expresses that <code>f</code>,
not necessarily all fields, has the same value in the old and current
state.</p>

<p>The optional <code>@</code>-label says to use it as the old-state instead of using
the <code>old</code> state. That is, using the example <code>c</code> from above, the expression
<code>unchanged@Lbl(c)</code> is equivalent to</p>
<pre><code class="language-dafny">c.x == old@Lbl(c.x) &amp;&amp; c.y == old@Lbl(c.y)
</code></pre>

<p>Each reference denoted by the arguments of <code>unchanged</code> must be non-null and
must be allocated in the old-state of the expression.</p>

<h3 id="sec-old-expression">20.24. Old and Old@ Expressions</h3>

<pre><code class="language-grammar">OldExpression_ =
  "old" [ "@" LabelName ]
  "(" Expression(allowLemma: true, allowLambda: true) ")"
</code></pre>

<p>An <em>old expression</em> is used in postconditions or in the body of a method
or in the body or specification of any two-state function or two-state lemma;
an <em>old</em> expression with a label is used only in the body of a method at a point
where the label dominates its use in this expression.</p>

<p><code>old(e)</code> evaluates
the argument using the value of the heap on entry to the method;
<code>old@ident(e)</code> evaluates the argument using the value of the heap at the
given statement label.</p>

<p>Note that <strong>old</strong> and <strong>old@</strong> only affect heap dereferences,
like <code>o.f</code> and <code>a[i]</code>.
In particular, neither form has any effect on the value returned for local
variables or out-parameters (as they are not on the heap).<sup id="fnref:Old" role="doc-noteref"><a href="#fn:Old" class="footnote" rel="footnote">9</a></sup>
If the value of an entire expression at a
particular point in the method body is needed later on in the method body,
the clearest means is to declare a ghost variable, initializing it to the
expression in question.</p>

<p>constructs in other specification languages like ACSL or JML.</p>

<p>The argument of an <code>old</code> expression may not contain nested <code>old</code>,
<a href="#sec-fresh-expression"><code>fresh</code></a>,
or <a href="#sec-unchanged-expression"><code>unchanged</code></a> expressions,
nor <a href="#sec-two-state">two-state functions</a> or <a href="#sec-two-state-lemma">two-state lemmas</a>.</p>

<p>Here are some explanatory examples. All <code>assert</code> statements verify to be true.</p>
<pre><code class="language-dafny">class A {

  var value: int

  method m(i: int)
    requires i == 6
    requires value == 42
    modifies this
  {
    var j: int := 17;
    value := 43;
    label L:
    j := 18;
    value := 44;
    label M:
    assert old(i) == 6; // i is local, but can't be changed anyway
    assert old(j) == 18; // j is local and not affected by old
    assert old@L(j) == 18; // j is local and not affected by old
    assert old(value) == 42;
    assert old@L(value) == 43;
    assert old@M(value) == 44 &amp;&amp; this.value == 44;
    // value is this.value; 'this' is the same
    // same reference in current and pre state but the
    // values stored in the heap as its fields are different;
    // '.value' evaluates to 42 in the pre-state, 43 at L,
    // and 44 in the current state
  }
}

</code></pre>
<pre><code class="language-dafny">class A {
  var value: int
  constructor ()
     ensures value == 10
  {
     value := 10;
  }
}

class B {
   var a: A
   constructor () { a := new A(); }

   method m()
     requires a.value == 11
     modifies this, this.a
   {
     label L:
     a.value := 12;
     label M:
     a := new A(); // Line X
     label N:
     a.value := 20;
     label P:

     assert old(a.value) == 11;
     assert old(a).value == 12; // this.a is from pre-state,
                                // but .value in current state
     assert old@L(a.value) == 11;
     assert old@L(a).value == 12; // same as above
     assert old@M(a.value) == 12; // .value in M state is 12
     assert old@M(a).value == 12;
     assert old@N(a.value) == 10; // this.a in N is the heap
                                  // reference at Line X
     assert old@N(a).value == 20; // .value in current state is 20
     assert old@P(a.value) == 20;
     assert old@P(a).value == 20;
  }
}

</code></pre>
<p>The next example demonstrates the interaction between <code>old</code> and array elements.</p>
<pre><code class="language-dafny">class A {
  var z1: array&lt;nat&gt;
  var z2: array&lt;nat&gt;

  method mm()
    requires z1.Length &gt; 10 &amp;&amp; z1[0] == 7
    requires z2.Length &gt; 10 &amp;&amp; z2[0] == 17
    modifies z2
  {
    var a: array&lt;nat&gt; := z1;
    assert a[0] == 7;
    a := z2;
    assert a[0] == 17;
    assert old(a[0]) == 17; // a is local with value z2
    z2[0] := 27;
    assert old(a[0]) == 17; // a is local, with current value of
                            // z2; in pre-state z2[0] == 17
    assert old(a)[0] == 27; // a is local, with current value of
                            // z2; z2[0] is currently 27
  }
}

</code></pre>

<h3 id="sec-cardinality-expression">20.25. Cardinality Expressions</h3>
<pre><code class="language-grammar">CardinalityExpression_ =
  "|" Expression(allowLemma: true, allowLambda: true) "|"
</code></pre>

<p>For a finite-collection expression <code>c</code>, <code>|c|</code> is the cardinality of <code>c</code>. For a
finite set or sequence, the cardinality is the number of elements. For
a multiset, the cardinality is the sum of the multiplicities of the
elements. For a finite map, the cardinality is the cardinality of the
domain of the map. Cardinality is not defined for infinite sets or infinite maps.
For more, see <a href="#sec-collection-types">Section 10</a>.</p>

<h3 id="2026-parenthesized-expression">20.26. Parenthesized Expression</h3>
<pre><code class="language-grammar">ParensExpression =
  "(" [ Expressions ] ")"
</code></pre>
<p>A <code>ParensExpression</code> is a list of zero or more expressions
enclosed in parentheses.</p>

<p>If there is exactly one expression enclosed then the value is just
the value of that expression.</p>

<p>If there are zero or more than one, the result is a <code>tuple</code> value.
See <a href="#sec-tuple-types">Section 17.1</a>.</p>

<h3 id="sec-seq-comprehension">20.27. Sequence Display Expression</h3>
<pre><code class="language-grammar">SeqDisplayExpr =
  ( "[" [ Expressions ] "]"
  | "seq" [ GenericInstantiation ]
    "(" Expression(allowLemma: true, allowLambda: true)
    "," Expression(allowLemma: true, allowLambda: true)
    ")"
  )
</code></pre>
<p>A sequence display expression provides a way to construct
a sequence with given values. For example</p>

<pre><code class="language-dafny">[1, 2, 3]
</code></pre>
<p>is a sequence with three elements in it.</p>

<pre><code class="language-dafny">seq(k, n =&gt; n+1)
</code></pre>
<p>is a sequence of k elements whose values are obtained by evaluating the
second argument (a function) on the indices 0 up to k.</p>

<p>See section [#sec-sequences] for more information on
sequences.</p>

<h3 id="2028-set-display-expression">20.28. Set Display Expression</h3>
<pre><code class="language-grammar">SetDisplayExpr =
  ( [ "iset" | "multiset" ] "{" [ Expressions ] "}"
  | "multiset" "(" Expression(allowLemma: true,
                              allowLambda: true) ")"
  )
</code></pre>

<p>A set display expression provides a way of constructing a set with given
elements. If the keyword <code>iset</code> is present, then a potentially infinite
set (with the finite set of given elements) is constructed.</p>

<p>For example</p>

<pre><code class="language-dafny">{1, 2, 3}
</code></pre>
<p>is a set with three elements in it.
See <a href="#sec-sets">Section 10.1</a> for more information on
sets.</p>

<p>A multiset display expression provides a way of constructing
a multiset with given elements and multiplicities. For example</p>

<pre><code class="language-dafny">multiset{1, 1, 2, 3}
</code></pre>
<p>is a multiset with three elements in it. The number 1 has a multiplicity of 2,
and the numbers 2 and 3 each have a multiplicity of 1.</p>

<p>A multiset cast expression converts a set or a sequence
into a multiset as shown here:</p>

<pre><code class="language-dafny">var s : set&lt;int&gt; := {1, 2, 3};
var ms : multiset&lt;int&gt; := multiset(s);
ms := ms + multiset{1};
var sq : seq&lt;int&gt; := [1, 1, 2, 3];
var ms2 : multiset&lt;int&gt; := multiset(sq);
assert ms == ms2;
</code></pre>

<p>See <a href="#sec-multisets">Section 10.2</a> for more information on
multisets.</p>

<h3 id="sec-map-display-expression">20.29. Map Display Expression</h3>
<pre><code class="language-grammar">MapDisplayExpr =
  ("map" | "imap" ) "[" [ MapLiteralExpressions ] "]"

MapLiteralExpressions =
  Expression(allowLemma: true, allowLambda: true)
  ":=" Expression(allowLemma: true, allowLambda: true)
  { "," Expression(allowLemma: true, allowLambda: true)
        ":=" Expression(allowLemma: true, allowLambda: true)
  }
</code></pre>

<p>A map display expression builds a finite or potentially infinite
map from explicit <code>MapLiteralExpressions</code>. For example:</p>

<pre><code class="language-dafny">var m := map[1 := "a", 2 := "b"];
ghost var im := imap[1 := "a", 2 := "b"];
</code></pre>

<p>See <a href="#sec-maps">Section 10.4</a> for more details on maps and imaps.</p>

<h3 id="2030-endless-expression">20.30. Endless Expression</h3>
<pre><code class="language-grammar">EndlessExpression(allowLemma, allowLambda) =
  ( IfExpression(allowLemma, allowLambda)
  | MatchExpression(allowLemma, allowLambda)
  | QuantifierExpression(allowLemma, allowLambda)
  | SetComprehensionExpr(allowLemma, allowLambda)
  | StmtInExpr Expression(allowLemma, allowLambda)
  | LetExpression(allowLemma, allowLambda)
  | MapComprehensionExpr(allowLemma, allowLambda)
  )
</code></pre>

<p><code>EndlessExpression</code> gets it name from the fact that all its alternate
productions have no terminating symbol to end them, but rather they
all end with an <code>Expression</code> at the end. The various
<code>EndlessExpression</code> alternatives are described below.</p>

<h3 id="2031-if-expression">20.31. If Expression</h3>
<pre><code class="language-grammar">IfExpression(allowLemma, allowLambda) =
    "if" ( BindingGuard(allowLambda: true)
         | Expression(allowLemma: true, allowLambda: true)
         )
    "then" Expression(allowLemma: true, allowLambda: true)
    "else" Expression(allowLemma, allowLambda)
</code></pre>

<p>The <code>IfExpression</code> is a conditional expression. It first evaluates
the expression following the <code>if</code>. If it evaluates to <code>true</code> then
it evaluates the expression following the <code>then</code> and that is the
result of the expression. If it evaluates to <code>false</code> then the
expression following the <code>else</code> is evaluated and that is the result
of the expression. It is important that only the selected expression
is evaluated as the following example shows.</p>

<pre><code class="language-dafny">var k := 10 / x; // error, may divide by 0.
var m := if x != 0 then 10 / x else 1; // ok, guarded
</code></pre>

<p>TO BE WRITTEN - binding form</p>

<h3 id="sec-case-pattern">20.32. Case and Extended Patterns</h3>
<pre><code class="language-grammar">CasePattern =
  ( Ident "(" [ CasePattern { "," CasePattern } ] ")"
  | "(" [ CasePattern { "," CasePattern } ] ")"
  | IdentTypeOptional
  )

ExtendedPattern =
  ( PossiblyNegatedLiteralExpression
  | IdentTypeOptional
  | [ Ident ] "(" [ ExtendedPattern { "," ExtendedPattern } ] ")"
  )

PossiblyNegatedLiteralExpression =
  ( "-" ( Nat | Dec )
  | LiteralExpression
  )
</code></pre>

<p>Case patterns and extended patterns are used for (possibly nested)
pattern matching on inductive, coinductive or base type values.
The <code>ExtendedPattern</code> construct is used in
<code>CaseStatement</code> and <code>CaseExpression</code>s,
that is, in <code>match</code>
<a href="#sec-match-statement">statements</a>
and <a href="#sec-match-expression">expressions</a>.
<code>CasePattern</code>s are used
in <code>LetExpr</code>s and <code>VarDeclStatement</code>s.
The <code>ExtendedPattern</code> differs from <code>CasePattern</code> is allowing literals
and symbolic constants.</p>

<p>When matching an inductive or coinductive value in
a <code>MatchStmt</code> or <code>MatchExpression</code>, the <code>ExtendedPattern</code>
must correspond to a</p>

<ul>
  <li>(1) bound variable (a simple identifier),</li>
  <li>(2) a constructor of the type of the value,</li>
  <li>(3) a literal of the correct type, or</li>
  <li>(4) a symbolic constant.</li>
</ul>

<p>If the extended pattern is</p>

<ul>
  <li>a parentheses-enclosed possibly-empty list of patterns,
then the pattern matches a tuple.</li>
  <li>an identifier followed
by a parentheses-enclosed possibly-empty list of patterns, then the pattern
matches a constructor.</li>
  <li>a literal, then the pattern matches exactly that literal.</li>
  <li>a simple identifier, then the pattern matches
    <ul>
      <li>a parameter-less constructor if there is one defined with the correct type and the given name, else</li>
      <li>the value of a symbolic constant, if a name lookup finds a declaration for
a constant with the given name (if the name is declared but with a non-matching type, a type resolution error will occur),</li>
      <li>otherwise, the identifier is a new bound variable</li>
    </ul>
  </li>
</ul>

<p>Any <code>ExtendedPattern</code>s inside the parentheses are then
matched against the arguments that were given to the
constructor when the value was constructed.
The number of <code>ExtendedPattern</code> must match the number
of parameters to the constructor (or the arity of the
tuple).
When matching a value of base type, the <code>ExtendedPattern</code> should
either be a <code>LiteralExpression_</code> of the same type as the value,
or a single identifier matching all values of this type.</p>

<p>The <code>ExtendedPattern</code>s and <code>CasePattern</code>s may be nested. The set of bound variable
identifiers contained in a <code>CaseBinding_</code> or <code>CasePattern</code> must be distinct.
They are bound to the corresponding values in the value being
matched. (Thus, for example, one cannot repeat a bound variable to
attempt to match a constructor that has two identical arguments.)</p>

<h3 id="sec-match-expression">20.33. Match Expression</h3>

<pre><code class="language-grammar">MatchExpression(allowLemma, allowLambda) =
  "match" Expression(allowLemma, allowLambda)
  ( "{" { CaseExpression(allowLemma: true, allowLambda: true) } "}"
  | { CaseExpression(allowLemma, allowLambda) }
  )

CaseExpression(allowLemma, allowLambda) =
  "case" ExtendedPattern "=&gt;" Expression(allowLemma, allowLambda)
</code></pre>

<p>A <code>MatchExpression</code> is used to conditionally evaluate and select an
expression depending on the value of an algebraic type, i.e. an inductive
type, a co-inductive type, or a base type.</p>

<p>The <code>Expression</code> following the <code>match</code> keyword is called the
<em>selector</em>. The selector is evaluated and then matched against each <code>CaseExpression</code> in order until a matching clause is found, as described in
the <a href="#sec-case-pattern">section on <code>CaseBinding</code>s</a>.</p>

<p>All of the variables in the <code>CasePattern</code>s must be distinct.
If types for the identifiers are not given then types are inferred
from the types of the constructors parameters. If types are
given then they must agree with the types of the
corresponding parameters.</p>

<p>A <code>MatchExpression</code> is evaluated by first evaluating the selector.
The <code>ExtendedPattern</code>s of each <code>CaseClause</code> are then compared in order
 with the resulting value until a matching pattern is found.
If the constructor had
parameters then the actual values used to construct the selector
value are bound to the identifiers in the identifier list.
The expression to the right of the <code>=&gt;</code> in the <code>CaseClause</code> is then
evaluated in the environment enriched by this binding. The result
of that evaluation is the result of the <code>MatchExpression</code>.</p>

<p>Note that the braces enclosing the <code>CaseClause</code>s may be omitted.</p>

<h3 id="sec-quantifier-expression">20.34. Quantifier Expression</h3>
<pre><code class="language-grammar">QuantifierExpression(allowLemma, allowLambda) =
    ( "forall" | "exists" ) QuantifierDomain "::"
    Expression(allowLemma, allowLambda)

QuantifierDomain =
  IdentTypeOptional { "," IdentTypeOptional } { Attribute }
  [ "|" Expression(allowLemma: true, allowLambda: true) ]
</code></pre>

<p>A <code>QuantifierExpression</code> is a boolean expression that specifies that a
given expression (the one following the <code>::</code>) is true for all (for
<strong>forall</strong>) or some (for <strong>exists</strong>) combination of values of the
quantified variables, namely those in the <code>QuantifierDomain</code>.</p>

<p>Here are some examples:</p>
<pre><code class="language-dafny">assert forall x : nat | x &lt;= 5 :: x * x &lt;= 25;
(forall n :: 2 &lt;= n ==&gt; (exists d :: n &lt; d &lt; 2*n))
</code></pre>

<p>The quantifier identifiers are <em>bound</em> within the scope of the
expressions in the <code>QuantifierExpression</code>.</p>

<p>If types are not given for the quantified identifiers, then Dafny
attempts to infer their types from the context of the expressions.
It this is not possible, the program is in error.</p>

<h3 id="sec-set-comprehension-expression">20.35. Set Comprehension Expressions</h3>
<pre><code class="language-grammar">SetComprehensionExpr(allowLemma, allowLambda) =
  [ "set" | "iset" ]
  IdentTypeOptional
  { "," IdentTypeOptional }
  { Attribute }
  "|"
  Expression(allowLemma, allowLambda)
  [ "::" Expression(allowLemma, allowLambda) ]
</code></pre>

<p>A set comprehension expression is an expression that yields a set
(possibly infinite only if <code>iset</code> is used) that
satisfies specified conditions. There are two basic forms.</p>

<p>If there is only one quantified variable, the optional <code>"::" Expression</code>
need not be supplied, in which case it is as if it had been supplied
and the expression consists solely of the quantified variable.
That is,</p>

<pre><code class="language-dafny">set x : T | P(x)
</code></pre>

<p>is equivalent to</p>

<pre><code class="language-dafny">set x : T | P(x) :: x
</code></pre>

<p>For the full form</p>

<pre><code class="language-dafny">var S := set x1:T1, x2:T2 ... | P(x1, x2, ...) :: Q(x1, x2, ...)
</code></pre>

<p>the elements of <code>S</code> will be all values resulting from evaluation of <code>Q(x1, x2, ...)</code>
for all combinations of quantified variables <code>x1, x2, ...</code> such that
predicate <code>P(x1, x2, ...)</code> holds. For example,</p>

<pre><code class="language-dafny">var S := set x:nat, y:nat | x &lt; 2 &amp;&amp; y &lt; 2 :: (x, y)
</code></pre>
<p>yields <code>S == {(0, 0), (0, 1), (1, 0), (1,1) }</code></p>

<p>The types on the quantified variables are optional and if not given Dafny
will attempt to infer them from the contexts in which they are used in the
<code>P</code> or <code>Q</code> expressions.</p>

<p>If a finite set was specified (set keyword used), Dafny must be able to prove that the
result is finite otherwise the set comprehension expression will not be
accepted.</p>

<p>Set comprehensions involving reference types such as</p>

<pre><code class="language-dafny">set o: object | true
</code></pre>

<p>are allowed in ghost expressions within methods, but not in ghost functions<sup id="fnref:set-of-objects-not-in-functions" role="doc-noteref"><a href="#fn:set-of-objects-not-in-functions" class="footnote" rel="footnote">10</a></sup>.
In particular, in ghost contexts, the
check that the result is finite should allow any set comprehension
where the bound variable is of a reference type. In non-ghost contexts,
it is not allowed, becauseeven though the resulting set would be
finiteit is not pleasant or practical to compute at run time.</p>

<p>The universe in which set comprehensions are evaluated is the set of all
<em>allocated</em> objects, of the appropriate type and satisfying the given predicate.
For example, given</p>

<pre><code class="language-dafny">class I {
  var i: int
}

method test() {
  ghost var m := set x: I :: 0 &lt;= x.i &lt;= 10;
}
</code></pre>
<p>the set <code>m</code> contains only those instances of <code>I</code> that have been allocated
at the point in program execution that <code>test</code> is evaluated. This could be
no instances, one per value of <code>x.i</code> in the stated range, multiple instances
of <code>I</code> for each value of <code>x.i</code>, or any other combination.</p>

<h3 id="sec-statement-in-an-expression">20.36. Statements in an Expression</h3>
<pre><code class="language-grammar">StmtInExpr = ( AssertStmt | AssumeStmt | ExpectStmt
             | RevealStmt | CalcStmt
             )
</code></pre>

<p>A <code>StmtInExpr</code> is a kind of statement that is allowed to
precede an expression in order to ensure that the expression
can be evaluated without error. For example:</p>

<pre><code class="language-dafny">assume x != 0; 10/x
</code></pre>

<p><code>Assert</code>, <code>assume</code>, <code>expect</code>, reveal and <code>calc</code> statements can be used in this way.</p>

<h3 id="sec-let-expression">20.37. Let Expression</h3>

<pre><code class="language-grammar">LetExpression(allowLemma, allowLambda) =
  (
    [ "ghost" ] "var" CasePattern { "," CasePattern }
    ( ":=" | ":-" | { Attribute } ":|" )
    Expression(allowLemma: false, allowLambda: true)
    { "," Expression(allowLemma: false, allowLambda: true) }
  |
    ":-"
    Expression(allowLemma: false, allowLambda: true)
  )
  ";"
  Expression(allowLemma, allowLambda)
</code></pre>

<p>A <code>let</code> expression allows binding of intermediate values to identifiers
for use in an expression. The start of the <code>let</code> expression is
signaled by the <code>var</code> keyword. They look much like a local variable
declaration except the scope of the variable only extends to the
enclosed expression.</p>

<p>For example:</p>
<pre><code class="language-dafny">var sum := x + y; sum * sum
</code></pre>

<p>In the simple case, the <code>CasePattern</code> is just an identifier with optional
type (which if missing is inferred from the rhs).</p>

<p>The more complex case allows destructuring of constructor expressions.
For example:</p>

<pre><code class="language-dafny">datatype Stuff = SCons(x: int, y: int) | Other
function GhostF(z: Stuff): int
  requires z.SCons?
{
  var SCons(u, v) := z; var sum := u + v; sum * sum
}
</code></pre>

<p>The syntax using <code>:-</code> is discussed in the following subsection.</p>

<h3 id="2038-let-or-fail-expression">20.38. Let or Fail Expression</h3>

<p>The Let expression described in <a href="#sec-let-expression">Section 20.37</a> has a failure variant
that simply uses <code>:-</code> instead of <code>:=</code>. This Let-or-Fail expression also permits propagating
failure results. However, in statements <a href="#sec-update-failure">Section 19.7</a>, failure results in
immediate return from the method; expressions do not have side effects or immediate return
mechanisms.</p>

<p>The expression <code>:- V; E</code> is desugared into the <em>expression</em></p>
<pre><code class="language-dafny">var tmp := V;
if tmp.IsFailure()
then tmp.PropagateFailure()
else E
</code></pre>

<p>The expression <code>var v :- V; E</code> is desugared into the <em>expression</em></p>
<pre><code class="language-dafny">var tmp := V;
if tmp.IsFailure()
then tmp.PropagateFailure()
else var v := tmp.Extract(); E
</code></pre>

<p>If the RHS is a list of expressions then the desugaring is similar. <code>var v, v1 :- V, V1; E</code> becomes</p>
<pre><code class="language-dafny">var tmp := V;
if tmp.IsFailure()
then tmp.PropagateFailure()
else var v, v1 := tmp.Extract(), V1; E
</code></pre>

<p>So, if tmp is a failure value, then a corresponding failure value is propagated along; otherwise, the expression
is evaluated as normal.</p>

<p>Note that the value of the let-or-fail expression is either <code>tmp.PropagateFailure()</code> or <code>E</code>, the two sides of the
if-then-else expression. Consequently these two expressions must have types that can be joined into one type for
the whole let-or-fail expression. Typically that means that <code>tmp.PropagateFailure()</code> is a failure value and
<code>E</code> is a value-carrying success value, both of the same failure-compatible type, as described in <a href="#sec-update-failure">Section 19.7</a>.</p>

<h3 id="sec-map-comprehension-expression">20.39. Map Comprehension Expression</h3>
<pre><code class="language-grammar">MapComprehensionExpr(allowLemma, allowLambda) =
  ( "map" | "imap" )
  IdentTypeOptional
  { "," IdentTypeOptional }
  { Attribute }
  [ "|" Expression(allowLemma: true, allowLambda: true) ]
  "::"
  Expression(allowLemma, allowLambda)
  [ ":=" Expression(allowLemma, allowLambda) ]
</code></pre>

<p>A <code>MapComprehensionExpr</code> defines a finite or infinite map value
by defining a domain (using the <code>IdentTypeOptional</code> and the optional
condition following the |) and for each value in the domain,
giving the mapped value using the expression following the ::.</p>

<p>For example:</p>
<pre><code class="language-dafny">function square(x : int) : int { x * x }
method test()
{
  var m := map x : int | 0 &lt;= x &lt;= 10 :: x * x;
  ghost var im := imap x : int :: x * x;
  ghost var im2 := imap x : int :: square(x);
}
</code></pre>

<p>Dafny finite maps must be finite, so the domain must be constrained to be finite.
But imaps may be infinite as the example shows. The last example shows
creation of an infinite map that gives the same results as a function.</p>

<p>If the expression includes the <code>:=</code> token, that token separates
domain values from range values. For example, in the following code</p>
<pre><code class="language-dafny">method test()
{
  var m := map x : int | 1 &lt;= x &lt;= 10 :: 2*x := 3*x;
}
</code></pre>
<p><code>m</code> maps <code>2</code> to <code>3</code>, <code>4</code> to <code>6</code>, and so on.</p>

<h3 id="sec-name-segment">20.40. Name Segment</h3>
<pre><code class="language-grammar">NameSegment = Ident [ GenericInstantiation | HashCall ]
</code></pre>

<p>A <code>NameSegment</code> names a Dafny entity by giving its declared
name optionally followed by information to
make the name more complete. For the simple case, it is
just an identifier.</p>

<p>If the identifier is for a generic entity, it is followed by
a <code>GenericInstantiation</code> which provides actual types for
the type parameters.</p>

<p>To reference a prefix predicate (see <a href="#sec-copredicates">Section 18.3.4</a>) or
prefix lemma (see <a href="#sec-prefix-lemmas">Section 18.3.5.3</a>), the identifier
must be the name of the greatest predicate or greatest lemma and it must be
followed by a <code>HashCall</code>.</p>

<h3 id="sec-hash-call">20.41. Hash Call</h3>
<pre><code class="language-grammar">HashCall = "#" [ GenericInstantiation ]
  "[" Expression(allowLemma: true, allowLambda: true) "]"
  "(" [ Bindings ] ")"
</code></pre>
<p>A <code>HashCall</code> is used to call the prefix for a greatest predicate or greatest lemma.
In the non-generic case, just insert <code>"#[k]"</code> before the call argument
list where k is the number of recursion levels.</p>

<p>In the case where the <code>greatest lemma</code> is generic, the generic type
argument is given before. Here is an example:</p>

<pre><code class="language-dafny">codatatype Stream&lt;T&gt; = Nil | Cons(head: int, stuff: T,
                                  tail: Stream&lt;T&gt;)

function append(M: Stream, N: Stream): Stream
{
  match M
  case Nil =&gt; N
  case Cons(t, s, M') =&gt; Cons(t, s, append(M', N))
}

function zeros&lt;T&gt;(s : T): Stream&lt;T&gt;
{
  Cons(0, s, zeros(s))
}

function ones&lt;T&gt;(s: T): Stream&lt;T&gt;
{
  Cons(1, s, ones(s))
}

greatest predicate atmost(a: Stream, b: Stream)
{
  match a
  case Nil =&gt; true
  case Cons(h,s,t) =&gt; b.Cons? &amp;&amp; h &lt;= b.head &amp;&amp; atmost(t, b.tail)
}

greatest lemma {:induction false} Theorem0&lt;T&gt;(s: T)
  ensures atmost(zeros(s), ones(s))
{
  // the following shows two equivalent ways to state the
  // co-inductive hypothesis
  if (*) {
    Theorem0#&lt;T&gt;[_k-1](s);
  } else {
    Theorem0(s);
  }
}

</code></pre>

<p>where the <code>HashCall</code> is <code>"Theorem0#&lt;T&gt;[_k-1](s);"</code>.
See <a href="#sec-copredicates">Section 18.3.4</a> and <a href="#sec-prefix-lemmas">Section 18.3.5.3</a>.</p>

<h3 id="2042-suffix">20.42. Suffix</h3>
<pre><code class="language-grammar">Suffix =
  ( AugmentedDotSuffix_
  | DatatypeUpdateSuffix_
  | SubsequenceSuffix_
  | SlicesByLengthSuffix_
  | SequenceUpdateSuffix_
  | SelectionSuffix_
  | ArgumentListSuffix_
  )
</code></pre>

<p>The <code>Suffix</code> non-terminal describes ways of deriving a new value from
the entity to which the suffix is appended. There are six kinds
of suffixes which are described below.</p>

<h4 id="20421-augmented-dot-suffix">20.42.1. Augmented Dot Suffix</h4>
<pre><code class="language-grammar">AugmentedDotSuffix_ = "." DotSuffix
                      [ GenericInstantiation | HashCall ]
</code></pre>

<p>An augmented dot suffix consists of a simple <code>DotSuffix</code> optionally
followed by either</p>

<ul>
  <li>a <code>GenericInstantiation</code> (for the case where the item
selected by the <code>DotSuffix</code> is generic), or</li>
  <li>a <code>HashCall</code> for the case where we want to call a prefix predicate
or prefix lemma. The result is the result of calling the prefix predicate
or prefix lemma.</li>
</ul>

<h4 id="sec-datatype-update-suffix">20.42.2. Datatype Update Suffix</h4>

<pre><code class="language-grammar">DatatypeUpdateSuffix_ =
  "." "(" MemberBindingUpdate { "," MemberBindingUpdate } ")"

MemberBindingUpdate =
  ( ident | digits )
  ":=" Expression(allowLemma: true, allowLambda: true)
</code></pre>

<p>A datatype update suffix is used to produce a new datatype value
that is the same as an old datatype value except that the
value corresponding to a given destructor has the specified value.
In a <code>MemberBindingUpdate</code>, the <code>ident</code> or <code>digits</code> is the
name of a destructor (i.e. formal parameter name) for one of the
constructors of the datatype. The expression to the right of the
<code>:=</code> is the new value for that formal.</p>

<p>All of the destructors in a <code>DatatypeUpdateSuffix_</code> must be
for the same constructor, and if they do not cover all of the
destructors for that constructor then the datatype value being
updated must have a value derived from that same constructor.</p>

<p>Here is an example:</p>

<pre><code class="language-dafny">module NewSyntax {
datatype MyDataType = MyConstructor(myint:int, mybool:bool)
                    | MyOtherConstructor(otherbool:bool)
                    | MyNumericConstructor(42:int)

method test(datum:MyDataType, x:int)
    returns (abc:MyDataType, def:MyDataType,
             ghi:MyDataType, jkl:MyDataType)
    requires datum.MyConstructor?
    ensures abc == datum.(myint := x + 2)
    ensures def == datum.(otherbool := !datum.mybool)
    ensures ghi == datum.(myint := 2).(mybool := false)
    // Resolution error: no non_destructor in MyDataType
    //ensures jkl == datum.(non_destructor := 5)
    ensures jkl == datum.(42 := 7)
{
    abc := MyConstructor(x + 2, datum.mybool);
    abc := datum.(myint := x + 2);
    def := MyOtherConstructor(!datum.mybool);
    ghi := MyConstructor(2, false);
    jkl := datum.(42 := 7);

    assert abc.(myint := abc.myint - 2) == datum.(myint := x);
}
}
</code></pre>

<h4 id="20423-subsequence-suffix">20.42.3. Subsequence Suffix</h4>
<pre><code class="language-grammar">SubsequenceSuffix_ =
  "[" [ Expression(allowLemma: true, allowLambda: true) ]
      ".." [ Expression(allowLemma: true, allowLambda: true) ]
  "]"
</code></pre>
<p>A subsequence suffix applied to a sequence produces a new sequence whose
elements are taken from a contiguous part of the original sequence. For
example, expression <code>s[lo..hi]</code> for sequence <code>s</code>, and integer-based
numerics <code>lo</code> and <code>hi</code> satisfying <code>0 &lt;= lo &lt;= hi &lt;= |s|</code>. See
section [#sec-other-sequence-expressions] for details.</p>

<h4 id="20424-slices-by-length-suffix">20.42.4. Slices By Length Suffix</h4>
<pre><code class="language-grammar">SlicesByLengthSuffix_ =
  "[" Expression(allowLemma: true, allowLambda: true) ":"
      [
        Expression(allowLemma: true, allowLambda: true)
        { ":" Expression(allowLemma: true, allowLambda: true) }
        [ ":" ]
      ]
  "]"
</code></pre>

<p>Applying a <code>SlicesByLengthSuffix_</code> to a sequence produces a
sequence of subsequences of the original sequence.
See section [#sec-other-sequence-expressions] for details.</p>

<h4 id="20425-sequence-update-suffix">20.42.5. Sequence Update Suffix</h4>
<pre><code class="language-grammar">SequenceUpdateSuffix_ =
  "[" Expression(allowLemma: true, allowLambda: true)
      ":=" Expression(allowLemma: true, allowLambda: true)
  "]"
</code></pre>

<p>For a sequence <code>s</code> and expressions <code>i</code> and <code>v</code>, the expression
<code>s[i := v]</code> is the same as the sequence <code>s</code> except that at
index <code>i</code> it has value <code>v</code>.</p>

<p>If the type of <code>s</code> is <code>seq&lt;T&gt;</code>, then <code>v</code> must have type <code>T</code>.
The index <code>i</code> can have any integer- or bit-vector-based type
(this is one situation in which Dafny implements implicit
conversion, as if an <code>as int</code> were appended to the index expression).
The expression <code>s[i := v]</code> has the same type as <code>s</code>.</p>

<h4 id="20426-selection-suffix">20.42.6. Selection Suffix</h4>
<pre><code class="language-grammar">SelectionSuffix_ =
  "[" Expression(allowLemma: true, allowLambda: true)
      { "," Expression(allowLemma: true, allowLambda: true) }
  "]"
</code></pre>

<p>If a <code>SelectionSuffix_</code> has only one expression in it, it is a
zero-based index that may be used to select a single element of a
sequence or from a single-dimensional array.</p>

<p>If a <code>SelectionSuffix_</code> has more than one expression in it, then
it is a list of indices to index into a multi-dimensional array.
The rank of the array must be the same as the number of indices.</p>

<p>If the <code>SelectionSuffix_</code> is used with an array or a sequence,
then each index expression can have any integer- or bit-vector-based
type
(this is one situation in which Dafny implements implicit
conversion, as if an <code>as int</code> were appended to the index expression).</p>

<h4 id="20427-argument-list-suffix">20.42.7. Argument List Suffix</h4>
<pre><code class="language-grammar">ArgumentListSuffix_ = "(" [ Expressions ] ")"
</code></pre>

<p>An argument list suffix is a parenthesized list of expressions that
are the arguments to pass to a method or function that is being
called. Applying such a suffix causes the method or function
to be called and the result is the result of the call.</p>

<h3 id="2043-expression-lists">20.43. Expression Lists</h3>
<pre><code class="language-grammar">Expressions =
    Expression(allowLemma: true, allowLambda: true)
    { "," Expression(allowLemma: true, allowLambda: true) }
</code></pre>

<p>The <code>Expressions</code> non-terminal represents a list of
one or more expressions separated by commas.</p>

<h3 id="2044-parameter-bindings">20.44. Parameter Bindings</h3>

<p>Method calls, object-allocation calls (<code>new</code>), function calls, and
datatype constructors can be called with both positional arguments
and named arguments.</p>
<pre><code class="language-grammar">ActualBindings =
    ActualBinding
    { "," ActualBinding }

ActualBinding =
    [ NoUSIdentOrDigits ":=" ]
    Expression(allowLemma: true, allowLambda: true)
</code></pre>

<p>Positional arguments must be given before any named arguments.
Positional arguments are passed to the formals in the corresponding
position. Named arguments are passed to the formal of the given
name. Named arguments can be given out of order from how the corresponding
formal parameters are declared. A formal declared with the modifier
<code>nameonly</code> is not allowed to be passed positionally.
The list of bindings for a call must
provide exactly one value for every required parameter and at most one
value for each optional parameter, and must never name
non-existent formals. Any optional parameter that is not given a value
takes on the default value declared in the callee for that optional parameter.</p>

<h3 id="2045-formal-parameters-and-default-value-expressions">20.45. Formal Parameters and Default-Value Expressions</h3>

<p>The formal parameters of a method, constructor in a class, iterator,
function, or datatype constructor can be declared with an expression
denoting a <em>default value</em>. This makes the parameter <em>optional</em>,
as opposed to <em>required</em>. All required parameters must be declared
before any optional parameters. All nameless parameters in a datatype
constructor must be declared before any <code>nameonly</code> parameters.</p>

<p>The default-value expression for a parameter is allowed to mention the
other parameters, including <code>this</code> (for instance methods and instance
functions), but not the implicit <code>_k</code> parameter in least and greatest
predicates and lemmas. The default value of a parameter may mention
both preceding and subsequent parameters, but there may not be any
dependent cycle between the parameters and their default-value
expressions.</p>

<p>The well-formedness of default-value expressions is checked independent
of the precondition of the enclosing declaration. For a function, the
parameter default-value expressions may only read what the functions
<code>reads</code> clause allows. For a datatype constructor, parameter default-value
expressions may not read anything. A default-value expression may not be
involved in any recursive or mutually recursive calls with the enclosing
declaration.</p>

<h3 id="sec-compile-time-constants">20.46. Compile-Time Constants</h3>

<p>In certain situations in Dafny it is helpful to know what the value of a
constant is during program analysis, before verification or execution takes
place. For example, a compiler can choose an optimized representation of a
<code>newtype</code> that is a subset of <code>int</code> if it knows the range of possible values
of the subset type: if the range is within 0 to less than 256, then an
unsigned 8-bit representation can be used.</p>

<p>To continue this example, suppose a new type is defined as</p>
<pre><code>const MAX := 47
newtype mytype = x | 0 &lt;= x &lt; MAX*4
</code></pre>
<p>In this case, we would prefer that Dafny recognize that <code>MAX*4</code> is
known to be constant with a value of <code>188</code>. The kinds of expressions
for which such an optimization is possible are called
<em>compile-time constants</em>. Note that the representation of <code>mytype</code> makes
no difference semantically, but can affect how compiled code is represented at run time.
In addition, though, using a symbolic constant (which may
well be used elsewhere as well) improves the self-documentation of the code.</p>

<p>In Dafny, the following expressions are compile-time constants<sup id="fnref:CTC" role="doc-noteref"><a href="#fn:CTC" class="footnote" rel="footnote">11</a></sup>, recursively
(that is, the arguments of any operation must themselves be compile-time constants):</p>

<ul>
  <li>int, bit-vector, real, boolean, char and string literals</li>
  <li>int operations: <code>+ - * / %</code> and unary <code>-</code> and comparisons <code>&lt; &lt;= &gt; &gt;= == !=</code></li>
  <li>real operations: <code>+ - *</code> and unary <code>-</code> and comparisons `&lt; &lt;= &gt; &gt;= == !=</li>
  <li>bool operations: <code>&amp;&amp; || ==&gt; &lt;== &lt;==&gt; == !=</code> and unary !</li>
  <li>bit-vector operations: <code>+ - * / % &lt;&lt; &gt;&gt; &amp; | ^</code> and unary <code>! -</code> and comparisons <code>&lt; &lt;= &gt; &gt;= == !=</code></li>
  <li>char operations: <code>&lt; &lt;= &gt; &gt;= == !=</code></li>
  <li>string operations: length: <code>|...|</code>, concatenation: <code>+</code>, comparisons <code>&lt; &lt;= == !=</code>, indexing <code>[]</code></li>
  <li>conversions between: <code>int</code> <code>real</code> <code>char</code> bit-vector</li>
  <li>newtype operations: newtype arguments, but not newtype results</li>
  <li>symbolic values that are declared <code>const</code> and have an explicit initialization value that is a compile-time constant</li>
  <li>conditional (if-then-else) expressions</li>
  <li>parenthesized expressions</li>
</ul>

<p>future versions of Dafny.</p>

<h3 id="sec-list-of-specification-expressions">20.47. List of specification expressions</h3>

<p>The following is a list of expressions that can only appear in specification contexts or in ghost blocks.</p>

<ul>
  <li><a href="#sec-fresh-expression">Fresh expressions</a></li>
  <li><a href="#sec-allocated-expression">Allocated expressions</a></li>
  <li><a href="#sec-unchanged-expression">Unchanged expressions</a></li>
  <li><a href="#sec-old-expression">Old expressions</a></li>
  <li><a href="#sec-statement-in-an-expression">Assert and calc expressions</a></li>
  <li><a href="#sec-hash-call">Hash Calls</a></li>
</ul>

<!--PDF NEWPAGE-->
<h2 id="sec-module-refinement">21. Refinement</h2>

<p>Refinement is the process of replacing something somewhat abstract with something somewhat more concrete.
For example, in one module one might declare a type name, with no definition,
such as <code>type T</code>, and then in a refining module, provide a definition.
One could prove general properties about the contents of an (abstract) module,
and use that abstract module, and then later provide a more concrete implementation without having to redo all of the proofs.</p>

<p>Dafny supports <em>module refinement</em>, where one module is created from another,
and in that process the new module may be made more concrete than the previous.
More precisely, refinement takes the following form in Dafny. One module
declares some program entities. A second module <em>refines</em> the first by
declaring how to augment or replace (some of) those program entities.
The first module is called the <em>refinement parent</em>; the second is the
<em>refining</em> module; the result of combining the two (the original declarations
and the augmentation directives) is the <em>assembled</em> module or <em>refinement result</em>.</p>

<p>Syntactically, the refinement parent is a normal module declaration.
The refining module declares which module is its refinement parent with the
<code>refines</code> clause:</p>
<pre><code>module P { // refinement parent
}
module M refines P { // refining module
}
</code></pre>

<p>The refinement result is created as follows.</p>

<p>0) The refinement result is a module within the same enclosing module as the
refining module, has the same name, and in fact replaces the refining module  in their shared scope.</p>

<p>1) All the declarations (including import and export declarations) of the parent are copied into the refinement result.
These declarations are <em>not</em> re-resolved. That is, the assignment of
declarations and types to syntactic names is not changed. The refinement
result may exist in a different enclosing module and with a different set of
imports than the refinement parent, so that if names were reresolved, the
result might be different (and possibly not semantically valid).
This is why Dafny does not re-resolve the names in their new context.</p>

<p>2) All the declarations of the refining module that have different names
than the declarations in the refinement parent are also copied into the
refinement result.
However, because the refining module is just a set of augmentation
directives and may refer to names copied from the refinement parent,
resolution of names and types of the declarations copied in this step is
performed in the context of the full refinement result.</p>

<p>3) Where declarations in the parent and refinement module have the same name,
the second refines the first and the combination, a refined declaration, is
the result placed in the refinement result module, to the exclusion of the
declarations with the same name from the parent and refinement modules.</p>

<p>The way the refinement result declarations are assembled depends on the kind of declaration;
the rules are described in subsections below.</p>

<p>So that it is clear that refinement is taking place, refining declarations
have some syntactic indicator that they are refining some parent declaration.
Typically this is the presence of a <code>...</code> token.</p>

<h3 id="211-export-set-declarations">21.1. Export set declarations</h3>

<p>A refining export set declaration begins with the syntax</p>
<pre><code class="language-grammar">"export" Ident ellipsis
</code></pre>
<p>but otherwise contains the same <code>provides</code>, <code>reveals</code> and <code>extends</code> sections,
with the ellipsis indicating that it is a refining declaration.</p>

<p>The result declaration has the same name as the two input declarations and the unions of names from each of the <code>provides</code>, <code>reveals</code>, and <code>extends</code>
sections, respectively.</p>

<p>An unnamed export set declaration from the parent is copied into the result
module with the name of the parent module. The result module has a default
export set according to the general rules for export sets, after all of
the result modules export set declarations have been assembled.</p>

<h3 id="212-import-declarations">21.2. Import declarations</h3>

<p>Aliasing import declarations are not refined. The result module contains the union
of the import declarations from the two input modules.
There must be no names in common among them.</p>

<p>Abstract import declarations (declared with <code>:</code> instead of <code>=</code>, <a href="#sec-module-abstraction">Section 4.6</a>) are refined. The refinement parent contains the
abstract import and the refining module contains a regular aliasing
import for the same name. Dafny checks that the refining import <em>adheres</em> to
the abstract import.</p>

<h3 id="213-sub-module-declarations">21.3. Sub-module declarations</h3>

<p>TODO</p>

<h3 id="214-const-declarations">21.4. Const declarations</h3>

<p>Const declarations can be refined as in the following example.</p>

<pre><code>module A {
  const ToDefine: int
  const ToDefineWithoutType: int
  const ToGhost: int := 1
}

module B refines A {
  const ToDefine: int := 2
  const ToDefineWithoutType ... := 3
  ghost const ToGhost: int
  const NewConst: int
}
</code></pre>

<p>Formally, a child <code>const</code> declaration may refine a <code>const</code> declaration
from a parent module if</p>

<ul>
  <li>the parent has no initialization,</li>
  <li>the child has the same type as the parent, and</li>
  <li>one or both of the following holds:
    <ul>
      <li>the child has an initializing expression</li>
      <li>the child is declared <code>ghost</code> and the parent is not <code>ghost</code>.</li>
    </ul>
  </li>
</ul>

<p>A refining module can also introduce new <code>const</code> declarations that do
not exist in the refinement parent.</p>

<h3 id="215-method-declarations">21.5. Method declarations</h3>

<p>Method declarations can be refined as in the following example.</p>

<pre><code>module A {
  method ToImplement(x: int) returns (r: int)
    ensures r &gt; x

  method ToStrengthen(x: int) returns (r: int)

  method ToDeterminize(x: int) returns (r: int)
    ensures r &gt;= x
  {
    var y :| y &gt;= x;
    return y;
  }

  method ToSuperimpose(x: int) returns (r: int)
  {
    var y: int := x;
    if y &lt; 0 {
      return -y;
    } else {
      return y;
    }
  }

}

module B refines A {
  method ToImplement(x: int) returns (r: int)
  {
    return x + 2;
  }

  method ToStrengthen...
    ensures r == x*2
  {
    return x*2;
  }

  method ToDeterminize(x: int) returns (r: int)
  {
    return x;
  }

  method ToSuperimpose(x: int) returns (r: int)
  {
    ...;
    if y &lt; 0 {
      print "inverting";
    } else {
      print "not modifying";
    }
  }
}
</code></pre>

<p>Formally, a child <code>method</code> definition may refine a parent <code>method</code>
declaration or definition to perform one or more of the following
operations:</p>

<ul>
  <li>provide a body missing in the parent (as in <code>ToDefine</code>),</li>
  <li>strengthen the postcondition of the parent method by adding one or more
<code>ensures</code> clauses (as in <code>ToStrengthen</code>),</li>
  <li>provide a more deterministic version of a non-deterministic parent
body (as in <code>ToDeterminize</code>), or</li>
  <li>superimpose the body of the parent method with additional statements
(as in <code>ToSuperimpose</code>).</li>
</ul>

<p>The type signature of a child method must be the same as that of the
parent method it refines. This can be ensured by providing an explicit
type signature equivalent to that of the parent (with renaming of
parameters allowed) or by using an ellipsis (<code>...</code>) to indicate copying
of the parent type signature. The body of a child method must satisfy
any ensures clauses from its parent in addition to any it adds.</p>

<p>To introduce additional statements, the child method can include
ellipses within the body to stand in for portions of code from the
parent body. Dafny then attempts to merge the body of the child with the
body of the parent by filling in the ellipses. In the <code>ToSuperimpose</code>
example, the explicit <code>...</code> at the beginning will expand to the variable
declaration for <code>y</code>. In addition, there is an implicit <code>...</code> before
every <code>}</code>, allowing new statements to be introduced at the beginning of
each block. In <code>ToSuperimpose</code>, these implicit ellipses expand to the
return statements in the parent method.</p>

<p>To help with understanding of the merging process, the IDE provides
hover text that shows what each <code>...</code> or <code>}</code> expands to.</p>

<p>The refinement result for <code>ToSuperimpose</code> will be as follows.</p>

<pre><code>method ToSuperimpose(x: int) returns (r: int)
{
  var y: int := x;
  if y &lt; 0 {
    print "inverting";
    return -y;
  } else {
    print "not modifying";
    return y;
  }
}
</code></pre>

<p>In general, a child method can add local variables and assignments,
add some forms of <code>assert</code>, convert an <code>assume </code> to an <code>assert</code> (using
<code>assert ...;</code>), replace a non-deterministic operation with a more
deterministic one, and insert additional <code>return</code> statements. A child
method cannot otherwise change the control-flow structure of a method.
Full details of the algorithm used to perform the merge operation are
available in <a href="https://dl.acm.org/doi/10.1007/s00165-012-0254-3">this
paper</a>. See also <a href="https://github.com/dafny-lang/dafny/blob/76c8d599155f45e9745ce854ab54d0ab4be52049/Source/Dafny/RefinementTransformer.cs#L55">this
comment</a>
in the source code.</p>

<p>A refined method is allowed only if it does not invalidate any parent
lemmas that mention it.</p>

<p>A refining module can also introduce new <code>method</code> declarations or
definitions that do not exist in the refinement parent.</p>

<h3 id="216-lemma-declarations">21.6. Lemma declarations</h3>

<p>As lemmas are (ghost) methods, the description of method refinement from
the previous section also applies to lemma refinement.</p>

<p>A valid refinement is one that does not invalidate any proofs. A lemma
from a refinement parent must still be valid for the refinement result
of any method or lemma it mentions.</p>

<h3 id="217-function-and-predicate-declarations">21.7. Function and predicate declarations</h3>

<p>Function (and equivalently predicate) declarations can be refined as in
the following example.</p>

<pre><code>module A {
  function F(x: int): (r: int)
    ensures r &gt; x

  function G(x: int): (r: int)
    ensures r &gt; x
  { x + 1 }
}

module B refines A {
  function F...
  { x + 1 }

  function G...
    ensures r == x + 1
}
</code></pre>

<p>Formally, a child <code>function</code> (or <code>predicate</code>) definition can refine a
parent <code>function</code> (or <code>predicate</code>) declaration or definition to</p>

<ul>
  <li>provide a body missing in the parent,</li>
  <li>strengthen the postcondition of the parent function by adding one or more
<code>ensures</code> clauses.</li>
</ul>

<p>The relation between the type signature of the parent and child function
is the same as for methods and lemmas, as described in the previous section.</p>

<p>A refining module can also introduce new <code>function</code> declarations or
definitions that do not exist in the refinement parent.</p>

<h3 id="218-iterator-declarations">21.8. Iterator declarations</h3>

<p>TODO</p>

<h3 id="219-class-and-trait-declarations">21.9. Class and trait declarations</h3>

<p>TODO</p>

<h3 id="2110-type-declarations">21.10. Type declarations</h3>
<p> opaque, type synonym, subset, newtype, datatype</p>

<p>TODO</p>

<!--PDF NEWPAGE-->
<h2 id="sec-attributes">22. Attributes</h2>
<p>Dafny allows many of its entities to be annotated with <em>Attributes</em>.
Attributes are declared between <code>{:</code> and <code>}</code> like this:</p>
<pre><code class="language-dafny">{:attributeName "argument", "second" + "argument", 57}
</code></pre>

<p>In general an attribute may have any name the user chooses. It may be
followed by a comma-separated list of expressions. These expressions will
be resolved and type-checked in the context where the attribute appears.</p>

<p>Any Dafny entity may have a list of attributes.
Dafny does not check that the attributes listed for an entity
are appropriate for it (which means that misspellings may
go silently unnoticed).</p>

<p>The grammar shows where the attribute annotations may appear:</p>
<pre><code class="language-grammar">Attribute = "{:" AttributeName [ Expressions ] "}"
</code></pre>

<p>Dafny has special processing for some attributes<sup id="fnref:boogie-attributes" role="doc-noteref"><a href="#fn:boogie-attributes" class="footnote" rel="footnote">12</a></sup>.  Of those,
some apply only to the entity bearing the attribute, while others (inherited
attributes) apply to the entity and its descendants (such as nested modules,
types, or declarations).  The attribute declaration closest to the entity
overrides those further away.</p>

<p>For attributes with a single boolean expression argument, the attribute
with no argument is interpreted as if it were true.</p>

<h3 id="221-attributes-on-top-level-declarations">22.1. Attributes on top-level declarations</h3>

<h4 id="2211-autocontracts">22.1.1. <code>{:autocontracts}</code></h4>
<p>Dynamic frames [@Kassios:FM2006;@SmansEtAl:VeriCool;@SmansEtAl:ImplicitDynamicFrames;
@LEINO:Dafny:DynamicFrames]
are frame expressions that can vary dynamically during
program execution. AutoContracts is an experimental feature that will
fill much of the dynamic-frames boilerplate into a class.</p>

<p>From the users perspective, what needs to be done is simply:</p>

<ul>
  <li>mark the class with {:autocontracts}</li>
  <li>declare a function (or predicate) called Valid()</li>
</ul>

<p>AutoContracts will then:</p>

<ul>
  <li>Declare:
    <pre><code class="language-dafny">ghost var Repr: set&lt;object&gt;
</code></pre>
  </li>
  <li>For function/predicate Valid(), insert:
    <pre><code class="language-dafny"> reads this, Repr
</code></pre>
  </li>
  <li>Into body of Valid(), insert (at the beginning of the body):
    <pre><code class="language-dafny"> this in Repr &amp;&amp; null !in Repr
</code></pre>
  </li>
  <li>and also insert, for every array-valued field A declared in the class:
    <pre><code class="language-dafny"> (A != null ==&gt; A in Repr) &amp;&amp;
</code></pre>
  </li>
  <li>and for every field F of a class type T where T has a field called Repr, also insert:
    <pre><code class="language-dafny"> (F != null ==&gt; F in Repr &amp;&amp; F.Repr &lt;= Repr &amp;&amp; this !in Repr)
</code></pre>
    <p>Except, if A or F is declared with <code>{:autocontracts false}</code>, then the implication will not
be added.</p>
  </li>
  <li>For every constructor, add:
    <pre><code class="language-dafny"> modifies this
 ensures Valid() &amp;&amp; fresh(Repr - {this})
</code></pre>
  </li>
  <li>At the end of the body of the constructor, add:
    <pre><code class="language-dafny"> Repr := {this};
 if (A != null) { Repr := Repr + {A}; }
 if (F != null) { Repr := Repr + {F} + F.Repr; }
</code></pre>
  </li>
  <li>For every method, add:
    <pre><code class="language-dafny"> requires Valid()
 modifies Repr
 ensures Valid() &amp;&amp; fresh(Repr - old(Repr))
</code></pre>
  </li>
  <li>At the end of the body of the method, add:
    <pre><code class="language-dafny"> if (A != null) { Repr := Repr + {A}; }
 if (F != null) { Repr := Repr + {F} + F.Repr; }
</code></pre>
  </li>
</ul>

<h4 id="sec-nativetype">22.1.2. <code>{:nativeType}</code></h4>
<p>The <code>{:nativeType}</code> attribute may only be used on a <code>NewtypeDecl</code>
where the base type is an integral type or a real type. For example:</p>

<pre><code class="language-dafny">newtype {:nativeType "byte"} ubyte = x : int | 0 &lt;= x &lt; 256
newtype {:nativeType "byte"} ubyte = x : int | 0 &lt;= x &lt; 257 // Fails
</code></pre>

<p>It can take one of the following forms:</p>

<ul>
  <li><code>{:nativeType}</code> - With no parameters it has no effect and the <code>NewtypeDecl</code>
will have its default behavior which is to choose a native type that can hold any
value satisfying the constraints, if possible, otherwise BigInteger is used.</li>
  <li><code>{:nativeType true}</code> - Also gives default <code>NewtypeDecl</code> behavior,
but gives an error if base type is not integral.</li>
  <li><code>{:nativeType false}</code> - Inhibits using a native type. BigInteger is used.</li>
  <li><code>{:nativeType "typename"}</code> - This form has an native integral
type name as a string literal. Acceptable values are:
    <ul>
      <li><code>"byte"</code>      8 bits, unsigned</li>
      <li><code>"sbyte"</code>     8 bits, signed</li>
      <li><code>"ushort"</code>    16 bits, unsigned</li>
      <li><code>"short"</code>     16 bits, signed</li>
      <li><code>"uint"</code>      32 bits, unsigned</li>
      <li><code>"int"</code>       32 bits, signed</li>
      <li><code>"number"</code>    53 bits, signed</li>
      <li><code>"ulong"</code>     64 bits, unsigned</li>
      <li><code>"long"</code>      64 bits, signed
If the target compiler
does not support X, then an error is generated. Also, if, after
scrutinizing the constraint predicate, the compiler cannot confirm
that the types values will fit in X, an error is generated.</li>
    </ul>
  </li>
</ul>

<h4 id="2213-ignore-deprecated">22.1.3. <code>{:ignore}</code> (deprecated)</h4>
<p>Ignore the declaration (after checking for duplicate names).</p>

<h4 id="sec-extern">22.1.4. <code>{:extern}</code></h4>

<p><code>{:extern}</code> is a target-language dependent modifier used:</p>

<ul>
  <li>to alter the <code>CompileName</code> of entities such as modules, classes, methods, etc.,</li>
  <li>to alter the <code>ReferenceName</code> of the entities,</li>
  <li>to decide how to define external opaque types,</li>
  <li>to decide whether to emit target code or not, and</li>
  <li>to decide whether a declaration is allowed not to have a body.</li>
</ul>

<p>The <code>CompileName</code> is the name for the entity when translating to one of the target languages.
The <code>ReferenceName</code> is the name used to refer to the entity in the target language.
A common use case of <code>{:extern}</code> is to avoid name clashes with existing library functions.</p>

<p><code>{:extern}</code> takes 0, 1, or 2 (possibly empty) string arguments:</p>

<ul>
  <li><code>{:extern}</code>: Dafny will use the Dafny name as the <code>CompileName</code> and not affect the <code>ReferenceName</code></li>
  <li><code>{:extern s1}</code>: Dafny will use <code>s1</code> as the <code>CompileName</code>, and replaces the last portion of the <code>ReferenceName</code> by <code>s1</code>.
   When used on an opaque type, s1 is used as a hint as to how to declare that type when compiling.</li>
  <li><code>{:extern s1, s2}</code> Dafny will use <code>s2</code> as the <code>CompileName</code>.
   Dafny will use a combination of <code>s1</code> and <code>s2</code> such as for example <code>s1.s2</code> as the <code>ReferenceName</code>
   It may also be the case that one of the arguments is simply ignored.</li>
</ul>

<p>Dafny does not perform sanity checks on the argumentsit is the users responsibility not to generate
  malformed target code.</p>

<p>One difference with <a href="#sec-axiom"><code>{:axiom}</code></a> is that the compiler will still emit code for an <a href="#sec-axiom"><code>{:axiom}</code></a>, if it is a <a href="#sec-function-declarations"><code>function method</code>, a <code>method</code> or a <code>function by method</code></a> with a body.</p>

<h3 id="222-attributes-on-functions-and-methods">22.2. Attributes on functions and methods</h3>

<h4 id="2221-autoreq">22.2.1. <code>{:autoReq}</code></h4>
<p>For a function declaration, if this attribute is set true at the nearest
level, then its <code>requires</code> clause is strengthened sufficiently so that
it may call the functions that it calls.</p>

<p>For following example</p>
<pre><code class="language-dafny">function f(x:int) : bool
  requires x &gt; 3
{
  x &gt; 7
}

// Should succeed thanks to auto_reqs
function {:autoReq} g(y:int, b:bool) : bool
{
  if b then f(y + 2) else f(2*y)
}
</code></pre>
<p>the <code>{:autoReq}</code> attribute causes Dafny to
deduce a <code>requires</code> clause for g as if it had been
declared</p>
<pre><code class="language-dafny">function g(y:int, b:bool) : bool
  requires if b then y + 2 &gt; 3 else 2 * y &gt; 3
{
  if b then f(y + 2) else f(2*y)
}
</code></pre>

<h4 id="sec-axiom">22.2.2. <code>{:axiom}</code></h4>
<p>The <code>{:axiom}</code> attribute may be placed on a function or method.
It means that the post-condition may be assumed to be true
without proof. In that case also the body of the function or
method may be omitted.</p>

<p>The <code>{:axiom}</code> attribute only prevents Dafny from verifying that the body matches the post-condition.
Dafny still verifies the well-formedness of pre-conditions, of post-conditions, and of the body if provided.
To prevent Dafny from running all these checks, one would use <a href="#sec-verify"><code>{:verify false}</code></a>, which is not recommended.</p>

<h4 id="2223-compile">22.2.3. <code>{:compile}</code></h4>
<p>The <code>{:compile}</code> attribute takes a boolean argument. It may be applied to
any top-level declaration. If that argument is false, then that declaration
will not be compiled at all.
The difference with <a href="#sec-extern"><code>{:extern}</code></a> is that <a href="#sec-extern"><code>{:extern}</code></a>
will still emit declaration code if necessary,
whereas <code>{:compile false}</code> will just ignore the declaration for compilation purposes.</p>

<h4 id="sec-extern-method">22.2.4. <code>{:extern &lt;name&gt;}</code></h4>
<p>See <a href="#sec-extern"><code>{:extern &lt;name&gt;}</code></a>.</p>

<h4 id="sec-fuel">22.2.5. <code>{:fuel X}</code></h4>
<p>The fuel attributes is used to specify how much fuel a function should have,
i.e., how many times the verifier is permitted to unfold its definition.  The
<code>{:fuel}</code> annotation can be added to the function itself, it which
case it will apply to all uses of that function, or it can overridden
within the scope of a module, function, method, iterator, calc, forall,
while, assert, or assume.  The general format is:</p>

<pre><code class="language-dafny">{:fuel functionName,lowFuel,highFuel}
</code></pre>

<p>When applied as an annotation to the function itself, omit
functionName.  If highFuel is omitted, it defaults to lowFuel + 1.</p>

<p>The default fuel setting for recursive functions is 1,2.  Setting the
fuel higher, say, to 3,4, will give more unfoldings, which may make
some proofs go through with less programmer assistance (e.g., with
fewer assert statements), but it may also increase verification time,
so use it with care.  Setting the fuel to 0,0 is similar to making the
definition opaque, except when used with all literal arguments.</p>

<h4 id="2226-id-string">22.2.6. <code>{:id &lt;string&gt;}</code></h4>
<p>Assign a custom unique ID to a function or a method to be used for verification
result caching.</p>

<h4 id="sec-induction">22.2.7. <code>{:induction}</code></h4>
<p>The <code>{:induction}</code> attribute controls the application of
proof by induction to two contexts. Given a list of
variables on which induction might be applied, the
<code>{:induction}</code> attribute selects a sub-list of those
variables (in the same order) to which to apply induction.</p>

<p>Dafny issue <a href="https://github.com/Microsoft/dafny/issues/34">34</a>
proposes to remove the restriction that the sub-list
be in the same order, and would apply induction in the
order given in the <code>{:induction}</code> attribute.</p>

<p>The two contexts are:</p>

<ul>
  <li>A method, in which case the bound variables are all the
in-parameters of the method.</li>
  <li>A <a href="#sec-induction-quantifier">quantifier expression</a>, in which case the bound variables
are the bound variables of the quantifier expression.</li>
</ul>

<p>The form of the <code>{:induction}</code> attribute is one of the following:</p>

<ul>
  <li><code>{:induction}</code>  apply induction to all bound variables</li>
  <li><code>{:induction false}</code>  suppress induction, that is, dont apply it to any bound variable</li>
  <li><code>{:induction L}</code> where <code>L</code> is a list consisting entirely of bound variables
 apply induction to the specified bound variables</li>
  <li><code>{:induction X}</code> where <code>X</code> is anything else  treat the same as
<code>{:induction}</code>, that is, apply induction to all bound variables. For this
usage conventionally <code>X</code> is <code>true</code>.</li>
</ul>

<p>Here is an example of using it on a quantifier expression:</p>
<pre><code class="language-dafny">lemma Fill_J(s: seq&lt;int&gt;)
  requires forall i :: 1 &lt;= i &lt; |s| ==&gt; s[i-1] &lt;= s[i]
  ensures forall i,j {:induction j} :: 0 &lt;= i &lt; j &lt; |s| ==&gt; s[i] &lt;= s[j]
{
}
</code></pre>

<h4 id="sec-print">22.2.8. <code>{:print}</code></h4>
<p>This attributes declares that a method may have print effects,
that is, it may use print statements and may call other methods
that have print effects. The attribute can be applied to compiled
methods, constructors, and iterators, and it gives an error if
applied to functions or ghost methods. An overriding method is
allowed to use a {:print} attribute only if the overridden method
does.
Print effects are enforced only with <code>/trackPrintEffects:1</code>.</p>

<h4 id="sec-opaque">22.2.9. <code>{:opaque}</code></h4>
<p>Ordinarily, the body of a function is transparent to its users, but
sometimes it is useful to hide it. If a function <code>foo</code> or <code>bar</code> is given the
<code>{:opaque}</code> attribute, then Dafny hides the body of the function,
so that it can only be seen within its recursive clique (if any),
or if the programmer specifically asks to see it via the statement <code>reveal foo(), bar();</code>.</p>

<p>More information about the Boogie implementation of <code>{:opaque}</code> <a href="https://github.com/dafny-lang/dafny/blob/master/docs/Compilation/Boogie.md">here</a>.</p>

<!--
Describe this where refinement is described, as appropriate.

-### 22.1.15. prependAssertToken
This is used internally in Dafny as part of module refinement.
It is an attribute on an assert statement.
The Dafny code has the following comment:

```dafny
// Clone the expression, but among the new assert's attributes, indicate
// that this assertion is supposed to be translated into a check.  That is,
// it is not allowed to be just assumed in the translation, despite the fact
// that the condition is inherited.
```

TODO: Decide if we want to describe this in more detail, or whether
the functionality is already adequately described where
refinement is described.
-->

<h4 id="22210-priority-n">22.2.10. <code>{:priority N}</code></h4>
<p>Assign a positive priority N to an implementation to control the order
in which implementations are verified (default: N = 1).</p>

<h4 id="22211-selective_checking">22.2.11. <code>{:selective_checking}</code></h4>
<p>Turn all assertions into assumptions except for the ones reachable from after the
assertions marked with the attribute <code>{:start_checking_here}</code>.
Thus, <code>assume {:start_checking_here} something;</code> becomes an inverse
of <code>assume false;</code>: the first one disables all verification before
it, and the second one disables all verification after.</p>

<h4 id="22212-tailrecursion">22.2.12. <code>{:tailrecursion}</code></h4>
<p>This attribute is used on method declarations. It has a boolean argument.</p>

<p>If specified with a <code>false</code> value, it means the user specifically
requested no tail recursion, so none is done.</p>

<p>If specified with a <code>true</code> value, or if no argument is specified,
then tail recursive optimization will be attempted subject to
the following conditions:</p>

<ul>
  <li>It is an error if the method is a ghost method and tail
recursion was explicitly requested.</li>
  <li>Only direct recursion is supported, not mutually recursive methods.</li>
  <li>If <code>{:tailrecursion true}</code> was specified but the code does not allow it,
an error message is given.</li>
</ul>

<h4 id="22213-test">22.2.13. <code>{:test}</code></h4>
<p>This attribute indicates the target function or method is meant
to be executed at runtime in order to test that the program is working as intended.</p>

<p>There are two different ways to dynamically test functionality in a test:</p>

<ol>
  <li>A test can optionally return a single value to indicate success or failure.
If it does, this must be a <em>failure-compatible</em> type
just as the <a href="#sec-update-failure">update-with-failure statement</a> requires. That is,
the returned type must define a <code>IsFailure()</code> function method. If <code>IsFailure()</code>
evaluates to <code>true</code> on the return value, the test will be marked a failure, and this
return value used as the failure message.</li>
  <li>Code in the control flow of the test can use <a href="#sec-expect-statement"><code>expect</code> statements</a>
to dynamically test if a boolean expression is true, and cause the test to halt
if not (but not the overall testing process). The optional second argument to 
a failed <code>expect</code> statement will be used as the test failure message.</li>
</ol>

<p>Note that the <code>expect</code> keyword can also be used to form assign or halt statements
such as <code>var x :- expect CalculateX();</code>, which is a convenient way to invoke a method
that may produce a failure within a test without having to return a value from the test.</p>

<p>There are also two different approaches to executing all tests in a program:</p>

<ol>
  <li>By default, the compiler will mark each compiled method as necessary so that
a designated target language testing framework will discover and run it.
This is currently only implemented for C#, using the xUnit <code>[Fact]</code> annotation.</li>
  <li>If the <code>/runAllTests:1</code> option is provided, Dafny will instead produce a main method
that invokes each test and prints the results.
This runner is currently very basic, but avoids introducing any additional target
language dependencies in the compiled code.</li>
</ol>

<h4 id="22214-timelimit-n">22.2.14. <code>{:timeLimit N}</code></h4>
<p>Set the time limit for verifying a given function or method.</p>

<h4 id="22215-timelimitmultiplier-x">22.2.15. <code>{:timeLimitMultiplier X}</code></h4>
<p>This attribute may be placed on a method or function declaration
and has an integer argument. If <code>{:timeLimitMultiplier X}</code> was
specified a <code>{:timelimit Y}</code> attributed is passed on to Boogie
where <code>Y</code> is <code>X</code> times either the default verification time limit
for a function or method, or times the value specified by the
Boogie <code>timelimit</code> command-line option.</p>

<h4 id="sec-verify">22.2.16. <code>{:verify false}</code></h4>

<p>Skip verification of a function or a method altogether.
Will not even try to verify well-formedness of postconditions and preconditions.
We discourage to use this attribute. Prefer <a href="#sec-axiom"><code>{:axiom}</code></a>,
which performs these minimal checks while not checking that the body satisfies postconditions.</p>

<h4 id="sec-vcs_max_cost">22.2.17. <code>{:vcs_max_cost N}</code></h4>
<p>Per-method version of the command-line option <code>/vcsMaxCost</code>.</p>

<p>The <a href="#sec-assertion-batches">assertion batch</a> of a method
will not be split unless the cost of an <a href="#sec-assertion-batches">assertion batch</a> exceeds this
number, defaults to 2000.0. In
<a href="#sec-vcs_max_keep_going_splits">keep-going mode</a>, only applies to the first round.
If <a href="#sec-vcs_split_on_every_assert"><code>{:vcs_split_on_every_assert}</code></a> is set, then this parameter is useless.</p>

<h4 id="sec-vcs_max_keep_going_splits">22.2.18. <code>{:vcs_max_keep_going_splits N}</code></h4>

<p>Per-method version of the command-line option <code>/vcsMaxKeepGoingSplits</code>.
If set to more than 1, activates the <em>keep going mode</em> where, after the first round of splitting,
<a href="#sec-assertion-batches">assertion batches</a> that timed out are split into <n> [assertion batches](#sec-assertion-batches) and retried
until we succeed proving them, or there is only one
single assertion that it timeouts (in which
case error is reported for that assertion).
Defaults to 1.
If [`{:vcs_split_on_every_assert}`](#sec-vcs_split_on_every_assert) is set, then this parameter is useless.</n></p>

<h4 id="sec-vcs_max_splits">22.2.19. <code>{:vcs_max_splits N}</code></h4>

<p>Per-method version of the command-line option <code>/vcsMaxSplits</code>.
Maximal number of <a href="#sec-assertion-batches">assertion batches</a> generated for this method.
In <a href="#sec-vcs_max_keep_going_splits">keep-going mode</a>, only applies to the first round.
Defaults to 1.
If <a href="#sec-vcs_split_on_every_assert"><code>{:vcs_split_on_every_assert}</code></a> is set, then this parameter is useless.</p>

<h4 id="sec-vcs_split_on_every_assert">22.2.20. <code>{:vcs_split_on_every_assert}</code></h4>
<p>Per-method version of the command-line option <code>/vcsSplitOnEveryAssert</code>.</p>

<p>In the first and only verification round, this option will split the original <a href="#sec-assertion-batches">assertion batch</a>
into one assertion batch per assertion.
This is mostly helpful for debugging which assertion is taking the most time to prove, e.g. to profile them.</p>

<h4 id="sec-synthesize-attr">22.2.21. <code>{:synthesize}</code></h4>

<p>The <code>{:synthesize}</code> attribute must be used on methods that have no body and
return one or more fresh objects. During compilation, 
the postconditions associated with such a
method are translated to a series of API calls to the target languagess
mocking framework. The object returned, therefore, behaves exactly as the
postconditions specify. If there is a possibility that this behavior violates
the specifications on the objects instance methods or hardcodes the values of
its fields, the compiler will throw an error but the compilation will go
through. Currently, this compilation pass is only supported in C# and requires
adding the latest version of the Moq library to the .csproj file before
generating the binary.</p>

<p>Not all Dafny postconditions can be successfully compiled - below is the
grammar for postconditions that are supported (<code>S</code> is the start symbol, <code>EXPR</code>
stands for an arbitrary Dafny expression, and <code>ID</code> stands for
variable/method/type identifiers):</p>

<pre><code>S         = FORALL
          | EQUALS
          | S &amp;&amp; S
EQUALS    = ID.ID (ARGLIST) == EXPR // stubs a function call
          | ID.ID           == EXPR // stubs field access
          | EQUALS &amp;&amp; EQUALS
FORALL    = forall BOUNDVARS :: EXPR ==&gt; EQUALS
ARGLIST   = ID   // this can be one of the bound variables
          | EXPR // this expr may not reference any of the bound variables
          | ARGLIST, ARGLIST
BOUNDVARS = ID : ID
          | BOUNDVARS, BOUNDVARS
</code></pre>

<h4 id="sec-attr-options">22.2.22. <code>{:options OPT0, OPT1, ... }</code></h4>

<p>This attribute applies only to modules. It attribute configures Dafny as if
<code>OPT0</code>, <code>OPT1</code>,  had been passed on the command line.  Outside of the module,
options revert to their previous values.</p>

<p>Only a small subset of Dafnys command line options is supported.  Use the
<code>/attrHelp</code> flag to see which ones.</p>

<h3 id="sec-verification-attributes-on-assert-statements">22.3. Attributes on assertions, preconditions and postconditions</h3>

<h4 id="sec-focus">22.3.1. <code>{:focus}</code></h4>
<p><code>assert {:focus} X;</code> splits verification into two <a href="#sec-assertion-batches">assertion batches</a>.
The first batch considers all assertions that are not on the block containing the <code>assert {:focus} X;</code>
The second batch considers all assertions that are on the block containing the <code>assert {:focus} X;</code> and those that will <em>always</em> follow afterwards.
Hence, it might also occasionally double-report errors.
If you truly want a split on the batches, prefer <a href="#sec-split_here"><code>{:split_here}</code></a>.</p>

<p>Here are two examples illustrating how <code>{:focus}</code> works, where <code>--</code> in the comments stands for <code>Assumption</code>:</p>
<pre><code class="language-dafny">method doFocus1(x: bool) returns (y: int) {
  y := 1;                     // Batch 1    Batch 2
  assert y == 1;              // Assertion  --
  if x {
    if false {
      assert y &gt;= 0;          // --         Assertion
      assert {:focus} y &lt;= 2; // --         Assertion
      y := 2;
      assert y == 2;          // --         Assertion
    }
  } else {
    assert y == 1;            // Assertion  --
  }
  assert y == 1;              // Assertion  Assertion
  if !x {
    assert y &gt;= 1;            // Assertion  Assertion
  } else {
    assert y &lt;= 1;            // Assertion  Assertion
  }
}
</code></pre>

<p>And another one where the focused block is guarded with a <code>while</code>, resulting in remaining assertions not being part of the first assertion batch:</p>
<pre><code class="language-dafny">method doFocus2(x: bool) returns (y: int) {
  y := 1;                     // Batch 1    Batch 2
  assert y == 1;              // Assertion  --
  if x {
    while false {
      assert y &gt;= 0;          // --         Assertion
      assert {:focus} y &lt;= 2; // --         Assertion
      y := 2;
      assert y == 2;          // --         Assertion
    }
  } else {
    assert y == 1;            // Assertion  --
  }
  assert y == 1;              // Assertion  --
  if !x {
    assert y &gt;= 1;            // Assertion  --
  } else {
    assert y &lt;= 1;            // Assertion  --
  }
}
</code></pre>

<h4 id="sec-split_here">22.3.2. <code>{:split_here}</code></h4>
<p><code>assert {:split_here} X;</code> splits verification into two <a href="#sec-assertion-batches">assertion batches</a>.
It verifies the code leading to this point (excluded) in a first assertion batch,
and the code leading from this point (included) to the next <code>{:split_here}</code> or until the end in a second assertion batch.
It might help with timeouts.</p>

<p>Here is one example, where <code>--</code> in the comments stands for <code>Assumption</code>:</p>
<pre><code class="language-dafny">method doSplitHere(x: bool) returns (y: int) {
  y := 1;                      // Batch 1    Batch 2     Batch 3
  assert y &gt;= 0;               // Assertion  --          --
  if x {
    assert y &lt;= 1;             // Assertion  --          --
    assert {:split_here} true; // --         Assertion   --
    assert y &lt;= 2;             // --         Assertion   --
    assert {:split_here} true; // --         --          Assertion
    if x {
      assert y == 1;           // --         --          Assertion
    } else {
      assert y &gt;= 1;           // --         --          Assertion
    }
  } else {
    assert y &lt;= 3;             // Assertion  --          --
  }
  assert y &gt;= -1;              // Assertion  --          --
}
</code></pre>

<h4 id="2233-subsumption-n">22.3.3. <code>{:subsumption n}</code></h4>
<p>Overrides the <code>/subsumption</code> command-line setting for this assertion.</p>

<h3 id="224-attributes-on-variable-declarations">22.4. Attributes on variable declarations</h3>

<h4 id="2241-assumption">22.4.1. <code>{:assumption}</code></h4>
<p>This attribute can only be placed on a local ghost bool
variable of a method. Its declaration cannot have a rhs, but it is
allowed to participate as the lhs of exactly one assignment of the
form: <code>b := b &amp;&amp; expr;</code>. Such a variable declaration translates in the
Boogie output to a declaration followed by an <code>assume b</code> command.
See [@LeinoWuestholz2015], Section 3, for example uses of the <code>{:assumption}</code>
attribute in Boogie.</p>

<h3 id="225-attributes-on-quantifier-expressions-forall-exists">22.5. Attributes on quantifier expressions (forall, exists)</h3>

<h4 id="2251-heapquantifier">22.5.1. <code>{:heapQuantifier}</code></h4>
<p>The <code>{:heapQuantifier}</code> attribute may be used on a <a href="#sec-quantifier-expression"><code>QuantifierExpression</code></a>.
When it appears in a quantifier expression, it is as if a new heap-valued
quantifier variable was added to the quantification. Consider this code
that is one of the invariants of a while loop.</p>

<pre><code class="language-dafny">invariant forall u {:heapQuantifier} :: f(u) == u + r
</code></pre>

<p>The quantifier is translated into the following Boogie:</p>

<pre><code>(forall q$heap#8: Heap, u#5: int ::
    {:heapQuantifier}
    $IsGoodHeap(q$heap#8) &amp;&amp; ($Heap == q$heap#8 || $HeapSucc($Heap, q$heap#8))
       ==&gt; $Unbox(Apply1(TInt, TInt, f#0, q$heap#8, $Box(u#5))): int == u#5 + r#0);
</code></pre>

<p>What this is saying is that the quantified expression, <code>f(u) == u + r</code>,
which may depend on the heap, is also valid for any good heap that is either the
same as the current heap, or that is derived from it by heap update operations.</p>

<h4 id="sec-induction-quantifier">22.5.2. <code>{:induction}</code></h4>
<p>See <a href="#sec-induction"><code>{:induction}</code></a>.</p>

<h4 id="2253-layerquantifier">22.5.3. <code>{:layerQuantifier}</code></h4>
<p>The word layer actually refers to the <a href="#sec-fuel"><code>{:fuel}</code></a>.
When Dafny is translating a quantified expression, if it has
a <code>{:layerQuantifier}</code> attribute an additional quantifier
variable is added to the quantifier bound variables.
This variable as the predefined <em>LayerType</em>.
A <code>{:layerQuantifier}</code> attribute may be placed on a quantifier expression.
Translation of Dafny into Boogie defines a <em>LayerType</em> which has defined zero and
successor constructors.</p>

<p>The Dafny source has the comment that if a function is recursive,
then make the reveal lemma quantifier a layerQuantifier.
And in that case it adds the attribute to the quantifier.</p>

<p>There is no explicit use of the <code>{:layerQuantifier}</code> attribute
in the Dafny tests. So I believe this attribute is only used
internally by Dafny and not externally.</p>

<p>TODO: Need more complete explanation of this attribute.
Dafny issue <a href="https://github.com/Microsoft/dafny/issues/35">35</a> tracks
further effort for this attribute.</p>

<h4 id="sec-trigger">22.5.4. <code>{:trigger}</code></h4>
<p>Trigger attributes are used on quantifiers and comprehensions.</p>

<p>The verifier instantiates the body of a quantified expression only 
when it can find an expression that matches the provided trigger.</p>

<p>Here is an example:</p>
<pre><code class="language-dafny">predicate P(i: int)
predicate Q(i: int)

lemma PHoldEvenly()
  ensures  forall i {:trigger Q(i)} :: P(i) ==&gt; P(i + 2) &amp;&amp; Q(i)

lemma PHoldsForTwo()
  ensures forall i :: P(i) ==&gt; P(i + 4)
{
  forall j: int
    ensures P(j) ==&gt; P(j + 4)
  {
    if P(j) {
      assert P(j); // Trivial assertion
      
      PHoldEvenly();
      // Invoking the lemma assumes `forall i :: P(i) ==&gt; P(i + 4)`,
      // but it's not instantiated yet
      
      // The verifier sees `Q(j)`, so it instantiates
      // `forall i :: P(i) ==&gt; P(i + 4)` with `j`
      // and we get the axiom `P(j) ==&gt; P(j + 2) &amp;&amp; Q(j)`
      assert Q(j);     // hence it can prove `Q(j)`
      assert P(j + 2); //   and it can prove `P(j + 2)`
      assert P(j + 4); // But it cannot prove this
      // because it did not instantiate `forall i :: P(i) ==&gt; P(i + 4)` with `j+2`
    }
  }
}
</code></pre>

<p>Here are ways one can prove <code>assert P(j + 4);</code>:</p>
<ul>
  <li>Add <code>assert Q(j + 2);</code> just before <code>assert P(j + 4);</code>, so that the verifier sees the trigger.</li>
  <li>Change the trigger <code>{:trigger Q(i)}</code> to <code>{:trigger P(i)}</code> (replace the trigger)</li>
  <li>Change the trigger <code>{:trigger Q(i)}</code> to <code>{:trigger Q(i)} {:trigger P(i)}</code> (add a trigger)</li>
  <li>Remove <code>{:trigger Q(i)}</code> so that it will automatically determine all possible triggers thanks to the option <code>/autoTriggers:1</code> which is the default.</li>
</ul>

<h3 id="226-other-undocumented-verification-attributes">22.6. Other undocumented verification attributes</h3>

<p>A scan of Dafnys sources shows it checks for the
following attributes.</p>

<ul>
  <li><code>{:$}</code></li>
  <li><code>{:$renamed$}</code></li>
  <li><code>{:InlineAssume}</code></li>
  <li><code>{:PossiblyUnreachable}</code></li>
  <li><code>{:__dominator_enabled}</code></li>
  <li><code>{:__enabled}</code></li>
  <li><code>{:a##post##}</code></li>
  <li><code>{:absdomain}</code></li>
  <li><code>{:ah}</code></li>
  <li><code>{:assumption}</code></li>
  <li><code>{:assumption_variable_initialization}</code></li>
  <li><code>{:atomic}</code></li>
  <li><code>{:aux}</code></li>
  <li><code>{:both}</code></li>
  <li><code>{:bvbuiltin}</code></li>
  <li><code>{:candidate}</code></li>
  <li><code>{:captureState}</code></li>
  <li><code>{:checksum}</code></li>
  <li><code>{:constructor}</code></li>
  <li><code>{:datatype}</code></li>
  <li><code>{:do_not_predicate}</code></li>
  <li><code>{:entrypoint}</code></li>
  <li><code>{:existential}</code></li>
  <li><code>{:exitAssert}</code></li>
  <li><code>{:expand}</code></li>
  <li><code>{:extern}</code></li>
  <li><code>{:focus}</code></li>
  <li><code>{:hidden}</code></li>
  <li><code>{:ignore}</code></li>
  <li><code>{:inline}</code></li>
  <li><code>{:left}</code></li>
  <li><code>{:linear}</code></li>
  <li><code>{:linear_in}</code></li>
  <li><code>{:linear_out}</code></li>
  <li><code>{:msg}</code></li>
  <li><code>{:name}</code></li>
  <li><code>{:originated_from_invariant}</code></li>
  <li><code>{:partition}</code></li>
  <li><code>{:positive}</code></li>
  <li><code>{:post}</code></li>
  <li><code>{:pre}</code></li>
  <li><code>{:precondition_previous_snapshot}</code></li>
  <li><code>{:qid}</code></li>
  <li><code>{:right}</code></li>
  <li><code>{:selective_checking}</code></li>
  <li><code>{:si_fcall}</code></li>
  <li><code>{:si_unique_call}</code></li>
  <li><code>{:sourcefile}</code></li>
  <li><code>{:sourceline}</code></li>
  <li><code>{:split_here}</code></li>
  <li><code>{:stage_active}</code></li>
  <li><code>{:stage_complete}</code></li>
  <li><code>{:staged_houdini_tag}</code></li>
  <li><code>{:start_checking_here}</code></li>
  <li><code>{:subsumption}</code></li>
  <li><code>{:template}</code></li>
  <li><code>{:terminates}</code></li>
  <li><code>{:upper}</code></li>
  <li><code>{:verified_under}</code></li>
  <li><code>{:weight}</code></li>
  <li><code>{:yields}</code></li>
</ul>

<!--PDF NEWPAGE-->
<h2 id="sec-advanced-topics">23. Advanced Topics</h2>

<h3 id="sec-type-parameter-completion">23.1. Type Parameter Completion</h3>

<p><a href="http://leino.science/papers/krml270.html">http://leino.science/papers/krml270.html</a></p>

<p>TO BE WRITTEN</p>

<h3 id="sec-type-inference">23.2. Type Inference</h3>

<p>TO BE WRITTEN</p>

<h3 id="233-ghost-inference">23.3. Ghost Inference</h3>

<p>TO BE WRITTEN</p>

<h3 id="234-well-founded-functions-and-extreme-predicates">23.4. Well-founded Functions and Extreme Predicates</h3>

<p>TODO: This section needs rewriting</p>

<p>This section is a tutorial on well-founded functions and extreme predicates.
We place it here in preparation for Section [#sec-class-types]
where function and predicate definitions are described.</p>

<p>Recursive functions are a core part of computer science and mathematics.
Roughly speaking, when the definition of such a function spells out a
terminating computation from given arguments, we may refer to
it as a <em>well-founded function</em>.  For example, the common factorial and
Fibonacci functions are well-founded functions.</p>

<p>There are also other ways to define functions.  An important case
regards the definition of a boolean function as an extreme solution
(that is, a least or greatest solution) to some equation.  For
computer scientists with interests in logic or programming languages,
these <em>extreme predicates</em> are important because they describe the
judgments that can be justified by a given set of inference rules
(see, e.g., [@CamilleriMelham:InductiveRelations;
@Winskel:FormalSemantics;
  @LeroyGrall:CoinductiveBigStep; @Pierce:SoftwareFoundations;
  @NipkowKlein:ConcreteSemantics]).</p>

<p>To benefit from machine-assisted reasoning, it is necessary not just
to understand extreme predicates but also to have techniques for
proving theorems about them.  A foundation for this reasoning was
developed by Paulin-Mohring [@PaulinMohring:InductiveCoq] and is the
basis of the constructive logic supported by Coq [@Coq:book] as well
as other proof assistants [@BoveDybjerNorell:BriefAgda;
@SwamyEtAl:Fstar2011].  Essentially, the idea is to represent the
knowledge that an extreme predicate holds by the proof term by which
this knowledge was derived.  For a predicate defined as the least
solution, such proof terms are values of an inductive datatype (that
is, finite proof trees), and for the greatest solution, a coinductive
datatype (that is, possibly infinite proof trees).  This means that
one can use induction and coinduction when reasoning about these proof
trees.  These extreme predicates are known as,
respectively, <em>least predicates</em> and <em>greatest predicates</em>.
Support for extreme predicates is also
available in the proof assistants Isabelle [@Paulson:CADE1994] and HOL
[@Harrison:InductiveDefs].</p>

<p>Dafny supports both well-founded functions and extreme predicates.
This section is a tutorial that describes the difference in general
terms, and then describes novel syntactic support in Dafny for
defining and proving lemmas with extreme predicates.  Although Dafnys
verifier has at its core a first-order SMT solver, Dafnys logical
encoding makes it possible to reason about fixpoints in an automated
way.</p>

<p>The encoding for greatest predicates in Dafny was described previously
[@LeinoMoskal:Coinduction] and is here described in Section
[#sec-co-inductive-datatypes].</p>

<h4 id="2341-function-definitions">23.4.1. Function Definitions</h4>

<p>To define a function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;&amp;#x003A;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" style="width: 4.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.149em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.501em, 1004.15em, 2.726em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-109" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-110" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>:</mo><mi>X</mi><mo stretchy="false"></mo><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">f \colon X \to Y</script> in terms of itself, one can
write an equation like
~ Equation {#eq-general}</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-112" style="width: 4.835em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1003.95em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-113"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-115" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-116" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-117"><span class="mi" id="MathJax-Span-118" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-20">f = \mathcal{F}(f)</script>
</p>
<p>~</p>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-122" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-123"><span class="texatom" id="MathJax-Span-124"><span class="mrow" id="MathJax-Span-125"><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-21">\mathcal{F}</script> is a non-recursive function of type
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-127" style="width: 10.349em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.666em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1008.67em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-128"><span class="mo" id="MathJax-Span-129" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-132" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-133" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-134" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-137" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false"></mo><mi>Y</mi><mo stretchy="false">)</mo><mo stretchy="false"></mo><mi>X</mi><mo stretchy="false"></mo><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-22">(X \to Y) \to X \to Y</script>.
Because it takes a function as an argument,
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-138" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-139"><span class="texatom" id="MathJax-Span-140"><span class="mrow" id="MathJax-Span-141"><span class="mi" id="MathJax-Span-142" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-23">\mathcal{F}</script>
is referred to as a <em>functor</em> (or <em>functional</em>, but not to be
confused by the category-theory notion of a functor).
Throughout, I will assume that
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-143" style="width: 2.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.153em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.06em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-144"><span class="texatom" id="MathJax-Span-145"><span class="mrow" id="MathJax-Span-146"><span class="mi" id="MathJax-Span-147" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-149" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-150" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-24">\mathcal{F}(f)</script>
by itself is well defined,
for example that it does not divide by zero.  I will also assume that
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-151" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-152"><span class="mi" id="MathJax-Span-153" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">f</script>
occurs
only in fully applied calls in
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-154" style="width: 2.576em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.153em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.06em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-155"><span class="texatom" id="MathJax-Span-156"><span class="mrow" id="MathJax-Span-157"><span class="mi" id="MathJax-Span-158" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-159" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-161" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-26">\mathcal{F}(f)</script>;
 eta expansion can be applied to
ensure this.  If
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-162" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-163"><span class="mi" id="MathJax-Span-164" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">f</script>
is a <code>boolean</code> function, that is, if
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-165" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.79em, 2.362em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.061em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">Y</script>
is
the type of booleans, then I call
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-168" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-169"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">f</script>
a <em>predicate</em>.</p>

<p>For example, the common Fibonacci function over the
natural numbers can be defined by the equation</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;&amp;#x03BB;&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-171" style="width: 27.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 23.319em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.508em, 1023.22em, 2.824em, -1000em); top: -2.416em; left: 0em;"><span class="mrow" id="MathJax-Span-172"><span class="texatom" id="MathJax-Span-173"><span class="mrow" id="MathJax-Span-174"><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-176" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-177" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-178" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-181" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-182" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-183" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Main; font-weight: bold;">i</span><span class="mi" id="MathJax-Span-186" style="font-family: MathJax_Main; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.101em;"></span></span></span></span><span class="mspace" id="MathJax-Span-187" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-189" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mn" id="MathJax-Span-190" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mspace" id="MathJax-Span-191" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-192"><span class="mrow" id="MathJax-Span-193"><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Main; font-weight: bold;">t</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Main; font-weight: bold;">h</span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Main; font-weight: bold;">e</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Main; font-weight: bold;">n</span></span></span><span class="mspace" id="MathJax-Span-198" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-199" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mspace" id="MathJax-Span-200" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-201"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Main; font-weight: bold;">e</span><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Main; font-weight: bold;">l</span><span class="mi" id="MathJax-Span-205" style="font-family: MathJax_Main; font-weight: bold;">s</span><span class="mi" id="MathJax-Span-206" style="font-family: MathJax_Main; font-weight: bold;">e</span></span></span><span class="mspace" id="MathJax-Span-207" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-208"><span class="mrow" id="MathJax-Span-209"><span class="mi" id="MathJax-Span-210" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-213" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-215" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-216" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-217" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-219" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-220"><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-223" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-224" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-226" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-227" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-228" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.416em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo>=</mo><mi></mi><mi>n</mi><mo></mo><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">i</mi><mi mathvariant="bold">f</mi></mrow><mspace width="mediummathspace"></mspace><mi>n</mi><mo>&lt;</mo><mn>2</mn><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi></mrow><mspace width="mediummathspace"></mspace><mi>n</mi><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">e</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">s</mi><mi mathvariant="bold">e</mi></mrow><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-30">
\mathit{fib} = \lambda n \bullet\: \mathbf{if}\:n < 2 \:\mathbf{then}\: n \:\mathbf{else}\: \mathit{fib}(n-2) + \mathit{fib}(n-1)
</script>
</p>

<p>With the understanding that the argument <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-229" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">n</script> is universally
quantified, we can write this equation equivalently as</p>

<p>~ Equation {#eq-fib}</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;i&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;n&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;e&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;l&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;s&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-232" style="width: 20.223em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.964em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.508em, 1016.87em, 2.824em, -1000em); top: -2.416em; left: 0em;"><span class="mrow" id="MathJax-Span-233"><span class="texatom" id="MathJax-Span-234"><span class="mrow" id="MathJax-Span-235"><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-239" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-242" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-243" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-244"><span class="mi" id="MathJax-Span-245" style="font-family: MathJax_Main; font-weight: bold;">i</span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Main; font-weight: bold;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.101em;"></span></span></span></span><span class="mspace" id="MathJax-Span-247" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-249" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mn" id="MathJax-Span-250" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span><span class="mspace" id="MathJax-Span-251" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-252"><span class="mrow" id="MathJax-Span-253"><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Main; font-weight: bold;">t</span><span class="mi" id="MathJax-Span-255" style="font-family: MathJax_Main; font-weight: bold;">h</span><span class="mi" id="MathJax-Span-256" style="font-family: MathJax_Main; font-weight: bold;">e</span><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Main; font-weight: bold;">n</span></span></span><span class="mspace" id="MathJax-Span-258" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mspace" id="MathJax-Span-260" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-261"><span class="mrow" id="MathJax-Span-262"><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Main; font-weight: bold;">e</span><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Main; font-weight: bold;">l</span><span class="mi" id="MathJax-Span-265" style="font-family: MathJax_Main; font-weight: bold;">s</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Main; font-weight: bold;">e</span></span></span><span class="mspace" id="MathJax-Span-267" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-268"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-271" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-272" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-275" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-276" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-277" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.416em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">i</mi><mi mathvariant="bold">f</mi></mrow><mspace width="mediummathspace"></mspace><mi>n</mi><mo>&lt;</mo><mn>2</mn><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">t</mi><mi mathvariant="bold">h</mi><mi mathvariant="bold">e</mi><mi mathvariant="bold">n</mi></mrow><mspace width="mediummathspace"></mspace><mi>n</mi><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">e</mi><mi mathvariant="bold">l</mi><mi mathvariant="bold">s</mi><mi mathvariant="bold">e</mi></mrow><mspace width="mediummathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-32">
\mathit{fib}(n) = \mathbf{if}\:n < 2\:\mathbf{then}\:n\:\mathbf{else}\:\mathit{fib}(n-2)%2B\mathit{fib}(n-1)
</script>
</p>
<p>~</p>

<p>The fact that the function being defined occurs on both sides of the equation
causes concern that we might not be defining the function properly, leading to a
logical inconsistency.  In general, there
could be many solutions to an equation like [#eq-general] or there could be none.
Lets consider two ways to make sure were defining the function uniquely.</p>

<h5 id="23411-well-founded-functions">23.4.1.1. Well-founded Functions</h5>

<p>A standard way to ensure that equation [#eq-general] has a unique solution in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-278" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-279"><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-33">f</script> is
to make sure the recursion is well-founded, which roughly means that the
recursion terminates.  This is done by introducing any well-founded
relation <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-281" style="width: 1.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.638em, 1000.94em, 2.588em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-282"><span class="mo" id="MathJax-Span-283" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.142em; border-left: 0px solid; width: 0px; height: 0.881em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo></math></span></span><script type="math/tex" id="MathJax-Element-34">\ll</script> on the domain of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-284" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-285"><span class="mi" id="MathJax-Span-286" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">f</script> and making sure that the argument to each recursive
call goes down in this ordering.  More precisely, if we formulate [#eq-general] as</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi&gt;&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" style="width: 6.778em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.672em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.397em, 1005.58em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-291" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-292" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-294" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-295"><span class="mi" id="MathJax-Span-296" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="texatom" id="MathJax-Span-297"><span class="mrow" id="MathJax-Span-298"><span class="msup" id="MathJax-Span-299"><span style="display: inline-block; position: relative; width: 0.269em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-300"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="mo" id="MathJax-Span-301" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mrow class="MJX-TeXAtom-ORD"><msup><mi></mi><mo></mo></msup></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">
f(x) = \mathcal{F}{'}(f)
</script>
</p>

<p>then we want to check <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-305" style="width: 3.469em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.889em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.526em, 1002.84em, 2.588em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-306"><span class="mi" id="MathJax-Span-307" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-308" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.142em; border-left: 0px solid; width: 0px; height: 1.014em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>E</mi><mo></mo><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">E \ll x</script> for each call <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;E&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-310" style="width: 2.524em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.101em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.01em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-311"><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-313" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math; font-style: italic;">E<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.026em;"></span></span><span class="mo" id="MathJax-Span-315" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>E</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38">f(E)</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-316" style="width: 6.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.725em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.4em, 1005.63em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-317"><span class="mi" id="MathJax-Span-318" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-319" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-321" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msup" id="MathJax-Span-323" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-324"><span class="mrow" id="MathJax-Span-325"><span class="mi" id="MathJax-Span-326" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mo" id="MathJax-Span-327" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-328" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-330" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.382em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo></mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">f(x) = \mathcal{F}(f)</script>.
When a function
definition satisfies  this <em>decrement condition</em>, then the function is said to be
<em>well-founded</em>.</p>

<p>For example, to check the decrement condition for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-331" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1001.06em, 2.567em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-332"><span class="texatom" id="MathJax-Span-333"><span class="mrow" id="MathJax-Span-334"><span class="mi" id="MathJax-Span-335" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-336" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-337" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.207em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-40">\mathit{fib}</script>
in [#eq-fib], we can pick <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-338" style="width: 1.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.638em, 1000.94em, 2.588em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-339"><span class="mo" id="MathJax-Span-340" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.142em; border-left: 0px solid; width: 0px; height: 0.881em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo></math></span></span><script type="math/tex" id="MathJax-Element-41">\ll</script>
to be the arithmetic less-than relation on natural numbers and check the
following, for any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-341" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-342"><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-42">n</script>:</p>
<p style="text-align: center;"> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-344" style="width: 18.805em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.809em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1015.79em, 2.659em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-345"><span class="mn" id="MathJax-Span-346" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span><span class="mspace" id="MathJax-Span-349" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-350" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-351" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-354" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-355" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-356" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span><span class="mspace" id="MathJax-Span-357" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-358" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-359" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span><span class="mo" id="MathJax-Span-361" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-363" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.082em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mn>2</mn><mo></mo><mi>n</mi><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>n</mi><mo></mo><mn>2</mn><mo></mo><mi>n</mi><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mi>n</mi><mo></mo><mn>1</mn><mo></mo><mi>n</mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-43"> 2 \leq n \;\Longrightarrow\; n-2 \ll n \;\wedge\; n-1 \ll n </script>
</p>

<p>Note that we are entitled to use the antecedent
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-365" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.4em, 2.659em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-366"><span class="mn" id="MathJax-Span-367" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.082em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo></mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-44">2 \leq n</script> because that is the
condition under which the else branch in [#eq-fib] is evaluated.</p>

<p>A well-founded function is often thought of as terminating in the sense
that the recursive <em>depth</em> in evaluating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-370" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-371"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-45">f</script>
on any given argument is finite.  That is, there are no infinite descending chains
of recursive calls.  However, the evaluation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-373" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-374"><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">f</script> on a given argument
may fail to terminate, because its <em>width</em> may be infinite.  For example, let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-376" style="width: 0.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.74em, 2.363em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-377"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi></math></span></span><script type="math/tex" id="MathJax-Element-47">P</script>
be some predicate defined on the ordinals and let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-379" style="width: 1.316em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.103em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1001.1em, 2.651em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-380"><span class="msubsup" id="MathJax-Span-381"><span style="display: inline-block; position: relative; width: 1.107em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.73em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-382"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Main; font-style: italic;">P</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.842em; left: 0.678em;"><span class="mo" id="MathJax-Span-385" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.404em; border-left: 0px solid; width: 0px; height: 1.28em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">P</mi></mrow><mo stretchy="false"></mo></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">\mathit{P}_\downarrow</script> be a predicate on the
ordinals defined by the following equation:</p>

<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x005F;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-386" style="width: 21.221em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.805em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1017.71em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="texatom" id="MathJax-Span-388"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Main; font-style: italic;">P</span></span></span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Main;">_</span><span class="mo" id="MathJax-Span-392" style="font-family: MathJax_Main; padding-left: 0.278em;"><span style="font-family: MathJax_Main; font-style: normal; font-weight: normal;">=</span></span><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-394" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-397" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-399" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-402" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-403" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">p</span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">o</span><span class="mspace" id="MathJax-Span-407" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-408" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-409" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-410" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-411"><span class="mi" id="MathJax-Span-412" style="font-family: MathJax_Main; font-style: italic;">P</span></span></span><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Main;">_</span><span class="mo" id="MathJax-Span-414" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-415" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-417" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">P</mi></mrow><mi mathvariant="normal">_</mi><mo stretchy="false">=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>o</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mi mathvariant="normal"></mi><mi>p</mi><mo></mo><mspace width="thickmathspace"></mspace><mi>p</mi><mo></mo><mi>o</mi><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">P</mi></mrow><mi mathvariant="normal">_</mi><mo stretchy="false"></mo><mo stretchy="false">(</mo><mi>p</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-49">
\mathit{P}\_\downarrow = P(o) \;\wedge\; \forall p \bullet\; p \ll o \;\Longrightarrow\; \mathit{P}\_\downarrow(p)
</script>
</p>

<p>With <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-418" style="width: 1.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.638em, 1000.94em, 2.588em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-419"><span class="mo" id="MathJax-Span-420" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.142em; border-left: 0px solid; width: 0px; height: 0.881em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo></math></span></span><script type="math/tex" id="MathJax-Element-50">\ll</script> as the usual ordering on ordinals, this equation satisfies the decrement
condition, but evaluating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;&amp;#x03C9;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-421" style="width: 2.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.521em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.43em, 2.808em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-422"><span class="msubsup" id="MathJax-Span-423"><span style="display: inline-block; position: relative; width: 1.107em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.73em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-424"><span class="mrow" id="MathJax-Span-425"><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Main; font-style: italic;">P</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.842em; left: 0.678em;"><span class="mo" id="MathJax-Span-427" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-428" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math; font-style: italic;"></span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.404em; border-left: 0px solid; width: 0px; height: 1.359em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">P</mi></mrow><mo stretchy="false"></mo></msub><mo stretchy="false">(</mo><mi></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">\mathit{P}_\downarrow(\omega)</script> would require evaluating
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;P&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-431" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.468em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.37em, 2.808em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-432"><span class="msubsup" id="MathJax-Span-433"><span style="display: inline-block; position: relative; width: 1.107em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.73em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-434"><span class="mrow" id="MathJax-Span-435"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Main; font-style: italic;">P</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.842em; left: 0.678em;"><span class="mo" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-439" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-440" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.404em; border-left: 0px solid; width: 0px; height: 1.359em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">P</mi></mrow><mo stretchy="false"></mo></msub><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-52">\mathit{P}_\downarrow(n)</script> for every natural number <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-441" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-442"><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-53">n</script>.  However, what we are concerned
about here is to avoid mathematical inconsistencies, and that is
indeed a consequence of the decrement condition.</p>

<h5 id="sec-fib-example">23.4.1.2. Example with Well-founded Functions</h5>

<p>So that we can later see how inductive proofs are done in Dafny, lets prove that
for any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-444" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-445"><span class="mi" id="MathJax-Span-446" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">n</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-447" style="width: 2.944em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.468em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.37em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-448"><span class="texatom" id="MathJax-Span-449"><span class="mrow" id="MathJax-Span-450"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-452" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-454" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-455" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-456" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">\mathit{fib}(n)</script> is even iff <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-457" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-458"><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">n</script> is a multiple of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-460" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.541em, 1000.48em, 2.543em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-461"><span class="mn" id="MathJax-Span-462" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 0.943em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-57">3</script>.
We split our task into
two cases.  If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-463" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.37em, 2.561em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-464"><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-466" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mn" id="MathJax-Span-467" style="font-family: MathJax_Main; padding-left: 0.278em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.11em; border-left: 0px solid; width: 0px; height: 0.965em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>&lt;</mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-58">n < 2</script>, then the property follows directly from the definition
of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-468" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1001.06em, 2.567em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-469"><span class="texatom" id="MathJax-Span-470"><span class="mrow" id="MathJax-Span-471"><span class="mi" id="MathJax-Span-472" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-474" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.207em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-59">\mathit{fib}</script>.  Otherwise, note that exactly one of the three numbers <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-475" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.26em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-476"><span class="mi" id="MathJax-Span-477" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-478" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-479" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-60">n-2</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-480" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.24em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-484" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-61">n-1</script>, and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-485" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-486"><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">n</script>
is a multiple of 3.  If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-488" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-489"><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">n</script> is the multiple of 3, then by invoking the
induction hypothesis on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-491" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.26em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-492"><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-495" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-64">n-2</script>
and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-496" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.24em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-497"><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-499" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-500" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-65">n-1</script>, we obtain that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-501" style="width: 11.4em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.559em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1009.46em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-502"><span class="texatom" id="MathJax-Span-503"><span class="mrow" id="MathJax-Span-504"><span class="mi" id="MathJax-Span-505" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-508" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-510" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-511" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-514" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-519" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-522" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-523" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-66">\mathit{fib}(n-2) + \mathit{fib}(n-1)</script> is the sum of two odd numbers,
which is even.  If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-524" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.26em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-525"><span class="mi" id="MathJax-Span-526" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-527" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-528" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-67">n-2</script> or <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-529" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.24em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-530"><span class="mi" id="MathJax-Span-531" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-532" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-533" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-68">n-1</script> is a multiple of 3, then by invoking the induction
hypothesis on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-534" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.26em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-535"><span class="mi" id="MathJax-Span-536" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-537" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-538" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-69">n-2</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-539" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.24em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-540"><span class="mi" id="MathJax-Span-541" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-542" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-543" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-70">n-1</script>, we obtain that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-544" style="width: 11.4em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.559em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1009.46em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-545"><span class="texatom" id="MathJax-Span-546"><span class="mrow" id="MathJax-Span-547"><span class="mi" id="MathJax-Span-548" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-549" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-552" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-553" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-554" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-555" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-556" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-557" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-558"><span class="mi" id="MathJax-Span-559" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-560" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-561" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-562" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-563" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-565" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mo" id="MathJax-Span-566" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>n</mi><mo></mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-71">\mathit{fib}(n-2) + \mathit{fib}(n-1)</script> is the sum of an
even number and an odd number, which is odd.  In this proof, we invoked the induction
hypothesis on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-567" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.26em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-568"><span class="mi" id="MathJax-Span-569" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-570" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-571" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-72">n-2</script> and on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-572" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.24em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-573"><span class="mi" id="MathJax-Span-574" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-575" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-576" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-73">n-1</script>.  This is allowed, because both are smaller than
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-577" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.56em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-578"><span class="mi" id="MathJax-Span-579" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-74">n</script>, and hence the invocations go down in the well-founded ordering on natural numbers.</p>

<h5 id="23413-extreme-solutions">23.4.1.3. Extreme Solutions</h5>

<p>We dont need to exclude the possibility of equation [#eq-general] having multiple
solutionsinstead, we can just be clear about which one of them we want.
Lets explore this, after a smidgen of lattice theory.</p>

<p>For any complete lattice <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-580" style="width: 3.311em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.784em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1002.69em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-581"><span class="mo" id="MathJax-Span-582" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-584" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-585" style="font-family: MathJax_Main; padding-left: 0.167em;"></span><span class="mo" id="MathJax-Span-586" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>Y</mi><mo>,</mo><mo></mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-75">(Y,\leq)</script> and any set <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-587" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.84em, 2.363em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-588"><span class="mi" id="MathJax-Span-589" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">X</script>, we can by <em>pointwise extension</em> define
a complete lattice <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-590" style="width: 6.463em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.41em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.43em, 1005.32em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-591"><span class="mo" id="MathJax-Span-592" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-594" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-595" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span><span class="mo" id="MathJax-Span-596" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-597" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-598"><span class="munderover" id="MathJax-Span-599"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-601" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.346em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false"></mo><mi>Y</mi><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-77">(X \to Y, \dot{\Rightarrow})</script>, where for any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo&gt;&amp;#x003A;&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-603" style="width: 6.095em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.095em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.501em, 1005.1em, 2.726em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-604"><span class="mi" id="MathJax-Span-605" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-606" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main;">:</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-610" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-611" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility; padding-left: 0.278em;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>,</mo><mi>g</mi><mo>:</mo><mi>X</mi><mo stretchy="false"></mo><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">f,g \colon X \to Y</script>,</p>

<p>Equation</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-612" style="width: 14.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.87em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.43em, 1011.78em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-613"><span class="mi" id="MathJax-Span-614" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="texatom" id="MathJax-Span-615"><span class="mrow" id="MathJax-Span-616"><span class="munderover" id="MathJax-Span-617"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-618" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-619" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mi" id="MathJax-Span-620" style="font-family: MathJax_Math; font-style: italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.014em;"></span></span><span class="mspace" id="MathJax-Span-621" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-622" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-623" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-624" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-625" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-626" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-627" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-628" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-629" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-631" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-632" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-633" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-634" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-635" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-637" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-638" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.346em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow><mi>q</mi><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mi mathvariant="normal"></mi><mi>x</mi><mo></mo><mspace width="thickmathspace"></mspace><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo></mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-79">
f \dot{\Rightarrow} q  \;\;\equiv\;\; \forall x \bullet\; f(x) \leq g(x)
</script>
</p>

<p>In particular, if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-639" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.79em, 2.362em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-640"><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.061em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">Y</script> is the set of booleans ordered by implication (<code>false</code> <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-642" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.57em, 1000.7em, 2.659em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-643"><span class="mo" id="MathJax-Span-644" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.046em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo></mo></math></span></span><script type="math/tex" id="MathJax-Element-81">\leq</script> <code>true</code>),
then the set of predicates over any domain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-645" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.84em, 2.363em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-646"><span class="mi" id="MathJax-Span-647" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">X</script> forms a complete lattice.
Tarskis Theorem [@Tarski:theorem] tells us that any monotonic function over a
complete lattice has a least and a greatest fixpoint.  In particular, this means that
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-648" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-649"><span class="texatom" id="MathJax-Span-650"><span class="mrow" id="MathJax-Span-651"><span class="mi" id="MathJax-Span-652" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-83">\mathcal{F}</script> has a least fixpoint and a greatest fixpoint, provided <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-653" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-654"><span class="texatom" id="MathJax-Span-655"><span class="mrow" id="MathJax-Span-656"><span class="mi" id="MathJax-Span-657" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-84">\mathcal{F}</script> is monotonic.</p>

<p>Speaking about the <em>set of solutions</em> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-658" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-659"><span class="mi" id="MathJax-Span-660" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">f</script> to [#eq-general] is the same as speaking
about the <em>set of fixpoints</em> of functor <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-661" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-662"><span class="texatom" id="MathJax-Span-663"><span class="mrow" id="MathJax-Span-664"><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-86">\mathcal{F}</script>.  In particular, the least and greatest
solutions to [#eq-general] are the same as the least and greatest fixpoints of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-666" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-667"><span class="texatom" id="MathJax-Span-668"><span class="mrow" id="MathJax-Span-669"><span class="mi" id="MathJax-Span-670" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-87">\mathcal{F}</script>.
In casual speak, it happens that we say fixpoint of [#eq-general], or more
grotesquely, fixpoint of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-671" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-672"><span class="mi" id="MathJax-Span-673" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-88">f</script> when we really mean fixpoint of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-89-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-674" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-675"><span class="texatom" id="MathJax-Span-676"><span class="mrow" id="MathJax-Span-677"><span class="mi" id="MathJax-Span-678" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-89">\mathcal{F}</script>.</p>

<p>In conclusion of our little excursion into lattice theory, we have that, under the
proviso of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-90-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-679" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-680"><span class="texatom" id="MathJax-Span-681"><span class="mrow" id="MathJax-Span-682"><span class="mi" id="MathJax-Span-683" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-90">\mathcal{F}</script> being monotonic, the set of solutions in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-91-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-684" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-91">f</script> to [#eq-general] is nonempty,
and among these solutions, there is in the <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-92-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-687" style="width: 1.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.998em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.272em, 1000.94em, 2.387em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-688"><span class="texatom" id="MathJax-Span-689"><span class="mrow" id="MathJax-Span-690"><span class="munderover" id="MathJax-Span-691"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-692" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-693" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.091em; border-left: 0px solid; width: 0px; height: 1.077em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow></math></span></span><script type="math/tex" id="MathJax-Element-92">\dot{\Rightarrow}</script> ordering a least solution (that is,
a function that returns <code>false</code> more often than any other) and a greatest solution (that
is, a function that returns <code>true</code> more often than any other).</p>

<p>When discussing extreme solutions, I will now restrict my attention to boolean functions
(that is, with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-93-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-694" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.79em, 2.362em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-695"><span class="mi" id="MathJax-Span-696" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.061em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-93">Y</script> being the type of booleans).  Functor <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-94-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-697" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-698"><span class="texatom" id="MathJax-Span-699"><span class="mrow" id="MathJax-Span-700"><span class="mi" id="MathJax-Span-701" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-94">\mathcal{F}</script> is monotonic
if the calls to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-95-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-702" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-703"><span class="mi" id="MathJax-Span-704" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-95">f</script> in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-96-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-705" style="width: 2.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.521em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.4em, 1002.43em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-706"><span class="msup" id="MathJax-Span-707"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-708"><span class="mrow" id="MathJax-Span-709"><span class="mi" id="MathJax-Span-710" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mo" id="MathJax-Span-711" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-712" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-713" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-714" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.382em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo></mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-96">\mathcal{F}(f)</script> are in <em>positive positions</em> (that is, under an even number
of negations).  Indeed, from now on, I will restrict my attention to such monotonic
functors <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-97-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-715" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-716"><span class="texatom" id="MathJax-Span-717"><span class="mrow" id="MathJax-Span-718"><span class="mi" id="MathJax-Span-719" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-97">\mathcal{F}</script>.</p>

<p>Let me introduce a running example.  Consider the following equation,
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-98-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-720" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.53em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-721"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-98">x</script> ranges over the integers:</p>

<p>~ Equation {#eq-EvenNat}</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-99-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mo&gt;&amp;#x2228;&lt;/mo&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-723" style="width: 13.658em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.45em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1011.36em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-724"><span class="mi" id="MathJax-Span-725" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-726" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-727" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-728" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-729" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-731" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-732" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-733" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mspace" id="MathJax-Span-734" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-735" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-736" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-737" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-738" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-739" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-741" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-742" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-743" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>=</mo><mn>0</mn><mspace width="mediummathspace"></mspace><mo></mo><mspace width="mediummathspace"></mspace><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-99">
g(x) = (x = 0 \:\vee\: g(x-2))
</script>
</p>
<p>~</p>

<p>This equation has four solutions in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-100-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-744" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-745"><span class="mi" id="MathJax-Span-746" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-100">g</script>.  With <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-101-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-747" style="width: 0.895em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.735em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.605em, 1000.71em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-748"><span class="mi" id="MathJax-Span-749" style="font-family: MathJax_Math; font-style: italic;">w</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.665em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>w</mi></math></span></span><script type="math/tex" id="MathJax-Element-101">w</script> ranging over the integers, they are:</p>

<p>Equation</p>
<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-102-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mtable columnalign=&quot;right left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mo&gt;&amp;#x2228;&lt;/mo&gt;&lt;mspace width=&quot;mediummathspace&quot; /&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;odd&lt;/mtext&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2261;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2208;&lt;/mo&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;{&lt;/mo&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;u&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;}&lt;/mo&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-750" style="width: 26.211em; display: inline-block;"><span style="display: inline-block; position: relative; width: 22.006em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(-0.902em, 1021.77em, 4.813em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-751"><span class="mtable" id="MathJax-Span-752" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 21.686em; height: 0px;"><span style="position: absolute; clip: rect(3.297em, 1004.28em, 8.963em, -1000em); top: -6.355em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.275em; height: 0px;"><span style="position: absolute; clip: rect(3.084em, 1004.28em, 4.399em, -1000em); top: -6.142em; right: 0em;"><span class="mtd" id="MathJax-Span-753"><span class="mrow" id="MathJax-Span-754"><span class="mi" id="MathJax-Span-755" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-756" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-757" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-758" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-759" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-760" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-761" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-762" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-763" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-764" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-765"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1004.28em, 4.399em, -1000em); top: -4.692em; right: 0em;"><span class="mtd" id="MathJax-Span-788"><span class="mrow" id="MathJax-Span-789"><span class="mi" id="MathJax-Span-790" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-792" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-793" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-794" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-795" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-796" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-797" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-798" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-799" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-800"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1004.28em, 4.399em, -1000em); top: -3.242em; right: 0em;"><span class="mtd" id="MathJax-Span-817"><span class="mrow" id="MathJax-Span-818"><span class="mi" id="MathJax-Span-819" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-821" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-822" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-823" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-824" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-825" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-826" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-827" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-828" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-829"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1004.28em, 4.399em, -1000em); top: -1.792em; right: 0em;"><span class="mtd" id="MathJax-Span-861"><span class="mrow" id="MathJax-Span-862"><span class="mi" id="MathJax-Span-863" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-864" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-865" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-866" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-867" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-868" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-869" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-870" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-871" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-872" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-873"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.355em;"></span></span><span style="position: absolute; clip: rect(3.297em, 1016.35em, 8.963em, -1000em); top: -6.355em; left: 5.275em;"><span style="display: inline-block; position: relative; width: 16.411em; height: 0px;"><span style="position: absolute; clip: rect(3.084em, 1011.43em, 4.399em, -1000em); top: -6.142em; left: 0em;"><span class="mtd" id="MathJax-Span-766"><span class="mrow" id="MathJax-Span-767"><span class="mi" id="MathJax-Span-768" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-769" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-770" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mi" id="MathJax-Span-771" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mspace" id="MathJax-Span-772" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-773"><span class="mrow" id="MathJax-Span-774"><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main;">|</span></span></span><span class="mspace" id="MathJax-Span-776" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-777" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-778" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">w</span><span class="mspace" id="MathJax-Span-780" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-782" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">w</span><span class="texatom" id="MathJax-Span-784"><span class="mrow" id="MathJax-Span-785"><span class="mtext" id="MathJax-Span-786" style="font-family: MathJax_Main;">&nbsp;even</span></span></span><span class="mo" id="MathJax-Span-787" style="font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1007.22em, 4.399em, -1000em); top: -4.692em; left: 0em;"><span class="mtd" id="MathJax-Span-801"><span class="mrow" id="MathJax-Span-802"><span class="mi" id="MathJax-Span-803" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-804" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-805" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mi" id="MathJax-Span-806" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mspace" id="MathJax-Span-807" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-808"><span class="mrow" id="MathJax-Span-809"><span class="mo" id="MathJax-Span-810" style="font-family: MathJax_Main;">|</span></span></span><span class="mspace" id="MathJax-Span-811" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-812" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="texatom" id="MathJax-Span-813"><span class="mrow" id="MathJax-Span-814"><span class="mtext" id="MathJax-Span-815" style="font-family: MathJax_Main;">&nbsp;even</span></span></span><span class="mo" id="MathJax-Span-816" style="font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1016.35em, 4.399em, -1000em); top: -3.242em; left: 0em;"><span class="mtd" id="MathJax-Span-830"><span class="mrow" id="MathJax-Span-831"><span class="mi" id="MathJax-Span-832" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-834" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mi" id="MathJax-Span-835" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mspace" id="MathJax-Span-836" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-837"><span class="mrow" id="MathJax-Span-838"><span class="mo" id="MathJax-Span-839" style="font-family: MathJax_Main;">|</span></span></span><span class="mspace" id="MathJax-Span-840" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-841" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-842" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-843" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-844" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">w</span><span class="mspace" id="MathJax-Span-845" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-846" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-847" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">w</span><span class="texatom" id="MathJax-Span-849"><span class="mrow" id="MathJax-Span-850"><span class="mtext" id="MathJax-Span-851" style="font-family: MathJax_Main;">&nbsp;even</span></span></span><span class="mo" id="MathJax-Span-852" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-853" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-854" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-855" style="height: 0em; vertical-align: 0em; width: 0.222em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-856" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">w</span><span class="texatom" id="MathJax-Span-857"><span class="mrow" id="MathJax-Span-858"><span class="mtext" id="MathJax-Span-859" style="font-family: MathJax_Main;">&nbsp;odd</span></span></span><span class="mo" id="MathJax-Span-860" style="font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1006.03em, 4.399em, -1000em); top: -1.792em; left: 0em;"><span class="mtd" id="MathJax-Span-874"><span class="mrow" id="MathJax-Span-875"><span class="mi" id="MathJax-Span-876" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-877" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-878" style="font-family: MathJax_Main; padding-left: 0.278em;">{</span><span class="mi" id="MathJax-Span-879" style="font-family: MathJax_Math; font-style: italic;">w</span><span class="mspace" id="MathJax-Span-880" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-881"><span class="mrow" id="MathJax-Span-882"><span class="mo" id="MathJax-Span-883" style="font-family: MathJax_Main;">|</span></span></span><span class="mspace" id="MathJax-Span-884" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-885"><span class="mrow" id="MathJax-Span-886"><span class="mi" id="MathJax-Span-887" style="font-family: MathJax_Main; font-style: italic;">t</span><span class="mi" id="MathJax-Span-888" style="font-family: MathJax_Main; font-style: italic;">r</span><span class="mi" id="MathJax-Span-889" style="font-family: MathJax_Main; font-style: italic;">u</span><span class="mi" id="MathJax-Span-890" style="font-family: MathJax_Main; font-style: italic;">e</span></span></span><span class="mo" id="MathJax-Span-891" style="font-family: MathJax_Main;">}</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="display: inline-block; width: 0px; height: 6.355em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -2.978em; border-left: 0px solid; width: 0px; height: 6.551em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mtable columnalign="right left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"></mrow></mtd><mtd><mi>x</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mi>w</mi><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thickmathspace"></mspace><mn>0</mn><mo></mo><mi>w</mi><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow><mo fence="false" stretchy="false">}</mo></mtd></mtr><mtr><mtd><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"></mrow></mtd><mtd><mi>x</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mi>w</mi><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thickmathspace"></mspace><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow><mo fence="false" stretchy="false">}</mo></mtd></mtr><mtr><mtd><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"></mrow></mtd><mtd><mi>x</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mi>w</mi><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thickmathspace"></mspace><mo stretchy="false">(</mo><mn>0</mn><mo></mo><mi>w</mi><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow><mo stretchy="false">)</mo><mspace width="mediummathspace"></mspace><mo></mo><mspace width="mediummathspace"></mspace><mi>w</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;odd</mtext></mrow><mo fence="false" stretchy="false">}</mo></mtd></mtr><mtr><mtd><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"></mrow></mtd><mtd><mi>x</mi><mo></mo><mo fence="false" stretchy="false">{</mo><mi>w</mi><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">u</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mo fence="false" stretchy="false">}</mo></mtd></mtr></mtable></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-102">
 \begin{array}{r@{}l}
  g(x) \;\;\equiv\;\;{}&  x \in \{w \;|\; 0 \leq w \;\wedge\; w\textrm{ even}\} \\
  g(x) \;\;\equiv\;\;{}&  x \in \{w \;|\; w\textrm{ even}\} \\
  g(x) \;\;\equiv\;\;{}&  x \in \{w \;|\; (0 \leq w \;\wedge\; w\textrm{ even}) \:\vee\: w\textrm{ odd}\} \\
  g(x) \;\;\equiv\;\;{}&  x \in \{w \;|\; \mathit{true}\}
  \end{array}
</script>
</p>

<p>The first of these is the least solution and the last is the greatest solution.</p>

<p>In the literature, the definition of an extreme predicate is often given as a set of
<em>inference rules</em>.  To designate the least solution, a single line separating the
antecedent (on top) from conclusion (on bottom) is used:</p>

<p>Equation {#g-ind-rule}
  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-103-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow /&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-892" style="width: 9.719em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.141em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.933em, 1008.14em, 2.979em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-893"><span class="mfrac" id="MathJax-Span-894"><span style="display: inline-block; position: relative; width: 1.363em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -4.4em; left: 50%; margin-left: 0em;"><span class="mrow" id="MathJax-Span-895"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1001.18em, 4.326em, -1000em); top: -3.553em; left: 50%; margin-left: -0.622em;"><span class="mrow" id="MathJax-Span-896"><span class="mi" id="MathJax-Span-897" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-898" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-899" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-900" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.827em, 1001.36em, 1.208em, -1000em); top: -1.27em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.363em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.05em;"></span></span></span></span><span class="mspace" id="MathJax-Span-901" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-902" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mfrac" id="MathJax-Span-903"><span style="display: inline-block; position: relative; width: 2.318em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.304em, 1002.13em, 4.326em, -1000em); top: -4.577em; left: 50%; margin-left: -1.099em;"><span class="mrow" id="MathJax-Span-904"><span class="mi" id="MathJax-Span-905" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-906" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-907" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-908" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-909" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-910" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.304em, 1001.23em, 4.326em, -1000em); top: -3.553em; left: 50%; margin-left: -0.647em;"><span class="mrow" id="MathJax-Span-911"><span class="mi" id="MathJax-Span-912" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.002em;"></span></span><span class="mo" id="MathJax-Span-913" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-914" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-915" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.827em, 1002.32em, 1.208em, -1000em); top: -1.27em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.318em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.05em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.795em; border-left: 0px solid; width: 0px; height: 2.185em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mfrac><mspace width="2em"></mspace><mspace width="2em"></mspace><mfrac><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-103">\frac{}{g(0)} \qquad\qquad \frac{g(x-2)}{g(x)}</script></p>

<p>Through repeated applications of such rules, one can show that the predicate holds for
a particular value.  For example, the <em>derivation</em>, or <em>proof tree</em>,
to the left in Figure [#fig-proof-trees] shows that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-104-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-916" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.733em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.64em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-917"><span class="mi" id="MathJax-Span-918" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-919" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-920" style="font-family: MathJax_Main;">6</span><span class="mo" id="MathJax-Span-921" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-104">g(6)</script> holds.
(In this simple example, the derivation is a rather degenerate proof tree.)
The use of these inference rules gives rise to a least solution, because proof trees are
accepted only if they are <em>finite</em>.</p>

<p>When inference rules are to designate the greatest solution, a thick
line is used:</p>

<p>~ Equation {#g-coind-rule}
    <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-105-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac linethickness=&quot;1.2pt&quot;&gt;&lt;mrow /&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac linethickness=&quot;1.2pt&quot;&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-922" style="width: 12.293em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.294em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(0.487em, 1010.29em, 3.425em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-923"><span class="mstyle" id="MathJax-Span-924"><span class="mrow" id="MathJax-Span-925"><span class="mfrac" id="MathJax-Span-926"><span style="display: inline-block; position: relative; width: 1.998em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -4.668em; left: 50%; margin-left: 0em;"><span class="mrow" id="MathJax-Span-927"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.66em, 4.399em, -1000em); top: -3.18em; left: 50%; margin-left: -0.879em;"><span class="mrow" id="MathJax-Span-928"><span class="mi" id="MathJax-Span-929" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-930" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-931" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-932" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1002em, 1.261em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 2.3px solid; width: 1.998em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.103em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-933" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-934" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mstyle" id="MathJax-Span-935"><span class="mrow" id="MathJax-Span-936"><span class="mfrac" id="MathJax-Span-937"><span style="display: inline-block; position: relative; width: 3.792em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.084em, 1003.46em, 4.399em, -1000em); top: -4.803em; left: 50%; margin-left: -1.776em;"><span class="mrow" id="MathJax-Span-938"><span class="mi" id="MathJax-Span-939" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-940" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-941" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-942" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-943" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-944" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.74em, 4.399em, -1000em); top: -3.18em; left: 50%; margin-left: -0.915em;"><span class="mrow" id="MathJax-Span-945"><span class="mi" id="MathJax-Span-946" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-947" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-948" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-949" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1003.79em, 1.261em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 2.3px solid; width: 3.792em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.103em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.325em; border-left: 0px solid; width: 0px; height: 3.246em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mstyle scriptlevel="0" displaystyle="true"><mfrac linethickness="1.2pt"><mrow></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mspace width="2em"></mspace><mspace width="2em"></mspace><mstyle scriptlevel="0" displaystyle="true"><mfrac linethickness="1.2pt"><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mrow></mfrac></mstyle></math></span></span><script type="math/tex" id="MathJax-Element-105">\genfrac{}{}{1.2pt}0{}{g(0)}
  \qquad\qquad
    \genfrac{}{}{1.2pt}0{g(x-2)}{g(x)}</script></p>

<p>In this case, proof trees are allowed to be infinite.
For example, the left-hand example below shows a finite proof tree that uses the rules of [#g-ind-rule] to establish <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-106-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-950" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.733em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.64em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-951"><span class="mi" id="MathJax-Span-952" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-953" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-954" style="font-family: MathJax_Main;">6</span><span class="mo" id="MathJax-Span-955" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-106">g(6)</script>.  On the right is a partial depiction of an infinite proof tree that uses the rules of [#g-coind-rule] to establish <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-107-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-956" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.733em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.64em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-957"><span class="mi" id="MathJax-Span-958" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-959" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-960" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-961" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-107">g(1)</script>.</p>

<p style="text-align: center;">
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-108-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac&gt;&lt;mrow /&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;4&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mspace width=&quot;2em&quot; /&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac linethickness=&quot;1.2pt&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac linethickness=&quot;1.2pt&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac linethickness=&quot;1.2pt&quot;&gt;&lt;mstyle displaystyle=&quot;true&quot; scriptlevel=&quot;0&quot;&gt;&lt;mfrac linethickness=&quot;1.2pt&quot;&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x22EE;&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;3&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;mrow&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/mstyle&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-962" style="width: 13.868em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.66em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(-4.796em, 1011.66em, 3.425em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-963"><span class="mstyle" id="MathJax-Span-964"><span class="mrow" id="MathJax-Span-965"><span class="mfrac" id="MathJax-Span-966"><span style="display: inline-block; position: relative; width: 2.958em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.795em, 1002.84em, 6.644em, -1000em); top: -6.957em; left: 50%; margin-left: -1.419em;"><span class="mstyle" id="MathJax-Span-967"><span class="mrow" id="MathJax-Span-968"><span class="mfrac" id="MathJax-Span-969"><span style="display: inline-block; position: relative; width: 2.598em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.82em, 1002.48em, 5.226em, -1000em); top: -5.539em; left: 50%; margin-left: -1.239em;"><span class="mstyle" id="MathJax-Span-970"><span class="mrow" id="MathJax-Span-971"><span class="mfrac" id="MathJax-Span-972"><span style="display: inline-block; position: relative; width: 2.238em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.158em, 1002.12em, 5.12em, -1000em); top: -5.434em; left: 50%; margin-left: -1.059em;"><span class="mstyle" id="MathJax-Span-973"><span class="mrow" id="MathJax-Span-974"><span class="mfrac" id="MathJax-Span-975"><span style="display: inline-block; position: relative; width: 1.878em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -4.668em; left: 50%; margin-left: 0em;"><span class="mrow" id="MathJax-Span-976"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.66em, 4.399em, -1000em); top: -3.27em; left: 50%; margin-left: -0.879em;"><span class="mrow" id="MathJax-Span-977"><span class="mi" id="MathJax-Span-978" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-979" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-980" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-981" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.827em, 1001.88em, 1.208em, -1000em); top: -1.27em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.878em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.05em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.66em, 4.399em, -1000em); top: -3.27em; left: 50%; margin-left: -0.879em;"><span class="mrow" id="MathJax-Span-982"><span class="mi" id="MathJax-Span-983" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-984" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-985" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-986" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.827em, 1002.24em, 1.208em, -1000em); top: -1.27em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.238em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.05em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.097em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.66em, 4.399em, -1000em); top: -3.27em; left: 50%; margin-left: -0.879em;"><span class="mrow" id="MathJax-Span-987"><span class="mi" id="MathJax-Span-988" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-989" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-990" style="font-family: MathJax_Main;">4</span><span class="mo" id="MathJax-Span-991" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.827em, 1002.6em, 1.208em, -1000em); top: -1.27em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.598em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.05em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.515em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.66em, 4.399em, -1000em); top: -3.27em; left: 50%; margin-left: -0.879em;"><span class="mrow" id="MathJax-Span-992"><span class="mi" id="MathJax-Span-993" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-994" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-995" style="font-family: MathJax_Main;">6</span><span class="mo" id="MathJax-Span-996" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.827em, 1002.96em, 1.208em, -1000em); top: -1.27em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 2.958em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.05em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-997" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-998" style="height: 0em; vertical-align: 0em; width: 2em; display: inline-block; overflow: hidden;"></span><span class="mstyle" id="MathJax-Span-999"><span class="mrow" id="MathJax-Span-1000"><span class="mfrac" id="MathJax-Span-1001"><span style="display: inline-block; position: relative; width: 4.216em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.921em, 1003.98em, 8.519em, -1000em); top: -8.923em; left: 50%; margin-left: -1.988em;"><span class="mstyle" id="MathJax-Span-1002"><span class="mrow" id="MathJax-Span-1003"><span class="mfrac" id="MathJax-Span-1004"><span style="display: inline-block; position: relative; width: 3.736em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.916em, 1003.5em, 6.891em, -1000em); top: -7.295em; left: 50%; margin-left: -1.748em;"><span class="mstyle" id="MathJax-Span-1005"><span class="mrow" id="MathJax-Span-1006"><span class="mfrac" id="MathJax-Span-1007"><span style="display: inline-block; position: relative; width: 3.256em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(1.91em, 1003.02em, 5.263em, -1000em); top: -5.667em; left: 50%; margin-left: -1.508em;"><span class="mstyle" id="MathJax-Span-1008"><span class="mrow" id="MathJax-Span-1009"><span class="mfrac" id="MathJax-Span-1010"><span style="display: inline-block; position: relative; width: 2.776em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.534em, 1000.2em, 4.179em, -1000em); top: -4.668em; left: 50%; margin-left: -0.139em;"><span class="mrow" id="MathJax-Span-1011"><span class="texatom" id="MathJax-Span-1012"><span class="mrow" id="MathJax-Span-1013"></span></span><span class="texatom" id="MathJax-Span-1014"><span class="mrow" id="MathJax-Span-1015"><span class="mo" id="MathJax-Span-1016" style="font-family: MathJax_Main;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1002.44em, 4.399em, -1000em); top: -3.18em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-1017"><span class="mi" id="MathJax-Span-1018" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1019" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1020" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1021" style="font-family: MathJax_Main;">5</span><span class="mo" id="MathJax-Span-1022" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1002.78em, 1.261em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 2.3px solid; width: 2.776em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.103em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.044em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1002.44em, 4.399em, -1000em); top: -3.18em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-1023"><span class="mi" id="MathJax-Span-1024" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1025" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1026" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1027" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-1028" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1003.26em, 1.261em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 2.3px solid; width: 3.256em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.103em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 5.672em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1002.44em, 4.399em, -1000em); top: -3.18em; left: 50%; margin-left: -1.268em;"><span class="mrow" id="MathJax-Span-1029"><span class="mi" id="MathJax-Span-1030" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1031" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-1032" style="font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1033" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1034" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1003.74em, 1.261em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 2.3px solid; width: 3.736em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.103em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 7.3em;"></span></span><span style="position: absolute; clip: rect(3.084em, 1001.66em, 4.399em, -1000em); top: -3.18em; left: 50%; margin-left: -0.879em;"><span class="mrow" id="MathJax-Span-1035"><span class="mi" id="MathJax-Span-1036" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1037" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1038" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-1039" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(0.825em, 1004.22em, 1.261em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 2.3px solid; width: 4.216em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.103em;"></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.325em; border-left: 0px solid; width: 0px; height: 9.533em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mfrac><mstyle scriptlevel="0" displaystyle="true"><mfrac><mrow></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mspace width="2em"></mspace><mspace width="2em"></mspace><mstyle scriptlevel="0" displaystyle="true"><mfrac linethickness="1.2pt"><mstyle scriptlevel="0" displaystyle="true"><mfrac linethickness="1.2pt"><mstyle scriptlevel="0" displaystyle="true"><mfrac linethickness="1.2pt"><mstyle scriptlevel="0" displaystyle="true"><mfrac linethickness="1.2pt"><mrow><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mo></mo></mrow></mrow><mrow><mi>g</mi><mo stretchy="false">(</mo><mo></mo><mn>5</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mrow><mi>g</mi><mo stretchy="false">(</mo><mo></mo><mn>3</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mrow><mi>g</mi><mo stretchy="false">(</mo><mo></mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle><mrow><mi>g</mi><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></mfrac></mstyle></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-108">\dfrac{
  \dfrac{
    \dfrac{
      \dfrac{}{g(0)}
      }{g(2)}
    }{g(4)}
  }{g(6)}
\qquad\qquad
\genfrac{}{}{1.2pt}0{
  \genfrac{}{}{1.2pt}0{
    \genfrac{}{}{1.2pt}0{
      \genfrac{}{}{1.2pt}0{
          {} {\vdots }
        }{g(-5)}
      }{g(-3)}
    }{g(-1)}
  }{g(1)}</script>
</p>

<p>Note that derivations may not be unique.  For example, in the case of the greatest
solution for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-109-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1040" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1041"><span class="mi" id="MathJax-Span-1042" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-109">g</script>, there are two proof trees that establish <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-110-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1043" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.733em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.64em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1044"><span class="mi" id="MathJax-Span-1045" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1046" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1047" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1048" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-110">g(0)</script>:  one is the finite
proof tree that uses the left-hand rule of [#g-coind-rule] once, the other is the infinite
proof tree that keeps on using the right-hand rule of [#g-coind-rule].</p>

<h4 id="2342-working-with-extreme-predicates">23.4.2. Working with Extreme Predicates</h4>

<p>In general, one cannot evaluate whether or not an extreme predicate holds for some
input, because doing so may take an infinite number of steps.  For example, following
the recursive calls in the definition [#eq-EvenNat] to try to evaluate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-111-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;7&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1049" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.733em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.64em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1050"><span class="mi" id="MathJax-Span-1051" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1052" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1053" style="font-family: MathJax_Main;">7</span><span class="mo" id="MathJax-Span-1054" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-111">g(7)</script> would never
terminate.  However, there are useful ways to establish that an extreme predicate holds
and there are ways to make use of one once it has been established.</p>

<p>For any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-112-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1055" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-1056"><span class="texatom" id="MathJax-Span-1057"><span class="mrow" id="MathJax-Span-1058"><span class="mi" id="MathJax-Span-1059" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-112">\mathcal{F}</script> as in [#eq-general], I define two infinite series of well-founded
functions, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-113-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1060" style="width: 1.893em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.576em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.155em, 1001.58em, 2.612em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1061"><span class="msubsup" id="MathJax-Span-1062"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1063"><span class="mrow" id="MathJax-Span-1064"><span class="msubsup" id="MathJax-Span-1065"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1066"><span class="mrow" id="MathJax-Span-1067"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1068"><span class="mrow" id="MathJax-Span-1069"><span class="mi" id="MathJax-Span-1070" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1071" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1072" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1073" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.358em; border-left: 0px solid; width: 0px; height: 1.483em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-113">{ {}^{\flat}!f}_k</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-114-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1074" style="width: 1.893em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.576em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.174em, 1001.58em, 2.612em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1075"><span class="msubsup" id="MathJax-Span-1076"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.96em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1077"><span class="mrow" id="MathJax-Span-1078"><span class="msubsup" id="MathJax-Span-1079"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1080"><span class="mrow" id="MathJax-Span-1081"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1082"><span class="mrow" id="MathJax-Span-1083"><span class="mi" id="MathJax-Span-1084" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1085" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1086" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1087" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.358em; border-left: 0px solid; width: 0px; height: 1.46em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-114">{ {}^{\sharp}!f}_k</script>
where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-115-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1088" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.354em, 1000.51em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1089"><span class="mi" id="MathJax-Span-1090" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-115">k</script> ranges over the natural numbers:</p>

<p>~ Equation {#eq-least-approx}</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-116-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;a&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;l&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;s&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1091" style="width: 17.65em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.811em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.761em, 1014.68em, 4.672em, -1000em); top: -3.466em; left: 0em;"><span class="mrow" id="MathJax-Span-1092"><span class="msubsup" id="MathJax-Span-1093"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1094"><span class="mrow" id="MathJax-Span-1095"><span class="msubsup" id="MathJax-Span-1096"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1097"><span class="mrow" id="MathJax-Span-1098"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1099"><span class="mrow" id="MathJax-Span-1100"><span class="mi" id="MathJax-Span-1101" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1102" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1103" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1104" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1105" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1106" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1107" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1108" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mrow" id="MathJax-Span-1109" style="padding-left: 0.278em;"><span class="mo" id="MathJax-Span-1110" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">{</span></span><span class="mtable" id="MathJax-Span-1111" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 9.166em; height: 0px;"><span style="position: absolute; clip: rect(2.381em, 1004.88em, 5.197em, -1000em); top: -3.992em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.977em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1001.95em, 4.353em, -1000em); top: -4.739em; left: 0em;"><span class="mtd" id="MathJax-Span-1112"><span class="mrow" id="MathJax-Span-1113"><span class="texatom" id="MathJax-Span-1114"><span class="mrow" id="MathJax-Span-1115"><span class="mi" id="MathJax-Span-1116" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-1117" style="font-family: MathJax_Main; font-style: italic;">a</span><span class="mi" id="MathJax-Span-1118" style="font-family: MathJax_Main; font-style: italic;">l</span><span class="mi" id="MathJax-Span-1119" style="font-family: MathJax_Main; font-style: italic;">s</span><span class="mi" id="MathJax-Span-1120" style="font-family: MathJax_Main; font-style: italic;">e</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(2.941em, 1004.88em, 4.447em, -1000em); top: -3.242em; left: 0em;"><span class="mtd" id="MathJax-Span-1129"><span class="mrow" id="MathJax-Span-1130"><span class="texatom" id="MathJax-Span-1131"><span class="mrow" id="MathJax-Span-1132"><span class="mi" id="MathJax-Span-1133" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-1134" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1135"><span style="display: inline-block; position: relative; width: 2.02em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1136"><span class="mrow" id="MathJax-Span-1137"><span class="msubsup" id="MathJax-Span-1138"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1139"><span class="mrow" id="MathJax-Span-1140"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1141"><span class="mrow" id="MathJax-Span-1142"><span class="mi" id="MathJax-Span-1143" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1144" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1145" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="texatom" id="MathJax-Span-1146"><span class="mrow" id="MathJax-Span-1147"><span class="mi" id="MathJax-Span-1148" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1149" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1150" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1151" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1152" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1153" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1154" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(2.381em, 1003.15em, 4.939em, -1000em); top: -3.992em; left: 5.977em;"><span style="display: inline-block; position: relative; width: 3.189em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1003.15em, 4.171em, -1000em); top: -4.739em; left: 0em;"><span class="mtd" id="MathJax-Span-1121"><span class="mrow" id="MathJax-Span-1122"><span class="texatom" id="MathJax-Span-1123"><span class="mrow" id="MathJax-Span-1124"><span class="mtext" id="MathJax-Span-1125" style="font-family: MathJax_Main;">if&nbsp;</span></span></span><span class="mi" id="MathJax-Span-1126" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1127" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1128" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.129em, 1003.15em, 4.189em, -1000em); top: -3.242em; left: 0em;"><span class="mtd" id="MathJax-Span-1155"><span class="mrow" id="MathJax-Span-1156"><span class="texatom" id="MathJax-Span-1157"><span class="mrow" id="MathJax-Span-1158"><span class="mtext" id="MathJax-Span-1159" style="font-family: MathJax_Main;">if&nbsp;</span></span></span><span class="mi" id="MathJax-Span-1160" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1161" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;</span><span class="mn" id="MathJax-Span-1162" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1163" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">}</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.466em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.309em; border-left: 0px solid; width: 0px; height: 3.214em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">a</mi><mi class="MJX-tex-mathit" mathvariant="italic">l</mi><mi class="MJX-tex-mathit" mathvariant="italic">s</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext>if&nbsp;</mtext></mrow><mi>k</mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext>if&nbsp;</mtext></mrow><mi>k</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr></mtable><mo>}</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-116">
   { {}^{\flat}\!f}_k(x) = \left\{
    \begin{array}{ll}
      \mathit{false}         & \textrm{if } k = 0 \\
      \mathcal{F}({ {}^{\flat}\!f}_{k-1})(x) & \textrm{if } k > 0
    \end{array}
     \right\} </script>.</p>
<p>~
~ Equation {#eq-greatest-approx}</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-117-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;{&lt;/mo&gt;&lt;mtable columnalign=&quot;left left&quot; rowspacing=&quot;4pt&quot; columnspacing=&quot;1em&quot;&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;u&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;mtr&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mtd&gt;&lt;mtd&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;if&amp;#xA0;&lt;/mtext&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/mtd&gt;&lt;/mtr&gt;&lt;/mtable&gt;&lt;mo&gt;}&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1164" style="width: 17.65em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.811em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.773em, 1014.68em, 4.66em, -1000em); top: -3.466em; left: 0em;"><span class="mrow" id="MathJax-Span-1165"><span class="msubsup" id="MathJax-Span-1166"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(2.91em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1167"><span class="mrow" id="MathJax-Span-1168"><span class="msubsup" id="MathJax-Span-1169"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1170"><span class="mrow" id="MathJax-Span-1171"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1172"><span class="mrow" id="MathJax-Span-1173"><span class="mi" id="MathJax-Span-1174" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1175" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1176" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1177" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1178" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1179" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1180" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1181" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mrow" id="MathJax-Span-1182" style="padding-left: 0.278em;"><span class="mo" id="MathJax-Span-1183" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">{</span></span><span class="mtable" id="MathJax-Span-1184" style="padding-right: 0.167em; padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 9.166em; height: 0px;"><span style="position: absolute; clip: rect(2.472em, 1004.88em, 5.185em, -1000em); top: -3.992em; left: 0em;"><span style="display: inline-block; position: relative; width: 4.977em; height: 0px;"><span style="position: absolute; clip: rect(3.208em, 1001.76em, 4.16em, -1000em); top: -4.728em; left: 0em;"><span class="mtd" id="MathJax-Span-1185"><span class="mrow" id="MathJax-Span-1186"><span class="texatom" id="MathJax-Span-1187"><span class="mrow" id="MathJax-Span-1188"><span class="mi" id="MathJax-Span-1189" style="font-family: MathJax_Main; font-style: italic;">t</span><span class="mi" id="MathJax-Span-1190" style="font-family: MathJax_Main; font-style: italic;">r</span><span class="mi" id="MathJax-Span-1191" style="font-family: MathJax_Main; font-style: italic;">u</span><span class="mi" id="MathJax-Span-1192" style="font-family: MathJax_Main; font-style: italic;">e</span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(2.96em, 1004.88em, 4.447em, -1000em); top: -3.254em; left: 0em;"><span class="mtd" id="MathJax-Span-1201"><span class="mrow" id="MathJax-Span-1202"><span class="texatom" id="MathJax-Span-1203"><span class="mrow" id="MathJax-Span-1204"><span class="mi" id="MathJax-Span-1205" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-1206" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-1207"><span style="display: inline-block; position: relative; width: 2.02em; height: 0px;"><span style="position: absolute; clip: rect(2.96em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1208"><span class="mrow" id="MathJax-Span-1209"><span class="msubsup" id="MathJax-Span-1210"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1211"><span class="mrow" id="MathJax-Span-1212"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1213"><span class="mrow" id="MathJax-Span-1214"><span class="mi" id="MathJax-Span-1215" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1216" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1217" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="texatom" id="MathJax-Span-1218"><span class="mrow" id="MathJax-Span-1219"><span class="mi" id="MathJax-Span-1220" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1221" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1222" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1223" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1224" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1225" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1226" style="font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(2.393em, 1003.15em, 4.927em, -1000em); top: -3.992em; left: 5.977em;"><span style="display: inline-block; position: relative; width: 3.189em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1003.15em, 4.171em, -1000em); top: -4.728em; left: 0em;"><span class="mtd" id="MathJax-Span-1193"><span class="mrow" id="MathJax-Span-1194"><span class="texatom" id="MathJax-Span-1195"><span class="mrow" id="MathJax-Span-1196"><span class="mtext" id="MathJax-Span-1197" style="font-family: MathJax_Main;">if&nbsp;</span></span></span><span class="mi" id="MathJax-Span-1198" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1199" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1200" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.129em, 1003.15em, 4.189em, -1000em); top: -3.254em; left: 0em;"><span class="mtd" id="MathJax-Span-1227"><span class="mrow" id="MathJax-Span-1228"><span class="texatom" id="MathJax-Span-1229"><span class="mrow" id="MathJax-Span-1230"><span class="mtext" id="MathJax-Span-1231" style="font-family: MathJax_Main;">if&nbsp;</span></span></span><span class="mi" id="MathJax-Span-1232" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1233" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;</span><span class="mn" id="MathJax-Span-1234" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1235" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">}</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.466em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.296em; border-left: 0px solid; width: 0px; height: 3.186em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mrow><mo>{</mo><mtable columnalign="left left" rowspacing="4pt" columnspacing="1em"><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">u</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext>if&nbsp;</mtext></mrow><mi>k</mi><mo>=</mo><mn>0</mn></mtd></mtr><mtr><mtd><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></mtd><mtd><mrow class="MJX-TeXAtom-ORD"><mtext>if&nbsp;</mtext></mrow><mi>k</mi><mo>&gt;</mo><mn>0</mn></mtd></mtr></mtable><mo>}</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-117">
   { {}^{\sharp}\!f}_k(x) = \left\{
    \begin{array}{ll}
      \mathit{true}          & \textrm{if } k = 0 \\
      \mathcal{F}({ {}^{\sharp}\!f}_{k-1})(x) & \textrm{if } k > 0
    \end{array}
    \right\} </script>.</p>
<p>~</p>

<p>These functions are called the <em>iterates</em> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-118-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1236" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1237"><span class="mi" id="MathJax-Span-1238" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-118">f</script>, and I will also refer to them
as the <em>prefix predicates</em> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-119-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1239" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1240"><span class="mi" id="MathJax-Span-1241" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-119">f</script> (or the <em>prefix predicate</em> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-120-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1242" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1243"><span class="mi" id="MathJax-Span-1244" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-120">f</script>, if we think
of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-121-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1245" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.354em, 1000.51em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1246"><span class="mi" id="MathJax-Span-1247" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-121">k</script> as being a parameter).
Alternatively, we can define <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-122-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1248" style="width: 1.893em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.576em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.155em, 1001.58em, 2.612em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1249"><span class="msubsup" id="MathJax-Span-1250"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1251"><span class="mrow" id="MathJax-Span-1252"><span class="msubsup" id="MathJax-Span-1253"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1254"><span class="mrow" id="MathJax-Span-1255"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1256"><span class="mrow" id="MathJax-Span-1257"><span class="mi" id="MathJax-Span-1258" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1259" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1260" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1261" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.358em; border-left: 0px solid; width: 0px; height: 1.483em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-122">{ {}^{\flat}!f}_k</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-123-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1262" style="width: 1.893em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.576em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.174em, 1001.58em, 2.612em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1263"><span class="msubsup" id="MathJax-Span-1264"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.96em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1265"><span class="mrow" id="MathJax-Span-1266"><span class="msubsup" id="MathJax-Span-1267"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1268"><span class="mrow" id="MathJax-Span-1269"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1270"><span class="mrow" id="MathJax-Span-1271"><span class="mi" id="MathJax-Span-1272" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1273" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1274" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1275" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.358em; border-left: 0px solid; width: 0px; height: 1.46em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-123">{ {}^{\sharp}!f}_k</script> without mentioning <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-124-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1276" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.53em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1277"><span class="mi" id="MathJax-Span-1278" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-124">x</script>:
Let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-125-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1279" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1280"><span class="mi" id="MathJax-Span-1281" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-125">\bot</script> denote the function that always returns <code>false</code>, let <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-126-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1282" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.538em, 1000.73em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1283"><span class="mi" id="MathJax-Span-1284" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.92em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-126">\top</script>
denote the function that always returns <code>true</code>, and let a superscript on <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-127-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1285" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-1286"><span class="texatom" id="MathJax-Span-1287"><span class="mrow" id="MathJax-Span-1288"><span class="mi" id="MathJax-Span-1289" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-127">\mathcal{F}</script> denote
exponentiation (for example, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-128-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1290" style="width: 5.465em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.569em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.325em, 1004.57em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1291"><span class="msubsup" id="MathJax-Span-1292"><span style="display: inline-block; position: relative; width: 1.341em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1293"><span class="mrow" id="MathJax-Span-1294"><span class="mi" id="MathJax-Span-1295" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mn" id="MathJax-Span-1296" style="font-size: 70.7%; font-family: MathJax_Main;">0</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1297" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1298" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-1299" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1300" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-1301" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.471em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mn>0</mn></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-128">\mathcal{F}^0(f) = f</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-129-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1302" style="width: 9.246em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.773em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.325em, 1007.68em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1303"><span class="msubsup" id="MathJax-Span-1304"><span style="display: inline-block; position: relative; width: 1.341em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1305"><span class="mrow" id="MathJax-Span-1306"><span class="mi" id="MathJax-Span-1307" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mn" id="MathJax-Span-1308" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1309" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1310" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-1311" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1312" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-1313" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-1314"><span class="mi" id="MathJax-Span-1315" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-1316" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-1317"><span class="mrow" id="MathJax-Span-1318"><span class="mi" id="MathJax-Span-1319" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span class="mo" id="MathJax-Span-1320" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1321" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-1322" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1323" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.471em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mn>2</mn></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-129">\mathcal{F}^2(f) = \mathcal{F}(\mathcal{F}(f))</script>).
Then, [#eq-least-approx] and [#eq-greatest-approx] can be stated equivalently as
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-130-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A5;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1324" style="width: 6.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.83em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.305em, 1005.74em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1325"><span class="msubsup" id="MathJax-Span-1326"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1327"><span class="mrow" id="MathJax-Span-1328"><span class="msubsup" id="MathJax-Span-1329"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1330"><span class="mrow" id="MathJax-Span-1331"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1332"><span class="mrow" id="MathJax-Span-1333"><span class="mi" id="MathJax-Span-1334" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1335" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1336" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1337" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1338" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1339" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.355em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1340"><span class="mrow" id="MathJax-Span-1341"><span class="mi" id="MathJax-Span-1342" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mi" id="MathJax-Span-1343" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1344" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1345" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-1346" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mi>k</mi></msup><mo stretchy="false">(</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-130">{ {}^{\flat}!f}_k = \mathcal{F}^k(\bot)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-131-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1347" style="width: 6.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.83em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.305em, 1005.74em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1348"><span class="msubsup" id="MathJax-Span-1349"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.96em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1350"><span class="mrow" id="MathJax-Span-1351"><span class="msubsup" id="MathJax-Span-1352"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1353"><span class="mrow" id="MathJax-Span-1354"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1355"><span class="mrow" id="MathJax-Span-1356"><span class="mi" id="MathJax-Span-1357" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1358" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1359" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1360" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1361" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-1362" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.355em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1363"><span class="mrow" id="MathJax-Span-1364"><span class="mi" id="MathJax-Span-1365" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mi" id="MathJax-Span-1366" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1367" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1368" style="font-family: MathJax_Main;"></span><span class="mo" id="MathJax-Span-1369" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.494em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mi>k</mi></msup><mo stretchy="false">(</mo><mi mathvariant="normal"></mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-131">{ {}^{\sharp}!f}_k = \mathcal{F}^k(\top)</script>.</p>

<p>For any solution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-132-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1370" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1371"><span class="mi" id="MathJax-Span-1372" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-132">f</script> to equation [#eq-general], we have, for any <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-133-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1373" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.354em, 1000.51em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1374"><span class="mi" id="MathJax-Span-1375" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-133">k</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-134-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1376" style="width: 0.528em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.42em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.501em, 1000.4em, 2.541em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1377"><span class="mi" id="MathJax-Span-1378" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.086em; border-left: 0px solid; width: 0px; height: 0.988em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi></mi></math></span></span><script type="math/tex" id="MathJax-Element-134">\ell</script>
such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-135-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1379" style="width: 2.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.258em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.501em, 1002.24em, 2.659em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1380"><span class="mi" id="MathJax-Span-1381" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1382" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-1383" style="font-family: MathJax_Main; padding-left: 0.278em;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.227em; border-left: 0px solid; width: 0px; height: 1.128em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo></mo><mi></mi></math></span></span><script type="math/tex" id="MathJax-Element-135">k \leq \ell</script>:</p>

<p>Equation {#eq-prefix-postfix}</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-136-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;&amp;#x2113;&lt;/mi&gt;&lt;/msub&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x21D2;&lt;/mo&gt;&lt;mo&gt;&amp;#x02D9;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mspace width=&quot;1em&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1384" style="width: 22.744em; display: inline-block;"><span style="display: inline-block; position: relative; width: 19.118em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.105em, 1019.12em, 2.618em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1385"><span class="msubsup" id="MathJax-Span-1386"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1387"><span class="mrow" id="MathJax-Span-1388"><span class="msubsup" id="MathJax-Span-1389"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1390"><span class="mrow" id="MathJax-Span-1391"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1392"><span class="mrow" id="MathJax-Span-1393"><span class="mi" id="MathJax-Span-1394" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1395" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1396" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1397" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1398" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1399" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-1400"><span class="mrow" id="MathJax-Span-1401"><span class="munderover" id="MathJax-Span-1402"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-1403" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-1404" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-1405" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1406" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1407"><span style="display: inline-block; position: relative; width: 1.043em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1408"><span class="mrow" id="MathJax-Span-1409"><span class="msubsup" id="MathJax-Span-1410"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1411"><span class="mrow" id="MathJax-Span-1412"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1413"><span class="mrow" id="MathJax-Span-1414"><span class="mi" id="MathJax-Span-1415" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1416" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1417" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1418" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1419" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1420" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-1421"><span class="mrow" id="MathJax-Span-1422"><span class="munderover" id="MathJax-Span-1423"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-1424" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-1425" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-1426" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1427" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1428" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mspace" id="MathJax-Span-1429" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1430" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-1431"><span class="mrow" id="MathJax-Span-1432"><span class="munderover" id="MathJax-Span-1433"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-1434" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-1435" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-1436" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1437" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1438"><span style="display: inline-block; position: relative; width: 1.043em; height: 0px;"><span style="position: absolute; clip: rect(2.91em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1439"><span class="mrow" id="MathJax-Span-1440"><span class="msubsup" id="MathJax-Span-1441"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1442"><span class="mrow" id="MathJax-Span-1443"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1444"><span class="mrow" id="MathJax-Span-1445"><span class="mi" id="MathJax-Span-1446" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1447" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1448" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1449" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1450" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1451" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="texatom" id="MathJax-Span-1452"><span class="mrow" id="MathJax-Span-1453"><span class="munderover" id="MathJax-Span-1454"><span style="display: inline-block; position: relative; width: 1em; height: 0px;"><span style="position: absolute; clip: rect(3.309em, 1000.94em, 4.173em, -1000em); top: -3.992em; left: 0em;"><span class="mo" id="MathJax-Span-1455" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; clip: rect(3.165em, 1000.31em, 3.6em, -1000em); top: -4.099em; left: 0.25em;"><span class="mo" id="MathJax-Span-1456" style="font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span></span><span class="mspace" id="MathJax-Span-1457" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mspace" id="MathJax-Span-1458" style="height: 0em; vertical-align: 0em; width: 1em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1459"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(2.91em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1460"><span class="mrow" id="MathJax-Span-1461"><span class="msubsup" id="MathJax-Span-1462"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1463"><span class="mrow" id="MathJax-Span-1464"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1465"><span class="mrow" id="MathJax-Span-1466"><span class="mi" id="MathJax-Span-1467" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1468" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1469" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1470" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.365em; border-left: 0px solid; width: 0px; height: 1.55em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi>k</mi></msub><mspace width="1em"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow><mspace width="thickmathspace"></mspace><mspace width="1em"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi></mi></msub><mspace width="1em"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow><mspace width="thickmathspace"></mspace><mspace width="1em"></mspace><mi>f</mi><mspace width="1em"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow><mspace width="thickmathspace"></mspace><mspace width="1em"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi></mi></msub><mspace width="1em"></mspace><mspace width="thickmathspace"></mspace><mrow class="MJX-TeXAtom-ORD"><mover><mo stretchy="false"></mo><mo></mo></mover></mrow><mspace width="thickmathspace"></mspace><mspace width="1em"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi>k</mi></msub></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-136">
 { {}^{\flat}\!f}_k    \quad\;\dot{\Rightarrow}\;\quad { {}^{\flat}\!f}_\ell \quad\;\dot{\Rightarrow}\;\quad f      \quad\;\dot{\Rightarrow}\;\quad { {}^{\sharp}\!f}_\ell \quad\;\dot{\Rightarrow}\;\quad { {}^{\sharp}\!f}_k </script></p>

<p>In other words, every ${ {}^{\flat}!f}<em>k$ is a _pre-fixpoint</em> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-137-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1471" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1472"><span class="mi" id="MathJax-Span-1473" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-137">f</script> and every ${ {}^{\sharp}!f}<em>k$ is a _post-fixpoint</em>
of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-138-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1474" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1475"><span class="mi" id="MathJax-Span-1476" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-138">f</script>.  Next, I define two functions, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-139-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1477" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1001.05em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1478"><span class="msubsup" id="MathJax-Span-1479"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1480" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1481"><span class="mrow" id="MathJax-Span-1482"><span class="mo" id="MathJax-Span-1483" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-139">f^{\downarrow}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-140-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1484" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1001.05em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1485"><span class="msubsup" id="MathJax-Span-1486"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1487" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1488"><span class="mrow" id="MathJax-Span-1489"><span class="mo" id="MathJax-Span-1490" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-140">f^{\uparrow}</script>, in
terms of the prefix predicates:</p>

<p>Equation {#eq-least-is-exists}</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-141-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2203;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1491" style="width: 10.769em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.034em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.263em, 1008.94em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1492"><span class="msubsup" id="MathJax-Span-1493"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1494" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1495"><span class="mrow" id="MathJax-Span-1496"><span class="mo" id="MathJax-Span-1497" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1498" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1499" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1500" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1501" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1502" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mspace" id="MathJax-Span-1503" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1504" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-1505" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1506" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-1507" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1508" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(2.891em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1509"><span class="mrow" id="MathJax-Span-1510"><span class="msubsup" id="MathJax-Span-1511"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1512"><span class="mrow" id="MathJax-Span-1513"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1514"><span class="mrow" id="MathJax-Span-1515"><span class="mi" id="MathJax-Span-1516" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1517" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1518" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1519" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1520" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1521" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1522" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.545em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo>=</mo><mspace width="thickmathspace"></mspace><mi mathvariant="normal"></mi><mi>k</mi><mo></mo><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-141">
 f^{\downarrow}(x) \;=\;  \exists k \bullet\; { {}^{\flat}\!f}_k(x) </script></p>
<p>Equation {#eq-greatest-is-forall}</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-142-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mspace width=&quot;negativethinmathspace&quot; /&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1523" style="width: 10.769em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.034em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.282em, 1008.94em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1524"><span class="msubsup" id="MathJax-Span-1525"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1526" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1527"><span class="mrow" id="MathJax-Span-1528"><span class="mo" id="MathJax-Span-1529" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1530" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1531" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1532" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1533" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1534" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mspace" id="MathJax-Span-1535" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1536" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-1537" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1538" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-1539" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1540" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.117em; height: 0px;"><span style="position: absolute; clip: rect(2.91em, 1000.73em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1541"><span class="mrow" id="MathJax-Span-1542"><span class="msubsup" id="MathJax-Span-1543"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1544"><span class="mrow" id="MathJax-Span-1545"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.404em; left: 0em;"><span class="texatom" id="MathJax-Span-1546"><span class="mrow" id="MathJax-Span-1547"><span class="mi" id="MathJax-Span-1548" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mspace" id="MathJax-Span-1549" style="height: 0em; vertical-align: 0em; margin-left: -0.167em;"></span><span class="mi" id="MathJax-Span-1550" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 0.673em;"><span class="mi" id="MathJax-Span-1551" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1552" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1553" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1554" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.522em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo>=</mo><mspace width="thickmathspace"></mspace><mi mathvariant="normal"></mi><mi>k</mi><mo></mo><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mspace width="negativethinmathspace"></mspace><mi>f</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-142">
  f^{\uparrow}(x) \;=\;  \forall k \bullet\; { {}^{\sharp}\!f}_k(x) </script></p>

<p>By [#eq-prefix-postfix], we also have that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-143-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1555" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1001.05em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1556"><span class="msubsup" id="MathJax-Span-1557"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1558" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1559"><span class="mrow" id="MathJax-Span-1560"><span class="mo" id="MathJax-Span-1561" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-143">f^{\downarrow}</script> is a pre-fixpoint of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-144-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1562" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-1563"><span class="texatom" id="MathJax-Span-1564"><span class="mrow" id="MathJax-Span-1565"><span class="mi" id="MathJax-Span-1566" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-144">\mathcal{F}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-145-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1567" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1001.05em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1568"><span class="msubsup" id="MathJax-Span-1569"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1570" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1571"><span class="mrow" id="MathJax-Span-1572"><span class="mo" id="MathJax-Span-1573" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-145">f^{\uparrow}</script>
is a post-fixpoint of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-146-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1574" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-1575"><span class="texatom" id="MathJax-Span-1576"><span class="mrow" id="MathJax-Span-1577"><span class="mi" id="MathJax-Span-1578" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-146">\mathcal{F}</script>.  The marvelous thing is that, if <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-147-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1579" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-1580"><span class="texatom" id="MathJax-Span-1581"><span class="mrow" id="MathJax-Span-1582"><span class="mi" id="MathJax-Span-1583" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-147">\mathcal{F}</script> is <em>continuous</em>, then
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-148-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1584" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1001.05em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1585"><span class="msubsup" id="MathJax-Span-1586"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1587" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1588"><span class="mrow" id="MathJax-Span-1589"><span class="mo" id="MathJax-Span-1590" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-148">f^{\downarrow}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-149-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1591" style="width: 1.263em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.05em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1001.05em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1592"><span class="msubsup" id="MathJax-Span-1593"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1594" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1595"><span class="mrow" id="MathJax-Span-1596"><span class="mo" id="MathJax-Span-1597" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-149">f^{\uparrow}</script> are the least and greatest fixpoints of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-150-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1598" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.418em, 1000.84em, 2.448em, -1000em); top: -2.258em; left: 0em;"><span class="mrow" id="MathJax-Span-1599"><span class="texatom" id="MathJax-Span-1600"><span class="mrow" id="MathJax-Span-1601"><span class="mi" id="MathJax-Span-1602" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.258em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.101em; border-left: 0px solid; width: 0px; height: 0.976em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-150">\mathcal{F}</script>.
These equations let us do proofs by induction when dealing with extreme predicates.
I will explain in Section [#sec-friendliness] how to check for continuity.</p>

<p>Lets consider two examples, both involving function <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-151-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1603" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1604"><span class="mi" id="MathJax-Span-1605" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-151">g</script> in
[#eq-EvenNat].  As it turns out, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-152-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1606" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1607"><span class="mi" id="MathJax-Span-1608" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-152">g</script>s defining functor is continuous,
and therefore I will write <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-153-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1609" style="width: 1.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1000.95em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1610"><span class="msubsup" id="MathJax-Span-1611"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1612" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1613"><span class="mrow" id="MathJax-Span-1614"><span class="mo" id="MathJax-Span-1615" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-153">g^{\downarrow}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-154-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1616" style="width: 1.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1000.95em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1617"><span class="msubsup" id="MathJax-Span-1618"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1619" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1620"><span class="mrow" id="MathJax-Span-1621"><span class="mo" id="MathJax-Span-1622" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-154">g^{\uparrow}</script> to denote the
least and greatest solutions for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-155-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1623" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1624"><span class="mi" id="MathJax-Span-1625" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-155">g</script> in [#eq-EvenNat].</p>

<h5 id="sec-example-least-solution">23.4.2.1. Example with Least Solution</h5>

<p>The main technique for establishing that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-156-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1626" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1627"><span class="msubsup" id="MathJax-Span-1628"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1629" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1630"><span class="mrow" id="MathJax-Span-1631"><span class="mo" id="MathJax-Span-1632" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1633" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1634" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1635" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-156">g^{\downarrow}(x)</script> holds for some
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-157-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1636" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.53em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1637"><span class="mi" id="MathJax-Span-1638" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.664em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-157">x</script>, that is, proving something of the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-158-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1639" style="width: 6.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.83em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1005.74em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1640"><span class="mi" id="MathJax-Span-1641" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mspace" id="MathJax-Span-1642" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1643" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-1644" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1645" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1646" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1647"><span class="mrow" id="MathJax-Span-1648"><span class="mo" id="MathJax-Span-1649" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1650" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1651" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1652" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-158">Q \;\Longrightarrow\; g^{\downarrow}(x)</script>, is to
construct a proof tree like the one for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-159-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mn&gt;6&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1653" style="width: 2.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.733em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.64em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1654"><span class="mi" id="MathJax-Span-1655" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-1656" style="font-family: MathJax_Main;">(</span><span class="mn" id="MathJax-Span-1657" style="font-family: MathJax_Main;">6</span><span class="mo" id="MathJax-Span-1658" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-159">g(6)</script> in Figure
[#fig-proof-trees].  For a proof in this direction, since were just
applying the defining equation, the fact that
were using a least solution for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-160-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1659" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1660"><span class="mi" id="MathJax-Span-1661" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-160">g</script> never plays a role (as long as we
limit ourselves to finite derivations).</p>

<p>The technique for going in the other direction, proving something <em>from</em> an established
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-161-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1662" style="width: 1.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1000.95em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1663"><span class="msubsup" id="MathJax-Span-1664"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1665" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1666"><span class="mrow" id="MathJax-Span-1667"><span class="mo" id="MathJax-Span-1668" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-161">g^{\downarrow}</script> property, that is, showing something of the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-162-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1669" style="width: 6.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.83em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1005.83em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1670"><span class="msubsup" id="MathJax-Span-1671"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1672" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1673"><span class="mrow" id="MathJax-Span-1674"><span class="mo" id="MathJax-Span-1675" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1676" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1677" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1678" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1679" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1680" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-1681" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1682" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-162">g^{\downarrow}(x) \;\Longrightarrow\; R</script>, typically
uses induction on the structure of the proof tree.  When the antecedent of our proof
obligation includes a predicate term <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-163-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1683" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1684"><span class="msubsup" id="MathJax-Span-1685"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1686" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1687"><span class="mrow" id="MathJax-Span-1688"><span class="mo" id="MathJax-Span-1689" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1690" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1691" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1692" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-163">g^{\downarrow}(x)</script>, it is sound to
imagine that we have been given a proof tree for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-164-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1693" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1694"><span class="msubsup" id="MathJax-Span-1695"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1696" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1697"><span class="mrow" id="MathJax-Span-1698"><span class="mo" id="MathJax-Span-1699" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1700" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1701" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1702" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-164">g^{\downarrow}(x)</script>.  Such a proof tree
would be a data structureto be more precise, a term in an
<em>inductive datatype</em>.
Least solutions like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-165-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1703" style="width: 1.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1000.95em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1704"><span class="msubsup" id="MathJax-Span-1705"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1706" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1707"><span class="mrow" id="MathJax-Span-1708"><span class="mo" id="MathJax-Span-1709" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-165">g^{\downarrow}</script> have been given the
name <em>least predicate</em>.</p>

<p>Lets prove <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-166-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1710" style="width: 14.183em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.922em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1011.91em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1711"><span class="msubsup" id="MathJax-Span-1712"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1713" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1714"><span class="mrow" id="MathJax-Span-1715"><span class="mo" id="MathJax-Span-1716" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1717" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1718" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1719" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1720" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1721" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-1722" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-1723" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-1724" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-1725" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mspace" id="MathJax-Span-1726" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1727" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-1728" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1729" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="texatom" id="MathJax-Span-1730"><span class="mrow" id="MathJax-Span-1731"><span class="mtext" id="MathJax-Span-1732" style="font-family: MathJax_Main;">&nbsp;even</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mn>0</mn><mo></mo><mi>x</mi><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-166">g^{\downarrow}(x) \;\Longrightarrow\; 0 \leq x \;\wedge\; x \textrm{ even}</script>.
We split our task into two cases, corresponding to which of the two
proof rules in [#g-ind-rule] was the
last one applied to establish <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-167-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1733" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1734"><span class="msubsup" id="MathJax-Span-1735"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1736" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1737"><span class="mrow" id="MathJax-Span-1738"><span class="mo" id="MathJax-Span-1739" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1740" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1741" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1742" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-167">g^{\downarrow}(x)</script>.  If it was the left-hand rule, then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-168-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1743" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.38em, 2.543em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1744"><span class="mi" id="MathJax-Span-1745" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1746" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1747" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 0.944em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-168">x=0</script>,
which makes it easy to establish the conclusion of our proof goal.  If it was the
right-hand rule, then we unfold the proof tree one level and obtain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-169-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1748" style="width: 4.835em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1003.95em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1749"><span class="msubsup" id="MathJax-Span-1750"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1751" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1752"><span class="mrow" id="MathJax-Span-1753"><span class="mo" id="MathJax-Span-1754" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1755" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1756" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1757" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1758" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-1759" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-169">g^{\downarrow}(x-2)</script>.
Since the proof tree for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-170-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2193;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1760" style="width: 4.835em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1003.95em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1761"><span class="msubsup" id="MathJax-Span-1762"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1763" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-1764"><span class="mrow" id="MathJax-Span-1765"><span class="mo" id="MathJax-Span-1766" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1767" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1768" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1769" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1770" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-1771" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-170">g^{\downarrow}(x-2)</script> is smaller than where we started, we invoke
the <em>induction hypothesis</em> and obtain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-171-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1772" style="width: 14.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.87em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1011.86em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1773"><span class="mn" id="MathJax-Span-1774" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1775" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-1776" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-1777" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1778" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1779" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-1780" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1781" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1782" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-1783" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1784" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-1785" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1786" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1787" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-1788" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-1789"><span class="mrow" id="MathJax-Span-1790"><span class="mtext" id="MathJax-Span-1791" style="font-family: MathJax_Main;">&nbsp;even</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo></mo><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-171">0 \leq (x-2) \;\wedge\; (x-2) \textrm{ even}</script>, from which
it is easy to establish the conclusion of our proof goal.</p>

<p>Heres how we do the proof formally using [#eq-least-is-exists].  We massage the
general form of our proof goal:</p>

<table>
  <tbody>
    <tr>
      <td>&nbsp;</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-172-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1792" style="width: 7.04em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.882em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1005.88em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1793"><span class="msubsup" id="MathJax-Span-1794"><span style="display: inline-block; position: relative; width: 1.047em; height: 0px;"><span style="position: absolute; clip: rect(3.129em, 1000.55em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-1795" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.618em;"><span class="texatom" id="MathJax-Span-1796"><span class="mrow" id="MathJax-Span-1797"><span class="mo" id="MathJax-Span-1798" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1799" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1800" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1801" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1802" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1803" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-1804" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1805" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-172">f^{\uparrow}(x) \;\Longrightarrow\; R</script></td>
    </tr>
    <tr>
      <td>=</td>
      <td>&nbsp;&nbsp;&nbsp;&nbsp; { [#eq-least-is-exists] }</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-173-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2203;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1806" style="width: 11.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.506em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.313em, 1009.5em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1807"><span class="mo" id="MathJax-Span-1808" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1809" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1810" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1811" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-1812" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-1813" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1814"><span class="mrow" id="MathJax-Span-1815"><span class="msubsup" id="MathJax-Span-1816"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1817"><span class="mrow" id="MathJax-Span-1818"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1819"><span class="mrow" id="MathJax-Span-1820"><span class="mi" id="MathJax-Span-1821" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1822" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1823" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1824" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1825" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1826" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1827" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1828" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1829" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1830" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-1831" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1832" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.485em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi mathvariant="normal"></mi><mi>k</mi><mo></mo><mspace width="thickmathspace"></mspace><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-173">(\exists k \bullet\; { {}^{\flat}!f}_k(x)) \;\Longrightarrow\; R</script></td>
    </tr>
    <tr>
      <td>=</td>
      <td>&nbsp;&nbsp;&nbsp;&nbsp; { distribute <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-174-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1833" style="width: 2.629em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.206em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.681em, 1002.21em, 2.545em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1834"><span class="mspace" id="MathJax-Span-1835" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1836" style="font-family: MathJax_Main;"></span><span class="mspace" id="MathJax-Span-1837" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.091em; border-left: 0px solid; width: 0px; height: 0.778em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace></math></span></span><script type="math/tex" id="MathJax-Element-174">\;\Longrightarrow\;</script> over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-175-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2203;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1838" style="width: 0.685em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.578em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.512em, 1000.52em, 2.521em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1839"><span class="mi" id="MathJax-Span-1840" style="font-family: MathJax_Main;"></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.951em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi></math></span></span><script type="math/tex" id="MathJax-Element-175">\exists</script> to the left }</td>
    </tr>
    <tr>
      <td>&nbsp;</td>
      <td><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-176-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1841" style="width: 11.347em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.506em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.313em, 1009.41em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1842"><span class="mi" id="MathJax-Span-1843" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-1844" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1845" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-1846" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1847" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="msubsup" id="MathJax-Span-1848"><span style="display: inline-block; position: relative; width: 1.561em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.18em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1849"><span class="mrow" id="MathJax-Span-1850"><span class="msubsup" id="MathJax-Span-1851"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1852"><span class="mrow" id="MathJax-Span-1853"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1854"><span class="mrow" id="MathJax-Span-1855"><span class="mi" id="MathJax-Span-1856" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1857" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1858" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.118em;"><span class="mi" id="MathJax-Span-1859" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1860" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1861" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1862" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1863" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1864" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-1865" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-1866" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span><span class="mo" id="MathJax-Span-1867" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.485em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi><mi>k</mi><mo></mo><mspace width="thickmathspace"></mspace><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>f</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>R</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-176">\forall k \bullet\; ({ {}^{\flat}!f}_k(x) \;\Longrightarrow\; R)</script></td>
    </tr>
  </tbody>
</table>

<p>The last line can be proved by induction over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-177-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1868" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.354em, 1000.51em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1869"><span class="mi" id="MathJax-Span-1870" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-177">k</script>.  So, in our case, we prove
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-178-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1871" style="width: 13.606em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.397em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.313em, 1011.38em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1872"><span class="msubsup" id="MathJax-Span-1873"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.11em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1874"><span class="mrow" id="MathJax-Span-1875"><span class="msubsup" id="MathJax-Span-1876"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1877"><span class="mrow" id="MathJax-Span-1878"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1879"><span class="mrow" id="MathJax-Span-1880"><span class="mi" id="MathJax-Span-1881" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1882" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1883" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.105em;"><span class="mi" id="MathJax-Span-1884" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1885" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1886" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1887" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1888" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mn" id="MathJax-Span-1889" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-1890" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-1891" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">x</span><span class="mo" id="MathJax-Span-1892" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mi" id="MathJax-Span-1893" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">x</span><span class="texatom" id="MathJax-Span-1894"><span class="mrow" id="MathJax-Span-1895"><span class="mtext" id="MathJax-Span-1896" style="font-family: MathJax_Main;">&nbsp;even</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.485em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>g</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false"></mo><mn>0</mn><mo></mo><mi>x</mi><mo></mo><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-178">{ {}^{\flat}!g}_k(x) \Longrightarrow 0 \leq x \wedge x \textrm{ even}</script> for every <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-179-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1897" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.354em, 1000.51em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-1898"><span class="mi" id="MathJax-Span-1899" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-179">k</script>.
If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-180-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1900" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.363em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.512em, 1002.32em, 2.543em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1901"><span class="mi" id="MathJax-Span-1902" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1903" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1904" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 0.977em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-180">k = 0</script>, then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-181-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1905" style="width: 3.469em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.889em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.313em, 1002.79em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1906"><span class="msubsup" id="MathJax-Span-1907"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.11em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1908"><span class="mrow" id="MathJax-Span-1909"><span class="msubsup" id="MathJax-Span-1910"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1911"><span class="mrow" id="MathJax-Span-1912"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1913"><span class="mrow" id="MathJax-Span-1914"><span class="mi" id="MathJax-Span-1915" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1916" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1917" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.105em;"><span class="mi" id="MathJax-Span-1918" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1919" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1920" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1921" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.485em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>g</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-181">{ {}^{\flat}!g}_k(x)</script> is <code>false</code>, so our goal holds trivially.
If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-182-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;gt;&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1922" style="width: 2.839em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.363em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.512em, 1002.32em, 2.561em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1923"><span class="mi" id="MathJax-Span-1924" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1925" style="font-family: MathJax_Main; padding-left: 0.278em;">&gt;</span><span class="mn" id="MathJax-Span-1926" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.11em; border-left: 0px solid; width: 0px; height: 0.998em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo>&gt;</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-182">k > 0</script>, then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-183-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;mo&gt;&amp;#x2228;&lt;/mo&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1927" style="width: 18.227em; display: inline-block;"><span style="display: inline-block; position: relative; width: 15.284em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.313em, 1015.19em, 2.819em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1928"><span class="msubsup" id="MathJax-Span-1929"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.11em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1930"><span class="mrow" id="MathJax-Span-1931"><span class="msubsup" id="MathJax-Span-1932"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1933"><span class="mrow" id="MathJax-Span-1934"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1935"><span class="mrow" id="MathJax-Span-1936"><span class="mi" id="MathJax-Span-1937" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1938" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1939" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.105em;"><span class="mi" id="MathJax-Span-1940" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1941" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1942" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1943" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1944" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-1945" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-1946" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1947" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1948" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span><span class="mo" id="MathJax-Span-1949" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="mo" id="MathJax-Span-1950" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-1951" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="msubsup" id="MathJax-Span-1952" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.452em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.11em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1953"><span class="mrow" id="MathJax-Span-1954"><span class="msubsup" id="MathJax-Span-1955"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-1956"><span class="mrow" id="MathJax-Span-1957"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-1958"><span class="mrow" id="MathJax-Span-1959"><span class="mi" id="MathJax-Span-1960" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1961" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-1962" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.105em;"><span class="texatom" id="MathJax-Span-1963"><span class="mrow" id="MathJax-Span-1964"><span class="mi" id="MathJax-Span-1965" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1966" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span class="mn" id="MathJax-Span-1967" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-1968" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-1969" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1970" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1971" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-1972" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-1973" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.418em; border-left: 0px solid; width: 0px; height: 1.543em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>g</mi></mrow><mi>k</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>x</mi><mo>=</mo><mn>0</mn><mo>:</mo><mo></mo><mo>:</mo><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>g</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mi>k</mi><mo></mo><mn>1</mn></mrow></msub><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-183">{ {}^{\flat}!g}_k(x) = (x = 0 :\vee: { {}^{\flat}!g}_{k-1}(x-2))</script>.  Our goal holds easily
for the first disjunct (<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-184-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1974" style="width: 2.891em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.416em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.38em, 2.543em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1975"><span class="mi" id="MathJax-Span-1976" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1977" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-1978" style="font-family: MathJax_Main; padding-left: 0.278em;">0</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.089em; border-left: 0px solid; width: 0px; height: 0.944em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>=</mo><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-184">x=0</script>).  For the other disjunct,
we apply the induction hypothesis (on the smaller <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-185-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1979" style="width: 2.681em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.258em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.512em, 1002.19em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1980"><span class="mi" id="MathJax-Span-1981" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-1982" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1983" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.048em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi><mo></mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-185">k-1</script> and with <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-186-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1984" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1002.26em, 2.603em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1985"><span class="mi" id="MathJax-Span-1986" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1987" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1988" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.16em; border-left: 0px solid; width: 0px; height: 1.015em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo></mo><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-186">x-2</script>) and
obtain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-187-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mtext&gt;&amp;#xA0;even&lt;/mtext&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1989" style="width: 14.131em; display: inline-block;"><span style="display: inline-block; position: relative; width: 11.87em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1011.86em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-1990"><span class="mn" id="MathJax-Span-1991" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-1992" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mo" id="MathJax-Span-1993" style="font-family: MathJax_Main; padding-left: 0.278em;">(</span><span class="mi" id="MathJax-Span-1994" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-1995" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-1996" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-1997" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-1998" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-1999" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-2000" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2001" style="font-family: MathJax_Main; padding-left: 0.222em;">(</span><span class="mi" id="MathJax-Span-2002" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2003" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-2004" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-2005" style="font-family: MathJax_Main;">)</span><span class="texatom" id="MathJax-Span-2006"><span class="mrow" id="MathJax-Span-2007"><span class="mtext" id="MathJax-Span-2008" style="font-family: MathJax_Main;">&nbsp;even</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn><mo></mo><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mtext>&nbsp;even</mtext></mrow></math></span></span><script type="math/tex" id="MathJax-Element-187">0 \leq (x-2)\;\wedge\; (x-2) \textrm{ even}</script>, from which our proof goal
follows.</p>

<h5 id="sec-example-greatest-solution">23.4.2.2. Example with Greatest Solution</h5>

<p>We can think of a given predicate <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-188-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2009" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2010"><span class="msubsup" id="MathJax-Span-2011"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2012" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2013"><span class="mrow" id="MathJax-Span-2014"><span class="mo" id="MathJax-Span-2015" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2016" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2017" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2018" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-188">g^{\uparrow}(x)</script> as being represented
by a proof treein this case a term in a <em>coinductive datatype</em>,
since the proof may be infinite.
Greatest solutions like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-189-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2019" style="width: 1.158em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.945em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.195em, 1000.95em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2020"><span class="msubsup" id="MathJax-Span-2021"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2022" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2023"><span class="mrow" id="MathJax-Span-2024"><span class="mo" id="MathJax-Span-2025" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.385em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-189">g^{\uparrow}</script> have
been given the name <em>greatest predicate</em>.
The main technique for proving something from a given proof tree, that
is, to prove something of the form <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-190-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;R&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2026" style="width: 6.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.83em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1005.83em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2027"><span class="msubsup" id="MathJax-Span-2028"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2029" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2030"><span class="mrow" id="MathJax-Span-2031"><span class="mo" id="MathJax-Span-2032" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2033" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2034" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2035" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-2036" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2037" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-2038" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-2039" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">R</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>R</mi></math></span></span><script type="math/tex" id="MathJax-Element-190">g^{\uparrow}(x) \;\Longrightarrow\; R</script>, is to
destruct the proof.  Since this is just unfolding the defining
equation, the fact that were using a greatest solution for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-191-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2040" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2041"><span class="mi" id="MathJax-Span-2042" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-191">g</script> never
plays a role (as long as we limit ourselves to a finite number of
unfoldings).</p>

<p>To go in the other direction, to establish a predicate defined as a greatest solution,
like <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-192-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2043" style="width: 6.935em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.83em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1005.74em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2044"><span class="mi" id="MathJax-Span-2045" style="font-family: MathJax_Math; font-style: italic;">Q</span><span class="mspace" id="MathJax-Span-2046" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2047" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-2048" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-2049" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2050" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2051"><span class="mrow" id="MathJax-Span-2052"><span class="mo" id="MathJax-Span-2053" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2054" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2055" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2056" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Q</mi><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-192">Q \;\Longrightarrow\; g^{\uparrow}(x)</script>, we may need an infinite number of steps.  For this purpose,
we can use inductions dual, <em>coinduction</em>.  Were it not for one little detail, coinduction
is as simple as continuations in programming: the next part of the proof obligation
is delegated to the <em>coinduction hypothesis</em>.  The little detail is making sure that
it is the next part were passing on for the continuation, not the same part.  This
detail is called <em>productivity</em> and corresponds to the requirement in
induction of making sure were going down a well-founded relation when
applying the induction hypothesis.  There are
many sources with more information, see for example the classic account by
Jacobs and Rutten [@JacobsRutten:IntroductionCoalgebra]
or a new attempt by Kozen and Silva
that aims to emphasize the simplicity, not the mystery, of
coinduction [@KozenSilva:Coinduction].</p>

<p>Lets prove <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-193-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;t&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;r&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;u&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;e&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2057" style="width: 8.143em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.828em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1006.73em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2058"><span class="texatom" id="MathJax-Span-2059"><span class="mrow" id="MathJax-Span-2060"><span class="mi" id="MathJax-Span-2061" style="font-family: MathJax_Main; font-style: italic;">t</span><span class="mi" id="MathJax-Span-2062" style="font-family: MathJax_Main; font-style: italic;">r</span><span class="mi" id="MathJax-Span-2063" style="font-family: MathJax_Main; font-style: italic;">u</span><span class="mi" id="MathJax-Span-2064" style="font-family: MathJax_Main; font-style: italic;">e</span></span></span><span class="mspace" id="MathJax-Span-2065" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2066" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-2067" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="msubsup" id="MathJax-Span-2068" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2069" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2070"><span class="mrow" id="MathJax-Span-2071"><span class="mo" id="MathJax-Span-2072" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2073" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2074" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2075" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">t</mi><mi class="MJX-tex-mathit" mathvariant="italic">r</mi><mi class="MJX-tex-mathit" mathvariant="italic">u</mi><mi class="MJX-tex-mathit" mathvariant="italic">e</mi></mrow><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-193">\mathit{true} \;\Longrightarrow\; g^{\uparrow}(x)</script>.  The intuitive coinductive proof goes like this:
According to the right-hand rule of [#g-coind-rule], <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-194-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2076" style="width: 2.786em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.311em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1002.22em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2077"><span class="msubsup" id="MathJax-Span-2078"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2079" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2080"><span class="mrow" id="MathJax-Span-2081"><span class="mo" id="MathJax-Span-2082" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2083" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2084" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2085" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-194">g^{\uparrow}(x)</script> follows if we
establish <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-195-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2191;&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2086" style="width: 4.835em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.044em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.352em, 1003.95em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2087"><span class="msubsup" id="MathJax-Span-2088"><span style="display: inline-block; position: relative; width: 0.959em; height: 0px;"><span style="position: absolute; clip: rect(3.392em, 1000.48em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2089" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.531em;"><span class="texatom" id="MathJax-Span-2090"><span class="mrow" id="MathJax-Span-2091"><span class="mo" id="MathJax-Span-2092" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2093" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2094" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2095" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-2096" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-2097" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.438em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>g</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false"></mo></mrow></msup><mo stretchy="false">(</mo><mi>x</mi><mo></mo><mn>2</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-195">g^{\uparrow}(x-2)</script>, and thats easy to do by invoking the coinduction hypothesis.
The little detail, productivity, is satisfied in this proof because we applied
a rule in [#g-coind-rule] before invoking the coinduction hypothesis.</p>

<p>For anyone who may have felt that the intuitive proof felt too easy, here is a formal
proof using [#eq-greatest-is-forall], which relies only on induction.  We massage the
general form of our proof goal:</p>

<!--
|~~~|~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~|
|   | $Q \;\Longrightarrow\; f^{\uparrow}(x)$                                                      |
| = | &nbsp;&nbsp;&nbsp;&nbsp;  { [#eq-greatest-is-forall] }                      |
|   | $Q \;\Longrightarrow\; \forall k \bullet\; { {}^{\sharp}\!f}_k(x)$                                  |
| = | &nbsp;&nbsp;&nbsp;&nbsp;  { distribute $\;\Longrightarrow\;$ over $\forall$ to the right } |
|   | $\forall k \bullet\; Q \;\Longrightarrow\; { {}^{\sharp}\!f}_k(x)$                                  |
-->

<p>The last line can be proved by induction over <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-196-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2098" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.354em, 1000.51em, 2.374em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2099"><span class="mi" id="MathJax-Span-2100" style="font-family: MathJax_Math; font-style: italic;">k</span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>k</mi></math></span></span><script type="math/tex" id="MathJax-Element-196">k</script>.  So, in our case, we prove
<!--
$\mathit{true} \;\Longrightarrow\; { {}^{\sharp}\!g}_k(x)$ for every $k$.
If $k=0$, then ${ {}^{\sharp}\!g}_k(x)$ is $\mathit{true}$, so our goal holds trivially.
If $k > 0$, then ${ {}^{\sharp}\!g}_k(x) = (x = 0 \:\vee\: { {}^{\sharp}\!g}_{k-1}(x-2))$.  We establish the second
disjunct by applying the induction hypothesis (on the smaller $k-1$ and with $x-2$).
--></p>

<h4 id="2343-other-techniques">23.4.3. Other Techniques</h4>

<p>Although in this paper I consider only well-founded functions and extreme
predicates, it is worth mentioning that there are additional ways of making sure that
the set of solutions to [#eq-general] is nonempty.  For example, if all calls to <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-197-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2101" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2102"><span class="mi" id="MathJax-Span-2103" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-197">f</script> in
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-198-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;F&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2104" style="width: 2.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.521em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.4em, 1002.43em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2105"><span class="msup" id="MathJax-Span-2106"><span style="display: inline-block; position: relative; width: 1.181em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.83em, 4.181em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-2107"><span class="mrow" id="MathJax-Span-2108"><span class="mi" id="MathJax-Span-2109" style="font-family: MathJax_Caligraphic;">F<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.11em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.402em; left: 0.912em;"><span class="mo" id="MathJax-Span-2110" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2111" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2112" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-2113" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.382em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">F</mi></mrow><mo></mo></msup><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-198">\mathcal{F}(f)</script> are <em>tail-recursive calls</em>, then (under the assumption that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-199-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2114" style="width: 0.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.788em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.79em, 2.362em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2115"><span class="mi" id="MathJax-Span-2116" style="font-family: MathJax_Math; font-style: italic; text-rendering: optimizelegibility;">Y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.182em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.061em; border-left: 0px solid; width: 0px; height: 0.937em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Y</mi></math></span></span><script type="math/tex" id="MathJax-Element-199">Y</script> is nonempty) the set of
solutions is nonempty.  To see this, consider an attempted evaluation of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-200-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2117" style="width: 2.261em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.891em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1001.8em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2118"><span class="mi" id="MathJax-Span-2119" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-2120" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2121" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2122" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-200">f(x)</script> that fails
to determine a definite result value because of an infinite chain of calls that applies <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-201-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2123" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2124"><span class="mi" id="MathJax-Span-2125" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-201">f</script>
to each value of some subset <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-202-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2126" style="width: 1.368em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.155em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.289em, 1001.16em, 2.363em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2127"><span class="msup" id="MathJax-Span-2128"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.85em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2129" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.909em;"><span class="mo" id="MathJax-Span-2130" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.028em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>X</mi><mo></mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-202">X</script> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-203-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2131" style="width: 1.001em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.84em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.365em, 1000.84em, 2.363em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2132"><span class="mi" id="MathJax-Span-2133" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.938em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-203">X</script>.  Then, apparently, the value of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-204-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2134" style="width: 0.633em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.525em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.343em, 1000.53em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2135"><span class="mi" id="MathJax-Span-2136" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.208em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi></math></span></span><script type="math/tex" id="MathJax-Element-204">f</script> for any one
of the values in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-205-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2137" style="width: 1.368em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.155em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.289em, 1001.16em, 2.363em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2138"><span class="msup" id="MathJax-Span-2139"><span style="display: inline-block; position: relative; width: 1.179em; height: 0px;"><span style="position: absolute; clip: rect(3.151em, 1000.85em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="mi" id="MathJax-Span-2140" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0.909em;"><span class="mo" id="MathJax-Span-2141" style="font-size: 70.7%; font-family: MathJax_Main;"></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.028em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>X</mi><mo></mo></msup></math></span></span><script type="math/tex" id="MathJax-Element-205">X</script> is not determined by the equation, but picking any particular result
values for these makes for a consistent definition.
This was pointed out by Manolios and Moore [@ManoliosMoore:PartialFunctions].
Functions can be underspecified in this way in the proof assistants ACL2 [@ACL2:book]
and HOL [@Krauss:PhD].</p>

<h3 id="235-functions-in-dafny">23.5. Functions in Dafny</h3>

<p>In this section, I explain with examples the support in
Dafny for well-founded functions, extreme predicates,
and proofs regarding these.</p>

<h4 id="2351-well-founded-functions-in-dafny">23.5.1. Well-founded Functions in Dafny</h4>

<p>Declarations of well-founded functions are unsurprising.  For example, the Fibonacci
function is declared as follows:</p>

<pre><code class="language-dafny">function fib(n: nat): nat
{
  if n &lt; 2 then n else fib(n-2) + fib(n-1)
}
</code></pre>

<p>Dafny verifies that the body (given as an expression in curly braces) is well defined.
This includes decrement checks for recursive (and mutually recursive) calls.  Dafny
predefines a well-founded relation on each type and extends it to lexicographic tuples
of any (fixed) length.  For example, the well-founded relation <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-206-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x226A;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2142" style="width: 3.154em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.626em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.638em, 1002.63em, 2.726em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2143"><span class="mi" id="MathJax-Span-2144" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2145" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2146" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.045em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo></mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-206">x \ll y</script> for integers
is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-207-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2147" style="width: 7.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.408em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1006.41em, 2.726em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2148"><span class="mi" id="MathJax-Span-2149" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2150" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mi" id="MathJax-Span-2151" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mspace" id="MathJax-Span-2152" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2153" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-2154" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-2155" style="font-family: MathJax_Main; padding-left: 0.222em;">0</span><span class="mo" id="MathJax-Span-2156" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2157" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.161em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>&lt;</mo><mi>y</mi><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mn>0</mn><mo></mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-207">x < y \;\wedge\; 0 \leq y</script>, the one for reals is <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-208-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1.0&lt;/mn&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mn&gt;0.0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2158" style="width: 11.505em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.664em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1009.66em, 2.726em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2159"><span class="mi" id="MathJax-Span-2160" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2161" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2162" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-2163" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-2164" style="font-family: MathJax_Main; padding-left: 0.222em;">1.0</span><span class="mspace" id="MathJax-Span-2165" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2166" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-2167" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-2168" style="font-family: MathJax_Main; padding-left: 0.222em;">0.0</span><span class="mo" id="MathJax-Span-2169" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2170" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.161em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo></mo><mi>y</mi><mo></mo><mn>1.0</mn><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mn>0.0</mn><mo></mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-208">x \leq y - 1.0 \;\wedge\; 0.0 \leq y</script>
(this is the same ordering as for integers, if you read the integer
relation as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-209-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo&gt;&amp;#x2227;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2171" style="width: 9.719em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.141em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.54em, 1008.14em, 2.726em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2172"><span class="mi" id="MathJax-Span-2173" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-2174" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2175" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-2176" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mn" id="MathJax-Span-2177" style="font-family: MathJax_Main; padding-left: 0.222em;">1</span><span class="mspace" id="MathJax-Span-2178" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2179" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-2180" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-2181" style="font-family: MathJax_Main; padding-left: 0.222em;">0</span><span class="mo" id="MathJax-Span-2182" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2183" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 1.161em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo></mo><mi>y</mi><mo></mo><mn>1</mn><mspace width="thickmathspace"></mspace><mo></mo><mspace width="thickmathspace"></mspace><mn>0</mn><mo></mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-209">x \leq y - 1 \;\wedge\; 0 \leq y</script>), the one for inductive
datatypes is structural inclusion,
and the one for coinductive datatypes is <code>false</code>.</p>

<p>Using a <code>decreases</code> clause, the programmer can specify the term in this predefined
order.  When a function definition omits a <code>decreases</code> clause, Dafny makes a simple
guess.  This guess (which can be inspected by hovering over the function name in the
Dafny IDE) is very often correct, so users are rarely bothered to provide explicit
<code>decreases</code> clauses.</p>

<p>If a function returns <code>bool</code>, one can drop the result type <code>: bool</code> and change the
keyword <code>function</code> to <code>predicate</code>.</p>

<h4 id="sec-proofs-in-dafny">23.5.2. Proofs in Dafny</h4>

<p>Dafny has <code>lemma</code> declarations.  These are really just special cases of methods:
they can have pre- and postcondition specifications and their body is a code block.
Here is the lemma we stated and proved in Section [#sec-fib-example]:</p>

<pre><code class="language-dafny">lemma FibProperty(n: nat)
  ensures fib(n) % 2 == 0 &lt;==&gt; n % 3 == 0
{
  if n &lt; 2 {
  } else {
    FibProperty(n-2); FibProperty(n-1);
  }
}
</code></pre>

<p>The postcondition of this lemma (keyword <code>ensures</code>) gives the proof
goal.  As in any program-correctness logic (e.g.,
[@Hoare:AxiomaticBasis]), the postcondition must
be established on every control path through the lemmas body.  For
<code>FibProperty</code>, I give the proof by
an <code>if</code> statement, hence introducing a case split.  The then branch is empty, because
Dafny can prove the postcondition automatically in this case.  The else branch
performs two recursive calls to the lemma.  These are the invocations of the induction
hypothesis and they follow the usual program-correctness rules,
namely: the precondition must hold at the call site, the call must terminate, and then
the caller gets to assume the postcondition upon return.  The proof glue needed
to complete the proof is done automatically by Dafny.</p>

<p>Dafny features an aggregate statement using which it is possible to make (possibly
infinitely) many calls at once.  For example, the induction hypothesis can be called
at once on all values <code>n'</code> smaller than <code>n</code>:</p>

<pre><code class="language-dafny">forall n' | 0 &lt;= n' &lt; n {
  FibProperty(n');
}
</code></pre>

<p>For our purposes, this corresponds to <em>strong induction</em>.  More
generally, the <code>forall</code> statement has the form</p>

<pre><code class="language-dafny">forall k | P(k)
  ensures Q(k)
{ Statements; }
</code></pre>

<p>Logically, this statement corresponds to <em>universal introduction</em>: the body proves that
<code>Q(k)</code> holds for an arbitrary <code>k</code> such that <code>P(k)</code>, and the conclusion of the <code>forall</code> statement
is then <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-210-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2200;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x27F9;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mi&gt;Q&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2184" style="width: 10.98em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.191em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1009.1em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2185"><span class="mi" id="MathJax-Span-2186" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2187" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2188" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-2189" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-2190" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.109em;"></span></span><span class="mo" id="MathJax-Span-2191" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2192" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2193" style="font-family: MathJax_Main;">)</span><span class="mspace" id="MathJax-Span-2194" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mo" id="MathJax-Span-2195" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mspace" id="MathJax-Span-2196" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mi" id="MathJax-Span-2197" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">Q</span><span class="mo" id="MathJax-Span-2198" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2199" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2200" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi><mi>k</mi><mo></mo><mspace width="thickmathspace"></mspace><mi>P</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mspace width="thickmathspace"></mspace><mo stretchy="false"></mo><mspace width="thickmathspace"></mspace><mi>Q</mi><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-210">\forall k \bullet\; P(k) \;\Longrightarrow\; Q(k)</script>.  When the body of the <code>forall</code> statement is
a single call (or <code>calc</code> statement), the <code>ensures</code> clause is inferred and can be omitted,
like in our <code>FibProperty</code> example.</p>

<p>Lemma <code>FibProperty</code> is simple enough that its whole body can be replaced by the one
<code>forall</code> statement above.  In fact, Dafny goes one step further: it automatically
inserts such a <code>forall</code> statement at the beginning of every lemma [@Leino:induction].
Thus, <code>FibProperty</code> can be declared and proved simply by:</p>

<pre><code class="language-dafny">lemma FibProperty(n: nat)
  ensures fib(n) % 2 == 0 &lt;==&gt; n % 3 == 0
{ }
</code></pre>

<p>Going in the other direction from universal introduction is existential elimination,
also known as Skolemization.  Dafny has a statement for this, too:
for any variable <code>x</code> and boolean expression <code>Q</code>, the
<em>assign such that</em> statement <code>x :| Q;</code> says to assign to <code>x</code> a value such that <code>Q</code>
will hold.  A proof obligation when using this statement is to show that there
exists an <code>x</code> such that <code>Q</code> holds.  For example, if the fact
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-211-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2203;&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;&amp;#x2219;&lt;/mo&gt;&lt;mspace width=&quot;thickmathspace&quot; /&gt;&lt;mn&gt;100&lt;/mn&gt;&lt;mo&gt;&amp;#x2264;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;f&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;i&lt;/mi&gt;&lt;mi class=&quot;MJX-tex-mathit&quot; mathvariant=&quot;italic&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mn&gt;200&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2201" style="width: 12.345em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.347em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.456em, 1010.31em, 2.771em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2202"><span class="mi" id="MathJax-Span-2203" style="font-family: MathJax_Main;"></span><span class="mi" id="MathJax-Span-2204" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2205" style="font-family: MathJax_Main; padding-left: 0.222em;"></span><span class="mspace" id="MathJax-Span-2206" style="height: 0em; vertical-align: 0em; width: 0.278em; display: inline-block; overflow: hidden;"></span><span class="mn" id="MathJax-Span-2207" style="font-family: MathJax_Main; padding-left: 0.222em;">100</span><span class="mo" id="MathJax-Span-2208" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="texatom" id="MathJax-Span-2209" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-2210"><span class="mi" id="MathJax-Span-2211" style="font-family: MathJax_Main; font-style: italic; text-rendering: optimizelegibility;">f</span><span class="mi" id="MathJax-Span-2212" style="font-family: MathJax_Main; font-style: italic;">i</span><span class="mi" id="MathJax-Span-2213" style="font-family: MathJax_Main; font-style: italic;">b</span></span></span><span class="mo" id="MathJax-Span-2214" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-2215" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-2216" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-2217" style="font-family: MathJax_Main; padding-left: 0.278em;">&lt;</span><span class="mn" id="MathJax-Span-2218" style="font-family: MathJax_Main; padding-left: 0.278em;">200</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.36em; border-left: 0px solid; width: 0px; height: 1.315em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi mathvariant="normal"></mi><mi>k</mi><mo></mo><mspace width="thickmathspace"></mspace><mn>100</mn><mo></mo><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-mathit" mathvariant="italic">f</mi><mi class="MJX-tex-mathit" mathvariant="italic">i</mi><mi class="MJX-tex-mathit" mathvariant="italic">b</mi></mrow><mo stretchy="false">(</mo><mi>k</mi><mo stretchy="false">)</mo><mo>&lt;</mo><mn>200</mn></math></span></span><script type="math/tex" id="MathJax-Element-211">\exists k \bullet\; 100 \leq \mathit{fib}(k) < 200</script> is known, then the statement
<code>k :| 100 &lt;= fib(k) &lt; 200;</code> will assign to <code>k</code> some value (chosen arbitrarily)
for which <code>fib(k)</code> falls in the given range.</p>

<h4 id="sec-friendliness">23.5.3. Extreme Predicates in Dafny</h4>

<p>In this previous subsection, I explained that a <code>predicate</code> declaration introduces a
well-founded predicate.  The declarations for introducing extreme predicates are
<code>least predicate</code> and <code>greatest predicate</code>.  Here is the definition of the least and
greatest solutions of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-212-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2219" style="width: 0.58em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.473em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.606em, 1000.47em, 2.568em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2220"><span class="mi" id="MathJax-Span-2221" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.306em; border-left: 0px solid; width: 0px; height: 0.895em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>g</mi></math></span></span><script type="math/tex" id="MathJax-Element-212">g</script> from above, lets call them <code>g</code> and <code>G</code>:</p>

<pre><code class="language-dafny">least predicate g(x: int) { x == 0 || g(x-2) }
greatest predicate G(x: int) { x == 0 || G(x-2) }
</code></pre>

<p>When Dafny receives either of these definitions, it automatically declares the corresponding
prefix predicates.  Instead of the names <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-213-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266D;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2222" style="width: 1.841em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.523em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.155em, 1001.52em, 2.612em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2223"><span class="msubsup" id="MathJax-Span-2224"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(2.941em, 1001.11em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-2225"><span class="mrow" id="MathJax-Span-2226"><span class="msubsup" id="MathJax-Span-2227"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-2228"><span class="mrow" id="MathJax-Span-2229"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-2230"><span class="mrow" id="MathJax-Span-2231"><span class="mi" id="MathJax-Span-2232" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2233" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-2234" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.105em;"><span class="mi" id="MathJax-Span-2235" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.358em; border-left: 0px solid; width: 0px; height: 1.483em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>g</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-213">{ {}^{\flat}!g}_k</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-214-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x266F;&lt;/mi&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;!&lt;/mo&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2236" style="width: 1.841em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.523em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.174em, 1001.52em, 2.612em, -1000em); top: -2.206em; left: 0em;"><span class="mrow" id="MathJax-Span-2237"><span class="msubsup" id="MathJax-Span-2238"><span style="display: inline-block; position: relative; width: 1.548em; height: 0px;"><span style="position: absolute; clip: rect(2.96em, 1001.11em, 4.354em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-2239"><span class="mrow" id="MathJax-Span-2240"><span class="msubsup" id="MathJax-Span-2241"><span style="display: inline-block; position: relative; width: 0.35em; height: 0px;"><span style="position: absolute; clip: rect(3.834em, 1000em, 4.149em, -1000em); top: -3.992em; left: 0em;"><span class="texatom" id="MathJax-Span-2242"><span class="mrow" id="MathJax-Span-2243"></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -4.354em; left: 0em;"><span class="texatom" id="MathJax-Span-2244"><span class="mrow" id="MathJax-Span-2245"><span class="mi" id="MathJax-Span-2246" style="font-size: 70.7%; font-family: MathJax_Main;"></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span><span class="mo" id="MathJax-Span-2247" style="font-family: MathJax_Main;">!</span><span class="mi" id="MathJax-Span-2248" style="font-family: MathJax_Math; font-style: italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span><span style="position: absolute; top: -3.751em; left: 1.105em;"><span class="mi" id="MathJax-Span-2249" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">k</span><span style="display: inline-block; width: 0px; height: 3.992em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.206em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.358em; border-left: 0px solid; width: 0px; height: 1.46em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="normal"></mi></mrow></msup><mo>!</mo><mi>g</mi></mrow><mi>k</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-214">{ {}^{\sharp}!g}_k</script> that I used above, Dafny
names the prefix predicates <code>g#[k]</code> and <code>G#[k]</code>, respectively, that is, the name of
the extreme predicate appended with <code>#</code>, and the subscript is given as an argument in
square brackets.  The definition of the prefix predicate derives from the body of
the extreme predicate and follows the form in [#eq-least-approx] and [#eq-greatest-approx].
Using a faux-syntax for illustrative purposes, here are the prefix
predicates that Dafny defines automatically from the extreme
predicates <code>g</code> and <code>G</code>:</p>

<pre><code class="language-dafny">predicate g#[_k: nat](x: int) { _k != 0 &amp;&amp; (x == 0 || g#[_k-1](x-2)) }
predicate G#[_k: nat](x: int) { _k != 0 ==&gt; (x == 0 || G#[_k-1](x-2)) }
</code></pre>

<p>The Dafny verifier is aware of the connection between extreme predicates and their
prefix predicates, [#eq-least-is-exists] and [#eq-greatest-is-forall].</p>

<p>Remember that to be well defined, the defining functor of an extreme predicate
must be monotonic, and for [#eq-least-is-exists] and [#eq-greatest-is-forall] to hold,
the functor must be continuous.  Dafny enforces the former of these by checking that
recursive calls of extreme predicates are in positive positions.  The continuity
requirement comes down to checking that they are also in <em>continuous positions</em>:
that recursive calls to least predicates are
not inside unbounded universal quantifiers and that recursive calls to greatest predicates
are not inside unbounded existential quantifiers [@Milner:CCS; @LeinoMoskal:Coinduction].</p>

<h4 id="2354-proofs-about-extreme-predicates">23.5.4. Proofs about Extreme Predicates</h4>

<p>From what I have presented so far, we can do the formal proofs from Sections
[#sec-example-least-solution] and [#sec-example-greatest-solution].  Here is the
former:</p>

<pre><code class="language-dafny">lemma EvenNat(x: int)
  requires g(x)
  ensures 0 &lt;= x &amp;&amp; x % 2 == 0
{
  var k: nat :| g#[k](x);
  EvenNatAux(k, x);
}
lemma EvenNatAux(k: nat, x: int)
  requires g#[k](x)
  ensures 0 &lt;= x &amp;&amp; x % 2 == 0
{
  if x == 0 { } else { EvenNatAux(k-1, x-2); }
}
</code></pre>

<p>Lemma <code>EvenNat</code> states the property we wish to prove.  From its
precondition (keyword <code>requires</code>) and
[#eq-least-is-exists], we know there is some <code>k</code> that will make the condition in the
assign-such-that statement true.  Such a value is then assigned to <code>k</code> and passed to
the auxiliary lemma, which promises to establish the proof goal.  Given the condition
<code>g#[k](x)</code>, the definition of <code>g#</code> lets us conclude <code>k != 0</code> as well as the disjunction
<code>x == 0 || g#[k-1](x-2)</code>.  The then branch considers the case of the first disjunct,
from which the proof goal follows automatically.  The else branch can then assume
<code>g#[k-1](x-2)</code> and calls the induction hypothesis with those parameters.  The proof
glue that shows the proof goal for <code>x</code> to follow from the proof goal with <code>x-2</code> is
done automatically.</p>

<p>Because Dafny automatically inserts the statement</p>

<pre><code class="language-dafny">forall k', x' | 0 &lt;= k' &lt; k &amp;&amp; g#[k'](x') {
  EvenNatAux(k', x');
}
</code></pre>

<p>at the beginning of the body of <code>EvenNatAux</code>, the body can be left empty and Dafny
completes the proof automatically.</p>

<p>Here is the Dafny program that gives the proof from Section [#sec-example-greatest-solution]:</p>

<pre><code class="language-dafny">lemma Always(x: int)
  ensures G(x)
{ forall k: nat { AlwaysAux(k, x); } }
lemma AlwaysAux(k: nat, x: int)
  ensures G#[k](x)
{ }
</code></pre>

<p>While each of these proofs involves only basic proof rules, the setup feels a bit clumsy,
even with the empty body of the auxiliary lemmas.  Moreover,
the proofs do not reflect the intuitive proofs I described in
Section [#sec-example-least-solution] and [#sec-example-greatest-solution].
These shortcoming are addressed in the next subsection.</p>

<h4 id="sec-nicer-proofs-of-extremes">23.5.5. Nicer Proofs of Extreme Predicates</h4>

<p>The proofs we just saw follow standard forms:
use Skolemization to convert the least predicate into a prefix predicate for some <code>k</code>
and then do the proof inductively over <code>k</code>; respectively,
by induction over <code>k</code>, prove the prefix predicate for every <code>k</code>, then use
universal introduction to convert to the greatest predicate.
With the declarations <code>least lemma</code> and <code>greatest lemma</code>, Dafny offers to
set up the proofs
in these standard forms.  What is gained is not just fewer characters in the program
text, but also a possible intuitive reading of the proofs.  (Okay, to be fair, the
reading is intuitive for simpler proofs; complicated proofs may or may not be intuitive.)</p>

<p>Somewhat analogous to the creation of prefix predicates from extreme predicates, Dafny
automatically creates a <em>prefix lemma</em> <code>L#</code> from each extreme lemma <code>L</code>.  The pre-
and postconditions of a prefix lemma are copied from those of the extreme lemma,
except for the following replacements:
For a least lemma, Dafny looks in the precondition to find calls (in positive, continuous
positions) to least predicates <code>P(x)</code> and replaces these with <code>P#[_k](x)</code>.
For a greatest lemma,
Dafny looks in the postcondition to find calls (in positive, continuous positions)
to greatest predicates <code>P</code> (including equality among coinductive datatypes, which is a built-in
greatest predicate) and replaces these with <code>P#[_k](x)</code>.
In each case, these predicates <code>P</code> are the lemmas <em>focal predicates</em>.</p>

<p>The body of the extreme lemma is moved to the prefix lemma, but with
replacing each recursive
call <code>L(x)</code> with <code>L#[_k-1](x)</code> and replacing each occurrence of a call
to a focal predicate
<code>P(x)</code> with <code>P#[_k-1](x)</code>.  The bodies of the extreme lemmas are then replaced as shown
in the previous subsection.  By construction, this new body correctly leads to the
extreme lemmas postcondition.</p>

<p>Let us see what effect these rewrites have on how one can write proofs.  Here are the proofs
of our running example:</p>

<pre><code class="language-dafny">least lemma EvenNat(x: int)
  requires g(x)
  ensures 0 &lt;= x &amp;&amp; x % 2 == 0
{ if x == 0 { } else { EvenNat(x-2); } }
greatest lemma Always(x: int)
  ensures G(x)
{ Always(x-2); }
</code></pre>

<p>Both of these proofs follow the intuitive proofs given in Sections
[#sec-example-least-solution] and [#sec-example-greatest-solution].  Note that in these
simple examples, the user is never bothered with either prefix predicates nor
prefix lemmasthe proofs just look like what youd expect.</p>

<p>Since Dafny automatically inserts calls to the induction hypothesis at the beginning of
each lemma, the bodies of the given extreme lemmas <code>EvenNat</code> and
<code>Always</code> can be empty and Dafny still completes the proofs.
Folks, it doesnt get any simpler than that!</p>

<h3 id="sec-definite-assignment">23.6. Variable Initialization and Definite Assignment</h3>

<p>TO BE WRITTEN  rules for default initialization; resulting rules for constructors; definite assignment rules</p>

<h3 id="sec-well-founded-orders">23.7. Well-founded Orders</h3>

<p>The well-founded order relations for a variety of built-in types in Dafny
are given in the following table:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">type of <code>X</code> and <code>x</code></th>
      <th style="text-align: left"><code>x</code> strictly below <code>X</code></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code>bool</code></td>
      <td style="text-align: left"><code>X &amp;&amp; !x</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>int</code></td>
      <td style="text-align: left"><code>x &lt; X &amp;&amp; 0 &lt;= X</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>real</code></td>
      <td style="text-align: left"><code>x &lt;= X - 1.0 &amp;&amp; 0.0 &lt;= X</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>set&lt;T&gt;</code></td>
      <td style="text-align: left"><code>x</code> is a proper subset of <code>X</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>multiset&lt;T&gt;</code></td>
      <td style="text-align: left"><code>x</code> is a proper multiset-subset of <code>X</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>seq&lt;T&gt;</code></td>
      <td style="text-align: left"><code>x</code> is a consecutive proper sub-sequence of <code>X</code></td>
    </tr>
    <tr>
      <td style="text-align: left"><code>map&lt;K, V&gt;</code></td>
      <td style="text-align: left"><code>x.Keys</code> is a proper subset of <code>X.Keys</code></td>
    </tr>
    <tr>
      <td style="text-align: left">inductive datatypes</td>
      <td style="text-align: left"><code>x</code> is structurally included in <code>X</code></td>
    </tr>
    <tr>
      <td style="text-align: left">reference types</td>
      <td style="text-align: left"><code>x == null &amp;&amp; X != null</code></td>
    </tr>
    <tr>
      <td style="text-align: left">co-inductive datatypes</td>
      <td style="text-align: left"><code>false</code></td>
    </tr>
    <tr>
      <td style="text-align: left">type parameter</td>
      <td style="text-align: left"><code>false</code></td>
    </tr>
    <tr>
      <td style="text-align: left">arrow types</td>
      <td style="text-align: left"><code>false</code></td>
    </tr>
  </tbody>
</table>

<p>Also, there are a few relations between the rows in the table above. For example, a datatype value <code>x</code> sitting inside a set that sits inside another datatype value <code>X</code> is considered to be strictly below <code>x</code>. Heres an illustration of that order, in a program that verifies:</p>

<pre><code class="language-dafny">datatype D = D(s: set&lt;D&gt;)

method TestD(dd: D) {
  var d := dd;
  while d != D({})
    decreases d
  {
    var x :| x in d.s;
    d := x;
  }
}
</code></pre>

<p>TODO: Write this section; revise the above</p>

<!--PDF NEWPAGE-->
<!--PDF NEWPAGE-->
<h2 id="sec-user-guide">24. Dafny Users Guide</h2>

<p>Most of this document describes the Dafny programming language.
This section describes the <code>dafny</code> tool, a combined verifier and compiler
that implements the Dafny language.</p>

<p>The development of the dafny language and tool is a GitHub project at <a href="https://github.com/dafny-lang/dafny">https://github.com/dafny-lang/dafny</a>.
The project is open source, with collaborators from various organizations and additional contributors welcome.
The software itself is licensed under the <a href="https://github.com/dafny-lang/dafny/blob/master/LICENSE.txt">MIT license</a>.</p>

<h3 id="241-introduction">24.1. Introduction</h3>

<p>The dafny tool implements the following capabilities:</p>

<ul>
  <li>checking that the input files represent a valid Dafny program (i.e., syntax, grammar and type checking);</li>
  <li>verifying that the program meets its specifications, by translating the program to verification conditions
and checking those with Boogie and an SMT solver, typically Z3;</li>
  <li>compiling the program to a target language, such as C#, Java, Javascript, Go (and others in development);</li>
  <li>running the executable produced by the compiler.</li>
</ul>

<p>Using various command-line flags, the tool can perform various combinations of the last three actions (the first
action is always performed).</p>

<h3 id="242-dafny-programs-and-files">24.2. Dafny Programs and Files</h3>

<p>A Dafny program is a set of modules.
Modules can refer to other modules, such as through <code>import</code> declarations
or <code>refines</code> clauses.
A Dafny program consists of all the modules needed so that all module
references are resolved.</p>

<p>Dafny files (<code>.dfy</code>) in the operating system each hold
some number of top-level declarations. Thus a full program may be
distributed among multiple files.
To apply the <code>dafny</code> tool to a Dafny program, the <code>dafny</code> tool must be
given all the files making up a complete program (or, possibly, more than
one program at a time). This can be effected either by listing all of the files
by name on the command-line or by using <code>include</code> directives within a file
to stipulate what other files contain modules that the given file needs.
Thus the complete set of modules are all the modules in all the files listed
on the command-line or referenced, recursively, by <code>include</code> directives
within those files. It does not matter if files are repeated either as
includes or on the command-line.<sup id="fnref:fn-duplicate-files" role="doc-noteref"><a href="#fn:fn-duplicate-files" class="footnote" rel="footnote">13</a></sup></p>

<p>Note however that although the complete set of files, command-line plus
included files, make up the program, by default, only those files listed on
the command-line are verified. To do a complete verification, each file
must be verified; it may well happen that a verification failure in one
file (which is not on the command-line and thus not checked) may hide a
verification failure in a file that is being checked.
Thus it is important to eventually check all files, preferably in an order
in which the files without dependencies are checked first, then those that
depend on them, etc., until all files are checked.</p>

<p>have the same absolute path, compared as case-sensitive strings
(regardless of whether the underlying file-system is case sensitive).
Use of symbolic links
may make the same file have a different absolute path; this will generally
cause duplicate declaration errors.</p>

<h3 id="243-installing-dafny">24.3. Installing Dafny</h3>

<p>The instructions for installing dafny and the required dependencies and environment
are described on the Dafny wiki:
<a href="https://github.com/dafny-lang/dafny/wiki/INSTALL">https://github.com/dafny-lang/dafny/wiki/INSTALL</a>.
They are not repeated here to avoid replicating information that
easily becomes inconsistent and out of date.</p>

<p>As of this writing, users can install pre-built Dafny binaries
or build directly from the source files maintained in the github project.</p>

<p>Current and past Dafny binary releases can be found at
<a href="https://github.com/dafny-lang/dafny/releases">https://github.com/dafny-lang/dafny/releases</a> for each supported platform.
Each release is a .zip file with a name combining the release name and the
platform. Current platforms are Windows 10, Ubuntu 16ff, and MacOS 10.14ff.</p>

<p>The principal dependency of the dafny tool is that it uses <code>dotnet</code>, which
is available and must be installed on Linux and Mac platforms to use dafny.</p>

<h3 id="244-dafny-code-style">24.4. Dafny Code Style</h3>

<p>There are code style conventions for Dafny code, recorded <a href="https://dafny-lang.github.io/dafny/StyleGuide/Style-Guide">here</a>.
Most significantly, code is written without tabs and with a 2 space indentation.</p>

<h3 id="245-ides-for-dafny">24.5. IDEs for Dafny</h3>

<p>Dafny source files are text files and can of course be edited with any
text editor. However, some tools provide syntax-aware features:</p>

<ul>
  <li>
    <p>There is a <a href="https://github.com/boogie-org/boogie-friends">Dafny mode for
  Emacs</a>.</p>
  </li>
  <li>
    <p>VSCode, a cross-platform editor for many programming languages 
has an extension for dafny, installed from within VSCode. VSCode is 
available <a href="http://code.visualstudio.com/">here</a>. The extension provides syntax highlighting, in-line parser, type and verification errors, and code navigation.</p>
  </li>
  <li>
    <p>An old Visual Studio plugin is no longer supported</p>
  </li>
</ul>

<p>Information about installing IDE extensions for Dafny is found
on the <a href="https://github.com/dafny-lang/dafny/wiki/INSTALL">Dafny INSTALL page in the wiki</a>.</p>

<h3 id="246-the-dafny-server">24.6. The Dafny Server</h3>

<p>Before Dafny <a href="https://github.com/dafny-lang/dafny/tree/master/Source/DafnyLanguageServer">implemented</a> the official <a href="https://microsoft.github.io/language-server-protocol/">Language Server Protocol</a>, it implemented its own protocol for <a href="https://github.com/boogie-org/boogie-friends">Emacs</a>, which resulted in a project called <a href="https://github.com/dafny-lang/dafny/tree/master/Source/DafnyServer">DafnyServer</a>.</p>

<p>The Dafny Server has <a href="https://github.com/dafny-lang/dafny/tree/master/Test/server">integration tests</a> that serve as the basis of the documentation.</p>

<p>The server is essentially a REPL, which produces output in the same format as the Dafny CLI; clients thus
do not need to understand the internals of Dafnys caching.  A typical editing session proceeds as follows:</p>

<ul>
  <li>When a new Dafny file is opened, the editor starts a new instance of the
Dafny server.  The cache is blank at that point.</li>
  <li>The editor sends a copy of the buffer for initial verification.  This takes
some time, after which the server returns a list of errors.</li>
  <li>The user makes modifications; the editor periodically sends a new copy of
the buffers contents to the Dafny server, which quickly returns an updated
list of errors.</li>
</ul>

<p>The client-server protocol is sequential, uses JSON, and works over ASCII
pipes by base64-encoding utf-8 queries.  It defines one type of query, and two
types of responses:</p>

<p>Queries are of the following form:</p>

<pre><code> verify
 &lt;base64 encoded JSON payload&gt;
 [[DAFNY-CLIENT: EOM]]
</code></pre>

<p>Responses are of the following form:</p>

<pre><code> &lt;list of errors and usual output, as produced by the Dafny CLI&gt;
 [SUCCESS] [[DAFNY-SERVER: EOM]]
</code></pre>

<p>or</p>

<pre><code> &lt;error message&gt;
 [FAILURE] [[DAFNY-SERVER: EOM]]
</code></pre>

<p>The JSON payload is an utf-8 encoded string resulting of the serialization of
a dictionary with 4 fields:</p>
<ul>
  <li>args:   An array of Dafny arguments, as passed to the Dafny CLI</li>
  <li>source: A Dafny program, or the path to a Dafny source file.</li>
  <li>sourceIsFile: A boolean indicating whether the source argument is a
              Dafny program or the path to one.</li>
  <li>filename:     The name of the original source file, to be used in error
              messages</li>
</ul>

<p>For small files, embedding the Dafny source directly into a message is
convenient; for larger files, however, it is generally better for performance
to write the source snapshot to a separate file, and to pass that to Dafny
by setting the sourceIsFile flag to true.</p>

<p>For example, if you compile and run <code>DafnyServer.exe</code>, you could paste the following command:</p>

<pre><code class="language-dafny">verify
eyJhcmdzIjpbIi9jb21waWxlOjAiLCIvcHJpbnRUb29sdGlwcyIsIi90aW1lTGltaXQ6MjAiXSwi
ZmlsZW5hbWUiOiJ0cmFuc2NyaXB0Iiwic291cmNlIjoibWV0aG9kIEEoYTppbnQpIHJldHVybnMg
KGI6IGludCkge1xuICBiIDo9IGE7XG4gIGFzc2VydCBmYWxzZTtcbn1cbiIsInNvdXJjZUlzRmls
ZSI6ZmFsc2V9
[[DAFNY-CLIENT: EOM]]
</code></pre>

<p>The interpreter sees the command <code>verify</code>, and then starts reading every line until it sees <code>[[DAFNY-CLIENT: EOM]]</code>
The payload is a base64 encoded string that you could encode or decode using JavaScripts <code>atob</code> and <code>btoa</code> function.
For example, the payload above was generated using the following code:</p>
<div class="language-js highlighter-rouge"><div class="highlight"><pre class="syntax"><code><span class="nx">btoa</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
  <span class="dl">"</span><span class="s2">args</span><span class="dl">"</span><span class="p">:</span> <span class="p">[</span>
    <span class="dl">"</span><span class="s2">/compile:0</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">/printTooltips</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">/timeLimit:20</span><span class="dl">"</span>
   <span class="p">],</span>
   <span class="dl">"</span><span class="s2">filename</span><span class="dl">"</span><span class="p">:</span><span class="dl">"</span><span class="s2">transcript</span><span class="dl">"</span><span class="p">,</span>
   <span class="dl">"</span><span class="s2">source</span><span class="dl">"</span><span class="p">:</span>
<span class="s2">`method A(a:int) returns (b: int) {
   b := a;
   assert false;
}
`</span><span class="p">,</span><span class="dl">"</span><span class="s2">sourceIsFile</span><span class="dl">"</span><span class="p">:</span> <span class="kc">false</span><span class="p">}))</span>
<span class="o">===</span> <span class="dl">"</span><span class="s2">eyJhcmdzIjpbIi9jb21waWxlOjAiLCIvcHJpbnRUb29sdGlwcyIsIi90aW1lTGltaXQ6MjAiXSwiZmlsZW5hbWUiOiJ0cmFuc2NyaXB0Iiwic291cmNlIjoibWV0aG9kIEEoYTppbnQpIHJldHVybnMgKGI6IGludCkge1xuICBiIDo9IGE7XG4gIGFzc2VydCBmYWxzZTtcbn1cbiIsInNvdXJjZUlzRmlsZSI6ZmFsc2V9</span><span class="dl">"</span>
</code></pre></div></div>

<p>Thus to decode such output, youd manually use <code>JSON.parse(atob(payload))</code>.
The Dafny Server is still supported, but we recommend using the <a href="https://github.com/dafny-lang/dafny/tree/master/Source/DafnyLanguageServer">Language Server</a> that is both available in Emacs and <a href="https://marketplace.visualstudio.com/items?itemName=dafny-lang.ide-vscode">VSCode</a>. The Language Server also provides features such as ghost highlighting or symbol hovering.</p>

<h3 id="247-using-dafny-from-the-command-line">24.7. Using Dafny From the Command Line</h3>

<p><code>dafny</code> is a conventional command-line tool, operating just like other
command-line tools in Windows and Unix-like systems.</p>

<ul>
  <li>The format of a command-line is determined by the shell program 
that is executing the command-line (.e.g. bash, the windows shell, 
COMMAND, etc.). The command-line typically consists of file names and 
options, in any order, separated by spaces.</li>
  <li>Files are designated by absolute paths or paths relative to the current
working directory. A command-line argument not matching a known option is considered a filepath.</li>
  <li>Files containing dafny code must have a <code>.dfy</code> suffix.</li>
  <li>There must be at least one <code>.dfy</code> file.</li>
  <li>The command-line may contain other kinds of files appropriate to
the language that the dafny files are being compiled to.</li>
</ul>

<p>The command <code>Dafny.exe /?</code> gives the current set of options supported
by the tool. The most commonly used options are described in <a href="#sec-command-line-options">Section 24.10</a>.</p>

<ul>
  <li>Options may begin with either a <code>/</code> (as is typical on Windows) or a <code>-</code> (as is typical on Linux)</li>
  <li>If an option is repeated (e.g., with a different argument), then 
the later instance on the command-line supersedes the earlier instance.</li>
  <li>If an option takes an argument, the option name is followed by a <code>:</code> and then by the argument value, with no
intervening white space; if the argument itself contains white space, the argument must be enclosed in quotes.</li>
  <li>Escape characters are determined by the shell executing the command-line.</li>
</ul>

<p>The dafny tool performs several tasks:</p>

<ul>
  <li>Checking the form of the text in a <code>.dfy</code> file. This step is always performed, unless the tool is simply asked for
help information or version number.</li>
  <li>Running the verification engine to check all implicit and explicit specifications. This step is performed by
default, but can be skipped by using the <code>-noVerify</code> or <code>-dafnyVerify:0</code> option</li>
  <li>Compiling the dafny program to a target language. This step is performed by default if the verification is
successful but can be skipped or always executed by using variations of the <code>-compile</code> option.</li>
  <li>Whether the source code of the compiled target is written out is controlled by <code>-spillTargetCode</code></li>
  <li>The particular target language used is chosen by <code>-compileTarget</code></li>
  <li>Whether or not the dafny tool attempts to run the compiled code is controlled by <code>-compile</code></li>
</ul>

<p>The dafny tool terminates with these exit codes:</p>

<ul>
  <li>0  success</li>
  <li>1  invalid command-line arguments</li>
  <li>2  parse or types errors</li>
  <li>3  compilation errors</li>
  <li>4  verification errors</li>
</ul>

<p>Errors in earlier phases of processing typically hide later errors.
For example, if a program has parsing errors, verification or compilation will
not be attempted.
The option <code>-countVerificationErrors:0</code> forces the tool to always end with a 0
exit code.</p>

<h3 id="248-verification">24.8. Verification</h3>

<p>In this section, we suggest a methodology to figure out <a href="#sec-verification-debugging">why a single assertion might not hold</a>, we propose techniques to deal with <a href="#sec-verification-debugging-slow">assertions that slow a proof down</a>, we explain how to <a href="#sec-assertion-batches">verify assertions in parallel or in a focused way</a>, and we also give some more examples of <a href="#sec-command-line-options-and-attributes-for-verification">useful options and attributes to control verification</a>.</p>

<h4 id="sec-verification-debugging">24.8.1. Verification debugging when verification fails</h4>

<p>Lets assume one assertion is failing (assertion might not hold or postcondition might not hold). What should you do next?</p>

<p>The following section is textual description of the animation below, 
which illustrates the principle of debugging an assertion by computing 
the weakest precondition:<br>
<img src="Dafny-Documentation--ignore_files/157976402-83fe4d37-8042-40fc-940f-bcfc235c7d2b.gif" alt="weakestpreconditionDemo"></p>

<h5 id="sec-failing-postconditions">24.8.1.1. Failing postconditions</h5>
<p>Lets look at an example of a failing postcondition.</p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  var j := if !b then 3 else 1;
  if b {
    return j;
  }//^^^^^^^ a postcondition might not hold on this return path.
  i := 2;
}
</code></pre>
<p>One first thing you can do is replace the statement <code>return j;</code> by two statements <code>i := j; return;</code> to better understand what is wrong:</p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  var j := if !b then 3 else 1;
  if b {
    i := j;
    return;
  }//^^^^^^^ a postcondition might not hold on this return path.
  i := 2;
}
</code></pre>
<p>Now, you can assert the postcondition just before the return:</p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  var j := if !b then 3 else 1;
  if b {
    i := j;
    assert 2 &lt;= i; // This assertion might not hold
    return;
  }
  i := 2;
}
</code></pre>
<p>Thats it! Now the postcondition is not failing anymore, but the <code>assert</code> contains the error!
you can now move to the next section to find out how to debug this <code>assert</code>.</p>

<h5 id="sec-failing-asserts">24.8.1.2. Failing asserts</h5>
<p>In the <a href="#sec-failing-postconditions">previous section</a>, we arrive to the point where we have a failing assertion:</p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  var j := if !b then 3 else 1;
  if b {
    i := j;
    assert 2 &lt;= i; // This assertion might not hold
    return;
  }
  i := 2;
}
</code></pre>
<p>To debug why this assert might not hold, we need to <em>move this assert up</em>, which is similar to <a href="https://en.wikipedia.org/wiki/Predicate_transformer_semantics#Weakest_preconditions"><em>computing the weakest precondition</em></a>.
For example, if we have <code>x := Y; assert F;</code> and the <code>assert F;</code> might not hold, the weakest precondition for it to hold before <code>x := Y;</code> can be written as the assertion <code>assert F[x:= Y];</code>, where we replace every occurence of <code>x</code> in <code>F</code> into <code>Y</code>.
Lets do it in our example:</p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  var j := if !b then 3 else 1;
  if b {
    assert 2 &lt;= j; // This assertion might not hold
    i := j;
    assert 2 &lt;= i;
    return;
  }
  i := 2;
}
</code></pre>
<p>Yay! The assertion <code>assert 2 &lt;= i;</code> is not proven wrong, which means that if we manage to prove <code>assert 2 &lt;= j;</code>, it will work.
Now, this assert should hold only if we are in this branch, so to <em>move the assert up</em>, we need to guard it.
Just before the <code>if</code>, we can add the weakest precondition <code>assert b ==&gt; (2 &lt;= j)</code>:</p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  var j := if !b then 3 else 1;
  assert b  ==&gt;  2 &lt;= j;  // This assertion might not hold
  if b {
    assert 2 &lt;= j;
    i := j;
    assert 2 &lt;= i;
    return;
  }
  i := 2;
}
</code></pre>
<p>Again, now the error is only on the topmost assert, which means that we are making progress.
Now, either the error is obvious, or we can one more time replace <code>j</code> by its value and create the assert <code>assert b ==&gt; ((if !b then 3 else 1) &gt;= 2);</code></p>
<pre><code class="language-dafny">method FailingPostcondition(b: bool) returns (i: int)
  ensures 2 &lt;= i
{
  assert b  ==&gt;  2 &lt;= (if !b then 3 else 1);  // This assertion might not hold
  var j := if !b then 3 else 1;
  assert b  ==&gt;  2 &lt;= j;
  if b {
    assert 2 &lt;= j;
    i := j;
    assert 2 &lt;= i;
    return;
  }
  i := 2;
}
</code></pre>
<p>At this point, this is pure logic. We can simplify the assumption:</p>
<pre><code>b ==&gt;  2 &lt;= (if !b then 3 else 1)
!b ||  (if !b then 2 &lt;= 3 else 2 &lt;= 1)
!b ||  (if !b then true else false)
!b || !b;
!b;
</code></pre>
<p>Now we can understand what went wrong: When b is true, all of these 
formulas above are false, this is why the Dafny verifier was not able to
 prove them.
In the next section, we will explain how to move asserts up in certain
 useful patterns.</p>

<h5 id="sec-failing-asserts-special-cases">24.8.1.3. Failing asserts cases</h5>

<p>This list is not exhaustive but can definitely be useful to provide 
the next step to figure out why Dafny could not prove an assertion.</p>

<table>
  <thead>
    <tr>
      <th>Failing assert</th>
      <th>Suggested rewriting</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><br><code>x := Y;</code><br><code>assert P;</code></td>
      <td><code>assert P[x := Y];</code><br><code>x := Y;</code><br><code>assert P;</code></td>
    </tr>
    <tr>
      <td><br><code>if B {</code><br>&nbsp;&nbsp;<code>  assert P;</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code></td>
      <td><code>assert B ==&gt; P;</code><br><code>if B {</code><br>&nbsp;&nbsp;<code>  assert P;</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code></td>
    </tr>
    <tr>
      <td><br><code>if B {</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>} else {</code><br>&nbsp;&nbsp;<code>  assert P;</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code></td>
      <td><code>assert !B ==&gt; P;</code><br><code>if B {</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>} else {</code><br>&nbsp;&nbsp;<code>  assert P;</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code></td>
    </tr>
    <tr>
      <td><br><br><code>if X {</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>} else {</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code><br><code>assert A;</code></td>
      <td><code>if X {</code><br>&nbsp;&nbsp;<code>  ...</code><br>&nbsp;&nbsp;<code>  assert A;</code><br><code>} else {</code><br>&nbsp;&nbsp;<code>  ...</code><br>&nbsp;&nbsp;<code>  assert A;</code><br><code>}</code><br><code>assert A;</code></td>
    </tr>
    <tr>
      <td><br><br><br><br><br><code>assert forall x :: Q(x);</code></td>
      <td><a href="#sec-forall-statement"><code>forall x</code></a><br>&nbsp;&nbsp;<code>  ensures Q(x)</code><br><code>{</code><br>&nbsp;&nbsp;<code>  assert Q(x);</code><br><code>};</code><br><code> assert forall x :: Q(x);</code></td>
    </tr>
    <tr>
      <td><br><br><br><br><br><code>assert forall x :: P(x) ==&gt; Q(x);</code></td>
      <td><a href="#sec-forall-statement"><code>forall x | P(x)</code></a><br>&nbsp;&nbsp;<code>  ensures Q(x)</code><br><code>{</code><br>&nbsp;&nbsp;<code>  assert Q(x);</code><br><code>};</code><br><code> assert forall x :: P(x) ==&gt; Q(x);</code></td>
    </tr>
    <tr>
      <td><br><code>assert exists x | P(x) :: Q(x);</code><br><code>assert exists x | P(x) :: Q'(x);</code></td>
      <td><code>if x :| P(x) {</code><br>&nbsp;&nbsp;<code>  assert Q(x);</code><br>&nbsp;&nbsp;<code>  assert Q'(x);</code><br><code>} else {</code><br>&nbsp;&nbsp;<code>  assert false;</code><br><code>}</code></td>
    </tr>
    <tr>
      <td><br><code>assert exists x :: P(x);</code><br></td>
      <td><code>assert P(x0);</code><br><code>assert exists x :: P(x);</code><br>for a given expression <code>x0</code>.</td>
    </tr>
    <tr>
      <td><br><code>ensures exists i :: P(i);</code><br></td>
      <td><code>returns (j: int)</code><br><code>ensures P(j) ensures exists i :: P(i)</code><br>in a lemma, so that the <code>j</code> can be computed explicitly.</td>
    </tr>
    <tr>
      <td><br><br><code>assert A == B;</code><br><code>callLemma(x);</code><br><code>assert B == C;</code><br></td>
      <td><a href="#sec-calc-statement"><code>calc == {</code></a><br>&nbsp;&nbsp;<code>  A;</code><br>&nbsp;&nbsp;<code>  B;</code><br>&nbsp;&nbsp;<code>  { callLemma(x); }</code><br>&nbsp;&nbsp;<code>  C;</code><br><code>};</code><br><code>assert A == B;</code><br>where the <a href="#sec-calc-statement"><code>calc</code></a> statement can be used to make intermediate computation steps explicit. Works with <code>&lt;</code>, <code>&gt;</code>, <code>&lt;=</code>, <code>&gt;=</code>, <code>==&gt;</code>, <code>&lt;==</code> and <code>&lt;==&gt;</code> for example.</td>
    </tr>
    <tr>
      <td><br><br><br><code>assert A ==&gt; B;</code></td>
      <td><code>if A {</code><br>&nbsp;&nbsp;<code>  assert B;</code><br><code>};</code><br><code>assert A ==&gt; B;</code></td>
    </tr>
    <tr>
      <td><br><br><code>assert A &amp;&amp; B;</code></td>
      <td><code>assert A;</code><br><code>assert B;</code><br><code>assert A &amp;&amp; B;</code></td>
    </tr>
    <tr>
      <td><br><code>assert P(x);</code><br>where <code>P</code> is an <a href="#sec-opaque"><code>{:opaque}</code></a> predicate</td>
      <td><a href="#sec-reveal-statement"><code>reveal P();</code></a><br><code>assert P(x);</code><br><br></td>
    </tr>
    <tr>
      <td><code>assert P(x);</code><br>where <code>P</code> is an <a href="#sec-opaque"><code>{:opaque}</code></a> predicate<br><br></td>
      <td><a href="#sec-assert-statement"><code>assert P(x) by {</code></a><br><a href="#sec-reveal-statement">&nbsp;&nbsp;<code>  reveal P();</code></a><br><code>}</code></td>
    </tr>
    <tr>
      <td><code>assert P(x);</code><br>where <code>P</code> is not an <a href="#sec-opaque"><code>{:opaque}</code></a> predicate with a lot of <code>&amp;&amp;</code> in its body and is assumed</td>
      <td>Make <code>P</code> <a href="#sec-opaque"><code>{:opaque}</code></a> so that if its assumed, it can be proven more easily. You can always <a href="#sec-reveal-statement">reveal</a> it when needed.</td>
    </tr>
    <tr>
      <td><code>ensures P ==&gt; Q</code> on a lemma<br></td>
      <td><code>requires P ensures Q</code> to avoid accidentally calling the lemma on inputs that do not satisfy <code>P</code></td>
    </tr>
    <tr>
      <td><code>seq(size, i =&gt; P)</code></td>
      <td><code>seq(size, i requires 0 &lt;= i &lt; size =&gt; P);</code></td>
    </tr>
    <tr>
      <td><br><br><code>assert forall x :: G(i) ==&gt; R(i);</code></td>
      <td><code>assert G(i0);</code><br><code>assert R(i0);</code><br><code>assert forall i :: G(i) ==&gt; R(i);</code> with a guess of the <code>i0</code> that makes the second assert to fail.</td>
    </tr>
    <tr>
      <td><br><br><code>assert forall i | 0 &lt; i &lt;= m :: P(i);</code></td>
      <td><code>assert forall i | 0 &lt; i &lt; m :: P(i);</code><br><code>assert forall i | i == m :: P(i);</code><br><code>assert forall i | 0 &lt; i &lt;= m :: P(i);</code><br><br></td>
    </tr>
    <tr>
      <td><br><br><code>assert forall i | i == m :: P(m);</code></td>
      <td><code>assert P(m);</code><br><code>assert forall i | i == m :: P(i);</code></td>
    </tr>
    <tr>
      <td><code>method m(i) returns (j: T)</code><br>&nbsp;&nbsp;<code>  requires A(i)</code><br>&nbsp;&nbsp;<code>  ensures B(i, j)</code><br><code>{</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code><br><br><code>method n() {</code><br>&nbsp;&nbsp;<code>  ...</code><br><br><br>&nbsp;&nbsp;<code>  var x := m(a);</code><br>&nbsp;&nbsp;<code>  assert P(x);</code></td>
      <td><code>method m(i) returns (j: T)</code><br>&nbsp;&nbsp;<code>  requires A(i)</code><br>&nbsp;&nbsp;<code>  ensures B(i, j)</code><br><code>{</code><br>&nbsp;&nbsp;<code>  ...</code><br><code>}</code><br><br><code>method n() {</code><br>&nbsp;&nbsp;<code>  ...</code><br>&nbsp;&nbsp;<code>  assert A(k);</code><br>&nbsp;&nbsp;<code>  assert forall x :: B(k, x) ==&gt; P(x);</code><br>&nbsp;&nbsp;<code>  var x := m(k);</code><br>&nbsp;&nbsp;<code>  assert P(x);</code></td>
    </tr>
  </tbody>
</table>

<h4 id="sec-verification-debugging-slow">24.8.2. Verification debugging when verification is slow</h4>

<p>In this section, we describe techniques to apply in the case when 
verification is slower than expected, does not terminate, or timeouts.</p>

<h5 id="sec-assume-false">24.8.2.1. <code>assume false;</code></h5>

<p>Assuming <code>false</code> is an empirical way to short-circuit the verifier and usually stop verification at a given point<sup id="fnref:explainer-assume-false" role="doc-noteref"><a href="#fn:explainer-assume-false" class="footnote" rel="footnote">14</a></sup>, and since the final compilation steps do not accept this command, it is safe to use it during development.
Another similar command, <code>assert false;</code>, would also short-circuit the verifier, but it would still make the verifier try to prove <code>false</code>, which can also lead to timeouts.</p>

<p>Thus, let us say a program of this shape takes forever to verify.</p>

<pre><code class="language-dafny">method NotTerminating(b: bool) {
   assert X;
   if b {
     assert Y;
   } else {
     assert Z;
     assert P;
   }
}
</code></pre>

<p>What we can first do is add an <code>assume false</code> at the beginning of the method:</p>

<pre><code class="language-dafny">method NotTerminating() {
   assume false; // Will never compile, but everything verifies instantly
   assert X;
   if b {
     assert Y;
   } else {
     assert Z;
     assert P;
   }
   assert W;
}
</code></pre>

<p>This verifies instantly. This gives use a strategy to bissect, or do 
binary search to find the assertion that slows everything down.
Now, we move the <code>assume false;</code> below the next assertion:</p>

<pre><code class="language-dafny">method NotTerminating() {
   assert X;
   assume false;
   if b {
     assert Y;
   } else {
     assert Z;
     assert P;
   }
   assert W;
}
</code></pre>

<p>If verification is slow again, we can use <a href="#sec-verification-debugging">techniques seen before</a> to decompose the assertion and find which component is slow to prove.</p>

<p>If verification is fast, thats the sign that <code>X</code> is probably not the problem,. We now move the <code>assume false;</code> after the if/then block:</p>

<pre><code class="language-dafny">method NotTerminating() {
   assert X;
   if b {
     assert Y;
   } else {
     assert Z;
     assert P;
   }
   assume false;
   assert W;
}
</code></pre>

<p>Now, if verification is fast, we know that <code>assert W;</code> is the problem. If it is slow, we know that one of the two branches of the <code>if</code> is the problem.
The next step is to put an <code>assume false;</code> at the end of the <code>then</code> branch, and an <code>assume false</code> at the beginning of the else branch:</p>

<pre><code class="language-dafny">method NotTerminating() {
   assert X;
   if b {
     assert Y;
     assume false;
   } else {
     assume false;
     assert Z;
     assert P;
   }
   assert W;
}
</code></pre>

<p>Now, if verification is slow, it means that <code>assert Y;</code> is the problem.
If verification is fast, it means that the problem lies in the <code>else</code> branch.
One trick to ensure we measure the verification time of the <code>else</code> branch and not the then branch is to move the first <code>assume false;</code> to the top of the then branch, along with a comment indicating that we are short-circuiting it for now.
Then, we can move the second <code>assume false;</code> down and identify which of the two assertions makes the verifier to be slow.</p>

<pre><code class="language-dafny">method NotTerminating() {
   assert X;
   if b {
     assume false; // Short-circuit because this branch is verified anyway
     assert Y;
   } else {
     assert Z;
     assume false;
     assert P;
   }
   assert W;
}
</code></pre>

<p>If verification is fast, which of the two assertions <code>assert Z;</code> or <code>assert P;</code> causes the slowdown?<sup id="fnref:answer-slowdown" role="doc-noteref"><a href="#fn:answer-slowdown" class="footnote" rel="footnote">15</a></sup></p>

<p>We now hope you know enough of <code>assume false;</code> to locate assertions that make verification slow.
Nest, we will describe some other strategies at the assertion level to figure out what happens and perhaps fix it.</p>

<h5 id="sec-verification-debugging-assert-by">24.8.2.2. <code>assert ... by {}</code></h5>

<p>If an assertion <code>assert X;</code> is slow, it is possible that 
calling a lemma or invoking other assertions can help proving it: The 
postcondition of this lemma, or the added assertions, could help the 
Dafny verifier figure out faster how to prove the result.</p>

<pre><code class="language-dafny">  assert SOMETHING_HELPING_TO_PROVE_LEMMA_PRECONDITION;
  LEMMA();
  assert X;
...
lemma () 
  requires LEMMA_PRECONDITION
  ensures X { ... }
</code></pre>

<p>However, this approach has the problem that it exposes the asserted 
expressions and lemma postconditions not only for the assertion we want 
to prove faster,
but also for every assertion that appears afterwards. This can result in
 slowdowns<sup id="fnref:verifier-lost" role="doc-noteref"><a href="#fn:verifier-lost" class="footnote" rel="footnote">16</a></sup>.
A good practice consists of wrapping the intermediate verification steps in an <code>assert ... by {}</code>, like this:</p>

<pre><code class="language-dafny">  assert X by {
    assert SOMETHING_HELPING_TO_PROVE_LEMMA_PRECONDITION;
    LEMMA();
  }
</code></pre>

<p>Now, only <code>X</code> is available for the Dafny Verifier to prove the rest of the method.</p>

<h5 id="sec-labeling-revealing-assertions">24.8.2.3. Labeling and revealing assertions</h5>

<p>Another way to prevent assertions or preconditions from cluttering the verifier<sup id="fnref:verifier-lost:1" role="doc-noteref"><a href="#fn:verifier-lost" class="footnote" rel="footnote">16</a></sup> is to label and reveal them.
Labeling an assertion has the effect of hiding its result, until there is a reveal calling that label.</p>

<p>The example of the <a href="#sec-verification-debugging-assert-by">previous section</a> could be written like this.</p>

<pre><code class="language-dafny">  assert p: SOMETHING_HELPING_TO_PROVE_LEMMA_PRECONDITION;
  // p is not available here.
  assert X by {
    reveal p;
    LEMMA();
  }
</code></pre>

<p>Similarly, if a precondition is only needed to prove a specific 
result in a method, one can label and reveal the precondition, like 
this:</p>

<pre><code class="language-dafny">method Slow(i: int, j: int)
  requires greater: i &gt; j {
  
  assert i &gt;= j by {
    reveal greater;
  }
}
</code></pre>

<h5 id="sec-non-opaque-function-method">24.8.2.4. Non-opaque <code>function method</code></h5>

<p>Functions are normally used for specifications, but their functional 
syntax is sometimes also desirable to write application code.
However, doing so naively results in the body of a <code>function method Fun()</code> be available for every caller, which can cause the verifier to time out or get extremely slow<sup id="fnref:verifier-lost:2" role="doc-noteref"><a href="#fn:verifier-lost" class="footnote" rel="footnote">16</a></sup>.
A solution for that is to add the attribute <a href="#sec-opaque"><code>{:opaque}</code></a> right between <code>function method</code> and <code>Fun()</code>, and use <a href="#sec-reveal-statement"><code>reveal Fun();</code></a> in the calling functions or methods when needed.</p>

<h5 id="sec-conversion-to-and-from-bitvectors">24.8.2.5. Conversion to and from bitvectors</h5>

<p>Bitvectors and natural integers are very similar, but they are not 
treated the same by the Dafny verifier. As such, conversion from <code>bv8</code> to an <code>int</code> and vice-versa is not straightforward, and can result in slowdowns.</p>

<p>There are two solutions to this for now. First, one can define a <a href="#sec-subset-types">subset type</a> instead of using the built-in type <code>bv8</code>:</p>

<pre><code class="language-dafny">type byte = x | 0 &lt;= x &lt; 256
</code></pre>

<p>One of the problems of this approach is that additions, substractions
 and multiplications do not enforce the result to be in the same bounds,
 so it would have to be checked, and possibly truncated with modulos. 
For example:</p>

<pre><code class="language-dafny">  var a: byte := 250;
  var b: byte := 200;
  var c := b - a;               // inferred to be an 'int', its value will be 50.
  var d := a + b;               // inferred to be an 'int', its value will be 450.
  var e := (a + b) % 256;       // still inferred to be an 'int'...
  var f: byte := (a + b) % 256; // OK
</code></pre>

<p>A better solution consists of creating a <a href="#sec-newtypes">newtype</a> that will have the ability to check bounds of arithmetic expressions, and can actually be compiled to bitvectors as well.</p>

<pre><code class="language-dafny">newtype {:nativeType "char"} byte = x | 0 &lt;= x &lt; 256
  var a: byte := 250;
  var b: byte := 200;
  var c := b - a; // OK, inferred to be a byte
  var d := a + b; // Error: cannot prove that the result of a + b is of type `byte`.
  var f := ((a as int + b as int) % 256) as byte // OK
</code></pre>

<p>One might consider refactoring this code into separate functions if used over and over.</p>

<h5 id="sec-nested-loops">24.8.2.6. Nested loops</h5>

<p>In the case of nested loops, the verifier might timeout sometimes because of the information available<sup id="fnref:verifier-lost:3" role="doc-noteref"><a href="#fn:verifier-lost" class="footnote" rel="footnote">16</a></sup>.
One way to mitigate this problem, when it happens, is to isolate the 
inner loop by refactoring it into a separate method, with suitable pre 
and postconditions that will usually assume and prove the invariant 
again.
For example,</p>

<pre><code class="language-dafny">`while X
   invariant Y
 {
   while X'
     invariant Y'
   {
 
   }
 }
</code></pre>

<p>could be refactored as this:</p>

<pre><code class="language-dafny">`while X
   invariant Y
 {
   innerLoop();
 }
...
method innerLoop()
  require Y'
  ensures Y'
</code></pre>

<p>In the next section, when everything can be proven in a timely 
manner, we explain another strategy to decrease proof time by 
parallelizing it if needed, and making the verifier focus on certain 
parts.</p>

<h4 id="sec-assertion-batches">24.8.3. Assertion batches</h4>

<p>To understand how to control verification,
it is first useful to understand how Dafny verifies functions and methods.</p>

<p>For every method (or function, constructor, etc.), Dafny extracts <em>assertions</em>. Here is a non-exhaustive list of such extracted assertions:</p>

<p><strong>Integer assertions:</strong></p>

<ul>
  <li>Every <a href="#sec-numeric-types">division</a> yields an <em>assertion</em> that the divisor is never zero.</li>
  <li>Every <a href="#sec-numeric-types">bounded number operation</a> yields an <em>assertion</em> that the result will be within the same bounds (no overflow, no underflows).</li>
  <li>Every <a href="#sec-as-expression">conversion</a> yields an <em>assertion</em> that conversion is compatible.</li>
  <li>Every <a href="#sec-bit-vector-types">bitvector shift</a> yields an <em>assertion</em> that the shift amount is never negative, and that the shift amount is within the width of the value.</li>
</ul>

<p><strong>Object assertions:</strong></p>

<ul>
  <li>Every <a href="#sec-class-types">object property access</a> yields an <em>assertion</em> that the object is not null.</li>
  <li>Every assignment <code>o.f := E;</code> yield an <em>assertion</em> that <code>o</code> is among the set of objects of the <code>modifies</code> clause of the enclosing <a href="#sec-loop-framing">loop</a> or <a href="#sec-modifies-clause">method</a>.</li>
  <li>Every read <code>o.f</code> yield an <em>assertion</em> that <code>o</code> is among the set of objects of the <a href="#sec-reads-clause"><code>reads</code></a> clause of the enclosing function or predicate; or the <a href="#sec-modifies-clause"><code>modifies</code></a> clause of the enclosing method.</li>
  <li>Every <a href="#sec-array-types">array access</a> <code>a[x]</code> yield the assertion that <code>0 &lt;= x &lt; a.Length</code>.</li>
  <li>Every <a href="#sec-sequences">sequence access</a> <code>a[x]</code> yield an <em>assertion</em>, that <code>0 &lt;= x &lt; |a|</code>, because sequences are never null.</li>
  <li>Every <a href="#sec-datatype-update-suffix">datatype update expression</a> and <a href="#sec-algebraic-datatype">datatype destruction</a> yields an <em>assertion</em> that the object has the given property.</li>
  <li>Every method overriding a <a href="#sec-trait-types"><code>trait</code></a> yield an <em>assertion</em> that any postcondition it provides is equal to or more detailed than in its parent trait, and an <em>assertion</em> that any precondition it provides is equal to or more permissive than in its parent trait.</li>
</ul>

<p><strong>Other implicit assertions:</strong></p>

<ul>
  <li>Every value whose type is assigned to a <a href="#sec-subset-types">subset type</a> yields an <em>assertion</em> that it satisfies the subset type constraint.</li>
  <li>Every non-empty <a href="#sec-subset-types">subset type</a> yields an <em>assertion</em> that its witness satisfies the constraint.</li>
  <li><a href="#sec-update-and-call-statement">Assign-such-that operators</a> <code>x :| P(x)</code> yield an <em>assertion</em> that <code>exists x :: P(x)</code>.</li>
  <li>Every recursive function yield an <em>assertion</em> that <a href="#sec-loop-termination">it terminates</a>.</li>
  <li>Every <a href="#sec-match-expression">match expression</a> or <a href="#sec-if-statement">alternative if statement</a> yield an <em>assertion</em> that all cases are covered.</li>
</ul>

<p><strong>Explicit assertions:</strong></p>

<ul>
  <li>Any explicit <a href="#sec-assert-statement"><code>assert</code></a> statement is <em>an assertion</em><sup id="fnref:precision-requires-clause" role="doc-noteref"><a href="#fn:precision-requires-clause" class="footnote" rel="footnote">17</a></sup>.</li>
  <li>A consecutive pair of lines in a <a href="#sec-calc-statement"><code>calc</code></a> statement forms <em>an assertion</em> that the expressions are related according to the common operator.</li>
  <li>Every call to a function or method with a <a href="#sec-requires-clause"><code>requires</code></a> clause yields <em>one assertion per requires clause</em><sup id="fnref:precision-requires-clause:1" role="doc-noteref"><a href="#fn:precision-requires-clause" class="footnote" rel="footnote">17</a></sup>
(special cases such as sequence indexing come with a special require clause that the index is within bounds).</li>
  <li>Every <a href="#sec-ensures-clause"><code>ensures</code></a> clause yields an <em>assertion</em> at the end of the method and on every return, and on <a href="#sec-forall-statement"><code>forall</code></a> statements.</li>
  <li>Every <a href="#sec-invariant-clause"><code>invariant</code></a> clause yields an <em>assertion</em> that it holds before the loop and an <em>assertion</em> that it holds at the end of the loop.</li>
  <li>Every <a href="#sec-decreases-clause"><code>decreases</code></a> clause yields an <em>assertion</em> at either a call site or at the end of a while loop.</li>
  <li>Every <a href="#sec-iterator-specification"><code>yield ensures</code></a> clause on <a href="#sec-iterator-types">iterator</a> yield <em>assertions</em> that the clause hold at every yielding point.</li>
  <li>Every <a href="#sec-iterator-specification"><code>yield requires</code></a> clause on <a href="#sec-iterator-types">iterator</a> yield <em>assertions</em> that the clause hold at every point when the iterator is called.</li>
</ul>

<p>It is useful to mentally visualize all these assertions as a list that roughly follows the order in the code,
except for <code>ensures</code> or <code>decreases</code> that generate assertions that seem earlier in the code but, for verification purposes, would be placed later.
In this list, each assertion depends on other assertions, statements and expressions that appear earlier in the control flow<sup id="fnref:complexity-path-encoding" role="doc-noteref"><a href="#fn:complexity-path-encoding" class="footnote" rel="footnote">18</a></sup>.</p>

<p>The fundamental unit of verification in Dafny is an <em>assertion batch</em>,
 which consists of one or more assertions from this list, along with 
all the remaining assertions turned into assumptions. To reduce 
overhead, by default Dafny collects all the assertions in the body of a 
given method into a single assertion batch that it sends to the 
verifier, which tries to prove it correct.</p>

<ul>
  <li>If the verifier says it is correct<sup id="fnref:smt-encoding" role="doc-noteref"><a href="#fn:smt-encoding" class="footnote" rel="footnote">19</a></sup>, it means that all the assertions hold.</li>
  <li>If the verifier returns a counterexample, this counterexample is 
used to determine both the failing assertion and the failing path.
In order to retrieve additional failing assertions, Dafny will again 
query the verifier after turning previously failed assertions into 
assumptions.<sup id="fnref:example-assertion-turned-into-assumption" role="doc-noteref"><a href="#fn:example-assertion-turned-into-assumption" class="footnote" rel="footnote">20</a></sup> <sup id="fnref:caveat-about-assertion-and-assumption" role="doc-noteref"><a href="#fn:caveat-about-assertion-and-assumption" class="footnote" rel="footnote">21</a></sup></li>
  <li>If the verifier returns <code>unknown</code> or times out, or even
 preemptively for difficult assertions or to reduce the chance that the 
verifier will be confused by the many assertions in a large batch, 
Dafny may partition the assertions into smaller batches<sup id="fnref:smaller-batches" role="doc-noteref"><a href="#fn:smaller-batches" class="footnote" rel="footnote">22</a></sup>. An extreme case is the use of the <code>/vcsSplitOnEveryAssert</code> command-line option or the <a href="#sec-vcs_split_on_every_assert"><code>{:vcs_split_on_every_assert}</code> attribute</a>, which causes Dafny to make one batch for each assertion.</li>
</ul>

<h5 id="sec-assertion-batches-control">24.8.3.1. Controlling assertion batches</h5>

<p>Here is how you can control how Dafny partitions assertions into batches.</p>

<ul>
  <li><a href="#sec-focus"><code>{:focus}</code></a> on an assert generates a separate assertion batch for the assertions of the enclosing block.</li>
  <li><a href="#sec-split_here"><code>{:split_here}</code></a> on an assert generates a separate assertion batch for assertions after this point.</li>
  <li><a href="#sec-vcs_split_on_every_assert"><code>{:vcs_split_on_every_assert}</code></a> on a function or a method generates one assertion batch per assertion</li>
</ul>

<p>We discourage the use of the following <em>heuristics attributes</em>
 to partition assertions into batches.
The effect of these attributes may vary, because they are low-level 
attributes and tune low-level heuristics, and will result in splits that
 could be manually controlled anyway.</p>
<ul>
  <li><a href="#sec-vcs_max_cost"><code>{:vcs_max_cost N}</code></a> on a function or method enables splitting the assertion batch until the cost of each batch is below N.
Usually, you would set <a href="#sec-vcs_max_cost"><code>{:vcs_max_cost 0}</code></a> and <a href="#sec-vcs_max_splits"><code>{:vcs_max_splits N}</code></a> to ensure it generates N assertion batches.</li>
  <li><a href="#sec-vcs_max_keep_going_splits"><code>{:vcs_max_keep_going_splits N}</code></a>
 where N &gt; 1 on a method dynamically splits the initial assertion 
batch up to N components if the verifier is stuck the first time.</li>
</ul>

<h4 id="sec-command-line-options-and-attributes-for-verification">24.8.4. Command-line options and other attributes to control verification</h4>

<p>There are many great options that control various aspects of verifying dafny programs. Here we mention only a few:</p>

<ul>
  <li>Control of output: <a href="#sec-controlling-output"><code>/dprint</code></a>, <a href="#sec-controlling-output"><code>/rprint</code></a>, <code>/stats</code>, <a href="#sec-controlling-compilation"><code>/compileVerbose</code></a></li>
  <li>Whether to print warnings: <code>/proverWarnings</code></li>
  <li>Control of time: <code>/timeLimit</code></li>
  <li>Control of resources: <code>/rLimit</code> and <code>{:rlimit}</code></li>
  <li>Control of the prover used: <code>/prover</code></li>
  <li>Control of how many times to <em>unroll</em> functions: <a href="#sec-fuel"><code>{:fuel}</code></a></li>
</ul>

<p>You can search for them in <a href="https://dafny-lang.github.io/dafny/DafnyRef/DafnyRef">this file</a> as some of them are still documented in raw text format.</p>

<h3 id="sec-compilation">24.9. Compilation</h3>

<p>The <code>dafny</code> tool can compile a Dafny program to one of several target languages. Details and idiosyncrasies of each
of these are described in the following subsections. In general note the following:</p>

<ul>
  <li>The compiled code originating from <code>dafny</code> can be compiled with other source and binary code, but only the <code>dafny</code>-originated code is verified.</li>
  <li>Output file names can be set using <code>-out</code>.</li>
  <li>Code generated by Dafny relies requires a Dafny-specific runtime 
library.  By default the runtime is included in the generated code for 
most languages (use <code>-useRuntimeLib</code> to omit it).  For Java and C++ the runtime must be linked to separately, except when running the generated code using Dafnys <code>-compile:3</code> or <code>-compile:4</code>.  All runtime libraries are part of the Binary (<code>./DafnyRuntime.*</code>) and Source (<code>./Source/DafnyRuntime/DafnyRuntime.*</code>) releases.</li>
  <li>Names in Dafny are written out as names in the target language. In
 some cases this can result in naming conflicts. Thus if a Dafny program
 is intended to be compiled to a target language X, you should avoid 
using Dafny identifiers that are not legal identifiers in X or that 
conflict with reserved words in X.</li>
</ul>

<h4 id="sec-user-guide-main">24.9.1. Main method</h4>

<p>To generate a stand-alone executable from a Dafny program, the
Dafny program must use a specific method as the executable entry point.
That method is determined as follows:</p>

<ul>
  <li>If the /Main option is specified on the command-line with an argument of -, then no entry point is used at all</li>
  <li>If the /Main option is specified on the command-line and its 
argument is
not an empty string, then its argument is
interpreted as the fully-qualified name of a method to be used as the 
entry point. If there is no matching method, an error message is issued.</li>
  <li>Otherwise, the program is searched for a method with the attribute <code>{:main}</code>.
If exactly one is found, that method is used as the entry point; if more
than one method has the <code>{:main}</code> attribute, an error message is issued.</li>
  <li>Otherwise, the program is searched for a method with the name <code>Main</code>.
If more than one is found
an error message is issued.</li>
</ul>

<p>Any abstract modules are not searched for candidate entry points,
but otherwise the entry point may be in any module or type. In addition,
an entry-point candidate must satisfy the following conditions:</p>

<ul>
  <li>The method takes no parameters or type parameters</li>
  <li>The method is not a ghost method</li>
  <li>The method has no requires or modifies clauses, unless it is marked <code>{:main}</code></li>
  <li>If the method is an instance (that is, non-static) method and the
enclosing type is a class,
then that class must not declare any constructor.
In this case, the runtime system will
allocate an object of the enclosing class and will invoke
the entry-point method on it.</li>
  <li>If the method is an instance (that is, non-static) method and the
enclosing type is not a class,
then the enclosing type must, when instantiated with auto-initializing
type parameters, be an auto-initialing type.
In this case, the runtime system will
invoke the entry-point method on a value of the enclosing type.</li>
</ul>

<p>Note, however, that the following are allowed:</p>

<ul>
  <li>The method is allowed to have <code>ensures</code> clauses</li>
  <li>The method is allowed to have <code>decreases</code> clauses, including a
<code>decreases *</code>. (If Main() has a <code>decreases *</code>, then its execution may
go on forever, but in the absence of a <code>decreases *</code> on Main(), Dafny
will have verified that the entire execution will eventually
terminate.)</li>
</ul>

<p>If no legal candidate entry point is identified, <code>dafny</code> will still produce executable output files, but
they will need to be linked with some other code in the target language that
provides a <code>main</code> entry point.</p>

<h4 id="2492-extern-declarations">24.9.2. extern declarations</h4>

<p>TO BE WRITTEN</p>

<h4 id="2493-c">24.9.3. C#</h4>

<p>TO BE WRITTEN</p>

<h4 id="2494-java">24.9.4. Java</h4>

<p>The Dafny-to-Java compiler writes out the translated files of a file <em>A</em><code>.dfy</code>
to a directory <em>A</em>-java. The <code>-out</code> option can be used to choose a
different output directory. The file <em>A</em><code>.dfy</code> is translated to <em>A</em><code>.java</code>,
which is placed in the output directory along with helper files.
If more than one <code>.dfy</code> file is listed on the command-line, then the output
directory name is taken from the first file, and <code>.java</code> files are written
for each of the <code>.dfy</code> files.</p>

<p>TO BE WRITTEN</p>

<h4 id="2495-javascript">24.9.5. Javascript</h4>

<p>TO BE WRITTEN</p>

<h4 id="2496-go">24.9.6. Go</h4>

<p>TO BE WRITTEN</p>

<h4 id="2497-c">24.9.7. C++</h4>

<p>The C++ backend was written assuming that it would primarily support writing
C/C++ style code in Dafny, which leads to some limitations in the current
implementation.</p>

<ul>
  <li>We do not support BigIntegers, so do not use <code>int</code>, or raw instances of
<code>arr.Length</code>, or sequence length, etc. in executable code.  You can however,
use <code>arr.Length as uint64</code> if you can prove your array is an appropriate
size.  The compiler will report inappropriate integer use.</li>
  <li>We do not support more advanced Dafny features like traits or co-inductive
types.</li>
  <li>Very limited support for higher order functions even for array init.  Use
extern definitions like newArrayFill (see [extern.dfy]
(https://github.com/dafny-lang/dafny/blob/master/Test/c++/extern.dfy)) or
similar.  See also the example in [<code>functions.dfy</code>]
(https://github.com/dafny-lang/dafny/blob/master/Test/c++/functions.dfy).</li>
  <li>The current backend also assumes the use of C++17 in order to cleanly and
performantly implement datatypes.</li>
</ul>

<h3 id="sec-command-line-options">24.10. Dafny Command Line Options</h3>

<p>There are many command-line options to the <code>dafny</code> tool.
The most current documentation of the options is within the tool itself,
using the <code>/?</code> or <code>/help</code> option.</p>

<p>Remember that options can be stated with either a leading <code>/</code> or a leading <code>-</code>.</p>

<h4 id="sec-controlling-help">24.10.1. Help and version information</h4>

<p>These options select output including documentation on command-line
options or attribute declarations, information on the version of Dafny
being used, and information about how Dafny was invoked.</p>

<ul>
  <li>
    <p><code>-?</code> or <code>-help</code> - print out the current list of command-line options
and terminate. All of these options are also described in this and
the following sections.</p>
  </li>
  <li>
    <p><code>-attrHelp</code> - print out the current list of supported attribute
declarations and terminate.</p>
  </li>
  <li>
    <p><code>-version</code> - print the version of the executable being invoked and
terminate.</p>
  </li>
  <li>
    <p><code>-env:&lt;n&gt;</code> - print the command-line arguments supplied to the program.
The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - never print command-line arguments.</p>
      </li>
      <li>
        <p><code>1</code> (default) - print them to Boogie (<code>.bpl</code>) files and prover logs.</p>
      </li>
      <li>
        <p><code>2</code> - operate like with option <code>1</code> but also print to standard output.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-wait</code> - wait for the user to press <code>Enter</code> before terminating after a successful execution.</p>
  </li>
</ul>

<h4 id="sec-controlling-input">24.10.2. Controlling input</h4>

<p>These options control how Dafny processes its input.</p>

<ul>
  <li>
    <p><code>-dprelude:&lt;file&gt;</code> - select an alternative Dafny prelude file. This
file contains Boogie definitions (including many axioms) required by
the translator from Dafny to Boogie. Using an alternative prelude is
primarily useful if youre extending the Dafny language or changing
how Dafny constructs are modeled. The default prelude is here:</p>

    <p><a href="https://github.com/dafny-lang/dafny/blob/master/Source/Dafny/DafnyPrelude.bpl">https://github.com/dafny-lang/dafny/blob/master/Source/Dafny/DafnyPrelude.bpl</a></p>
  </li>
  <li>
    <p><code>-stdin</code> - read standard input and treat it as Dafny souce code,
instead of reading from a file.</p>
  </li>
</ul>

<h4 id="sec-controlling-plugins">24.10.3. Controlling plugins</h4>

<p>TO BE WRITTEN</p>

<h4 id="sec-controlling-output">24.10.4. Controlling output</h4>

<p>These options instruct Dafny to print various information about your
program during processing, including variations of the original source
code (which can be helpful for debugging).</p>

<ul>
  <li>
    <p><code>-stats</code> - print various statistics about the Dafny files supplied on
the command line. The statistics include the number of total
functions, recursive functions, total methods, ghost methods, classes,
and modules. They also include the maximum call graph width and the
maximum module height.</p>
  </li>
  <li>
    <p><code>-dprint:&lt;file&gt;</code> - print the Dafny program after parsing (use <code>-</code> for
<code>&lt;file&gt;</code> to print to the console).</p>
  </li>
  <li>
    <p><code>-rprint:&lt;file&gt;</code> - print the Dafny program after type resolution (use
<code>-</code> for <code>&lt;file&gt;</code> to print to the console).</p>
  </li>
  <li>
    <p><code>-printMode:&lt;Everything|DllEmbed|NoIncludes|NoGhost&gt;</code> - select what to
include in the output requested by <code>-dprint</code> or <code>-rprint</code>. The
argument can be one of the following.</p>

    <ul>
      <li>
        <p><code>Everything</code> (default) - include everything.</p>
      </li>
      <li>
        <p><code>DllEmbed</code>- print the source that will be included in a compiled DLL.</p>
      </li>
      <li>
        <p><code>NoIncludes</code> - disable printing of methods incorporated via the
include mechanism that have the <code>{:verify false}</code> attribute, as well
as datatypes and fields included from other files.</p>
      </li>
      <li>
        <p><code>NoGhost</code> - disabls printing of functions, ghost methods, and proof
statements in implementation methods. Also disable anything
<code>NoIncludes</code> disables.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-printIncludes:&lt;None|Immediate|Transitive&gt;</code> - select what information
from included files to incorporate into the output selected by
<code>-dprint</code> or <code>-rprint</code>. The argument can be one of the following.</p>

    <ul>
      <li>
        <p><code>None</code> (default) - dont print anything from included files.</p>
      </li>
      <li>
        <p><code>Immediate</code> - print files directly included by files specified on
the command line. Exit after printing.</p>
      </li>
      <li>
        <p><code>Transitive</code> - print files transitively included by files specified
on the command line. Exit after printing.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-view:&lt;view1, view2&gt;</code> - TO BE WRITTEN</p>
  </li>
  <li>
    <p><code>-funcCallGraph</code> - print out the function call graph. Each line has
the format <code>func,mod=callee*</code>, where <code>func</code> is the name of a function,
<code>mod</code> is the name of its containing module, and <code>callee*</code> is a
space-separated list of the functions that <code>func</code> calls.</p>
  </li>
  <li>
    <p><code>-showSnippets:&lt;n&gt;</code> - show a source code snippet for each Dafny
message. The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> (default) - dont print snippets.</p>
      </li>
      <li>
        <p><code>1</code> - do print snippets.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-printTooltips</code> - dump additional positional information (displayed
as mouse-over tooltips by LSP clients) to standard output as <code>Info</code>
messages.</p>
  </li>
  <li>
    <p><code>-pmtrace</code> - print debugging information from the pattern-match
compiler.</p>
  </li>
  <li>
    <p><code>-titrace</code> - print debugging information during the type inference
process.</p>
  </li>
</ul>

<h4 id="sec-controlling-language">24.10.5. Controlling language features</h4>

<p>These options allow some Dafny language features to be enabled or
disabled. Some of these options exist for backward compatibility with
older versions of Dafny.</p>

<ul>
  <li>
    <p><code>-noIncludes</code> - ignore <code>include</code> directives in the program.</p>
  </li>
  <li>
    <p><code>-noExterns</code> - ignore <code>extern</code> and <code>dllimport</code> attributes in the
program.</p>
  </li>
  <li>
    <p><code>-functionSyntax:&lt;version&gt;</code> - select what function syntax to
recognize. The syntax for functions is changing from Dafny version 3
to version 4. This switch gives early access to the new syntax, and
also provides a mode to help with migration. The valid arguments
include the following.</p>

    <ul>
      <li>
        <p><code>3</code> (default) - compiled functions are written <code>function method</code> and
<code>predicate method</code>. Ghost functions are written <code>function</code> and
<code>predicate</code>.</p>
      </li>
      <li>
        <p><code>4</code> - compiled functions are written <code>function</code> and <code>predicate</code>.
Ghost functions are written <code>ghost function</code> and <code>ghost predicate</code>.</p>
      </li>
      <li>
        <p><code>migration3to4</code> - compiled functions are written <code>function method</code>
and <code>predicate method</code>. Ghost functions are written <code>ghost function</code>
and <code>ghost predicate</code>. To migrate from version 3 to version 4, use
this flag on your version 3 program to flag all occurrences of
<code>function</code> and <code>predicate</code> as parsing errors. These are ghost
functions, so change those into the new syntax <code>ghost function</code> and
<code>ghost predicate</code>. Then, start using <code>-functionSyntax:4</code>. This will
flag all occurrences of <code>function method</code> and <code>predicate method</code> as
parsing errors. So, change those to just <code>function</code> and <code>predicate</code>.
As a result, your program will use version 4 syntax and have the
same meaning as your previous version 3 program.</p>
      </li>
      <li>
        <p><code>experimentalDefaultGhost</code> - like <code>migration3to4</code>, but allow
<code>function</code> and <code>predicate</code> as alternatives to declaring ghost
functions and predicates, respectively</p>
      </li>
      <li>
        <p><code>experimentalDefaultCompiled</code> - like <code>migration3to4</code>, but allow
<code>function</code> and <code>predicate</code> as alternatives to declaring compiled
functions and predic ates, respectively</p>
      </li>
      <li>
        <p><code>experimentalPredicateAlwaysGhost</code> - compiled functions are written
<code>function</code>. Ghost functions are written <code>ghost function</code>. Predicates
are always ghost and are written <code>predicate</code>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-disableScopes</code> - treat all export sets as <code>export reveal *</code> to never
  hide function bodies or type definitions during translation.</p>
  </li>
  <li>
    <p><code>-allowsGlobals</code> - allow the implicit class <code>_default</code> to contain
fields, instance functions, and instance methods. These class members
are declared at the module scope, outside of explicit classes. This
command-line option is provided to simplify a transition from the
behavior in the language prior to version 1.9.3, from which point
onward all functions and methods declared at the module scope are
implicitly static and field declarations are not allowed at the
module scope.</p>
  </li>
</ul>

<h4 id="sec-controlling-warnings">24.10.6. Controlling warnings</h4>

<p>These options control what warnings Dafny produces, and whether to treat
warnings as errors.</p>

<ul>
  <li>
    <p><code>-warnShadowing</code> - emit a warning if the name of a declared variable
caused another variable to be shadowed.</p>
  </li>
  <li>
    <p><code>-deprecation:&lt;n&gt;</code> - control warnings about deprecated features. The
value of <code>&lt;n&gt;</code> can be any of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - dont issue any warnings.</p>
      </li>
      <li>
        <p><code>1</code> (default) - issue warnings.</p>
      </li>
      <li>
        <p><code>2</code> - issue warnings and advise about alternate syntax.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-warningsAsErrors</code> - treat warnings as errors.</p>
  </li>
</ul>

<h4 id="sec-controlling-verification">24.10.7. Controlling verification</h4>

<p>These options control how Dafny verifies the input program, including
how much it verifies, what techniques it uses to perform verification,
and what information it produces about the verification process.</p>

<ul>
  <li>
    <p><code>-dafnyVerify:&lt;n&gt;</code> - turn verification of the program on or off. The
value of <code>&lt;n&gt;</code> can be any of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - stop after type checking.</p>
      </li>
      <li>
        <p><code>1</code> - continue on to verification and compilation.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-verifyAllModules</code> - verify modules that come from include directives.</p>

    <p>By default, Dafny only verifies files explicitly listed on the command
line: if <code>a.dfy</code> includes <code>b.dfy</code>, a call to <code>Dafny a.dfy</code> will detect
and report verification errors from <code>a.dfy</code> but not from <code>b.dfy</code>.</p>

    <p>With this flag, Dafny will instead verify everything: all input
modules and all their transitive dependencies. This way <code>Dafny a.dfy</code>
will verify <code>a.dfy</code> and all files that it includes (here <code>b.dfy</code>), as
well all files that these files include, etc.</p>

    <p>Running Dafny with <code>-verifyAllModules</code> on the file containing your
main result is a good way to ensure that all its dependencies verify.</p>
  </li>
  <li>
    <p><code>-separateModuleOutput</code> - output verification results for each module
separately, rather than aggregating them after they are all finished.</p>
  </li>
  <li>
    <p><code>-verificationLogger:&lt;configuration string&gt;</code> - log verification
results to the given test result logger. The currently supported
loggers are <code>trx</code>, <code>csv</code>, and <code>text</code>. These are the XML-based format
commonly used for test results for .NET languages, a custom CSV
schema, and a textual format meant for human consumption,
respectively. You can provide configuration using the same string
format as when using the <code>--logger</code> option for dotnet test, such as:</p>

    <pre><code>  -verificationLogger:trx;LogFileName=&lt;...&gt;
</code></pre>

    <p>The exact mapping of verification concepts to these formats is
experimental and subject to change!</p>

    <p>The <code>trx</code> and <code>csv</code> loggers automatically choose an output file name
by default, and print the name of this file to the console. The <code>text</code>
logger prints its output to the console by default, but can send
output to a file given the <code>LogFileName</code> option.</p>

    <p>The <code>text</code> logger also includes a more detailed breakdown of what
assertions appear in each assertion batch. When combined with the
<code>-vcsSplitOnEveryAssert</code> option, it will provide approximate time and
resource use costs for each assertion, allowing identification of
especially expensive assertions.</p>
  </li>
  <li>
    <p><code>-mimicVerificationOf:&lt;Dafny version&gt;</code> - let Dafny attempt to mimic
the verification behavior of a previous version of Dafny. This can be
useful during migration to a newer version of Dafny when a Dafny
program has proofs, such as methods or lemmas, that are unstable in
the sense that their verification may become slower or fail altogether
after logically irrelevant changes are made in the verification input.</p>

    <p>Accepted versions are: <code>3.3</code>. Note that falling back on the behavior
of version 3.3 turns off features that prevent certain classes of
verification instability.</p>
  </li>
  <li>
    <p><code>-noCheating:&lt;n&gt;</code> - control whether certain assumptions are allowed.
The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> (default) - allow <code>assume</code> statements and free invariants.</p>
      </li>
      <li>
        <p><code>1</code> - treat all assumptions as <code>assert</code> statements, and drop free
invariants.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-induction:&lt;n&gt;</code> - control the behavior of induction. The value of
<code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - never do induction, not even when attributes request it.</p>
      </li>
      <li>
        <p><code>1</code> - apply induction only when attributes request it.</p>
      </li>
      <li>
        <p><code>2</code> - apply induction as requested (by attributes) and also for
heuristically chosen quantifiers.</p>
      </li>
      <li>
        <p><code>3</code> - apply induction as requested, and for heuristically chosen
quantifiers and lemmas.</p>
      </li>
      <li>
        <p><code>4</code> (default) - apply induction as requested, and for all lemmas.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-inductionHeuristic:&lt;n&gt;</code> - control the heuristics used for induction.
The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - use the least discriminating induction heuristic (that is,
lean toward applying induction more often).</p>
      </li>
      <li>
        <p><code>1</code>, <code>2</code>, <code>3</code>, <code>4</code>, <code>5</code> - use an intermediate heuristic, ordered as
follows as far as how discriminating they are: 0 &lt; 1 &lt; 2 &lt; (3,4) &lt; 5
&lt; 6.</p>
      </li>
      <li>
        <p><code>6</code> (default) - use the most discriminating induction heuristic.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-trackPrintEffects:&lt;n&gt;</code> - control what implementations are allowed to
use <code>print</code>. The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> (default) - every compiled method, constructor, and iterator,
whether or not it bears a <code>{:print}</code> attribute, may have print
effects.</p>
      </li>
      <li>
        <p><code>1</code> - A compiled method, constructor, or iterator is allowed to have
print effects only if it is marked with the <code>{:print}</code> attribute.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-allocated:&lt;n&gt;</code> - specify defaults for where Dafny should assert and
assume <code>allocated(x)</code> for various parameters <code>x</code>, local variables <code>x</code>,
bound variables <code>x</code>, etc. Lower <code>&lt;n&gt;</code> may require more manual
<code>allocated(x)</code> annotations and thus may be more difficult to use. The
value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - never assume or assert <code>allocated(x)</code> by default.</p>
      </li>
      <li>
        <p><code>1</code> - assume <code>allocated(x)</code> only for non-ghost variables and fields.
(These assumptions are free, since non-ghost variables always
contain allocated values at run-time.) This option may speed up
verification relative to <code>-allocated:2</code>.</p>
      </li>
      <li>
        <p><code>2</code> - assert/assume <code>allocated(x)</code> on all variables, even bound
variables in quantifiers. This option is the easiest to use for code
that uses the heap heavily.</p>
      </li>
      <li>
        <p><code>3</code> - (default) make frugal use of heap parameters.</p>
      </li>
      <li>
        <p><code>4</code> - like <code>3</code> but add <code>allocated</code> antecedents when ranges dont imply
allocatedness.</p>
      </li>
    </ul>

    <p>Warning: this option should be chosen consistently across an entire
project; it would be unsound to use different defaults for different
files or modules within a project. Furthermore, modes <code>-allocated:0</code> and
<code>-allocated:1</code> let functions depend on the allocation state, which is
not sound in general.</p>
  </li>
  <li>
    <p><code>-definiteAssignment:&lt;n&gt;</code> - control the rules governing definite
assignment, the property that every variable is eventually assigned a
value along every path. The value of <code>&lt;n&gt;</code> can be one of the
following.</p>

    <ul>
      <li>
        <p><code>0</code> - ignore definite-assignment rules; this mode is unsound and is
for testing only.</p>
      </li>
      <li>
        <p><code>1</code> (default) - enforce definite-assignment rules for compiled
variables and fields whose types do not support auto-initialization
and for ghost variables and fields whose type is possibly empty.</p>
      </li>
      <li>
        <p><code>2</code> - enforce definite-assignment for all non-yield-parameter
variables and fields, regardless of their types.</p>
      </li>
      <li>
        <p><code>3</code> - like <code>2</code>, but also performs checks in the compiler that no
nondeterministic statements are used; thus, a program that passes at
this level 3 is one that the language guarantees that values seen
during execution will be the same in every run of the program.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-noAutoReq</code> - ignore <code>autoReq</code> attributes, and therefore do not
automatically generate <code>requires</code> clauses.</p>
  </li>
  <li>
    <p><code>-autoReqPrint:&lt;file&gt;</code> - print the requires clauses that were
automatically generated by <code>autoReq</code> to the given <code>&lt;file&gt;</code>.</p>
  </li>
  <li>
    <p><code>-noNLarith</code> - reduce Z3s knowledge of non-linear arithmetic (the
operators <code>*</code>, <code>/</code>, and <code>%</code>). Enabling this option will typically
require more manual work to complete proofs (by explicitly applying
lemmas about non-linear operators), but will also result in more
predictable behavior, since Z3 can sometimes get stuck down an
unproductive path while attempting to prove things about those
operators. (This option will perhaps be replaced by <code>-arith</code> in the
future. For now, it takes precedence over <code>-arith</code>.)</p>
  </li>
  <li>
    <p><code>-arith:&lt;n&gt;</code> - control how arithmetic is modeled during verification.
This is an experimental switch, and its options may change. The value
of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - use Boogie/Z3 built-ins for all arithmetic operations.</p>
      </li>
      <li>
        <p><code>1</code> (default) - like <code>0</code>, but introduce symbolic synonyms for <code>*</code>,
<code>/</code>, and <code>%</code>, and allow these operators to be used in triggers.</p>
      </li>
      <li>
        <p><code>2</code> - like <code>1</code>, but also introduce symbolic synonyms for <code>+</code> and
<code>-</code>.</p>
      </li>
      <li>
        <p><code>3</code> - turn off non-linear arithmetic in the SMT solver. Still use
Boogie/Z3 built-in symbols for all arithmetic operations.</p>
      </li>
      <li>
        <p><code>4</code> - like <code>3</code>, but introduce symbolic synonyms for <code>*</code>, <code>/</code>, and <code>%</code>,
and allow these operators to be used in triggers.</p>
      </li>
      <li>
        <p><code>5</code> - like <code>4</code>, but also introduce symbolic synonyms for <code>+</code> and
<code>-</code>.</p>
      </li>
      <li>
        <p><code>6</code> - like <code>5</code>, and introduce axioms that distribute <code>+</code> over <code>*</code>.</p>
      </li>
      <li>
        <p><code>7</code> - like <code>6</code>, and introduce facts about the associativity of
literal arguments over <code>*</code>.</p>
      </li>
      <li>
        <p><code>8</code> - like <code>7</code>, and introduce axioms for the connection between <code>*</code>,
<code>/</code>, and <code>%</code>.</p>
      </li>
      <li>
        <p><code>9</code> - like <code>8</code>, and introduce axioms for sign of multiplication.</p>
      </li>
      <li>
        <p><code>10</code> - like <code>9</code>, and introduce axioms for commutativity and
associativity of <code>*</code>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-autoTriggers:&lt;n&gt;</code> - control automatic generation of <code>{:trigger}</code>
annotations. See Section [#sec-trigger]. The value of <code>&lt;n&gt;</code> can be one
of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - do not generate <code>{:trigger}</code> annotations for user-level
quantifiers.</p>
      </li>
      <li>
        <p><code>1</code> (default) - add a <code>{:trigger}</code> annotation to each user-level
quantifier. Existing annotations are preserved.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-rewriteFocalPredicates:&lt;n&gt;</code> - control rewriting of predicates in the
body of prefix lemmas. See Section [#sec-nicer-proofs-of-extremes].
The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - dont rewrite predicates in the body of prefix lemmas.</p>
      </li>
      <li>
        <p><code>1</code> (default) - in the body of prefix lemmas, rewrite any use of a
focal predicate <code>P</code> to <code>P#[_k-1]</code>.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-extractCounterexample</code> - control generation of counterexamples. If
verification fails, report a detailed counterexample for the first
failing assertion. Requires specifying the <code>-mv</code> option, to specify
where to write the counterexample, as well as the
<code>-proverOpt:O:model_compress=false</code> and
<code>-proverOpt:O:model.completion=true</code> options.</p>
  </li>
  <li>
    <p><code>-countVerificationErrors:&lt;n&gt;</code> - if <code>0</code> then always exit with a 0 exit
code, regardless of whether errors are found. If <code>1</code> (default) then
use the appropriate exit code. This option is deprecated.</p>
  </li>
</ul>

<h4 id="sec-controlling-boogie">24.10.8. Controlling boogie</h4>

<ul>
  <li><code>-print:&lt;file&gt;</code> - print the translation of the Dafny file to a Boogie file.</li>
</ul>

<p>If you have Boogie installed locally, you can run the printed Boogie file with the following script:</p>

<pre><code>DOTNET=$(which dotnet)

BOOGIE_ROOT="path/to/boogie/Source"
BOOGIE="$BOOGIE_ROOT/BoogieDriver/bin/Debug/net6.0/BoogieDriver.dll"

if [[ ! -x "$DOTNET" ]]; then
    echo "Error: Dafny requires .NET Core to run on non-Windows systems."
    exit 1
fi

#Uncomment if you prefer to use the executable instead of the DLL
#BOOGIE=$(which boogie)

BOOGIE_OPTIONS="/infer:j"
PROVER_OPTIONS="\
  /proverOpt:O:auto_config=false \
  /proverOpt:O:type_check=true \
  /proverOpt:O:smt.case_split=3 \
  /proverOpt:O:smt.qi.eager_threshold=100 \
  /proverOpt:O:smt.delay_units=true \
  /proverOpt:O:smt.arith.solver=2 \
  "

"$DOTNET" "$BOOGIE" $BOOGIE_OPTIONS $PROVER_OPTIONS "$@"
#Uncomment if you want to use the executable instead of the DLL
#"$BOOGIE" $BOOGIE_OPTIONS $PROVER_OPTIONS "$@"
</code></pre>

<h4 id="sec-controlling-prover">24.10.9. Controlling the prover</h4>

<p>TO BE WRITTEN</p>

<h4 id="sec-controlling-test-gen">24.10.10. Controlling test generation</h4>

<p>TO BE WRITTEN</p>

<h4 id="sec-controlling-compilation">24.10.11. Controlling compilation</h4>

<p>These options control what code gets compiled, what target language is
used, how compilation proceeds, and whether the compiled program is
immediately executed.</p>

<ul>
  <li>
    <p><code>-compile:&lt;n&gt;</code> - control whether compilation happens. The value of
<code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - do not compile the program</p>
      </li>
      <li>
        <p><code>1</code> (default) - upon successful verification, compile the program
to the target language.</p>
      </li>
      <li>
        <p><code>2</code> - always compile, regardless of verification success.</p>
      </li>
      <li>
        <p><code>3</code> - if verification is successful, compile the program (like
option <code>1</code>), and then if there is a <code>Main</code> method, attempt to run the
program.</p>
      </li>
      <li>
        <p><code>4</code> - always compile (like option <code>2</code>), and then if there is a
<code>Main</code> method, attempt to run the program.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-compileTarget:&lt;s&gt;</code> - set the target programming language for the
compiler. The value of <code>&lt;s&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>cs</code> - C#</p>
      </li>
      <li>
        <p><code>go</code> - Go</p>
      </li>
      <li>
        <p><code>js</code> - Javascript</p>
      </li>
      <li>
        <p><code>java</code> - Java</p>
      </li>
      <li>
        <p><code>py</code> - Python</p>
      </li>
      <li>
        <p><code>cpp</code> - C++</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-spillTargetCode:&lt;n&gt;</code> - control whether to write out compiled code in
the target language (instead of just holding it in internal temporary
memory). The value of <code>&lt;s&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> (default) - dont make any extra effort to write the textual
target program (but still compile it, if <code>-compile</code> indicates to do
so).</p>
      </li>
      <li>
        <p><code>1</code> - write it out to the target language, if it is being compiled.</p>
      </li>
      <li>
        <p><code>2</code> - write the compiled program if it passes verification,
regardless of the <code>-compile</code> setting.</p>
      </li>
      <li>
        <p><code>3</code> - write the compiled program regardless of verification success
and the <code>-compile</code> setting.</p>
      </li>
    </ul>
  </li>
</ul>

<p>Note that some compiler targets may (always or in some situations) write
out the textual target program as part of compilation, in which case
<code>-spillTargetCode:0</code> behaves the same way as <code>-spillTargetCode:1</code>.</p>

<ul>
  <li>
    <p><code>-Main:&lt;name&gt;</code> - specify the (fully-qualified) name of the method to
use as the executable entry point. The default is the method with the
<code>{:main}</code> attribute, or else the method named <code>Main</code>.</p>
  </li>
  <li>
    <p><code>-out:&lt;file&gt;</code> - set the name to use for compiled code files.</p>
  </li>
</ul>

<p>By default, Dafny reuses the name of the Dafny file being compiled.
Compilers that generate a single file use the file name as-is (e.g. the
C# backend will generate <code>&lt;file&gt;.dll</code> and optionally <code>&lt;file&gt;.cs</code> with
<code>-spillTargetCode</code>). Compilers that generate multiple files use the file
name as a directory name (e.g. the Java backend will generate files in
directory <code>&lt;file&gt;-java/</code>). Any file extension is ignored, so
<code>-out:&lt;file&gt;</code> is the same as <code>-out:&lt;file&gt;.&lt;ext&gt;</code> if <code>&lt;file&gt;</code> contains no
periods.</p>

<ul>
  <li>
    <p><code>-compileVerbose:&lt;n&gt;</code> - control whether to write out compilation
progress information. The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - do not print any information (silent mode)</p>
      </li>
      <li>
        <p><code>1</code> (default) - print information such as the files being created by
the compiler</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-coverage:&lt;file&gt;</code> - emit branch-coverage calls and outputs into
<code>&lt;file&gt;</code>, including a legend that gives a description of each
source-location identifier used in the branch-coverage calls. (Use <code>-</code>
as <code>&lt;file&gt;</code> to print to the console.)</p>
  </li>
  <li>
    <p><code>-optimize</code> - produce optimized C# code by passing the <code>/optimize</code>
flag to the <code>csc</code> executable.</p>
  </li>
  <li>
    <p><code>-optimizeResolution:&lt;n&gt;</code> - control optimization of method target
resolution. The value of <code>&lt;n&gt;</code> can be one of the following.</p>

    <ul>
      <li>
        <p><code>0</code> - resolve and translate all methods.</p>
      </li>
      <li>
        <p><code>1</code> - translate methods only in the call graph of the current
verification target.</p>
      </li>
      <li>
        <p><code>2</code> (default) - as in <code>1</code>, but resolve only methods that are defined
in the current verification target file, not in included files.</p>
      </li>
    </ul>
  </li>
  <li>
    <p><code>-useRuntimeLib</code> - refer to the pre-built <code>DafnyRuntime.dll</code> in the
compiled assembly rather than including <code>DafnyRuntime.cs</code> in the build
process.</p>
  </li>
</ul>

<h3 id="2411-full-list-of--command-line-options-">24.11. Full list of -command-line options <!-- PDFOMIT --></h3>
<p>For the on-line version only, the output of <code>dafny /?</code> follows: <!--PDFOMIT--></p>
<pre><code>Usage: Dafny [ option ... ] [ filename ... ]

  ---- General options -------------------------------------------------------

  /version      print the Dafny version number
  /help         print this message
  /attrHelp     print a message about supported declaration attributes
  /env:&lt;n&gt;      print command line arguments
                  0 - never, 1 (default) - during BPL print and prover log,
                  2 - like 1 and also to standard output
  /printVerifiedProceduresCount:&lt;n&gt;
                0 - no
                1 (default) - yes
  /wait         await Enter from keyboard before terminating program
  /xml:&lt;file&gt;   also produce output in XML format to &lt;file&gt;

  All the .dfy files supplied on the command line along with files recursively
  included by 'include' directives are considered a single Dafny program;
  however only those files listed on the command line are verified.
  
  Exit code: 0 -- success; 1 -- invalid command-line; 2 -- parse or type errors;
             3 -- compilation errors; 4 -- verification errors
  
  ---- Input configuration ---------------------------------------------------
  
  /dprelude:&lt;file&gt;
      choose Dafny prelude file
  /stdin
      Read standard input and treat it as an input .dfy file.
  
  ---- Plugins ---------------------------------------------------------------
  
  /plugin:&lt;path to one assembly&gt;[ &lt;arguments&gt;]
      (experimental) One path to an assembly that contains at least one
      instantiatable class extending Microsoft.Dafny.Plugin.Rewriter.
      It can also extend Microsoft.Dafny.Plugins.PluginConfiguration to receive arguments
      More information about what plugins do and how define them:
      https://github.com/dafny-lang/dafny/blob/master/Source/DafnyLanguageServer/README.md#about-plugins
  
  ---- Overall reporting and printing ----------------------------------------
  
  /stats        Print interesting statistics about the Dafny files supplied.
  /dprint:&lt;file&gt;
      print Dafny program after parsing it
      (use - as &lt;file&gt; to print to console)
  /rprint:&lt;file&gt;
      print Dafny program after resolving it
      (use - as &lt;file&gt; to print to console)
  /printMode:&lt;Everything|DllEmbed|NoIncludes|NoGhost&gt;
      Everything is the default.
      DllEmbed prints the source that will be included in a compiled dll.
      NoIncludes disables printing of {:verify false} methods incorporated via the
      include mechanism, as well as datatypes and fields included from other files.
      NoGhost disables printing of functions, ghost methods, and proof statements in
      implementation methods.  It also disables anything NoIncludes disables.
  /printIncludes:&lt;None|Immediate|Transitive&gt;
      None is the default.
      Immediate prints files included by files listed on the command line
      Transitive recurses on the files printed by Immediate
      Immediate and Transitive will exit after printing.
  /view:&lt;view1, view2&gt;
      print the filtered views of a module after it is resolved (/rprint).
      If print before the module is resolved (/dprint), then everything in the module
      is printed.
      If no view is specified, then everything in the module is printed.
  /showSnippets:&lt;n&gt;
      0 (default) - don't show source code snippets for Dafny messages
      1 - show a source code snippet for each Dafny message
  /funcCallGraph Print out the function call graph.  Format is: func,mod=callee*
  /pmtrace      print pattern-match compiler debug info
  /titrace      print type-inference debug info
  /printTooltips
      Dump additional positional information (displayed as mouse-over tooltips by
      the VS plugin) to stdout as 'Info' messages.
  
  ---- Language feature selection --------------------------------------------
  
  /noIncludes   Ignore include directives
  /noExterns    Ignore extern and dllimport attributes
  /functionSyntax:&lt;version&gt;
      The syntax for functions is changing from Dafny version 3 to version 4.
      This switch gives early access to the new syntax, and also provides a mode
      to help with migration.
      3 (default) - Compiled functions are written `function method` and
          `predicate method`. Ghost functions are written `function` and `predicate`.
      4 - Compiled functions are written `function` and `predicate`. Ghost functions
          are written `ghost function` and `ghost predicate`.
      migration3to4 - Compiled functions are written `function method` and
          `predicate method`. Ghost functions are written `ghost function` and
          `ghost predicate`. To migrate from version 3 to version 4, use this flag
          on your version 3 program. This will give flag all occurrences of
          `function` and `predicate` as parsing errors. These are ghost functions,
          so change those into the new syntax `ghost function` and `ghost predicate`.
          Then, start using /functionSyntax:4. This will flag all occurrences of
          `function method` and `predicate method` as parsing errors. So, change
          those to just `function` and `predicate`. Now, your program uses version 4
          syntax and has the exact same meaning as your previous version 3 program.
      experimentalDefaultGhost - like migration3to4, but allow `function` and
          `predicate` as alternatives to declaring ghost functions and predicates,
          respectively
      experimentalDefaultCompiled - like migration3to4, but allow `function` and
          `predicate` as alternatives to declaring compiled functions and predicates,
          respectively
      experimentalPredicateAlwaysGhost - Compiled functions are written `function`.
          Ghost functions are written `ghost function`. Predicates are always ghost
          and are written `predicate`.
  /disableScopes
      Treat all export sets as 'export reveal *'. i.e. don't hide function bodies
      or type definitions during translation.
  /allowGlobals Allow the implicit class '_default' to contain fields, instance functions,
      and instance methods.  These class members are declared at the module scope,
      outside of explicit classes.  This command-line option is provided to simplify
      a transition from the behavior in the language prior to version 1.9.3, from
      which point onward all functions and methods declared at the module scope are
      implicitly static and fields declarations are not allowed at the module scope.
  
  ---- Warning selection -----------------------------------------------------
  
  /warnShadowing  Emits a warning if the name of a declared variable caused another variable
      to be shadowed
  /deprecation:&lt;n&gt;
      0 - don't give any warnings about deprecated features
      1 (default) - show warnings about deprecated features
      2 - also point out where there's new simpler syntax
  /warningsAsErrors
      Treat warnings as errors.
  
  ---- Verification options -------------------------------------------------
  
  /dafnyVerify:&lt;n&gt;
      0 - stop after typechecking
      1 - continue on to translation, verification, and compilation
  /verifyAllModules
      Verify modules that come from an include directive
  /separateModuleOutput
      Output verification results for each module separately, rather than
      aggregating them after they are all finished.
  /verificationLogger:&lt;configuration string&gt;
      Logs verification results to the given test result logger. The currently
      supported loggers are `trx`, `csv`, and `text`. These are the
      XML-based format commonly used for test results for .NET languages, a
      custom CSV schema, and a textual format meant for human consumption. You
      can provide configuration using the same string format as when using the
      --logger option for dotnet test, such as:
          /verificationLogger:trx;LogFileName=&lt;...&gt;.
      The exact mapping of verification concepts to these formats is
      experimental and subject to change!
  
      The `trx` and `csv` loggers automatically choose an output file
      name by default, and print the name of this file to the console. The
      `text` logger prints its output to the console by default, but can
      send output to a file given the `LogFileName` option.
  
      The `text` logger also includes a more detailed breakdown of what
      assertions appear in each assertion batch. When combined with the
      `/vcsSplitOnEveryAssert` option, it will provide approximate time
      and resource use costs for each assertion, allowing identification
      of especially expensive assertions.
  /mimicVerificationOf:&lt;Dafny version&gt;
      Let Dafny attempt to mimic the verification as it was in a previous version of Dafny.
      Useful during migration to a newer version of Dafny when a Dafny program has proofs, such as methods or lemmas,
      that are unstable in the sense that their verification may become slower or fail altogether
      after logically irrelevant changes are made in the verification input.
  
      Accepted versions are: 3.3 (note that this turns off features that prevent classes of verification instability)
  /noCheating:&lt;n&gt;
      0 (default) - allow assume statements and free invariants
      1 - treat all assumptions as asserts, and drop free.
  /induction:&lt;n&gt;
      0 - never do induction, not even when attributes request it
      1 - only apply induction when attributes request it
      2 - apply induction as requested (by attributes) and also
          for heuristically chosen quantifiers
      3 - apply induction as requested, and for
          heuristically chosen quantifiers and lemmas
      4 (default) - apply induction as requested, and for lemmas
  /inductionHeuristic:&lt;n&gt;
      0 - least discriminating induction heuristic (that is, lean
          toward applying induction more often)
      1,2,3,4,5 - levels in between, ordered as follows as far as
          how discriminating they are:  0 &lt; 1 &lt; 2 &lt; (3,4) &lt; 5 &lt; 6
      6 (default) - most discriminating
  /trackPrintEffects:&lt;n&gt;
      0 (default) - Every compiled method, constructor, and iterator, whether or not
         it bears a {:print} attribute, may have print effects.
      1 - A compiled method, constructor, or iterator is allowed to have print effects
         only if it is marked with {:print}.
  /allocated:&lt;n&gt;
      Specify defaults for where Dafny should assert and assume
      allocated(x) for various parameters x, local variables x,
      bound variables x, etc.  Lower &lt;n&gt; may require more manual
      allocated(x) annotations and thus may be more difficult to use.
      Warning: this option should be chosen consistently across
      an entire project; it would be unsound to use different
      defaults for different files or modules within a project.
      And even so, modes /allocated:0 and /allocated:1 let functions
      depend on the allocation state, which is not sound in general.
      0 - Nowhere (never assume/assert allocated(x) by default).
      1 - Assume allocated(x) only for non-ghost variables and fields
          (these assumptions are free, since non-ghost variables
          always contain allocated values at run-time).  This option
          may speed up verification relative to /allocated:2.
      2 - Assert/assume allocated(x) on all variables,
          even bound variables in quantifiers.  This option is
          the easiest to use for heapful code.
      3 - (default) Frugal use of heap parameters.
      4 - mode 3 but with alloc antecedents when ranges don't imply
          allocatedness.
  /definiteAssignment:&lt;n&gt;
      0 - ignores definite-assignment rules; this mode is for testing only--it is
          not sound
      1 (default) - enforces definite-assignment rules for compiled variables and fields
          whose types do not support auto-initialization and for ghost variables
          and fields whose type is possibly empty
      2 - enforces definite-assignment for all non-yield-parameter
          variables and fields, regardless of their types
      3 - like 2, but also performs checks in the compiler that no nondeterministic
          statements are used; thus, a program that passes at this level 3 is one
          that the language guarantees that values seen during execution will be
          the same in every run of the program
  /noAutoReq    Ignore autoReq attributes
  /autoReqPrint:&lt;file&gt;
      Print out requirements that were automatically generated by autoReq.
  /noNLarith    Reduce Z3's knowledge of non-linear arithmetic (*,/,%).
      Results in more manual work, but also produces more predictable behavior.
      (This switch will perhaps be replaced by /arith in the future.
      For now, it takes precedence of /arith.)
  /arith:&lt;n&gt;    (Experimental switch. Its options may change.)
      0 - Use Boogie/Z3 built-ins for all arithmetic operations.
      1 (default) - Like 0, but introduce symbolic synonyms for *,/,%, and
          allow these operators to be used in triggers.
      2 - Like 1, but introduce symbolic synonyms also for +,-.
      3 - Turn off non-linear arithmetic in the SMT solver. Still,
          use Boogie/Z3 built-in symbols for all arithmetic operations.
      4 - Like 3, but introduce symbolic synonyms for *,/,%, and allow these
          operators to be used in triggers.
      5 - Like 4, but introduce symbolic synonyms also for +,-.
      6 - Like 5, and introduce axioms that distribute + over *.
      7 - like 6, and introduce facts that associate literals arguments of *.
      8 - Like 7, and introduce axiom for the connection between *,/,%.
      9 - Like 8, and introduce axioms for sign of multiplication
      10 - Like 9, and introduce axioms for commutativity and
          associativity of *
  /autoTriggers:&lt;n&gt;
      0 - Do not generate {:trigger} annotations for user-level quantifiers.
      1 (default) - Add a {:trigger} to each user-level quantifier. Existing
                    annotations are preserved.
  /rewriteFocalPredicates:&lt;n&gt;
      0 - Don't rewrite predicates in the body of prefix lemmas.
      1 (default) - In the body of prefix lemmas, rewrite any use of a focal predicate
                    P to P#[_k-1].
  /extractCounterexample
      If verification fails, report a detailed counterexample for the first
      failing assertion. Requires specifying the /mv option as well as
      /proverOpt:O:model_compress=false and /proverOpt:O:model.completion=true.
  /countVerificationErrors:&lt;n&gt;
      [ deprecated ]
      0 - Set exit code to 0 regardless of the presence of any other errors.
      1 (default) - Emit usual exit code (cf. beginning of the help message).
  
  ---- Test generation options -----------------------------------------------
  
  
  /generateTestMode:&lt;None|Block|Path&gt;
      None is the default and has no effect.
      Block prints block-coverage tests for the given program.
      Path prints path-coverage tests for the given program.
      Using /definiteAssignment:3 and /loopUnroll is highly recommended when
      generating tests.
  /warnDeadCode
      Use block-coverage tests to warn about potential dead code.
  /generateTestSeqLengthLimit:&lt;n&gt;
      If /testMode is not None, using this argument adds an axiom that sets the
      length of all sequences to be no greater than &lt;n&gt;. This is useful in
      conjunction with loop unrolling.
  /generateTestTargetMethod:&lt;methodName&gt;
      If specified, only this method will be tested.
  /generateTestInlineDepth:&lt;n&gt;
      0 is the default. When used in conjunction with /testTargetMethod, this
      argument specifies the depth up to which all non-tested methods should be
      inlined.
  
  ---- Compilation options ---------------------------------------------------
  
  /compile:&lt;n&gt;  0 - do not compile Dafny program
      1 (default) - upon successful verification of the Dafny
          program, compile it to the designated target language
          (/noVerify automatically counts as failed verification)
      2 - always attempt to compile Dafny program to the target
          language, regardless of verification outcome
      3 - if there is a Main method and there are no verification
          errors and /noVerify is not used, compiles program in
          memory (i.e., does not write an output file) and runs it
      4 - like (3), but attempts to compile and run regardless of
          verification outcome
  /compileTarget:&lt;lang&gt;
      cs (default) - Compilation to .NET via C#
      go - Compilation to Go
      js - Compilation to JavaScript
      java - Compilation to Java
      py - Compilation to Python
      cpp - Compilation to C++
  
      Note that the C++ backend has various limitations (see Docs/Compilation/Cpp.md).
      This includes lack of support for BigIntegers (aka int), most higher order
      functions, and advanced features like traits or co-inductive types.
  /Main:&lt;name&gt;
      The (fully-qualified) name of the method to use as the executable entry point.
      Default is the method with the {:main} attribute, or else the method named 'Main'.
  /runAllTests:&lt;n&gt; (experimental)
      0 (default) - Annotates compiled methods with the {:test} attribute
          such that they can be tested using a testing framework
          in the target language (e.g. xUnit for C#).
      1 - Emits a main method in the target language that will execute every method
          in the program with the {:test} attribute.
          Cannot be used if the program already contains a main method.
          Note that /compile:3 or 4 must be provided as well to actually execute
          this main method!
  /compileVerbose:&lt;n&gt;
      0 - don't print status of compilation to the console
      1 (default) - print information such as files being written by
          the compiler to the console
  /spillTargetCode:&lt;n&gt;
      This option concerns the textual representation of the target program.
      This representation is of no interest when working with only Dafny code,
      but may be of interest in cross-language situations.
      0 (default) - Don't make any extra effort to write the textual target program
          (but still compile it, if /compile indicates to do so).
      1 - Write the textual target program, if it is being compiled.
      2 - Write the textual target program, provided it passes the verifier (and
          /noVerify is NOT used), regardless of /compile setting.
      3 - Write the textual target program, regardless of verification outcome
          and /compile setting.
      Note, some compiler targets may (always or in some situations) write out the
      textual target program as part of compilation, in which case /spillTargetCode:0
      behaves the same way as /spillTargetCode:1.
  /out:&lt;file&gt;
      filename and location for the generated target language files
  /coverage:&lt;file&gt;
      The compiler emits branch-coverage calls and outputs into
      &lt;file&gt; a legend that gives a description of each
      source-location identifier used in the branch-coverage calls.
      (use - as &lt;file&gt; to print to console)
  /optimize     Produce optimized C# code, meaning:
        - passes /optimize flag to csc.exe.
  /optimizeResolution:&lt;n&gt;
      0 - Resolve and translate all methods
      1 - Translate methods only in the call graph of current verification target
      2 (default) - As in 1, but only resolve method bodies in non-included Dafny sources
  /useRuntimeLib
      Refer to pre-built DafnyRuntime.dll in compiled assembly rather
      than including DafnyRuntime.cs verbatim.
  
  ----------------------------------------------------------------------------
  
  Dafny generally accepts Boogie options and passes these on to Boogie. However,
  some Boogie options, like /loopUnroll, may not be sound for Dafny or may not
  have the same meaning for a Dafny program as it would for a similar Boogie
  program.
  
  ---- Boogie options --------------------------------------------------------

  Multiple .bpl files supplied on the command line are concatenated into one
  Boogie program.

  /lib           : Include library definitions
  /proc:&lt;p&gt;      : Only check procedures matched by pattern &lt;p&gt;. This option
                   may be specified multiple times to match multiple patterns.
                   The pattern &lt;p&gt; matches the whole procedure name and may
                   contain * wildcards which match any character zero or more
                   times.
  /noProc:&lt;p&gt;    : Do not check procedures matched by pattern &lt;p&gt;. Exclusions
                   with /noProc are applied after inclusions with /proc.
  /noResolve     : parse only
  /noTypecheck   : parse and resolve only

  /print:&lt;file&gt;  : print Boogie program after parsing it
                   (use - as &lt;file&gt; to print to console)
  /pretty:&lt;n&gt;
                0 - print each Boogie statement on one line (faster).
                1 (default) - pretty-print with some line breaks.
  /printWithUniqueIds : print augmented information that uniquely
                   identifies variables
  /printUnstructured : with /print option, desugars all structured statements
  /printDesugared : with /print option, desugars calls
  /printLambdaLifting : with /print option, desugars lambda lifting

  /freeVarLambdaLifting : Boogie's lambda lifting transforms the bodies of lambda
                         expressions into templates with holes. By default, holes
                         are maximally large subexpressions that do not contain
                         bound variables. This option performs a form of lambda
                         lifting in which holes are the lambda's free variables.

  /overlookTypeErrors : skip any implementation with resolution or type
                        checking errors

  /loopUnroll:&lt;n&gt;
                unroll loops, following up to n back edges (and then some)
  /soundLoopUnrolling
                sound loop unrolling
  /printModel:&lt;n&gt;
                0 (default) - do not print Z3's error model
                1 - print Z3's error model
  /printModelToFile:&lt;file&gt;
                print model to &lt;file&gt; instead of console
  /mv:&lt;file&gt;    Specify file to save the model with captured states
                (see documentation for :captureState attribute)
  /enhancedErrorMessages:&lt;n&gt;
                0 (default) - no enhanced error messages
                1 - Z3 error model enhanced error messages

  /printCFG:&lt;prefix&gt; : print control flow graph of each implementation in
                       Graphviz format to files named:
                         &lt;prefix&gt;.&lt;procedure name&gt;.dot

  /useBaseNameForFileName : When parsing use basename of file for tokens instead
                            of the path supplied on the command line

  /emitDebugInformation:&lt;n&gt;
                0 - do not emit debug information
                1 (default) - emit the debug information :qid, :skolemid and set-info :boogie-vc-id

  /normalizeNames:&lt;n&gt;
                0 (default) - Keep Boogie program names when generating SMT commands
                1 - Normalize Boogie program names when generating SMT commands. 
                  This keeps SMT solver input, and thus output, 
                  constant when renaming declarations in the input program.

  /normalizeDeclarationOrder:&lt;n&gt;
                0 - Keep order of top-level declarations when generating SMT commands.
                1 (default) - Normalize order of top-level declarations when generating SMT commands.
                  This keeps SMT solver input, and thus output, 
                  constant when reordering declarations in the input program.

  ---- Inference options -----------------------------------------------------

  /infer:&lt;flags&gt;
                use abstract interpretation to infer invariants
                &lt;flags&gt; must specify exactly one of the following domains:
                   t = trivial bottom/top lattice
                   j = stronger intervals
                together with any of the following options:
                   s = debug statistics
                0..9 = number of iterations before applying a widen (default=0)
  /checkInfer   instrument inferred invariants as asserts to be checked by
                theorem prover
  /contractInfer
                perform procedure contract inference
  /instrumentInfer
                h - instrument inferred invariants only at beginning of
                    loop headers (default)
                e - instrument inferred invariants at beginning and end
                    of every block (this mode is intended for use in
                    debugging of abstract domains)
  /printInstrumented
                print Boogie program after it has been instrumented with
                invariants

  ---- Debugging and general tracing options ---------------------------------

  /trace        blurt out various debug trace information
  /traceTimes   output timing information at certain points in the pipeline
  /tracePOs     output information about the number of proof obligations
                (also included in the /trace output)
  /break        launch and break into debugger

  ---- Civl options ----------------------------------------------------------

  /trustMoverTypes
                do not verify mover type annotations on atomic action declarations
  /trustNoninterference
                do not perform noninterference checks
  /trustLayersUpto:&lt;n&gt;
                do not verify layers &lt;n&gt; and below
  /trustLayersDownto:&lt;n&gt;
                do not verify layers &lt;n&gt; and above
  /trustInductiveSequentialization
                do not perform inductive sequentialization checks
  /civlDesugaredFile:&lt;file&gt;
                print plain Boogie program to &lt;file&gt;

  ---- Verification-condition generation options -----------------------------

  /liveVariableAnalysis:&lt;c&gt;
                0 = do not perform live variable analysis
                1 = perform live variable analysis (default)
                2 = perform interprocedural live variable analysis
  /noVerify     skip VC generation and invocation of the theorem prover
  /verifySnapshots:&lt;n&gt;
                verify several program snapshots (named &lt;filename&gt;.v0.bpl
                to &lt;filename&gt;.vN.bpl) using verification result caching:
                0 - do not use any verification result caching (default)
                1 - use the basic verification result caching
                2 - use the more advanced verification result caching
                3 - use the more advanced caching and report errors according
                    to the new source locations for errors and their
                    related locations (but not /errorTrace and CaptureState
                    locations)
  /traceCaching:&lt;n&gt;
                0 (default) - none
                1 - for testing
                2 - for benchmarking
                3 - for testing, benchmarking, and debugging
  /verifySeparately
                verify each input program separately
  /removeEmptyBlocks:&lt;c&gt;
                0 - do not remove empty blocks during VC generation
                1 - remove empty blocks (default)
  /coalesceBlocks:&lt;c&gt;
                0 = do not coalesce blocks
                1 = coalesce blocks (default)
  /traceverify  print debug output during verification condition generation
  /subsumption:&lt;c&gt;
                apply subsumption to asserted conditions:
                0 - never, 1 - not for quantifiers, 2 (default) - always
  /alwaysAssumeFreeLoopInvariants
                usually, a free loop invariant (or assume
                statement in that position) is ignored in checking contexts
                (like other free things); this option includes these free
                loop invariants as assumes in both contexts
  /inline:&lt;i&gt;   use inlining strategy &lt;i&gt; for procedures with the :inline
                attribute, see /attrHelp for details:
                  none
                  assume (default)
                  assert
                  spec
  /printInlined
                print the implementation after inlining calls to
                procedures with the :inline attribute (works with /inline)
  /recursionBound:&lt;n&gt;
                Set the recursion bound for stratified inlining to
                be n (default 500)
  /smoke        Soundness Smoke Test: try to stick assert false; in some
                places in the BPL and see if we can still prove it
  /smokeTimeout:&lt;n&gt;
                Timeout, in seconds, for a single theorem prover
                invocation during smoke test, defaults to 10.
  /causalImplies
                Translate Boogie's A ==&gt; B into prover's A ==&gt; A &amp;&amp; B.
  /typeEncoding:&lt;m&gt;
                Encoding of types when generating VC of a polymorphic program:
                   p = predicates (default)
                   a = arguments
                Boogie automatically detects monomorphic programs and enables
                monomorphic VC generation, thereby overriding the above option.
  /monomorphize
                Try to monomorphize program. An error is reported if
                monomorphization is not possible. This feature is experimental!
  /useArrayTheory
                Use the SMT theory of arrays (as opposed to axioms). Supported
                only for monomorphic programs.
  /reflectAdd   In the VC, generate an auxiliary symbol, elsewhere defined
                to be +, instead of +.
  /prune
                Turn on pruning. Pruning will remove any top-level Boogie declarations 
                that are not accessible by the implementation that is about to be verified.
                Without pruning, due to the unstable nature of SMT solvers,
                a change to any part of a Boogie program has the potential 
                to affect the verification of any other part of the program.
  /printPruned:&lt;file&gt;
                After pruning, print the Boogie program to the specified file.
  /relaxFocus   Process foci in a bottom-up fashion. This way only generates
                a linear number of splits. The default way (top-down) is more
                aggressive and it may create an exponential number of splits.

  /randomSeed:&lt;n&gt;
                Turn on randomization of the input that Boogie passes to the 
                SMT solver and turn on randomization in the SMT solver itself.
 
                Certain Boogie inputs are unstable in the sense that changes to 
                the input that preserve its meaning may cause the output to change.
                The /randomSeed option simulates meaning-preserving changes to 
                the input without requiring the user to actually make those changes.

                The /randomSeed option is implemented by renaming variables and 
                reordering declarations in the input, and by setting 
                solver options that have similar effects.

  /randomSeedIterations:&lt;n&gt;
                Attempt to prove each VC n times with n random seeds. If
                /randomSeed has been provided, each proof attempt will use
                a new random seed derived from this original seed. If not,
                it will implicitly use /randomSeed:0 to ensure a difference
                between iterations.

  ---- Verification-condition splitting --------------------------------------

  /vcsMaxCost:&lt;f&gt;
                VC will not be split unless the cost of a VC exceeds this
                number, defaults to 2000.0. This does NOT apply in the
                keep-going mode after first round of splitting.
  /vcsMaxSplits:&lt;n&gt;
                Maximal number of VC generated per method. In keep
                going mode only applies to the first round.
                Defaults to 1.
  /vcsMaxKeepGoingSplits:&lt;n&gt;
                If set to more than 1, activates the keep
                going mode, where after the first round of splitting,
                VCs that timed out are split into &lt;n&gt; pieces and retried
                until we succeed proving them, or there is only one
                assertion on a single path and it timeouts (in which
                case error is reported for that assertion).
                Defaults to 1.
  /vcsKeepGoingTimeout:&lt;n&gt;
                Timeout in seconds for a single theorem prover
                invocation in keep going mode, except for the final
                single-assertion case. Defaults to 1s.
  /vcsFinalAssertTimeout:&lt;n&gt;
                Timeout in seconds for the single last
                assertion in the keep going mode. Defaults to 30s.
  /vcsPathJoinMult:&lt;f&gt;
                If more than one path join at a block, by how much
                multiply the number of paths in that block, to accomodate
                for the fact that the prover will learn something on one
                paths, before proceeding to another. Defaults to 0.8.
  /vcsPathCostMult:&lt;f1&gt;
  /vcsAssumeMult:&lt;f2&gt;
                The cost of a block is
                    (&lt;assert-cost&gt; + &lt;f2&gt;*&lt;assume-cost&gt;) *
                    (1.0 + &lt;f1&gt;*&lt;entering-paths&gt;)
                &lt;f1&gt; defaults to 1.0, &lt;f2&gt; defaults to 0.01.
                The cost of a single assertion or assumption is
                currently always 1.0.
  /vcsPathSplitMult:&lt;f&gt;
                If the best path split of a VC of cost A is into
                VCs of cost B and C, then the split is applied if
                A &gt;= &lt;f&gt;*(B+C), otherwise assertion splitting will be
                applied. Defaults to 0.5 (always do path splitting if
                possible), set to more to do less path splitting
                and more assertion splitting.
  /vcsSplitOnEveryAssert
                Splits every VC so that each assertion is isolated
                into its own VC. May result in VCs without any assertions.
  /vcsDumpSplits
                For split #n dump split.n.dot and split.n.bpl.
                Warning: Affects error reporting.
  /vcsCores:&lt;n&gt;
                Try to verify &lt;n&gt; VCs at once. Defaults to 1.
  /vcsLoad:&lt;f&gt;  Sets vcsCores to the machine's ProcessorCount * f,
                rounded to the nearest integer (where 0.0 &lt;= f &lt;= 3.0),
                but never to less than 1.

  ---- Prover options --------------------------------------------------------

  /errorLimit:&lt;num&gt;
                Limit the number of errors produced for each procedure
                (default is 5, some provers may support only 1).
                Set num to 0 to find as many assertion failures as possible.
  /timeLimit:&lt;num&gt;
                Limit the number of seconds spent trying to verify
                each procedure
  /rlimit:&lt;num&gt;
                Limit the Z3 resource spent trying to verify each procedure
  /errorTrace:&lt;n&gt;
                0 - no Trace labels in the error output,
                1 (default) - include useful Trace labels in error output,
                2 - include all Trace labels in the error output
  /vcBrackets:&lt;b&gt;
                bracket odd-charactered identifier names with |'s.  &lt;b&gt; is:
                   0 - no (default),
                   1 - yes
  /proverDll:&lt;tp&gt;
                use theorem prover &lt;tp&gt;, where &lt;tp&gt; is either the name of
                a DLL containing the prover interface located in the
                Boogie directory, or a full path to a DLL containing such
                an interface. The default interface shipped is:
                    SMTLib (uses the SMTLib2 format and calls an SMT solver)
  /proverOpt:KEY[=VALUE]
                Provide a prover-specific option (short form /p).
  /proverHelp   Print prover-specific options supported by /proverOpt.
  /proverLog:&lt;file&gt;
                Log input for the theorem prover.  Like filenames
                supplied as arguments to other options, &lt;file&gt; can use the
                following macros:
                    @TIME@    expands to the current time
                    @PREFIX@  expands to the concatenation of strings given
                              by /logPrefix options
                    @FILE@    expands to the last filename specified on the
                              command line
                In addition, /proverLog can also use the macro '@PROC@',
                which causes there to be one prover log file per
                verification condition, and the macro then expands to the
                name of the procedure that the verification condition is for.
  /logPrefix:&lt;str&gt;
                Defines the expansion of the macro '@PREFIX@', which can
                be used in various filenames specified by other options.
  /proverLogAppend
                Append (not overwrite) the specified prover log file
  /proverWarnings
                0 (default) - don't print, 1 - print to stdout,
                2 - print to stderr
  /restartProver
                Restart the prover after each query
</code></pre>
<p><!-- PDFOMIT --></p>

<!--PDF NEWPAGE-->

<p>Sample math B: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-215-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2250" style="width: 2.996em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.521em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.512em, 1002.51em, 2.532em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2251"><span class="mi" id="MathJax-Span-2252" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-2253" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2254" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.964em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mo stretchy="false"></mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-215">a \to b</script> or</p>
<p style="text-align: center;"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-216-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mi&gt;&amp;#x03C0;&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-2255" style="width: 3.206em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.679em; height: 0px; font-size: 119%;"><span style="position: absolute; clip: rect(1.695em, 1002.68em, 2.532em, -1000em); top: -2.363em; left: 0em;"><span class="mrow" id="MathJax-Span-2256"><span class="mi" id="MathJax-Span-2257" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mo" id="MathJax-Span-2258" style="font-family: MathJax_Main; padding-left: 0.278em;"></span><span class="mi" id="MathJax-Span-2259" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;"><span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.363em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.746em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>a</mi><mo stretchy="false"></mo><mi></mi></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-216"> a \to \pi </script></p>
<p>or ( a \top ) or [ a \to \pi ]</p>

<p>Colors</p>
<pre><code class="language-dafny">integer literal:  10
hex literal:      0xDEAD
real literal:     1.1
boolean literal:  true false
char literal:     'c'
string literal:   "abc"
verbatim string:  @"abc"
ident:            ijk
type:             int
generic type:     map&lt;int,T&gt;
operator:         &lt;=
punctuation:      { }
keyword:          while
spec:             requires
comment:          // comment
attribute         {: name }
error:            $
</code></pre>

<p>Syntax color tests:</p>

<pre><code class="language-dafny">integer: 0 00 20 01 0_1
float:   .0 1.0 1. 0_1.1_0
bad:    0_
hex:    0x10_abcdefABCDEF
string:   "string \n \t \r \0" "a\"b" "'" "\'" ""
string:   "!@#$%^&amp;*()_-+={}[]|:;\\&lt;&gt;,.?/~`"
string:   "\u1234 "
string:   "     " : "\0\n\r\t\'\"\\"
notstring: "abcde
notstring: "\u123 " : "x\Zz" : "x\ux"
vstring:  @"" @"a" @"""" @"'\" @"\u"
vstring:  @"xx""y y""zz "
vstring:  @" " @"       "
vstring:  @"x
x"
bad:      @!
char:    'a' '\n' '\'' '"' '\"' ' ' '\\'
char:    '\0' '\r' '\t'  '\u1234'
badchar:  $ `
ids:  '\u123'   '\Z'  '\u'  '\u2222Z'
ids:  '\u123ZZZ'     '\u2222Z'
ids: 'a : a' : 'ab' :  'a'b' : 'a''b'
ids:  a_b _ab ab? _0
id-label:  a@label
literal:  true false null
op:      - ! ~ x  -!~x
op:      a + b - c * d / e % f a+b-c*d/e%f
op:      &lt;= &gt;= &lt; &gt; == != b&amp;&amp;c || ==&gt; &lt;==&gt; &lt;==
# 25. !=# !! in !in
op:      !in  !in
not op:  !inx
punc:    . , :: | :| := ( ) [ ] { }
types:   int real string char bool nat ORDINAL
types:   object object?
types:   bv1 bv10 bv0
types:   array array2 array20 array10
types:   array? array2? array20? array10?
ids:     array1 array0 array02 bv02 bv_1
ids:     intx natx int0 int_ int? bv1_ bv1x array2x
types:   seq&lt;int&gt;  set &lt; bool &gt;
types:   map&lt;bool,bool&gt;  imap &lt; bool , bool &gt;
types:   seq&lt;Node&gt; seq&lt; Node &gt;
types:   seq&lt;set&lt; real&gt; &gt;
types:   map&lt;set&lt;int&gt;,seq&lt;bool&gt;&gt;
types:   G&lt;A,int&gt; G&lt;G&lt;A&gt;,G&lt;bool&gt;&gt;
types:   seq map imap set iset multiset
ids:     seqx mapx
no arg:  seq &lt; &gt;  seq &lt; , &gt;  seq &lt;bool , , bool &gt;  seq&lt;bool,&gt;
keywords: if while assert assume
spec:    requires  reads modifies
attribute:  {: MyAttribute "asd", 34 }
attribute:  {: MyAttribute }
comment:  // comment
comment:  /* comment */ after
comment:  // comment /* asd */ dfg
comment:  /* comment /* embedded */ tail */ after
comment:  /* comment // embedded */ after
comment: /* comment
   /* inner comment
   */
   outer comment
   */ after
   more after
</code></pre>

<h2 id="26-references">26. References</h2>
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:binding" role="doc-endnote">
      <p>The binding power of shift and bit-wise operations is different than in C-like languages.&nbsp;<a href="#fnref:binding" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-map-display" role="doc-endnote">
      <p>This is likely to change in the future to disallow
multiple occurrences of the same key.&nbsp;<a href="#fnref:fn-map-display" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-map-membership" role="doc-endnote">
      <p>This is likely to change in the future as
follows:  The <code>in</code> and <code>!in</code> operations will no longer be
supported on maps, with <code>x in m</code> replaced by <code>x in m.Keys</code>,
and similarly for <code>!in</code>.&nbsp;<a href="#fnref:fn-map-membership" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-traits" role="doc-endnote">
      <p>Traits are new to Dafny and are likely to evolve for a while.&nbsp;<a href="#fnref:fn-traits" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:overload" role="doc-endnote">
      <p>It is possible to conceive of a mechanism for disambiguating&nbsp;<a href="#fnref:overload" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-iterator-field-names" role="doc-endnote">
      <p>It would make sense to rename the special
fields <code>_reads</code> and <code>_modifies</code> to have the same names as the
corresponding keywords, <code>reads</code> and <code>modifies</code>, as is done for
function values.  Also, the various <code>_decreases\(_i_\)</code> fields can be
combined into one field named <code>decreases</code> whose type is a
<em>n</em>-tuple. These changes may be incorporated into a future version
of Dafny.&nbsp;<a href="#fnref:fn-iterator-field-names" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-copredicate-restriction" role="doc-endnote">
      <p>Higher-order function support in Dafny is
rather modest and typical reasoning patterns do not involve them, so this
restriction is not as limiting as it would have been in, e.g., Coq.&nbsp;<a href="#fnref:fn-copredicate-restriction" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-co-predicate-co-lemma-diffs" role="doc-endnote">
      <p>Note, two places where co-predicates
and co-lemmas are not analogous are (a) co-predicates must not make
recursive calls to their prefix predicates and (b) co-predicates cannot
mention <code>_k</code>.&nbsp;<a href="#fnref:fn-co-predicate-co-lemma-diffs" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:Old" role="doc-endnote">
      <p>The semantics of <code>old</code> in Dafny differs from similar&nbsp;<a href="#fnref:Old" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:set-of-objects-not-in-functions" role="doc-endnote">
      <p>In order to be deterministic, the result of a function should only depend on the arguments and of the objects  it <a href="#sec-reads-clause">reads</a>, and Dafny does not provide a way to explicitely pass the entire heap as the argument to a function. See <a href="https://github.com/dafny-lang/dafny/issues/1366#issuecomment-906785889">this post</a> for more insights.&nbsp;<a href="#fnref:set-of-objects-not-in-functions" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:CTC" role="doc-endnote">
      <p>This set of operations that are constant-folded may be enlarged in&nbsp;<a href="#fnref:CTC" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:boogie-attributes" role="doc-endnote">
      <p>All entities that Dafny translates to Boogie have their attributes passed on to Boogie except for the <a href="#sec-axiom"><code>{:axiom}</code></a> attribute (which conflicts with Boogie usage) and the <a href="#sec-trigger"><code>{:trigger}</code></a> attribute which is instead converted into a Boogie quantifier <em>trigger</em>. See Section 11 of [@Leino:Boogie2-RefMan].&nbsp;<a href="#fnref:boogie-attributes" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:fn-duplicate-files" role="doc-endnote">
      <p>File names are considered equal if they&nbsp;<a href="#fnref:fn-duplicate-files" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:explainer-assume-false" role="doc-endnote">
      <p><code>assume false</code> tells the Dafny verifier Assume 
everything is true from this point of the program. The reason is that, 
false proves anything. For example, <code>false ==&gt; A</code> is always true because it is equivalent to <code>!false || A</code>, which reduces to <code>true || A</code>, which reduces to <code>true</code>.&nbsp;<a href="#fnref:explainer-assume-false" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:answer-slowdown" role="doc-endnote">
      <p><code>assert P;</code>.&nbsp;<a href="#fnref:answer-slowdown" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:verifier-lost" role="doc-endnote">
      <p>By default, the expression of an assertion or a precondition is
 added to the knowledge base of the Dafny verifier for further 
assertions or postconditions. However, this is not always desirable, 
because if the verifier has too much knowledge, it might get lost trying
 to prove something in the wrong direction.&nbsp;<a href="#fnref:verifier-lost" class="reversefootnote" role="doc-backlink"></a>&nbsp;<a href="#fnref:verifier-lost:1" class="reversefootnote" role="doc-backlink"><sup>2</sup></a>&nbsp;<a href="#fnref:verifier-lost:2" class="reversefootnote" role="doc-backlink"><sup>3</sup></a>&nbsp;<a href="#fnref:verifier-lost:3" class="reversefootnote" role="doc-backlink"><sup>4</sup></a></p>
    </li>
    <li id="fn:precision-requires-clause" role="doc-endnote">
      <p>Dafny actually breaks things down further. For example, a precondition <code>requires A &amp;&amp; B</code> or an assert statement <code>assert A &amp;&amp; B;</code> turns into two assertions, more or less like <code>requires A requires B</code> and <code>assert A; assert B;</code>.&nbsp;<a href="#fnref:precision-requires-clause" class="reversefootnote" role="doc-backlink"></a>&nbsp;<a href="#fnref:precision-requires-clause:1" class="reversefootnote" role="doc-backlink"><sup>2</sup></a></p>
    </li>
    <li id="fn:complexity-path-encoding" role="doc-endnote">
      <p>All the complexities of the execution paths (if-then-else, 
loops, goto, break.) are, down the road and for verification purposes, 
cleverly encoded with variables recording the paths and guarding 
assumptions made on each path. In practice, a second clever encoding of 
variables enables grouping many assertions together, and recovers which 
assertion is failing based on the value of variables that the SMT solver
 returns.&nbsp;<a href="#fnref:complexity-path-encoding" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:smt-encoding" role="doc-endnote">
      <p>The formula sent to the underlying SMT solver is the negation 
of the formula that the verifier wants to prove - also called a VC or 
verification condition. Hence, if the SMT solver returns unsat, it 
means that the SMT formula is always false, meaning the verifiers 
formula is always true. On the other side, if the SMT solver returns 
sat, it means that the SMT formula can be made true with a special 
variable assignment, which means that the verifiers formula is false 
under that same variable assignment, meaning its a counter-example for 
the verifier. In practice and because of quantifiers, the SMT solver 
will usually return unknown instead of sat, but will still provide a
 variable assignment that it couldnt prove that it does not make the 
formula true. Dafny reports it as a counter-example but it might not 
be a real counter-example, only provide hints about what Dafny 
knows.&nbsp;<a href="#fnref:smt-encoding" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:example-assertion-turned-into-assumption" role="doc-endnote">
      <p>This <a href="https://github.com/dafny-lang/dafny/discussions/1898#discussioncomment-2344533">post</a> gives an overview of how assertions are turned into assumptions for verification purposes.&nbsp;<a href="#fnref:example-assertion-turned-into-assumption" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:caveat-about-assertion-and-assumption" role="doc-endnote">
      <p>Caveat about assertion and assumption: One big difference 
between an assertion transformed in an assumption and the original 
assertion is that the original assertion can unroll functions twice,
 whereas the assumed assertion can unroll them only once. Hence, Dafny
 can still continue to analyze assertions after a failing assertion 
without automatically proving false (which would make all further 
assertions vacuous).&nbsp;<a href="#fnref:caveat-about-assertion-and-assumption" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
    <li id="fn:smaller-batches" role="doc-endnote">
      <p>To create a smaller batch, Dafny duplicates the assertion 
batch, and arbitrarily transforms the clones of an assertion into 
assumptions except in exactly one batch, so that each assertion is 
verified only in one batch. This results in easier formulas for the 
verifier because it has less to prove, but it takes more overhead 
because every verification instance have a common set of axioms and 
there is no knowledge sharing between instances because they run 
independently.&nbsp;<a href="#fnref:smaller-batches" class="reversefootnote" role="doc-backlink"></a></p>
    </li>
  </ol>
</div>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">

</footer>



<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size3, sans-serif;"></div></div></body></html>